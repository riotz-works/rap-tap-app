(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{193:function(t,e,a){"use strict";a(199),a(201);var n=a(197),r=a.n(n),o=a(50);if(r.a.initializeApp(o.a.firebase),!r.a.auth||!r.a.database)throw Error("firebase auth and database are not supported");r.a.auth().signInAnonymously();var s=r.a.database();e.a=s},196:function(t,e,a){var n=a(207);"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);(0,a(37).default)("0f32f924",n,!0,{sourceMap:!1})},206:function(t,e,a){"use strict";var n=a(196);a.n(n).a},207:function(t,e,a){(e=a(36)(!1)).push([t.i,".chat-contents[data-v-3c6248f3]{max-height:200px;overflow:scroll}.chat-content-flex[data-v-3c6248f3],.chat-input-flex[data-v-3c6248f3]{margin:.2em}",""]),t.exports=e},209:function(t,e,a){var n=a(253);"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);(0,a(37).default)("0eb44e56",n,!0,{sourceMap:!1})},211:function(t,e,a){"use strict";a(26);var n=a(0),r=a(193),o=n.default.extend({name:"Chat",props:{roomId:{type:String,required:!0},myNickname:{type:String,required:!0}},data:function(){return{chatCount:0,chats:[],chatInputMessage:""}},mounted:function(){var t=this;r.a.ref("/rooms/".concat(this.roomId,"/messages")).on("child_added",(function(e){if(e&&e.val()){var a=e.val();t.chats.push({id:"chatid-".concat(t.chatCount+1),nickname:a.name,content:a.content}),t.chatCount++}}))},methods:{sendChatMessage:function(){r.a.ref("/rooms/".concat(this.roomId,"/messages")).push({name:this.myNickname,content:this.chatInputMessage}),this.chatInputMessage=""}}}),s=(a(206),a(25)),c=Object(s.a)(o,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("section",[a("v-layout",{attrs:{row:""}},[a("v-flex",{staticClass:"chat-content-flex",attrs:{xs12:""}},[a("v-card",{staticClass:"chat-contents transparent-panel"},t._l(t.chats,(function(e){return a("div",{key:e.id},[a("v-chip",{attrs:{label:"",color:"pink","text-color":"white"}},[t._v("\n            "+t._s(e.nickname)+"\n          ")]),t._v(t._s(e.content)+"\n        ")],1)})),0)],1)],1),t._v(" "),a("v-layout",{attrs:{row:""}},[a("v-flex",{staticClass:"chat-input-flex",attrs:{xs12:""}},[a("v-card",{staticClass:"transparent-panel"},[a("v-card-actions",[a("v-text-field",{attrs:{counter:20,"append-icon":"chat",label:"メッセージを入力してください",required:""},on:{"click:append":t.sendChatMessage},model:{value:t.chatInputMessage,callback:function(e){t.chatInputMessage=e},expression:"chatInputMessage"}})],1)],1)],1)],1)],1)}),[],!1,null,"3c6248f3",null);e.a=c.exports},252:function(t,e,a){"use strict";var n=a(209);a.n(n).a},253:function(t,e,a){(e=a(36)(!1)).push([t.i,".battle-movie[data-v-56dde882]{width:100%;height:auto}.display-label[data-v-56dde882]{margin:.5em 0;width:100%}.margin-0-2[data-v-56dde882]{margin:.2em}",""]),t.exports=e},260:function(t,e,a){"use strict";a.r(e);a(218);var n=a(219),r=a.n(n),o=a(0),s=a(211),c=a(50),i=a(193),p=o.default.extend({components:{Chat:s.a},data:function(){return{roomState:"wating",peer:void 0,rapperStreamA:void 0,rapperStreamB:void 0,rappers:{A:{state:"waiting",nickname:"Waiting...",peerId:void 0,feedback:{thumbUp:0,thumbDown:0}},B:{state:"waiting",nickname:"Waiting...",peerId:void 0,feedback:{thumbUp:0,thumbDown:0}}}}},computed:{roomId:function(){return this.$route.query.roomId},roomName:function(){return this.$route.query.roomName},nickname:function(){return this.$route.query.nickname}},mounted:function(){var t=this;this.peer=new r.a({key:c.a.skywayApiKey,debug:3}),this.peer.on("open",(function(){var e=t.peer.joinRoom(t.roomId,{mode:"sfu"});e.on("peerJoin",(function(){})),e.on("stream",(function(e){t.$coreApi.get("/rooms/".concat(t.roomId)).then((function(a){var n=a.data.rappers.find((function(t){return t.peerId===e.peerId}));if(n){if(t.rappers.A.peerId){if(!t.rappers.B.peerId){t.rappers.B.peerId=n.peerId,t.rappers.B.nickname=n.nickname,i.a.ref("/rooms/".concat(t.roomId,"/rappers/").concat(t.rappers.B.peerId,"/feedback")).on("value",(function(e){e&&e.val()&&(t.rappers.B.feedback=e.val())})),t.rappers.B.state="entered",t.rapperStreamB=e,document.getElementById("rapper-b").srcObject=e}}else t.rappers.A.peerId=n.peerId,t.rappers.A.nickname=n.nickname,i.a.ref("/rooms/".concat(t.roomId,"/rappers/").concat(t.rappers.A.peerId,"/feedback")).on("value",(function(e){e&&e.val()&&(t.rappers.A.feedback=e.val())})),t.rappers.A.state="entered",t.rapperStreamA=e,document.getElementById("rapper-a").srcObject=e;t.rappers.A.peerId&&t.rappers.B.peerId&&(t.roomState="started")}}))}))}))},methods:{sendMessage:function(){i.a.ref("/rooms/".concat(this.$route.query.roomId,"/messages")).push({name:this.nickname,content:this.chatMessage}),this.chatMessage=""},onClickThumbUpForA:function(){i.a.ref("/rooms/".concat(this.$route.query.roomId,"/rappers/").concat(this.rappers.A.peerId,"/feedback")).transaction((function(t){return t?{thumbUp:t.thumbUp+1,thumbDown:t.thumbDown}:void 0}))},onClickThumbDownForA:function(){i.a.ref("/rooms/".concat(this.$route.query.roomId,"/rappers/").concat(this.rappers.A.peerId,"/feedback")).transaction((function(t){return t?{thumbUp:t.thumbUp,thumbDown:t.thumbDown+1}:void 0}))},onClickThumbUpForB:function(){i.a.ref("/rooms/".concat(this.$route.query.roomId,"/rappers/").concat(this.rappers.B.peerId,"/feedback")).transaction((function(t){return t?{thumbUp:t.thumbUp+1,thumbDown:t.thumbDown}:void 0}))},onClickThumbDownForB:function(){i.a.ref("/rooms/".concat(this.$route.query.roomId,"/rappers/").concat(this.rappers.B.peerId,"/feedback")).transaction((function(t){return t?{thumbUp:t.thumbUp,thumbDown:t.thumbDown+1}:void 0}))}}}),u=(a(252),a(25)),d=Object(u.a)(p,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("section",[a("v-layout",{attrs:{row:""}},[a("v-flex",{staticClass:"margin-0-2",attrs:{xs6:"","text-xs-center":""}},[a("v-card",{staticClass:"transparent-panel"},["waiting"===t.rappers.A.state?a("div",[a("br"),t._v(" "),a("v-progress-circular",{staticClass:"battle-movie",attrs:{size:50,color:"amber",indeterminate:""}})],1):t._e(),t._v(" "),a("video",{staticClass:"battle-movie",attrs:{id:"rapper-a",autoplay:"",playsinline:""}}),t._v(" "),a("v-card-title",[a("div",[t._v(t._s(t.rappers.A.nickname))])]),t._v(" "),a("v-card-actions",[a("v-chip",{attrs:{color:"white",label:"",outline:""},on:{click:t.onClickThumbUpForA}},[a("v-avatar",[a("v-icon",{staticClass:"neon"},[t._v("thumb_up")])],1),t._v(" "),a("span",{staticClass:"neon"},[t._v(t._s(t.rappers.A.feedback.thumbUp))])],1),t._v(" "),a("v-spacer"),t._v(" "),a("v-chip",{attrs:{color:"white",label:"",outline:""},on:{click:t.onClickThumbDownForA}},[a("span",{staticClass:"neon-blue"},[t._v(t._s(t.rappers.A.feedback.thumbDown))]),t._v(" "),a("v-avatar",[a("v-icon",{staticClass:"neon-blue thumbDown"},[t._v("thumb_down")])],1)],1)],1)],1)],1),t._v(" "),a("v-flex",{staticClass:"margin-0-2",attrs:{xs6:"","text-xs-center":""}},[a("v-card",{staticClass:"transparent-panel"},["waiting"===t.rappers.B.state?a("div",[a("br"),t._v(" "),a("v-progress-circular",{staticClass:"battle-movie",attrs:{size:50,color:"amber",indeterminate:""}})],1):t._e(),t._v(" "),a("video",{staticClass:"battle-movie",attrs:{id:"rapper-b",autoplay:"",playsinline:""}}),t._v(" "),a("v-card-title",[a("div",[t._v(t._s(t.rappers.B.nickname))])]),t._v(" "),a("v-card-actions",[a("v-chip",{attrs:{color:"white",label:"",outline:""},on:{click:t.onClickThumbUpForB}},[a("v-avatar",[a("v-icon",{staticClass:"neon"},[t._v("thumb_up")])],1),t._v(" "),a("span",{staticClass:"neon"},[t._v(t._s(t.rappers.B.feedback.thumbUp))])],1),t._v(" "),a("v-spacer"),t._v(" "),a("v-chip",{attrs:{color:"white",label:"",outline:""},on:{click:t.onClickThumbDownForB}},[a("span",{staticClass:"neon-blue"},[t._v(t._s(t.rappers.B.feedback.thumbDown))]),t._v(" "),a("v-avatar",[a("v-icon",{staticClass:"neon-blue thumbDown"},[t._v("thumb_down")])],1)],1)],1)],1)],1)],1),t._v(" "),a("chat",{attrs:{"room-id":t.roomId,"my-nickname":t.nickname}})],1)}),[],!1,null,"56dde882",null);e.default=d.exports}}]);