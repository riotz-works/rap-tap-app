/*! For license information please see LICENSES */
webpackJsonp([2],{"/+CH":function(e,t,n){!function(t,n){e.exports=n()}(window,function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s="./src/peer.js")}({"./node_modules/after/index.js":function(e,t){function n(){}e.exports=function(e,t,r){var i=!1;return r=r||n,o.count=e,0===e?t():o;function o(e,n){if(o.count<=0)throw new Error("after called too many times");--o.count,e?(i=!0,t(e),t=r):0!==o.count||i||t(null,n)}}},"./node_modules/arraybuffer.slice/index.js":function(e,t){e.exports=function(e,t,n){var r=e.byteLength;if(t=t||0,n=n||r,e.slice)return e.slice(t,n);if(t<0&&(t+=r),n<0&&(n+=r),n>r&&(n=r),t>=r||t>=n||0===r)return new ArrayBuffer(0);for(var i=new Uint8Array(e),o=new Uint8Array(n-t),s=t,a=0;s<n;s++,a++)o[a]=i[s];return o.buffer}},"./node_modules/backo2/index.js":function(e,t){function n(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}e.exports=n,n.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),n=Math.floor(t*this.jitter*e);e=0==(1&Math.floor(10*t))?e-n:e+n}return 0|Math.min(e,this.max)},n.prototype.reset=function(){this.attempts=0},n.prototype.setMin=function(e){this.ms=e},n.prototype.setMax=function(e){this.max=e},n.prototype.setJitter=function(e){this.jitter=e}},"./node_modules/base64-arraybuffer/lib/base64-arraybuffer.js":function(e,t){!function(){"use strict";for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n=new Uint8Array(256),r=0;r<e.length;r++)n[e.charCodeAt(r)]=r;t.encode=function(t){var n,r=new Uint8Array(t),i=r.length,o="";for(n=0;n<i;n+=3)o+=e[r[n]>>2],o+=e[(3&r[n])<<4|r[n+1]>>4],o+=e[(15&r[n+1])<<2|r[n+2]>>6],o+=e[63&r[n+2]];return i%3==2?o=o.substring(0,o.length-1)+"=":i%3==1&&(o=o.substring(0,o.length-2)+"=="),o},t.decode=function(e){var t,r,i,o,s,a=.75*e.length,u=e.length,c=0;"="===e[e.length-1]&&(a--,"="===e[e.length-2]&&a--);var h=new ArrayBuffer(a),l=new Uint8Array(h);for(t=0;t<u;t+=4)r=n[e.charCodeAt(t)],i=n[e.charCodeAt(t+1)],o=n[e.charCodeAt(t+2)],s=n[e.charCodeAt(t+3)],l[c++]=r<<2|i>>4,l[c++]=(15&i)<<4|o>>2,l[c++]=(3&o)<<6|63&s;return h}}()},"./node_modules/base64-js/index.js":function(e,t,n){"use strict";t.byteLength=function(e){return 3*e.length/4-c(e)},t.toByteArray=function(e){var t,n,r,s,a,u=e.length;s=c(e),a=new o(3*u/4-s),n=s>0?u-4:u;var h=0;for(t=0;t<n;t+=4)r=i[e.charCodeAt(t)]<<18|i[e.charCodeAt(t+1)]<<12|i[e.charCodeAt(t+2)]<<6|i[e.charCodeAt(t+3)],a[h++]=r>>16&255,a[h++]=r>>8&255,a[h++]=255&r;2===s?(r=i[e.charCodeAt(t)]<<2|i[e.charCodeAt(t+1)]>>4,a[h++]=255&r):1===s&&(r=i[e.charCodeAt(t)]<<10|i[e.charCodeAt(t+1)]<<4|i[e.charCodeAt(t+2)]>>2,a[h++]=r>>8&255,a[h++]=255&r);return a},t.fromByteArray=function(e){for(var t,n=e.length,i=n%3,o="",s=[],a=0,u=n-i;a<u;a+=16383)s.push(l(e,a,a+16383>u?u:a+16383));1===i?(t=e[n-1],o+=r[t>>2],o+=r[t<<4&63],o+="=="):2===i&&(t=(e[n-2]<<8)+e[n-1],o+=r[t>>10],o+=r[t>>4&63],o+=r[t<<2&63],o+="=");return s.push(o),s.join("")};for(var r=[],i=[],o="undefined"!=typeof Uint8Array?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0,u=s.length;a<u;++a)r[a]=s[a],i[s.charCodeAt(a)]=a;function c(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");return"="===e[t-2]?2:"="===e[t-1]?1:0}function h(e){return r[e>>18&63]+r[e>>12&63]+r[e>>6&63]+r[63&e]}function l(e,t,n){for(var r,i=[],o=t;o<n;o+=3)r=(e[o]<<16)+(e[o+1]<<8)+e[o+2],i.push(h(r));return i.join("")}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63},"./node_modules/blob/index.js":function(e,t,n){(function(t){var n=t.BlobBuilder||t.WebKitBlobBuilder||t.MSBlobBuilder||t.MozBlobBuilder,r=function(){try{return 2===new Blob(["hi"]).size}catch(e){return!1}}(),i=r&&function(){try{return 2===new Blob([new Uint8Array([1,2])]).size}catch(e){return!1}}(),o=n&&n.prototype.append&&n.prototype.getBlob;function s(e){for(var t=0;t<e.length;t++){var n=e[t];if(n.buffer instanceof ArrayBuffer){var r=n.buffer;if(n.byteLength!==r.byteLength){var i=new Uint8Array(n.byteLength);i.set(new Uint8Array(r,n.byteOffset,n.byteLength)),r=i.buffer}e[t]=r}}}function a(e,t){t=t||{};var r=new n;s(e);for(var i=0;i<e.length;i++)r.append(e[i]);return t.type?r.getBlob(t.type):r.getBlob()}function u(e,t){return s(e),new Blob(e,t||{})}e.exports=r?i?t.Blob:u:o?a:void 0}).call(this,n("./node_modules/webpack/buildin/global.js"))},"./node_modules/component-bind/index.js":function(e,t){var n=[].slice;e.exports=function(e,t){if("string"==typeof t&&(t=e[t]),"function"!=typeof t)throw new Error("bind() requires a function");var r=n.call(arguments,2);return function(){return t.apply(e,r.concat(n.call(arguments)))}}},"./node_modules/component-emitter/index.js":function(e,t,n){function r(e){if(e)return function(e){for(var t in r.prototype)e[t]=r.prototype[t];return e}(e)}e.exports=r,r.prototype.on=r.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},r.prototype.once=function(e,t){function n(){this.off(e,n),t.apply(this,arguments)}return n.fn=t,this.on(e,n),this},r.prototype.off=r.prototype.removeListener=r.prototype.removeAllListeners=r.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n,r=this._callbacks["$"+e];if(!r)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var i=0;i<r.length;i++)if((n=r[i])===t||n.fn===t){r.splice(i,1);break}return this},r.prototype.emit=function(e){this._callbacks=this._callbacks||{};var t=[].slice.call(arguments,1),n=this._callbacks["$"+e];if(n)for(var r=0,i=(n=n.slice(0)).length;r<i;++r)n[r].apply(this,t);return this},r.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},r.prototype.hasListeners=function(e){return!!this.listeners(e).length}},"./node_modules/component-inherit/index.js":function(e,t){e.exports=function(e,t){var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},"./node_modules/decode-uri-component/index.js":function(e,t,n){"use strict";var r=new RegExp("%[a-f0-9]{2}","gi"),i=new RegExp("(%[a-f0-9]{2})+","gi");function o(e,t){try{return decodeURIComponent(e.join(""))}catch(e){}if(1===e.length)return e;t=t||1;var n=e.slice(0,t),r=e.slice(t);return Array.prototype.concat.call([],o(n),o(r))}function s(e){try{return decodeURIComponent(e)}catch(i){for(var t=e.match(r),n=1;n<t.length;n++)t=(e=o(t,n).join("")).match(r);return e}}e.exports=function(e){if("string"!=typeof e)throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof e+"`");try{return e=e.replace(/\+/g," "),decodeURIComponent(e)}catch(t){return function(e){for(var t={"%FE%FF":"��","%FF%FE":"��"},n=i.exec(e);n;){try{t[n[0]]=decodeURIComponent(n[0])}catch(e){var r=s(n[0]);r!==n[0]&&(t[n[0]]=r)}n=i.exec(e)}t["%C2"]="�";for(var o=Object.keys(t),a=0;a<o.length;a++){var u=o[a];e=e.replace(new RegExp(u,"g"),t[u])}return e}(e)}}},"./node_modules/detect-browser/index.js":function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){return function(e,t,n){this.name=e,this.version=t,this.os=n}}();t.BrowserInfo=n;var r=function(){return function(t){this.version=t,this.name="node",this.os=e.platform}}();t.NodeInfo=r;var i=function(){return function(){this.bot=!0,this.name="bot",this.version=null,this.os=null}}();t.BotInfo=i;var o=3,s=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["vivaldi",/Vivaldi\/([0-9\.]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)$/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FBAV\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["searchbot",/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/]],a=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/],["Search Bot",/(nuhk)|(Googlebot)|(Yammybot)|(Openbot)|(Slurp)|(MSNBot)|(Ask Jeeves\/Teoma)|(ia_archiver)/]];function u(e){var t=""!==e&&s.reduce(function(t,n){var r=n[0],i=n[1];if(t)return t;var o=i.exec(e);return!!o&&[r,o]},!1);if(!t)return null;var r=t[0],a=t[1];if("searchbot"===r)return new i;var u=a[1]&&a[1].split(/[._]/).slice(0,3);return u?u.length<o&&(u=u.concat(function(e){for(var t=[],n=0;n<e;n++)t.push("0");return t}(o-u.length))):u=[],new n(r,u.join("."),c(e))}function c(e){for(var t=0,n=a.length;t<n;t++){var r=a[t],i=r[0];if(r[1].test(e))return i}return null}function h(){return void 0!==e&&e.version?new r(e.version.slice(1)):null}t.detect=function(){return"undefined"!=typeof navigator?u(navigator.userAgent):h()},t.parseUserAgent=u,t.detectOS=c,t.getNodeVersion=h}).call(this,n("./node_modules/process/browser.js"))},"./node_modules/engine.io-parser/lib/browser.js":function(e,t,n){(function(e){var r,i=n("./node_modules/engine.io-parser/lib/keys.js"),o=n("./node_modules/has-binary2/index.js"),s=n("./node_modules/arraybuffer.slice/index.js"),a=n("./node_modules/after/index.js"),u=n("./node_modules/engine.io-parser/lib/utf8.js");e&&e.ArrayBuffer&&(r=n("./node_modules/base64-arraybuffer/lib/base64-arraybuffer.js"));var c="undefined"!=typeof navigator&&/Android/i.test(navigator.userAgent),h="undefined"!=typeof navigator&&/PhantomJS/i.test(navigator.userAgent),l=c||h;t.protocol=3;var p=t.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},d=i(p),f={type:"error",data:"parser error"},m=n("./node_modules/blob/index.js");function y(e,t,n){for(var r=new Array(e.length),i=a(e.length,n),o=function(e,n,i){t(n,function(t,n){r[e]=n,i(t,r)})},s=0;s<e.length;s++)o(s,e[s],i)}t.encodePacket=function(n,r,i,o){"function"==typeof r&&(o=r,r=!1),"function"==typeof i&&(o=i,i=null);var s=void 0===n.data?void 0:n.data.buffer||n.data;if(e.ArrayBuffer&&s instanceof ArrayBuffer)return function(e,n,r){if(!n)return t.encodeBase64Packet(e,r);var i=e.data,o=new Uint8Array(i),s=new Uint8Array(1+i.byteLength);s[0]=p[e.type];for(var a=0;a<o.length;a++)s[a+1]=o[a];return r(s.buffer)}(n,r,o);if(m&&s instanceof e.Blob)return function(e,n,r){if(!n)return t.encodeBase64Packet(e,r);if(l)return function(e,n,r){if(!n)return t.encodeBase64Packet(e,r);var i=new FileReader;return i.onload=function(){e.data=i.result,t.encodePacket(e,n,!0,r)},i.readAsArrayBuffer(e.data)}(e,n,r);var i=new Uint8Array(1);i[0]=p[e.type];var o=new m([i.buffer,e.data]);return r(o)}(n,r,o);if(s&&s.base64)return function(e,n){var r="b"+t.packets[e.type]+e.data.data;return n(r)}(n,o);var a=p[n.type];return void 0!==n.data&&(a+=i?u.encode(String(n.data),{strict:!1}):String(n.data)),o(""+a)},t.encodeBase64Packet=function(n,r){var i,o="b"+t.packets[n.type];if(m&&n.data instanceof e.Blob){var s=new FileReader;return s.onload=function(){var e=s.result.split(",")[1];r(o+e)},s.readAsDataURL(n.data)}try{i=String.fromCharCode.apply(null,new Uint8Array(n.data))}catch(e){for(var a=new Uint8Array(n.data),u=new Array(a.length),c=0;c<a.length;c++)u[c]=a[c];i=String.fromCharCode.apply(null,u)}return o+=e.btoa(i),r(o)},t.decodePacket=function(e,n,r){if(void 0===e)return f;if("string"==typeof e){if("b"===e.charAt(0))return t.decodeBase64Packet(e.substr(1),n);if(r&&!1===(e=function(e){try{e=u.decode(e,{strict:!1})}catch(e){return!1}return e}(e)))return f;var i=e.charAt(0);return Number(i)==i&&d[i]?e.length>1?{type:d[i],data:e.substring(1)}:{type:d[i]}:f}i=new Uint8Array(e)[0];var o=s(e,1);return m&&"blob"===n&&(o=new m([o])),{type:d[i],data:o}},t.decodeBase64Packet=function(e,t){var n=d[e.charAt(0)];if(!r)return{type:n,data:{base64:!0,data:e.substr(1)}};var i=r.decode(e.substr(1));return"blob"===t&&m&&(i=new m([i])),{type:n,data:i}},t.encodePayload=function(e,n,r){"function"==typeof n&&(r=n,n=null);var i=o(e);if(n&&i)return m&&!l?t.encodePayloadAsBlob(e,r):t.encodePayloadAsArrayBuffer(e,r);if(!e.length)return r("0:");y(e,function(e,r){t.encodePacket(e,!!i&&n,!1,function(e){r(null,function(e){return e.length+":"+e}(e))})},function(e,t){return r(t.join(""))})},t.decodePayload=function(e,n,r){if("string"!=typeof e)return t.decodePayloadAsBinary(e,n,r);var i;if("function"==typeof n&&(r=n,n=null),""===e)return r(f,0,1);for(var o,s,a="",u=0,c=e.length;u<c;u++){var h=e.charAt(u);if(":"===h){if(""===a||a!=(o=Number(a)))return r(f,0,1);if(a!=(s=e.substr(u+1,o)).length)return r(f,0,1);if(s.length){if(i=t.decodePacket(s,n,!1),f.type===i.type&&f.data===i.data)return r(f,0,1);if(!1===r(i,u+o,c))return}u+=o,a=""}else a+=h}return""!==a?r(f,0,1):void 0},t.encodePayloadAsArrayBuffer=function(e,n){if(!e.length)return n(new ArrayBuffer(0));y(e,function(e,n){t.encodePacket(e,!0,!0,function(e){return n(null,e)})},function(e,t){var r=t.reduce(function(e,t){var n;return e+(n="string"==typeof t?t.length:t.byteLength).toString().length+n+2},0),i=new Uint8Array(r),o=0;return t.forEach(function(e){var t="string"==typeof e,n=e;if(t){for(var r=new Uint8Array(e.length),s=0;s<e.length;s++)r[s]=e.charCodeAt(s);n=r.buffer}i[o++]=t?0:1;var a=n.byteLength.toString();for(s=0;s<a.length;s++)i[o++]=parseInt(a[s]);i[o++]=255;for(r=new Uint8Array(n),s=0;s<r.length;s++)i[o++]=r[s]}),n(i.buffer)})},t.encodePayloadAsBlob=function(e,n){y(e,function(e,n){t.encodePacket(e,!0,!0,function(e){var t=new Uint8Array(1);if(t[0]=1,"string"==typeof e){for(var r=new Uint8Array(e.length),i=0;i<e.length;i++)r[i]=e.charCodeAt(i);e=r.buffer,t[0]=0}var o=(e instanceof ArrayBuffer?e.byteLength:e.size).toString(),s=new Uint8Array(o.length+1);for(i=0;i<o.length;i++)s[i]=parseInt(o[i]);if(s[o.length]=255,m){var a=new m([t.buffer,s.buffer,e]);n(null,a)}})},function(e,t){return n(new m(t))})},t.decodePayloadAsBinary=function(e,n,r){"function"==typeof n&&(r=n,n=null);for(var i=e,o=[];i.byteLength>0;){for(var a=new Uint8Array(i),u=0===a[0],c="",h=1;255!==a[h];h++){if(c.length>310)return r(f,0,1);c+=a[h]}i=s(i,2+c.length),c=parseInt(c);var l=s(i,0,c);if(u)try{l=String.fromCharCode.apply(null,new Uint8Array(l))}catch(e){var p=new Uint8Array(l);l="";for(h=0;h<p.length;h++)l+=String.fromCharCode(p[h])}o.push(l),i=s(i,c)}var d=o.length;o.forEach(function(e,i){r(t.decodePacket(e,n,!0),i,d)})}}).call(this,n("./node_modules/webpack/buildin/global.js"))},"./node_modules/engine.io-parser/lib/keys.js":function(e,t){e.exports=Object.keys||function(e){var t=[],n=Object.prototype.hasOwnProperty;for(var r in e)n.call(e,r)&&t.push(r);return t}},"./node_modules/engine.io-parser/lib/utf8.js":function(e,t,n){(function(e,r){var i;!function(o){var s="object"==typeof t&&t,a=("object"==typeof e&&e&&e.exports,"object"==typeof r&&r);a.global!==a&&a.window;var u,c,h,l=String.fromCharCode;function p(e){for(var t,n,r=[],i=0,o=e.length;i<o;)(t=e.charCodeAt(i++))>=55296&&t<=56319&&i<o?56320==(64512&(n=e.charCodeAt(i++)))?r.push(((1023&t)<<10)+(1023&n)+65536):(r.push(t),i--):r.push(t);return r}function d(e,t){if(e>=55296&&e<=57343){if(t)throw Error("Lone surrogate U+"+e.toString(16).toUpperCase()+" is not a scalar value");return!1}return!0}function f(e,t){return l(e>>t&63|128)}function m(e,t){if(0==(4294967168&e))return l(e);var n="";return 0==(4294965248&e)?n=l(e>>6&31|192):0==(4294901760&e)?(d(e,t)||(e=65533),n=l(e>>12&15|224),n+=f(e,6)):0==(4292870144&e)&&(n=l(e>>18&7|240),n+=f(e,12),n+=f(e,6)),n+=l(63&e|128)}function y(){if(h>=c)throw Error("Invalid byte index");var e=255&u[h];if(h++,128==(192&e))return 63&e;throw Error("Invalid continuation byte")}function v(e){var t,n;if(h>c)throw Error("Invalid byte index");if(h==c)return!1;if(t=255&u[h],h++,0==(128&t))return t;if(192==(224&t)){if((n=(31&t)<<6|y())>=128)return n;throw Error("Invalid continuation byte")}if(224==(240&t)){if((n=(15&t)<<12|y()<<6|y())>=2048)return d(n,e)?n:65533;throw Error("Invalid continuation byte")}if(240==(248&t)&&(n=(7&t)<<18|y()<<12|y()<<6|y())>=65536&&n<=1114111)return n;throw Error("Invalid UTF-8 detected")}var g={version:"2.1.2",encode:function(e,t){for(var n=!1!==(t=t||{}).strict,r=p(e),i=r.length,o=-1,s="";++o<i;)s+=m(r[o],n);return s},decode:function(e,t){var n=!1!==(t=t||{}).strict;u=p(e),c=u.length,h=0;for(var r,i=[];!1!==(r=v(n));)i.push(r);return function(e){for(var t,n=e.length,r=-1,i="";++r<n;)(t=e[r])>65535&&(i+=l((t-=65536)>>>10&1023|55296),t=56320|1023&t),i+=l(t);return i}(i)}};void 0===(i=function(){return g}.call(t,n,t,e))||(e.exports=i)}()}).call(this,n("./node_modules/webpack/buildin/module.js")(e),n("./node_modules/webpack/buildin/global.js"))},"./node_modules/enum/dist/enum.js":function(e,t,n){"use strict";(function(t){var r=function(e){return e&&e.__esModule?e.default:e},i=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},o=r(n("./node_modules/enum/dist/enumItem.js")),s=n("./node_modules/enum/dist/isType.js").isString,a=n("./node_modules/enum/dist/indexOf.js").indexOf,u=r(n("./node_modules/is-buffer/index.js")),c="LE",h=function(){function e(t,n){var r=this;if(i(this,e),this.size=4,this.indirection=1,n&&s(n)&&(n={name:n}),this._options=n||{},this._options.separator=this._options.separator||" | ",this._options.endianness=this._options.endianness||c,this._options.ignoreCase=this._options.ignoreCase||!1,this._options.freez=this._options.freez||!1,this.enums=[],t.length){this._enumLastIndex=t.length;var a=t;t={};for(var u=0;u<a.length;u++)t[a[u]]=Math.pow(2,u)}for(var h in t)p(this._options.name,h),this[h]=new o(h,t[h],{ignoreCase:this._options.ignoreCase}),this.enums.push(this[h]);this._enumMap=t,this._options.ignoreCase&&(this.getLowerCaseEnums=function(){for(var e={},t=0,n=this.enums.length;t<n;t++)e[this.enums[t].key.toLowerCase()]=this.enums[t];return e}),this._options.name&&(this.name=this._options.name);this.isFlaggable=function(){for(var e=0,t=r.enums.length;e<t;e++){var n=r.enums[e];if(0===n.value||n.value&n.value-1)return!1}return!0}(),this._options.freez&&this.freezeEnums()}return e.prototype.getKey=function(e){var t=this.get(e);if(t)return t.key},e.prototype.getValue=function(e){var t=this.get(e);if(t)return t.value},e.prototype.get=function(e,t){if(null!==e&&void 0!==e){if(u(e)&&(e=e["readUInt32"+this._options.endianness](t||0)),o.isEnumItem(e)){if(a.call(this.enums,e)>=0)return e;if(!this.isFlaggable||this.isFlaggable&&e.key.indexOf(this._options.separator)<0)return;return this.get(e.key)}if(s(e)){var n=this;if(this._options.ignoreCase&&(n=this.getLowerCaseEnums(),e=e.toLowerCase()),e.indexOf(this._options.separator)>0){for(var r=e.split(this._options.separator),i=0,c=0;c<r.length;c++){i|=n[r[c]].value}return new o(e,i)}return n[e]}for(var h in this)if(this.hasOwnProperty(h)&&this[h].value===e)return this[h];var l=null;if(this.isFlaggable)for(var p in this)this.hasOwnProperty(p)&&0!=(e&this[p].value)&&(l?l+=this._options.separator:l="",l+=p);return this.get(l||null)}},e.prototype.set=function(e,t,n){var r=this.get(n);if(r)return e["writeUInt32"+this._options.endianness](r.value,t||0)},e.prototype.freezeEnums=function(){function e(e){return e}return Object.isFrozen&&Object.isSealed&&Object.getOwnPropertyNames&&Object.getOwnPropertyDescriptor&&Object.defineProperties&&Object.__defineGetter__&&Object.__defineSetter__&&function t(n){if("object"==typeof n&&null!==n&&!Object.isFrozen(n)&&!Object.isSealed(n)){for(var r in n)n.hasOwnProperty(r)&&(n.__defineGetter__(r,e.bind(null,n[r])),n.__defineSetter__(r,function(e){throw TypeError("Cannot redefine property; Enum Type is not extensible.")}),t(n[r]));Object.freeze?Object.freeze(n):function(e){Object.getOwnPropertyNames(e).forEach(function(t){Object.getOwnPropertyDescriptor(e,t).configurable&&Object.defineProperties(e,t,{writable:!1,configurable:!1})})}(n)}}(this),this},e.prototype.toJSON=function(){return this._enumMap},e.prototype.extend=function(e){if(e.length){var t=e;e={};for(var n=0;n<t.length;n++){var r=this._enumLastIndex+n;e[t[n]]=Math.pow(2,r)}for(var i in e)p(this._options.name,i),this[i]=new o(i,e[i],{ignoreCase:this._options.ignoreCase}),this.enums.push(this[i]);for(var s in this._enumMap)e[s]=this._enumMap[s];this._enumLastIndex+=e.length,this._enumMap=e,this._options.freez&&this.freezeEnums()}},e.register=function(){var n=void 0===arguments[0]?"Enum":arguments[0];t[n]||(t[n]=e)},e}();e.exports=h;var l=["_options","get","getKey","getValue","enums","isFlaggable","_enumMap","toJSON","_enumLastIndex"];function p(e,t){if(e&&"name"===t||a.call(l,t)>=0)throw new Error("Enum key "+t+" is a reserved word!")}}).call(this,n("./node_modules/webpack/buildin/global.js"))},"./node_modules/enum/dist/enumItem.js":function(e,t,n){"use strict";var r=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},i=n("./node_modules/enum/dist/isType.js"),o=i.isObject,s=i.isString,a=function(){function e(t,n){var i=void 0===arguments[2]?{}:arguments[2];r(this,e),this.key=t,this.value=n,this._options=i,this._options.ignoreCase=this._options.ignoreCase||!1}return e.prototype.has=function(t){return e.isEnumItem(t)?0!=(this.value&t.value):s(t)?this._options.ignoreCase?this.key.toLowerCase().indexOf(t.toLowerCase())>=0:this.key.indexOf(t)>=0:0!=(this.value&t)},e.prototype.is=function(t){return e.isEnumItem(t)?this.key===t.key:s(t)?this._options.ignoreCase?this.key.toLowerCase()===t.toLowerCase():this.key===t:this.value===t},e.prototype.toString=function(){return this.key},e.prototype.toJSON=function(){return this.key},e.prototype.valueOf=function(){return this.value},e.isEnumItem=function(t){return t instanceof e||o(t)&&void 0!==t.key&&void 0!==t.value},e}();e.exports=a},"./node_modules/enum/dist/indexOf.js":function(e,t,n){"use strict";t.__esModule=!0;var r=Array.prototype.indexOf||function(e,t){void 0===t&&(t=0),t<0&&(t+=this.length),t<0&&(t=0);for(var n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};t.indexOf=r},"./node_modules/enum/dist/isType.js":function(e,t,n){"use strict";t.__esModule=!0;var r=function(e,t){return typeof t===e};t.isType=r;t.isObject=function(e){return r("object",e)};t.isString=function(e){return r("string",e)}},"./node_modules/enum/index.js":function(e,t,n){e.exports=n("./node_modules/enum/dist/enum.js")},"./node_modules/has-binary2/index.js":function(e,t,n){(function(t){var r=n("./node_modules/has-binary2/node_modules/isarray/index.js"),i=Object.prototype.toString,o="function"==typeof t.Blob||"[object BlobConstructor]"===i.call(t.Blob),s="function"==typeof t.File||"[object FileConstructor]"===i.call(t.File);e.exports=function e(n){if(!n||"object"!=typeof n)return!1;if(r(n)){for(var i=0,a=n.length;i<a;i++)if(e(n[i]))return!0;return!1}if("function"==typeof t.Buffer&&t.Buffer.isBuffer&&t.Buffer.isBuffer(n)||"function"==typeof t.ArrayBuffer&&n instanceof ArrayBuffer||o&&n instanceof Blob||s&&n instanceof File)return!0;if(n.toJSON&&"function"==typeof n.toJSON&&1===arguments.length)return e(n.toJSON(),!0);for(var u in n)if(Object.prototype.hasOwnProperty.call(n,u)&&e(n[u]))return!0;return!1}}).call(this,n("./node_modules/webpack/buildin/global.js"))},"./node_modules/has-binary2/node_modules/isarray/index.js":function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},"./node_modules/has-cors/index.js":function(e,t){try{e.exports="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(t){e.exports=!1}},"./node_modules/ieee754/index.js":function(e,t){t.read=function(e,t,n,r,i){var o,s,a=8*i-r-1,u=(1<<a)-1,c=u>>1,h=-7,l=n?i-1:0,p=n?-1:1,d=e[t+l];for(l+=p,o=d&(1<<-h)-1,d>>=-h,h+=a;h>0;o=256*o+e[t+l],l+=p,h-=8);for(s=o&(1<<-h)-1,o>>=-h,h+=r;h>0;s=256*s+e[t+l],l+=p,h-=8);if(0===o)o=1-c;else{if(o===u)return s?NaN:1/0*(d?-1:1);s+=Math.pow(2,r),o-=c}return(d?-1:1)*s*Math.pow(2,o-r)},t.write=function(e,t,n,r,i,o){var s,a,u,c=8*o-i-1,h=(1<<c)-1,l=h>>1,p=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,d=r?0:o-1,f=r?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,s=h):(s=Math.floor(Math.log(t)/Math.LN2),t*(u=Math.pow(2,-s))<1&&(s--,u*=2),(t+=s+l>=1?p/u:p*Math.pow(2,1-l))*u>=2&&(s++,u/=2),s+l>=h?(a=0,s=h):s+l>=1?(a=(t*u-1)*Math.pow(2,i),s+=l):(a=t*Math.pow(2,l-1)*Math.pow(2,i),s=0));i>=8;e[n+d]=255&a,d+=f,a/=256,i-=8);for(s=s<<i|a,c+=i;c>0;e[n+d]=255&s,d+=f,s/=256,c-=8);e[n+d-f]|=128*m}},"./node_modules/indexof/index.js":function(e,t){var n=[].indexOf;e.exports=function(e,t){if(n)return e.indexOf(t);for(var r=0;r<e.length;++r)if(e[r]===t)return r;return-1}},"./node_modules/is-buffer/index.js":function(e,t){function n(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}e.exports=function(e){return null!=e&&(n(e)||function(e){return"function"==typeof e.readFloatLE&&"function"==typeof e.slice&&n(e.slice(0,0))}(e)||!!e._isBuffer)}},"./node_modules/isarray/index.js":function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},"./node_modules/js-binarypack/lib/binarypack.js":function(e,t,n){var r=n("./node_modules/js-binarypack/lib/bufferbuilder.js").BufferBuilder,i=n("./node_modules/js-binarypack/lib/bufferbuilder.js").binaryFeatures,o={unpack:function(e){return new s(e).unpack()},pack:function(e){var t=new a;return t.pack(e),t.getBuffer()}};function s(e){this.index=0,this.dataBuffer=e,this.dataView=new Uint8Array(this.dataBuffer),this.length=this.dataBuffer.byteLength}function a(){this.bufferBuilder=new r}function u(e){var t=e.charCodeAt(0);return t<=2047?"00":t<=65535?"000":t<=2097151?"0000":t<=67108863?"00000":"000000"}e.exports=o,s.prototype.unpack=function(){var e,t=this.unpack_uint8();if(t<128)return t;if((224^t)<32)return(224^t)-32;if((e=160^t)<=15)return this.unpack_raw(e);if((e=176^t)<=15)return this.unpack_string(e);if((e=144^t)<=15)return this.unpack_array(e);if((e=128^t)<=15)return this.unpack_map(e);switch(t){case 192:return null;case 193:return;case 194:return!1;case 195:return!0;case 202:return this.unpack_float();case 203:return this.unpack_double();case 204:return this.unpack_uint8();case 205:return this.unpack_uint16();case 206:return this.unpack_uint32();case 207:return this.unpack_uint64();case 208:return this.unpack_int8();case 209:return this.unpack_int16();case 210:return this.unpack_int32();case 211:return this.unpack_int64();case 212:case 213:case 214:case 215:return;case 216:return e=this.unpack_uint16(),this.unpack_string(e);case 217:return e=this.unpack_uint32(),this.unpack_string(e);case 218:return e=this.unpack_uint16(),this.unpack_raw(e);case 219:return e=this.unpack_uint32(),this.unpack_raw(e);case 220:return e=this.unpack_uint16(),this.unpack_array(e);case 221:return e=this.unpack_uint32(),this.unpack_array(e);case 222:return e=this.unpack_uint16(),this.unpack_map(e);case 223:return e=this.unpack_uint32(),this.unpack_map(e)}},s.prototype.unpack_uint8=function(){var e=255&this.dataView[this.index];return this.index++,e},s.prototype.unpack_uint16=function(){var e=this.read(2),t=256*(255&e[0])+(255&e[1]);return this.index+=2,t},s.prototype.unpack_uint32=function(){var e=this.read(4),t=256*(256*(256*e[0]+e[1])+e[2])+e[3];return this.index+=4,t},s.prototype.unpack_uint64=function(){var e=this.read(8),t=256*(256*(256*(256*(256*(256*(256*e[0]+e[1])+e[2])+e[3])+e[4])+e[5])+e[6])+e[7];return this.index+=8,t},s.prototype.unpack_int8=function(){var e=this.unpack_uint8();return e<128?e:e-256},s.prototype.unpack_int16=function(){var e=this.unpack_uint16();return e<32768?e:e-65536},s.prototype.unpack_int32=function(){var e=this.unpack_uint32();return e<Math.pow(2,31)?e:e-Math.pow(2,32)},s.prototype.unpack_int64=function(){var e=this.unpack_uint64();return e<Math.pow(2,63)?e:e-Math.pow(2,64)},s.prototype.unpack_raw=function(e){if(this.length<this.index+e)throw new Error("BinaryPackFailure: index is out of range "+this.index+" "+e+" "+this.length);var t=this.dataBuffer.slice(this.index,this.index+e);return this.index+=e,t},s.prototype.unpack_string=function(e){for(var t,n,r=this.read(e),i=0,o="";i<e;)(t=r[i])<128?(o+=String.fromCharCode(t),i++):(192^t)<32?(n=(192^t)<<6|63&r[i+1],o+=String.fromCharCode(n),i+=2):(n=(15&t)<<12|(63&r[i+1])<<6|63&r[i+2],o+=String.fromCharCode(n),i+=3);return this.index+=e,o},s.prototype.unpack_array=function(e){for(var t=new Array(e),n=0;n<e;n++)t[n]=this.unpack();return t},s.prototype.unpack_map=function(e){for(var t={},n=0;n<e;n++){var r=this.unpack(),i=this.unpack();t[r]=i}return t},s.prototype.unpack_float=function(){var e=this.unpack_uint32(),t=(e>>23&255)-127;return(0==e>>31?1:-1)*(8388607&e|8388608)*Math.pow(2,t-23)},s.prototype.unpack_double=function(){var e=this.unpack_uint32(),t=this.unpack_uint32(),n=e>>31,r=(e>>20&2047)-1023,i=(1048575&e|1048576)*Math.pow(2,r-20)+t*Math.pow(2,r-52);return(0==n?1:-1)*i},s.prototype.read=function(e){var t=this.index;if(t+e<=this.length)return this.dataView.subarray(t,t+e);throw new Error("BinaryPackFailure: read index out of range")},a.prototype.getBuffer=function(){return this.bufferBuilder.getBuffer()},a.prototype.pack=function(e){var t=typeof e;if("string"==t)this.pack_string(e);else if("number"==t)Math.floor(e)===e?this.pack_integer(e):this.pack_double(e);else if("boolean"==t)!0===e?this.bufferBuilder.append(195):!1===e&&this.bufferBuilder.append(194);else if("undefined"==t)this.bufferBuilder.append(192);else{if("object"!=t)throw new Error('Type "'+t+'" not yet supported');if(null===e)this.bufferBuilder.append(192);else{var n=e.constructor;if(n==Array)this.pack_array(e);else if(n==Blob||n==File)this.pack_bin(e);else if(n==ArrayBuffer)i.useArrayBufferView?this.pack_bin(new Uint8Array(e)):this.pack_bin(e);else if("BYTES_PER_ELEMENT"in e)i.useArrayBufferView?this.pack_bin(new Uint8Array(e.buffer)):this.pack_bin(e.buffer);else if(n==Object)this.pack_object(e);else if(n==Date)this.pack_string(e.toString());else{if("function"!=typeof e.toBinaryPack)throw new Error('Type "'+n.toString()+'" not yet supported');this.bufferBuilder.append(e.toBinaryPack())}}}this.bufferBuilder.flush()},a.prototype.pack_bin=function(e){var t=e.length||e.byteLength||e.size;if(t<=15)this.pack_uint8(160+t);else if(t<=65535)this.bufferBuilder.append(218),this.pack_uint16(t);else{if(!(t<=4294967295))throw new Error("Invalid length");this.bufferBuilder.append(219),this.pack_uint32(t)}this.bufferBuilder.append(e)},a.prototype.pack_string=function(e){var t=function(e){return e.length>600?new Blob([e]).size:e.replace(/[^\u0000-\u007F]/g,u).length}(e);if(t<=15)this.pack_uint8(176+t);else if(t<=65535)this.bufferBuilder.append(216),this.pack_uint16(t);else{if(!(t<=4294967295))throw new Error("Invalid length");this.bufferBuilder.append(217),this.pack_uint32(t)}this.bufferBuilder.append(e)},a.prototype.pack_array=function(e){var t=e.length;if(t<=15)this.pack_uint8(144+t);else if(t<=65535)this.bufferBuilder.append(220),this.pack_uint16(t);else{if(!(t<=4294967295))throw new Error("Invalid length");this.bufferBuilder.append(221),this.pack_uint32(t)}for(var n=0;n<t;n++)this.pack(e[n])},a.prototype.pack_integer=function(e){if(-32<=e&&e<=127)this.bufferBuilder.append(255&e);else if(0<=e&&e<=255)this.bufferBuilder.append(204),this.pack_uint8(e);else if(-128<=e&&e<=127)this.bufferBuilder.append(208),this.pack_int8(e);else if(0<=e&&e<=65535)this.bufferBuilder.append(205),this.pack_uint16(e);else if(-32768<=e&&e<=32767)this.bufferBuilder.append(209),this.pack_int16(e);else if(0<=e&&e<=4294967295)this.bufferBuilder.append(206),this.pack_uint32(e);else if(-2147483648<=e&&e<=2147483647)this.bufferBuilder.append(210),this.pack_int32(e);else if(-0x8000000000000000<=e&&e<=0x8000000000000000)this.bufferBuilder.append(211),this.pack_int64(e);else{if(!(0<=e&&e<=0x10000000000000000))throw new Error("Invalid integer");this.bufferBuilder.append(207),this.pack_uint64(e)}},a.prototype.pack_double=function(e){var t=0;e<0&&(t=1,e=-e);var n=Math.floor(Math.log(e)/Math.LN2),r=e/Math.pow(2,n)-1,i=Math.floor(r*Math.pow(2,52)),o=Math.pow(2,32),s=t<<31|n+1023<<20|i/o&1048575,a=i%o;this.bufferBuilder.append(203),this.pack_int32(s),this.pack_int32(a)},a.prototype.pack_object=function(e){var t=Object.keys(e).length;if(t<=15)this.pack_uint8(128+t);else if(t<=65535)this.bufferBuilder.append(222),this.pack_uint16(t);else{if(!(t<=4294967295))throw new Error("Invalid length");this.bufferBuilder.append(223),this.pack_uint32(t)}for(var n in e)e.hasOwnProperty(n)&&(this.pack(n),this.pack(e[n]))},a.prototype.pack_uint8=function(e){this.bufferBuilder.append(e)},a.prototype.pack_uint16=function(e){this.bufferBuilder.append(e>>8),this.bufferBuilder.append(255&e)},a.prototype.pack_uint32=function(e){var t=4294967295&e;this.bufferBuilder.append((4278190080&t)>>>24),this.bufferBuilder.append((16711680&t)>>>16),this.bufferBuilder.append((65280&t)>>>8),this.bufferBuilder.append(255&t)},a.prototype.pack_uint64=function(e){var t=e/Math.pow(2,32),n=e%Math.pow(2,32);this.bufferBuilder.append((4278190080&t)>>>24),this.bufferBuilder.append((16711680&t)>>>16),this.bufferBuilder.append((65280&t)>>>8),this.bufferBuilder.append(255&t),this.bufferBuilder.append((4278190080&n)>>>24),this.bufferBuilder.append((16711680&n)>>>16),this.bufferBuilder.append((65280&n)>>>8),this.bufferBuilder.append(255&n)},a.prototype.pack_int8=function(e){this.bufferBuilder.append(255&e)},a.prototype.pack_int16=function(e){this.bufferBuilder.append((65280&e)>>8),this.bufferBuilder.append(255&e)},a.prototype.pack_int32=function(e){this.bufferBuilder.append(e>>>24&255),this.bufferBuilder.append((16711680&e)>>>16),this.bufferBuilder.append((65280&e)>>>8),this.bufferBuilder.append(255&e)},a.prototype.pack_int64=function(e){var t=Math.floor(e/Math.pow(2,32)),n=e%Math.pow(2,32);this.bufferBuilder.append((4278190080&t)>>>24),this.bufferBuilder.append((16711680&t)>>>16),this.bufferBuilder.append((65280&t)>>>8),this.bufferBuilder.append(255&t),this.bufferBuilder.append((4278190080&n)>>>24),this.bufferBuilder.append((16711680&n)>>>16),this.bufferBuilder.append((65280&n)>>>8),this.bufferBuilder.append(255&n)}},"./node_modules/js-binarypack/lib/bufferbuilder.js":function(e,t){var n={};n.useBlobBuilder=function(){try{return new Blob([]),!1}catch(e){return!0}}(),n.useArrayBufferView=!n.useBlobBuilder&&function(){try{return 0===new Blob([new Uint8Array([])]).size}catch(e){return!0}}(),e.exports.binaryFeatures=n;var r=e.exports.BlobBuilder;function i(){this._pieces=[],this._parts=[]}"undefined"!=typeof window&&(r=e.exports.BlobBuilder=window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder||window.BlobBuilder),i.prototype.append=function(e){"number"==typeof e?this._pieces.push(e):(this.flush(),this._parts.push(e))},i.prototype.flush=function(){if(this._pieces.length>0){var e=new Uint8Array(this._pieces);n.useArrayBufferView||(e=e.buffer),this._parts.push(e),this._pieces=[]}},i.prototype.getBuffer=function(){if(this.flush(),n.useBlobBuilder){for(var e=new r,t=0,i=this._parts.length;t<i;t++)e.append(this._parts[t]);return e.getBlob()}return new Blob(this._parts)},e.exports.BufferBuilder=i},"./node_modules/ms/index.js":function(e,t){var n=1e3,r=60*n,i=60*r,o=24*i,s=365.25*o;function a(e,t,n){if(!(e<t))return e<1.5*t?Math.floor(e/t)+" "+n:Math.ceil(e/t)+" "+n+"s"}e.exports=function(e,t){t=t||{};var u=typeof e;if("string"===u&&e.length>0)return function(e){if((e=String(e)).length>100)return;var t=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(!t)return;var a=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return a*s;case"days":case"day":case"d":return a*o;case"hours":case"hour":case"hrs":case"hr":case"h":return a*i;case"minutes":case"minute":case"mins":case"min":case"m":return a*r;case"seconds":case"second":case"secs":case"sec":case"s":return a*n;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return a;default:return}}(e);if("number"===u&&!1===isNaN(e))return t.long?function(e){return a(e,o,"day")||a(e,i,"hour")||a(e,r,"minute")||a(e,n,"second")||e+" ms"}(e):function(e){if(e>=o)return Math.round(e/o)+"d";if(e>=i)return Math.round(e/i)+"h";if(e>=r)return Math.round(e/r)+"m";if(e>=n)return Math.round(e/n)+"s";return e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},"./node_modules/node-libs-browser/node_modules/buffer/index.js":function(e,t,n){"use strict";(function(e){var r=n("./node_modules/base64-js/index.js"),i=n("./node_modules/ieee754/index.js"),o=n("./node_modules/isarray/index.js");function s(){return u.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function a(e,t){if(s()<t)throw new RangeError("Invalid typed array length");return u.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=u.prototype:(null===e&&(e=new u(t)),e.length=t),e}function u(e,t,n){if(!(u.TYPED_ARRAY_SUPPORT||this instanceof u))return new u(e,t,n);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return l(this,e)}return c(this,e,t,n)}function c(e,t,n,r){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,n,r){if(t.byteLength,n<0||t.byteLength<n)throw new RangeError("'offset' is out of bounds");if(t.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");t=void 0===n&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,n):new Uint8Array(t,n,r);u.TYPED_ARRAY_SUPPORT?(e=t).__proto__=u.prototype:e=p(e,t);return e}(e,t,n,r):"string"==typeof t?function(e,t,n){"string"==typeof n&&""!==n||(n="utf8");if(!u.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|f(t,n),i=(e=a(e,r)).write(t,n);i!==r&&(e=e.slice(0,i));return e}(e,t,n):function(e,t){if(u.isBuffer(t)){var n=0|d(t.length);return 0===(e=a(e,n)).length?e:(t.copy(e,0,0,n),e)}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||function(e){return e!=e}(t.length)?a(e,0):p(e,t);if("Buffer"===t.type&&o(t.data))return p(e,t.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function h(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function l(e,t){if(h(t),e=a(e,t<0?0:0|d(t)),!u.TYPED_ARRAY_SUPPORT)for(var n=0;n<t;++n)e[n]=0;return e}function p(e,t){var n=t.length<0?0:0|d(t.length);e=a(e,n);for(var r=0;r<n;r+=1)e[r]=255&t[r];return e}function d(e){if(e>=s())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s().toString(16)+" bytes");return 0|e}function f(e,t){if(u.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var r=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return U(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return V(e).length;default:if(r)return U(e).length;t=(""+t).toLowerCase(),r=!0}}function m(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function y(e,t,n,r,i){if(0===e.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=i?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(i)return-1;n=e.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof t&&(t=u.from(t,r)),u.isBuffer(t))return 0===t.length?-1:v(e,t,n,r,i);if("number"==typeof t)return t&=255,u.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):v(e,[t],n,r,i);throw new TypeError("val must be string, number or Buffer")}function v(e,t,n,r,i){var o,s=1,a=e.length,u=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;s=2,a/=2,u/=2,n/=2}function c(e,t){return 1===s?e[t]:e.readUInt16BE(t*s)}if(i){var h=-1;for(o=n;o<a;o++)if(c(e,o)===c(t,-1===h?0:o-h)){if(-1===h&&(h=o),o-h+1===u)return h*s}else-1!==h&&(o-=o-h),h=-1}else for(n+u>a&&(n=a-u),o=n;o>=0;o--){for(var l=!0,p=0;p<u;p++)if(c(e,o+p)!==c(t,p)){l=!1;break}if(l)return o}return-1}function g(e,t,n,r){n=Number(n)||0;var i=e.length-n;r?(r=Number(r))>i&&(r=i):r=i;var o=t.length;if(o%2!=0)throw new TypeError("Invalid hex string");r>o/2&&(r=o/2);for(var s=0;s<r;++s){var a=parseInt(t.substr(2*s,2),16);if(isNaN(a))return s;e[n+s]=a}return s}function _(e,t,n,r){return q(U(t,e.length-n),e,n,r)}function b(e,t,n,r){return q(function(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,r)}function w(e,t,n,r){return b(e,t,n,r)}function E(e,t,n,r){return q(V(t),e,n,r)}function S(e,t,n,r){return q(function(e,t){for(var n,r,i,o=[],s=0;s<e.length&&!((t-=2)<0);++s)n=e.charCodeAt(s),r=n>>8,i=n%256,o.push(i),o.push(r);return o}(t,e.length-n),e,n,r)}function C(e,t,n){return 0===t&&n===e.length?r.fromByteArray(e):r.fromByteArray(e.slice(t,n))}function T(e,t,n){n=Math.min(e.length,n);for(var r=[],i=t;i<n;){var o,s,a,u,c=e[i],h=null,l=c>239?4:c>223?3:c>191?2:1;if(i+l<=n)switch(l){case 1:c<128&&(h=c);break;case 2:128==(192&(o=e[i+1]))&&(u=(31&c)<<6|63&o)>127&&(h=u);break;case 3:o=e[i+1],s=e[i+2],128==(192&o)&&128==(192&s)&&(u=(15&c)<<12|(63&o)<<6|63&s)>2047&&(u<55296||u>57343)&&(h=u);break;case 4:o=e[i+1],s=e[i+2],a=e[i+3],128==(192&o)&&128==(192&s)&&128==(192&a)&&(u=(15&c)<<18|(63&o)<<12|(63&s)<<6|63&a)>65535&&u<1114112&&(h=u)}null===h?(h=65533,l=1):h>65535&&(h-=65536,r.push(h>>>10&1023|55296),h=56320|1023&h),r.push(h),i+=l}return function(e){var t=e.length;if(t<=k)return String.fromCharCode.apply(String,e);var n="",r=0;for(;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=k));return n}(r)}t.Buffer=u,t.SlowBuffer=function(e){+e!=e&&(e=0);return u.alloc(+e)},t.INSPECT_MAX_BYTES=50,u.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),t.kMaxLength=s(),u.poolSize=8192,u._augment=function(e){return e.__proto__=u.prototype,e},u.from=function(e,t,n){return c(null,e,t,n)},u.TYPED_ARRAY_SUPPORT&&(u.prototype.__proto__=Uint8Array.prototype,u.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&u[Symbol.species]===u&&Object.defineProperty(u,Symbol.species,{value:null,configurable:!0})),u.alloc=function(e,t,n){return function(e,t,n,r){return h(t),t<=0?a(e,t):void 0!==n?"string"==typeof r?a(e,t).fill(n,r):a(e,t).fill(n):a(e,t)}(null,e,t,n)},u.allocUnsafe=function(e){return l(null,e)},u.allocUnsafeSlow=function(e){return l(null,e)},u.isBuffer=function(e){return!(null==e||!e._isBuffer)},u.compare=function(e,t){if(!u.isBuffer(e)||!u.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var n=e.length,r=t.length,i=0,o=Math.min(n,r);i<o;++i)if(e[i]!==t[i]){n=e[i],r=t[i];break}return n<r?-1:r<n?1:0},u.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(e,t){if(!o(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return u.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var r=u.allocUnsafe(t),i=0;for(n=0;n<e.length;++n){var s=e[n];if(!u.isBuffer(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(r,i),i+=s.length}return r},u.byteLength=f,u.prototype._isBuffer=!0,u.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)m(this,t,t+1);return this},u.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)m(this,t,t+3),m(this,t+1,t+2);return this},u.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)m(this,t,t+7),m(this,t+1,t+6),m(this,t+2,t+5),m(this,t+3,t+4);return this},u.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?T(this,0,e):function(e,t,n){var r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return N(this,t,n);case"utf8":case"utf-8":return T(this,t,n);case"ascii":return I(this,t,n);case"latin1":case"binary":return A(this,t,n);case"base64":return C(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return R(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}.apply(this,arguments)},u.prototype.equals=function(e){if(!u.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===u.compare(this,e)},u.prototype.inspect=function(){var e="",n=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(e+=" ... ")),"<Buffer "+e+">"},u.prototype.compare=function(e,t,n,r,i){if(!u.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),t<0||n>e.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&t>=n)return 0;if(r>=i)return-1;if(t>=n)return 1;if(t>>>=0,n>>>=0,r>>>=0,i>>>=0,this===e)return 0;for(var o=i-r,s=n-t,a=Math.min(o,s),c=this.slice(r,i),h=e.slice(t,n),l=0;l<a;++l)if(c[l]!==h[l]){o=c[l],s=h[l];break}return o<s?-1:s<o?1:0},u.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},u.prototype.indexOf=function(e,t,n){return y(this,e,t,n,!0)},u.prototype.lastIndexOf=function(e,t,n){return y(this,e,t,n,!1)},u.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var i=this.length-t;if((void 0===n||n>i)&&(n=i),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var o=!1;;)switch(r){case"hex":return g(this,e,t,n);case"utf8":case"utf-8":return _(this,e,t,n);case"ascii":return b(this,e,t,n);case"latin1":case"binary":return w(this,e,t,n);case"base64":return E(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return S(this,e,t,n);default:if(o)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),o=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var k=4096;function I(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(127&e[i]);return r}function A(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(e[i]);return r}function N(e,t,n){var r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);for(var i="",o=t;o<n;++o)i+=B(e[o]);return i}function R(e,t,n){for(var r=e.slice(t,n),i="",o=0;o<r.length;o+=2)i+=String.fromCharCode(r[o]+256*r[o+1]);return i}function O(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function x(e,t,n,r,i,o){if(!u.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<o)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function P(e,t,n,r){t<0&&(t=65535+t+1);for(var i=0,o=Math.min(e.length-n,2);i<o;++i)e[n+i]=(t&255<<8*(r?i:1-i))>>>8*(r?i:1-i)}function D(e,t,n,r){t<0&&(t=4294967295+t+1);for(var i=0,o=Math.min(e.length-n,4);i<o;++i)e[n+i]=t>>>8*(r?i:3-i)&255}function M(e,t,n,r,i,o){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function L(e,t,n,r,o){return o||M(e,0,n,4),i.write(e,t,n,r,23,4),n+4}function j(e,t,n,r,o){return o||M(e,0,n,8),i.write(e,t,n,r,52,8),n+8}u.prototype.slice=function(e,t){var n,r=this.length;if(e=~~e,t=void 0===t?r:~~t,e<0?(e+=r)<0&&(e=0):e>r&&(e=r),t<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e),u.TYPED_ARRAY_SUPPORT)(n=this.subarray(e,t)).__proto__=u.prototype;else{var i=t-e;n=new u(i,void 0);for(var o=0;o<i;++o)n[o]=this[o+e]}return n},u.prototype.readUIntLE=function(e,t,n){e|=0,t|=0,n||O(e,t,this.length);for(var r=this[e],i=1,o=0;++o<t&&(i*=256);)r+=this[e+o]*i;return r},u.prototype.readUIntBE=function(e,t,n){e|=0,t|=0,n||O(e,t,this.length);for(var r=this[e+--t],i=1;t>0&&(i*=256);)r+=this[e+--t]*i;return r},u.prototype.readUInt8=function(e,t){return t||O(e,1,this.length),this[e]},u.prototype.readUInt16LE=function(e,t){return t||O(e,2,this.length),this[e]|this[e+1]<<8},u.prototype.readUInt16BE=function(e,t){return t||O(e,2,this.length),this[e]<<8|this[e+1]},u.prototype.readUInt32LE=function(e,t){return t||O(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},u.prototype.readUInt32BE=function(e,t){return t||O(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},u.prototype.readIntLE=function(e,t,n){e|=0,t|=0,n||O(e,t,this.length);for(var r=this[e],i=1,o=0;++o<t&&(i*=256);)r+=this[e+o]*i;return r>=(i*=128)&&(r-=Math.pow(2,8*t)),r},u.prototype.readIntBE=function(e,t,n){e|=0,t|=0,n||O(e,t,this.length);for(var r=t,i=1,o=this[e+--r];r>0&&(i*=256);)o+=this[e+--r]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*t)),o},u.prototype.readInt8=function(e,t){return t||O(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},u.prototype.readInt16LE=function(e,t){t||O(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},u.prototype.readInt16BE=function(e,t){t||O(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},u.prototype.readInt32LE=function(e,t){return t||O(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},u.prototype.readInt32BE=function(e,t){return t||O(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},u.prototype.readFloatLE=function(e,t){return t||O(e,4,this.length),i.read(this,e,!0,23,4)},u.prototype.readFloatBE=function(e,t){return t||O(e,4,this.length),i.read(this,e,!1,23,4)},u.prototype.readDoubleLE=function(e,t){return t||O(e,8,this.length),i.read(this,e,!0,52,8)},u.prototype.readDoubleBE=function(e,t){return t||O(e,8,this.length),i.read(this,e,!1,52,8)},u.prototype.writeUIntLE=function(e,t,n,r){(e=+e,t|=0,n|=0,r)||x(this,e,t,n,Math.pow(2,8*n)-1,0);var i=1,o=0;for(this[t]=255&e;++o<n&&(i*=256);)this[t+o]=e/i&255;return t+n},u.prototype.writeUIntBE=function(e,t,n,r){(e=+e,t|=0,n|=0,r)||x(this,e,t,n,Math.pow(2,8*n)-1,0);var i=n-1,o=1;for(this[t+i]=255&e;--i>=0&&(o*=256);)this[t+i]=e/o&255;return t+n},u.prototype.writeUInt8=function(e,t,n){return e=+e,t|=0,n||x(this,e,t,1,255,0),u.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},u.prototype.writeUInt16LE=function(e,t,n){return e=+e,t|=0,n||x(this,e,t,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):P(this,e,t,!0),t+2},u.prototype.writeUInt16BE=function(e,t,n){return e=+e,t|=0,n||x(this,e,t,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):P(this,e,t,!1),t+2},u.prototype.writeUInt32LE=function(e,t,n){return e=+e,t|=0,n||x(this,e,t,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):D(this,e,t,!0),t+4},u.prototype.writeUInt32BE=function(e,t,n){return e=+e,t|=0,n||x(this,e,t,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):D(this,e,t,!1),t+4},u.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t|=0,!r){var i=Math.pow(2,8*n-1);x(this,e,t,n,i-1,-i)}var o=0,s=1,a=0;for(this[t]=255&e;++o<n&&(s*=256);)e<0&&0===a&&0!==this[t+o-1]&&(a=1),this[t+o]=(e/s>>0)-a&255;return t+n},u.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t|=0,!r){var i=Math.pow(2,8*n-1);x(this,e,t,n,i-1,-i)}var o=n-1,s=1,a=0;for(this[t+o]=255&e;--o>=0&&(s*=256);)e<0&&0===a&&0!==this[t+o+1]&&(a=1),this[t+o]=(e/s>>0)-a&255;return t+n},u.prototype.writeInt8=function(e,t,n){return e=+e,t|=0,n||x(this,e,t,1,127,-128),u.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},u.prototype.writeInt16LE=function(e,t,n){return e=+e,t|=0,n||x(this,e,t,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):P(this,e,t,!0),t+2},u.prototype.writeInt16BE=function(e,t,n){return e=+e,t|=0,n||x(this,e,t,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):P(this,e,t,!1),t+2},u.prototype.writeInt32LE=function(e,t,n){return e=+e,t|=0,n||x(this,e,t,4,2147483647,-2147483648),u.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):D(this,e,t,!0),t+4},u.prototype.writeInt32BE=function(e,t,n){return e=+e,t|=0,n||x(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),u.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):D(this,e,t,!1),t+4},u.prototype.writeFloatLE=function(e,t,n){return L(this,e,t,!0,n)},u.prototype.writeFloatBE=function(e,t,n){return L(this,e,t,!1,n)},u.prototype.writeDoubleLE=function(e,t,n){return j(this,e,t,!0,n)},u.prototype.writeDoubleBE=function(e,t,n){return j(this,e,t,!1,n)},u.prototype.copy=function(e,t,n,r){if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);var i,o=r-n;if(this===e&&n<t&&t<r)for(i=o-1;i>=0;--i)e[i+t]=this[i+n];else if(o<1e3||!u.TYPED_ARRAY_SUPPORT)for(i=0;i<o;++i)e[i+t]=this[i+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+o),t);return o},u.prototype.fill=function(e,t,n,r){if("string"==typeof e){if("string"==typeof t?(r=t,t=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===e.length){var i=e.charCodeAt(0);i<256&&(e=i)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!u.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;var o;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(o=t;o<n;++o)this[o]=e;else{var s=u.isBuffer(e)?e:U(new u(e,r).toString()),a=s.length;for(o=0;o<n-t;++o)this[o+t]=s[o%a]}return this};var F=/[^+\/0-9A-Za-z-_]/g;function B(e){return e<16?"0"+e.toString(16):e.toString(16)}function U(e,t){var n;t=t||1/0;for(var r=e.length,i=null,o=[],s=0;s<r;++s){if((n=e.charCodeAt(s))>55295&&n<57344){if(!i){if(n>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(s+1===r){(t-=3)>-1&&o.push(239,191,189);continue}i=n;continue}if(n<56320){(t-=3)>-1&&o.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(t-=3)>-1&&o.push(239,191,189);if(i=null,n<128){if((t-=1)<0)break;o.push(n)}else if(n<2048){if((t-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function V(e){return r.toByteArray(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(F,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function q(e,t,n,r){for(var i=0;i<r&&!(i+n>=t.length||i>=e.length);++i)t[i+n]=e[i];return i}}).call(this,n("./node_modules/webpack/buildin/global.js"))},"./node_modules/node-libs-browser/node_modules/events/events.js":function(e,t){function n(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function r(e){return"function"==typeof e}function i(e){return"object"==typeof e&&null!==e}function o(e){return void 0===e}e.exports=n,n.EventEmitter=n,n.prototype._events=void 0,n.prototype._maxListeners=void 0,n.defaultMaxListeners=10,n.prototype.setMaxListeners=function(e){if(!function(e){return"number"==typeof e}(e)||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},n.prototype.emit=function(e){var t,n,s,a,u,c;if(this._events||(this._events={}),"error"===e&&(!this._events.error||i(this._events.error)&&!this._events.error.length)){if((t=arguments[1])instanceof Error)throw t;var h=new Error('Uncaught, unspecified "error" event. ('+t+")");throw h.context=t,h}if(o(n=this._events[e]))return!1;if(r(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:a=Array.prototype.slice.call(arguments,1),n.apply(this,a)}else if(i(n))for(a=Array.prototype.slice.call(arguments,1),s=(c=n.slice()).length,u=0;u<s;u++)c[u].apply(this,a);return!0},n.prototype.addListener=function(e,t){var s;if(!r(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,r(t.listener)?t.listener:t),this._events[e]?i(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,i(this._events[e])&&!this._events[e].warned&&(s=o(this._maxListeners)?n.defaultMaxListeners:this._maxListeners)&&s>0&&this._events[e].length>s&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace()),this},n.prototype.on=n.prototype.addListener,n.prototype.once=function(e,t){if(!r(t))throw TypeError("listener must be a function");var n=!1;function i(){this.removeListener(e,i),n||(n=!0,t.apply(this,arguments))}return i.listener=t,this.on(e,i),this},n.prototype.removeListener=function(e,t){var n,o,s,a;if(!r(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(s=(n=this._events[e]).length,o=-1,n===t||r(n.listener)&&n.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(i(n)){for(a=s;a-- >0;)if(n[a]===t||n[a].listener&&n[a].listener===t){o=a;break}if(o<0)return this;1===n.length?(n.length=0,delete this._events[e]):n.splice(o,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},n.prototype.removeAllListeners=function(e){var t,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(r(n=this._events[e]))this.removeListener(e,n);else if(n)for(;n.length;)this.removeListener(e,n[n.length-1]);return delete this._events[e],this},n.prototype.listeners=function(e){return this._events&&this._events[e]?r(this._events[e])?[this._events[e]]:this._events[e].slice():[]},n.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(r(t))return 1;if(t)return t.length}return 0},n.listenerCount=function(e,t){return e.listenerCount(t)}},"./node_modules/object-sizeof/byte_size.js":function(e,t){e.exports={STRING:2,BOOLEAN:4,NUMBER:8}},"./node_modules/object-sizeof/index.js":function(e,t,n){"use strict";var r=n("./node_modules/object-sizeof/byte_size.js"),i=n("./node_modules/node-libs-browser/node_modules/buffer/index.js").Buffer;e.exports=function e(t){if(null!==t&&"object"==typeof t){if(i.isBuffer(t))return t.length;var n=0;for(var o in t)if(Object.hasOwnProperty.call(t,o)){n+=e(o);try{n+=e(t[o])}catch(e){e instanceof RangeError&&(n=0)}}return n}return"string"==typeof t?t.length*r.STRING:"boolean"==typeof t?r.BOOLEAN:"number"==typeof t?r.NUMBER:0}},"./node_modules/parseqs/index.js":function(e,t){t.encode=function(e){var t="";for(var n in e)e.hasOwnProperty(n)&&(t.length&&(t+="&"),t+=encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t},t.decode=function(e){for(var t={},n=e.split("&"),r=0,i=n.length;r<i;r++){var o=n[r].split("=");t[decodeURIComponent(o[0])]=decodeURIComponent(o[1])}return t}},"./node_modules/parseuri/index.js":function(e,t){var n=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,r=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];e.exports=function(e){var t=e,i=e.indexOf("["),o=e.indexOf("]");-1!=i&&-1!=o&&(e=e.substring(0,i)+e.substring(i,o).replace(/:/g,";")+e.substring(o,e.length));for(var s=n.exec(e||""),a={},u=14;u--;)a[r[u]]=s[u]||"";return-1!=i&&-1!=o&&(a.source=t,a.host=a.host.substring(1,a.host.length-1).replace(/;/g,":"),a.authority=a.authority.replace("[","").replace("]","").replace(/;/g,":"),a.ipv6uri=!0),a}},"./node_modules/process/browser.js":function(e,t){var n,r,i=e.exports={};function o(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function a(e){if(n===setTimeout)return setTimeout(e,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(e){n=o}try{r="function"==typeof clearTimeout?clearTimeout:s}catch(e){r=s}}();var u,c=[],h=!1,l=-1;function p(){h&&u&&(h=!1,u.length?c=u.concat(c):l=-1,c.length&&d())}function d(){if(!h){var e=a(p);h=!0;for(var t=c.length;t;){for(u=c,c=[];++l<t;)u&&u[l].run();l=-1,t=c.length}u=null,h=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===s||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function f(e,t){this.fun=e,this.array=t}function m(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];c.push(new f(e,t)),1!==c.length||h||a(d)},f.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=m,i.addListener=m,i.once=m,i.off=m,i.removeListener=m,i.removeAllListeners=m,i.emit=m,i.prependListener=m,i.prependOnceListener=m,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},"./node_modules/query-string/index.js":function(e,t,n){"use strict";const r=n("./node_modules/strict-uri-encode/index.js"),i=n("./node_modules/decode-uri-component/index.js");function o(e,t){return t.encode?t.strict?r(e):encodeURIComponent(e):e}function s(e,t){return t.decode?i(e):e}function a(e){const t=e.indexOf("?");return-1===t?"":e.slice(t+1)}function u(e,t){const n=function(e){let t;switch(e.arrayFormat){case"index":return(e,n,r)=>{t=/\[(\d*)\]$/.exec(e),e=e.replace(/\[\d*\]$/,""),t?(void 0===r[e]&&(r[e]={}),r[e][t[1]]=n):r[e]=n};case"bracket":return(e,n,r)=>{t=/(\[\])$/.exec(e),e=e.replace(/\[\]$/,""),t?void 0!==r[e]?r[e]=[].concat(r[e],n):r[e]=[n]:r[e]=n};case"comma":return(e,t,n)=>{const r="string"==typeof t&&t.split("").indexOf(",")>-1?t.split(","):t;n[e]=r};default:return(e,t,n)=>{void 0!==n[e]?n[e]=[].concat(n[e],t):n[e]=t}}}(t=Object.assign({decode:!0,arrayFormat:"none"},t)),r=Object.create(null);if("string"!=typeof e)return r;if(!(e=e.trim().replace(/^[?#&]/,"")))return r;for(const i of e.split("&")){let[e,o]=i.replace(/\+/g," ").split("=");o=void 0===o?null:s(o,t),n(s(e,t),o,r)}return Object.keys(r).sort().reduce((e,t)=>{const n=r[t];return Boolean(n)&&"object"==typeof n&&!Array.isArray(n)?e[t]=function e(t){return Array.isArray(t)?t.sort():"object"==typeof t?e(Object.keys(t)).sort((e,t)=>Number(e)-Number(t)).map(e=>t[e]):t}(n):e[t]=n,e},Object.create(null))}t.extract=a,t.parse=u,t.stringify=((e,t)=>{if(!e)return"";const n=function(e){switch(e.arrayFormat){case"index":return t=>(n,r)=>{const i=n.length;return void 0===r?n:null===r?[...n,[o(t,e),"[",i,"]"].join("")]:[...n,[o(t,e),"[",o(i,e),"]=",o(r,e)].join("")]};case"bracket":return t=>(n,r)=>void 0===r?n:null===r?[...n,[o(t,e),"[]"].join("")]:[...n,[o(t,e),"[]=",o(r,e)].join("")];case"comma":return t=>(n,r,i)=>r?0===i?[[o(t,e),"=",o(r,e)].join("")]:[[n,o(r,e)].join(",")]:n;default:return t=>(n,r)=>void 0===r?n:null===r?[...n,o(t,e)]:[...n,[o(t,e),"=",o(r,e)].join("")]}}(t=Object.assign({encode:!0,strict:!0,arrayFormat:"none"},t)),r=Object.keys(e);return!1!==t.sort&&r.sort(t.sort),r.map(r=>{const i=e[r];return void 0===i?"":null===i?o(r,t):Array.isArray(i)?i.reduce(n(r),[]).join("&"):o(r,t)+"="+o(i,t)}).filter(e=>e.length>0).join("&")}),t.parseUrl=((e,t)=>{const n=e.indexOf("#");return-1!==n&&(e=e.slice(0,n)),{url:e.split("?")[0]||"",query:u(a(e),t)}})},"./node_modules/sdp-interop/lib/array-equals.js":function(e,t){e.exports=function e(t){if(!t)return!1;if(this.length!=t.length)return!1;for(var n=0,r=this.length;n<r;n++)if(this[n]instanceof Array&&t[n]instanceof Array){if(!e.apply(this[n],[t[n]]))return!1}else if(this[n]!=t[n])return!1;return!0}},"./node_modules/sdp-interop/lib/index.js":function(e,t,n){t.Interop=n("./node_modules/sdp-interop/lib/interop.js")},"./node_modules/sdp-interop/lib/interop.js":function(e,t,n){"use strict";var r=n("./node_modules/sdp-interop/lib/transform.js"),i=n("./node_modules/sdp-interop/lib/array-equals.js");function o(){this.cache={mlB2UMap:{},mlU2BMap:{}}}e.exports=o,o.prototype.candidateToUnifiedPlan=function(e){var t=new RTCIceCandidate(e);return t.sdpMLineIndex=this.cache.mlB2UMap[t.sdpMLineIndex],t},o.prototype.candidateToPlanB=function(e){var t=new RTCIceCandidate(e);if(0===t.sdpMid.indexOf("audio"))t.sdpMid="audio";else{if(0!==t.sdpMid.indexOf("video"))throw new Error("candidate with "+t.sdpMid+" not allowed");t.sdpMid="video"}return t.sdpMLineIndex=this.cache.mlU2BMap[t.sdpMLineIndex],t},o.prototype.getFirstSendingIndexFromAnswer=function(e){if(!this.cache.answer)return null;var t=r.parse(this.cache.answer);if(t&&t.media&&Array.isArray(t.media))for(var n=0;n<t.media.length;n++)if(t.media[n].type==e&&(!t.media[n].direction||"sendrecv"===t.media[n].direction||"sendonly"===t.media[n].direction))return n;return null},o.prototype.toPlanB=function(e){var t=this;if("object"!=typeof e||null===e||"string"!=typeof e.sdp)return console.warn("An empty description was passed as an argument."),e;var n=r.parse(e.sdp);if(void 0===n.media||!Array.isArray(n.media)||0===n.media.length)return console.warn("The description has no media."),e;if(n.media.length<=3&&n.media.every(function(e){return-1!==["video","audio","data"].indexOf(e.mid)}))return console.warn("This description does not look like Unified Plan."),e;for(var i=e.sdp,o=!1,a=0;a<n.media.length;a++){n.media[a].rtp.forEach(function(e){if("NULL"===e.codec){o=!0;var n=r.parse(t.cache.offer);e.codec=n.media[a].rtp[0].codec}})}o&&(i=r.write(n)),this.cache[e.type]=i;var u=n.media;n.media=[];var c={},h=[],l={};u.forEach(function(e){if(("string"!=typeof e.rtcpMux||"rtcp-mux"!==e.rtcpMux)&&"inactive"!==e.direction)throw new Error("Cannot convert to Plan B because m-lines without the rtcp-mux attribute were found.");void 0!==c[e.type]&&"inactive"!==c[e.type].direction||(c[e.type]=e)}),u.forEach(function(e){var t=e.type;if("application"===t)return n.media.push(e),void h.push(e.mid);"object"==typeof e.sources&&Object.keys(e.sources).forEach(function(n){"object"!=typeof c[t].sources&&(c[t].sources={}),c[t].sources[n]=e.sources[n],void 0!==e.msid&&(c[t].sources[n].msid=e.msid)}),void 0!==e.ssrcGroups&&Array.isArray(e.ssrcGroups)&&(void 0!==c[t].ssrcGroups&&Array.isArray(c[t].ssrcGroups)||(c[t].ssrcGroups=[]),c[t].ssrcGroups=c[t].ssrcGroups.concat(e.ssrcGroups));var r=e.direction;l[t]=(l[t]||0)|s[r||"inactive"],c[t]===e&&(e.mid=t,delete e.bundleOnly,delete e.msid,"inactive"!==r&&h.push(t),n.media.push(e))}),n.groups.some(function(e){if("BUNDLE"===e.type)return e.mids=h.join(" "),!0}),n.msidSemantic={semantic:"WMS",token:"*"};var p=r.write(n);return new RTCSessionDescription({type:e.type,sdp:p})},o.prototype.toUnifiedPlan=function(e){var t=this;if("object"!=typeof e||null===e||"string"!=typeof e.sdp)return console.warn("An empty description was passed as an argument."),e;var n=r.parse(e.sdp);if(void 0===n.media||!Array.isArray(n.media)||0===n.media.length)return console.warn("The description has no media."),e;if(n.media.length>3||!n.media.every(function(e){return-1!==["video","audio","data"].indexOf(e.mid)}))return console.warn("This description does not look like Plan B."),e;var o=[];n.media.forEach(function(e){o.push(e.mid)});var s,a=!1;if(void 0!==n.groups&&Array.isArray(n.groups)&&(a=n.groups.every(function(e){return"BUNDLE"!==e.type||i.apply(e.mids.sort(),[o.sort()])})),!a)throw new Error("Cannot convert to Unified Plan because m-lines that are not bundled were found.");void 0!==this.cache[e.type]&&(s=r.parse(this.cache[e.type]));var u={audio:{},video:{}},c={},h=0,l=0;if(n.media.forEach(function(n){if(("string"!=typeof n.rtcpMux||"rtcp-mux"!==n.rtcpMux)&&"inactive"!==n.direction)throw new Error("Cannot convert to Unified Plan because m-lines without the rtcp-mux attribute were found.");if("application"!==n.type){var r=n.sources,i=n.ssrcGroups,o=n.candidates,a=n.iceUfrag,p=n.icePwd,d=n.fingerprint,f=n.port;delete n.sources,delete n.ssrcGroups,delete n.candidates,delete n.iceUfrag,delete n.icePwd,delete n.fingerprint,delete n.port,delete n.mid;var m={};void 0!==i&&Array.isArray(i)&&i.forEach(function(e){"SIM"!==e.semantics&&void 0!==e.ssrcs&&Array.isArray(e.ssrcs)&&e.ssrcs.forEach(function(t){void 0===m[t]&&(m[t]=[]),m[t].push(e)})});var y={};"object"==typeof r&&Object.keys(r).forEach(function(i){var v;if("offer"!==e.type||r[i].msid)if(void 0!==m[i]&&Array.isArray(m[i])&&m[i].some(function(e){return e.ssrcs.some(function(e){if("object"==typeof y[e])return v=y[e],!0})}),"object"==typeof v)v.sources[i]=r[i],delete r[i].msid;else{if(v=Object.create(n),y[i]=v,void 0!==r[i].msid&&(v.msid=r[i].msid,delete r[i].msid),v.sources={},v.sources[i]=r[i],v.ssrcGroups=m[i],void 0!==s&&void 0!==s.media&&Array.isArray(s.media)&&s.media.forEach(function(e){"object"==typeof e.sources&&Object.keys(e.sources).forEach(function(t){t===i&&(v.mid=e.mid)})}),void 0===v.mid){if("answer"===e.type)throw new Error("An unmapped SSRC was found.");v.mid=[n.type,"-",i].join("")}v.candidates=o,v.iceUfrag=a,v.icePwd=p,v.fingerprint=d,v.port=f,c[v.mid]=v,t.cache.mlU2BMap[l]=h,void 0===t.cache.mlB2UMap[h]&&(t.cache.mlB2UMap[h]=l),l++}else u[n.type][i]=r[i]}),h++}else c[n.mid]=n}),n.media=[],o=[],"answer"===e.type)for(var p=0;p<s.media.length;p++){var d=s.media[p];void 0===c[d.mid]&&(delete d.msid,delete d.sources,delete d.ssrcGroups,d.direction&&"sendrecv"!==d.direction?"sendonly"===d.direction&&(d.direction="inactive"):d.direction="recvonly"),n.media.push(d),"string"==typeof d.mid&&o.push(d.mid)}else void 0!==s&&void 0!==s.media&&Array.isArray(s.media)&&s.media.forEach(function(e){o.push(e.mid),void 0!==c[e.mid]?n.media.push(c[e.mid]):(delete e.msid,delete e.sources,delete e.ssrcGroups,e.direction&&"sendrecv"!==e.direction||(e.direction="recvonly"),e.direction&&"sendonly"!==e.direction||(e.direction="inactive"),n.media.push(e))}),Object.keys(c).forEach(function(e){-1===o.indexOf(e)&&(o.push(e),"recvonly"===c[e].direction?n.media.some(function(t){if(("sendrecv"===t.direction||"sendonly"===t.direction)&&t.type===c[e].type)return Object.keys(c[e].sources).forEach(function(n){t.sources[n]=c[e].sources[n]}),!0}):n.media.push(c[e]))});["audio","video"].forEach(function(e){if(n&&n.media&&Array.isArray(n.media)){var r=null;if(Object.keys(u[e]).length>0&&null===(r=t.getFirstSendingIndexFromAnswer(e)))for(var i=0;i<n.media.length;i++)if(n.media[i].type===e){r=i;break}if(r&&n.media.length>r){var o=n.media[r];Object.keys(u[e]).forEach(function(t){o.sources&&o.sources[t]&&console.warn("Replacing an existing SSRC."),o.sources||(o.sources={}),o.sources[t]=u[e][t]})}}}),n.groups.some(function(e){if("BUNDLE"===e.type)return e.mids=o.join(" "),!0}),n.msidSemantic={semantic:"WMS",token:"*"};var f=r.write(n);return this.cache[e.type]=f,new RTCSessionDescription({type:e.type,sdp:f})};var s={inactive:0,recvonly:1,sendonly:2,sendrecv:3}},"./node_modules/sdp-interop/lib/transform.js":function(e,t,n){var r=n("./node_modules/sdp-interop/node_modules/sdp-transform/lib/index.js");t.write=function(e,t){return void 0!==e&&void 0!==e.media&&Array.isArray(e.media)&&e.media.forEach(function(e){void 0!==e.sources&&0!==Object.keys(e.sources).length&&(e.ssrcs=[],Object.keys(e.sources).forEach(function(t){var n=e.sources[t];Object.keys(n).forEach(function(r){e.ssrcs.push({id:t,attribute:r,value:n[r]})})}),delete e.sources),void 0!==e.ssrcGroups&&Array.isArray(e.ssrcGroups)&&e.ssrcGroups.forEach(function(e){void 0!==e.ssrcs&&Array.isArray(e.ssrcs)&&(e.ssrcs=e.ssrcs.join(" "))})}),void 0!==e&&void 0!==e.groups&&Array.isArray(e.groups)&&e.groups.forEach(function(e){void 0!==e.mids&&Array.isArray(e.mids)&&(e.mids=e.mids.join(" "))}),r.write(e,t)},t.parse=function(e){var t=r.parse(e);return void 0!==t&&void 0!==t.media&&Array.isArray(t.media)&&t.media.forEach(function(e){void 0!==e.ssrcs&&Array.isArray(e.ssrcs)&&(e.sources={},e.ssrcs.forEach(function(t){e.sources[t.id]||(e.sources[t.id]={}),e.sources[t.id][t.attribute]=t.value}),delete e.ssrcs),void 0!==e.ssrcGroups&&Array.isArray(e.ssrcGroups)&&e.ssrcGroups.forEach(function(e){"string"==typeof e.ssrcs&&(e.ssrcs=e.ssrcs.split(" "))})}),void 0!==t&&void 0!==t.groups&&Array.isArray(t.groups)&&t.groups.forEach(function(e){"string"==typeof e.mids&&(e.mids=e.mids.split(" "))}),t}},"./node_modules/sdp-interop/node_modules/sdp-transform/lib/grammar.js":function(e,t){var n=e.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w\/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-\.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(e){return e.encoding?"rtpmap:%d %s/%s/%s":e.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(e){return null!=e.address?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%d trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(e){return null!=e.subtype?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:(\d+)(?:\/(\w+))? (\S*)(?: (\S*))?/,names:["value","direction","uri","config"],format:function(e){return"extmap:%d"+(e.direction?"/%s":"%v")+" %s"+(e.config?" %s":"")}},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(e){return null!=e.sessionConfig?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?(?: network-id (\d*))?(?: network-cost (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","tcptype","generation","network-id","network-cost"],format:function(e){var t="candidate:%s %d %s %d %s %d typ %s";return t+=null!=e.raddr?" raddr %s rport %d":"%v%v",t+=null!=e.tcptype?" tcptype %s":"%v",null!=e.generation&&(t+=" generation %d"),t+=null!=e["network-id"]?" network-id %d":"%v",t+=null!=e["network-cost"]?" network-cost %d":"%v"}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_]*)(?::(.*))?/,names:["id","attribute","value"],format:function(e){var t="ssrc:%d";return null!=e.attribute&&(t+=" %s",null!=e.value&&(t+=":%s")),t}},{push:"ssrcGroups",reg:/^ssrc-group:([\x21\x23\x24\x25\x26\x27\x2A\x2B\x2D\x2E\w]*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{name:"sctpmap",reg:/^sctpmap:([\w_\/]*) (\S*)(?: (\S*))?/,names:["sctpmapNumber","app","maxMessageSize"],format:function(e){return null!=e.maxMessageSize?"sctpmap:%s %s %s":"sctpmap:%s %s"}},{name:"xGoogleFlag",reg:/^x-google-flag:([^\s]*)/,format:"x-google-flag:%s"},{push:"rids",reg:/^rid:([\d\w]+) (\w+)(?: ([\S| ]*))?/,names:["id","direction","params"],format:function(e){return e.params?"rid:%s %s %s":"rid:%s %s"}},{push:"imageattrs",reg:new RegExp("^imageattr:(\\d+|\\*)[\\s\\t]+(send|recv)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*)(?:[\\s\\t]+(recv|send)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*))?"),names:["pt","dir1","attrs1","dir2","attrs2"],format:function(e){return"imageattr:%s %s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast",reg:new RegExp("^simulcast:(send|recv) ([a-zA-Z0-9\\-_~;,]+)(?:\\s?(send|recv) ([a-zA-Z0-9\\-_~;,]+))?$"),names:["dir1","list1","dir2","list2"],format:function(e){return"simulcast:%s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast_03",reg:/^simulcast:[\s\t]+([\S+\s\t]+)$/,names:["value"],format:"simulcast: %s"},{name:"framerate",reg:/^framerate:(\d+(?:$|\.\d+))/,format:"framerate:%s"},{push:"invalid",names:["value"]}]};Object.keys(n).forEach(function(e){n[e].forEach(function(e){e.reg||(e.reg=/(.*)/),e.format||(e.format="%s")})})},"./node_modules/sdp-interop/node_modules/sdp-transform/lib/index.js":function(e,t,n){var r=n("./node_modules/sdp-interop/node_modules/sdp-transform/lib/parser.js"),i=n("./node_modules/sdp-interop/node_modules/sdp-transform/lib/writer.js");t.write=i,t.parse=r.parse,t.parseFmtpConfig=r.parseFmtpConfig,t.parseParams=r.parseParams,t.parsePayloads=r.parsePayloads,t.parseRemoteCandidates=r.parseRemoteCandidates,t.parseImageAttributes=r.parseImageAttributes,t.parseSimulcastStreamList=r.parseSimulcastStreamList},"./node_modules/sdp-interop/node_modules/sdp-transform/lib/parser.js":function(e,t,n){var r=function(e){return String(Number(e))===e?Number(e):e},i=function(e,t,n){var i=e.name&&e.names;e.push&&!t[e.push]?t[e.push]=[]:i&&!t[e.name]&&(t[e.name]={});var o=e.push?{}:i?t[e.name]:t;!function(e,t,n,i){if(i&&!n)t[i]=r(e[1]);else for(var o=0;o<n.length;o+=1)null!=e[o+1]&&(t[n[o]]=r(e[o+1]))}(n.match(e.reg),o,e.names,e.name),e.push&&t[e.push].push(o)},o=n("./node_modules/sdp-interop/node_modules/sdp-transform/lib/grammar.js"),s=RegExp.prototype.test.bind(/^([a-z])=(.*)/);t.parse=function(e){var t={},n=[],r=t;return e.split(/(\r\n|\r|\n)/).filter(s).forEach(function(e){var t=e[0],s=e.slice(2);"m"===t&&(n.push({rtp:[],fmtp:[]}),r=n[n.length-1]);for(var a=0;a<(o[t]||[]).length;a+=1){var u=o[t][a];if(u.reg.test(s))return i(u,r,s)}}),t.media=n,t};var a=function(e,t){var n=t.split(/=(.+)/,2);return 2===n.length&&(e[n[0]]=r(n[1])),e};t.parseParams=function(e){return e.split(/\;\s?/).reduce(a,{})},t.parseFmtpConfig=t.parseParams,t.parsePayloads=function(e){return e.split(" ").map(Number)},t.parseRemoteCandidates=function(e){for(var t=[],n=e.split(" ").map(r),i=0;i<n.length;i+=3)t.push({component:n[i],ip:n[i+1],port:n[i+2]});return t},t.parseImageAttributes=function(e){return e.split(" ").map(function(e){return e.substring(1,e.length-1).split(",").reduce(a,{})})},t.parseSimulcastStreamList=function(e){return e.split(";").map(function(e){return e.split(",").map(function(e){var t,n=!1;return"~"!==e[0]?t=r(e):(t=r(e.substring(1,e.length)),n=!0),{scid:t,paused:n}})})}},"./node_modules/sdp-interop/node_modules/sdp-transform/lib/writer.js":function(e,t,n){var r=n("./node_modules/sdp-interop/node_modules/sdp-transform/lib/grammar.js"),i=/%[sdv%]/g,o=function(e,t,n){var r=[e+"="+(t.format instanceof Function?t.format(t.push?n:n[t.name]):t.format)];if(t.names)for(var o=0;o<t.names.length;o+=1){var s=t.names[o];t.name?r.push(n[t.name][s]):r.push(n[t.names[o]])}else r.push(n[t.name]);return function(e){var t=1,n=arguments,r=n.length;return e.replace(i,function(e){if(t>=r)return e;var i=n[t];switch(t+=1,e){case"%%":return"%";case"%s":return String(i);case"%d":return Number(i);case"%v":return""}})}.apply(null,r)},s=["v","o","s","i","u","e","p","c","b","t","r","z","a"],a=["i","c","b","a"];e.exports=function(e,t){t=t||{},null==e.version&&(e.version=0),null==e.name&&(e.name=" "),e.media.forEach(function(e){null==e.payloads&&(e.payloads="")});var n=t.outerOrder||s,i=t.innerOrder||a,u=[];return n.forEach(function(t){r[t].forEach(function(n){n.name in e&&null!=e[n.name]?u.push(o(t,n,e)):n.push in e&&null!=e[n.push]&&e[n.push].forEach(function(e){u.push(o(t,n,e))})})}),e.media.forEach(function(e){u.push(o("m",r.m[0],e)),i.forEach(function(t){r[t].forEach(function(n){n.name in e&&null!=e[n.name]?u.push(o(t,n,e)):n.push in e&&null!=e[n.push]&&e[n.push].forEach(function(e){u.push(o(t,n,e))})})})}),u.join("\r\n")+"\r\n"}},"./node_modules/sdp-transform/lib/grammar.js":function(e,t){var n=e.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w\/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-\.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(e){return e.encoding?"rtpmap:%d %s/%s/%s":e.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(e){return null!=e.address?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%d trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(e){return null!=e.subtype?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:(\d+)(?:\/(\w+))? (\S*)(?: (\S*))?/,names:["value","direction","uri","config"],format:function(e){return"extmap:%d"+(e.direction?"/%s":"%v")+" %s"+(e.config?" %s":"")}},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(e){return null!=e.sessionConfig?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?(?: network-id (\d*))?(?: network-cost (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","tcptype","generation","network-id","network-cost"],format:function(e){var t="candidate:%s %d %s %d %s %d typ %s";return t+=null!=e.raddr?" raddr %s rport %d":"%v%v",t+=null!=e.tcptype?" tcptype %s":"%v",null!=e.generation&&(t+=" generation %d"),t+=null!=e["network-id"]?" network-id %d":"%v",t+=null!=e["network-cost"]?" network-cost %d":"%v"}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_-]*)(?::(.*))?/,names:["id","attribute","value"],format:function(e){var t="ssrc:%d";return null!=e.attribute&&(t+=" %s",null!=e.value&&(t+=":%s")),t}},{push:"ssrcGroups",reg:/^ssrc-group:([\x21\x23\x24\x25\x26\x27\x2A\x2B\x2D\x2E\w]*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{name:"sctpmap",reg:/^sctpmap:([\w_\/]*) (\S*)(?: (\S*))?/,names:["sctpmapNumber","app","maxMessageSize"],format:function(e){return null!=e.maxMessageSize?"sctpmap:%s %s %s":"sctpmap:%s %s"}},{name:"xGoogleFlag",reg:/^x-google-flag:([^\s]*)/,format:"x-google-flag:%s"},{push:"rids",reg:/^rid:([\d\w]+) (\w+)(?: ([\S| ]*))?/,names:["id","direction","params"],format:function(e){return e.params?"rid:%s %s %s":"rid:%s %s"}},{push:"imageattrs",reg:new RegExp("^imageattr:(\\d+|\\*)[\\s\\t]+(send|recv)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*)(?:[\\s\\t]+(recv|send)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*))?"),names:["pt","dir1","attrs1","dir2","attrs2"],format:function(e){return"imageattr:%s %s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast",reg:new RegExp("^simulcast:(send|recv) ([a-zA-Z0-9\\-_~;,]+)(?:\\s?(send|recv) ([a-zA-Z0-9\\-_~;,]+))?$"),names:["dir1","list1","dir2","list2"],format:function(e){return"simulcast:%s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast_03",reg:/^simulcast:[\s\t]+([\S+\s\t]+)$/,names:["value"],format:"simulcast: %s"},{name:"framerate",reg:/^framerate:(\d+(?:$|\.\d+))/,format:"framerate:%s"},{name:"sourceFilter",reg:/^source-filter: *(excl|incl) (\S*) (IP4|IP6|\*) (\S*) (.*)/,names:["filterMode","netType","addressTypes","destAddress","srcList"],format:"source-filter: %s %s %s %s %s"},{name:"bundleOnly",reg:/^(bundle-only)/},{name:"label",reg:/^label:(.+)/,format:"label:%s"},{name:"sctpPort",reg:/^sctp-port:(\d+)$/,format:"sctp-port:%s"},{name:"maxMessageSize",reg:/^max-message-size:(\d+)$/,format:"max-message-size:%s"},{push:"invalid",names:["value"]}]};Object.keys(n).forEach(function(e){n[e].forEach(function(e){e.reg||(e.reg=/(.*)/),e.format||(e.format="%s")})})},"./node_modules/sdp-transform/lib/index.js":function(e,t,n){var r=n("./node_modules/sdp-transform/lib/parser.js"),i=n("./node_modules/sdp-transform/lib/writer.js");t.write=i,t.parse=r.parse,t.parseFmtpConfig=r.parseFmtpConfig,t.parseParams=r.parseParams,t.parsePayloads=r.parsePayloads,t.parseRemoteCandidates=r.parseRemoteCandidates,t.parseImageAttributes=r.parseImageAttributes,t.parseSimulcastStreamList=r.parseSimulcastStreamList},"./node_modules/sdp-transform/lib/parser.js":function(e,t,n){var r=function(e){return String(Number(e))===e?Number(e):e},i=function(e,t,n){var i=e.name&&e.names;e.push&&!t[e.push]?t[e.push]=[]:i&&!t[e.name]&&(t[e.name]={});var o=e.push?{}:i?t[e.name]:t;!function(e,t,n,i){if(i&&!n)t[i]=r(e[1]);else for(var o=0;o<n.length;o+=1)null!=e[o+1]&&(t[n[o]]=r(e[o+1]))}(n.match(e.reg),o,e.names,e.name),e.push&&t[e.push].push(o)},o=n("./node_modules/sdp-transform/lib/grammar.js"),s=RegExp.prototype.test.bind(/^([a-z])=(.*)/);t.parse=function(e){var t={},n=[],r=t;return e.split(/(\r\n|\r|\n)/).filter(s).forEach(function(e){var t=e[0],s=e.slice(2);"m"===t&&(n.push({rtp:[],fmtp:[]}),r=n[n.length-1]);for(var a=0;a<(o[t]||[]).length;a+=1){var u=o[t][a];if(u.reg.test(s))return i(u,r,s)}}),t.media=n,t};var a=function(e,t){var n=t.split(/=(.+)/,2);return 2===n.length?e[n[0]]=r(n[1]):1===n.length&&t.length>1&&(e[n[0]]=void 0),e};t.parseParams=function(e){return e.split(/\;\s?/).reduce(a,{})},t.parseFmtpConfig=t.parseParams,t.parsePayloads=function(e){return e.split(" ").map(Number)},t.parseRemoteCandidates=function(e){for(var t=[],n=e.split(" ").map(r),i=0;i<n.length;i+=3)t.push({component:n[i],ip:n[i+1],port:n[i+2]});return t},t.parseImageAttributes=function(e){return e.split(" ").map(function(e){return e.substring(1,e.length-1).split(",").reduce(a,{})})},t.parseSimulcastStreamList=function(e){return e.split(";").map(function(e){return e.split(",").map(function(e){var t,n=!1;return"~"!==e[0]?t=r(e):(t=r(e.substring(1,e.length)),n=!0),{scid:t,paused:n}})})}},"./node_modules/sdp-transform/lib/writer.js":function(e,t,n){var r=n("./node_modules/sdp-transform/lib/grammar.js"),i=/%[sdv%]/g,o=function(e,t,n){var r=[e+"="+(t.format instanceof Function?t.format(t.push?n:n[t.name]):t.format)];if(t.names)for(var o=0;o<t.names.length;o+=1){var s=t.names[o];t.name?r.push(n[t.name][s]):r.push(n[t.names[o]])}else r.push(n[t.name]);return function(e){var t=1,n=arguments,r=n.length;return e.replace(i,function(e){if(t>=r)return e;var i=n[t];switch(t+=1,e){case"%%":return"%";case"%s":return String(i);case"%d":return Number(i);case"%v":return""}})}.apply(null,r)},s=["v","o","s","i","u","e","p","c","b","t","r","z","a"],a=["i","c","b","a"];e.exports=function(e,t){t=t||{},null==e.version&&(e.version=0),null==e.name&&(e.name=" "),e.media.forEach(function(e){null==e.payloads&&(e.payloads="")});var n=t.outerOrder||s,i=t.innerOrder||a,u=[];return n.forEach(function(t){r[t].forEach(function(n){n.name in e&&null!=e[n.name]?u.push(o(t,n,e)):n.push in e&&null!=e[n.push]&&e[n.push].forEach(function(e){u.push(o(t,n,e))})})}),e.media.forEach(function(e){u.push(o("m",r.m[0],e)),i.forEach(function(t){r[t].forEach(function(n){n.name in e&&null!=e[n.name]?u.push(o(t,n,e)):n.push in e&&null!=e[n.push]&&e[n.push].forEach(function(e){u.push(o(t,n,e))})})})}),u.join("\r\n")+"\r\n"}},"./node_modules/socket.io-client/lib/index.js":function(e,t,n){var r=n("./node_modules/socket.io-client/lib/url.js"),i=n("./node_modules/socket.io-client/node_modules/socket.io-parser/index.js"),o=n("./node_modules/socket.io-client/lib/manager.js"),s=n("./node_modules/socket.io-client/node_modules/debug/src/browser.js")("socket.io-client");e.exports=t=u;var a=t.managers={};function u(e,t){"object"==typeof e&&(t=e,e=void 0),t=t||{};var n,i=r(e),u=i.source,c=i.id,h=i.path,l=a[c]&&h in a[c].nsps;return t.forceNew||t["force new connection"]||!1===t.multiplex||l?(s("ignoring socket cache for %s",u),n=o(u,t)):(a[c]||(s("new io instance for %s",u),a[c]=o(u,t)),n=a[c]),i.query&&!t.query&&(t.query=i.query),n.socket(i.path,t)}t.protocol=i.protocol,t.connect=u,t.Manager=n("./node_modules/socket.io-client/lib/manager.js"),t.Socket=n("./node_modules/socket.io-client/lib/socket.js")},"./node_modules/socket.io-client/lib/manager.js":function(e,t,n){var r=n("./node_modules/socket.io-client/node_modules/engine.io-client/lib/index.js"),i=n("./node_modules/socket.io-client/lib/socket.js"),o=n("./node_modules/component-emitter/index.js"),s=n("./node_modules/socket.io-client/node_modules/socket.io-parser/index.js"),a=n("./node_modules/socket.io-client/lib/on.js"),u=n("./node_modules/component-bind/index.js"),c=n("./node_modules/socket.io-client/node_modules/debug/src/browser.js")("socket.io-client:manager"),h=n("./node_modules/indexof/index.js"),l=n("./node_modules/backo2/index.js"),p=Object.prototype.hasOwnProperty;function d(e,t){if(!(this instanceof d))return new d(e,t);e&&"object"==typeof e&&(t=e,e=void 0),(t=t||{}).path=t.path||"/socket.io",this.nsps={},this.subs=[],this.opts=t,this.reconnection(!1!==t.reconnection),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor(t.randomizationFactor||.5),this.backoff=new l({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==t.timeout?2e4:t.timeout),this.readyState="closed",this.uri=e,this.connecting=[],this.lastPing=null,this.encoding=!1,this.packetBuffer=[];var n=t.parser||s;this.encoder=new n.Encoder,this.decoder=new n.Decoder,this.autoConnect=!1!==t.autoConnect,this.autoConnect&&this.open()}e.exports=d,d.prototype.emitAll=function(){for(var e in this.emit.apply(this,arguments),this.nsps)p.call(this.nsps,e)&&this.nsps[e].emit.apply(this.nsps[e],arguments)},d.prototype.updateSocketIds=function(){for(var e in this.nsps)p.call(this.nsps,e)&&(this.nsps[e].id=this.generateId(e))},d.prototype.generateId=function(e){return("/"===e?"":e+"#")+this.engine.id},o(d.prototype),d.prototype.reconnection=function(e){return arguments.length?(this._reconnection=!!e,this):this._reconnection},d.prototype.reconnectionAttempts=function(e){return arguments.length?(this._reconnectionAttempts=e,this):this._reconnectionAttempts},d.prototype.reconnectionDelay=function(e){return arguments.length?(this._reconnectionDelay=e,this.backoff&&this.backoff.setMin(e),this):this._reconnectionDelay},d.prototype.randomizationFactor=function(e){return arguments.length?(this._randomizationFactor=e,this.backoff&&this.backoff.setJitter(e),this):this._randomizationFactor},d.prototype.reconnectionDelayMax=function(e){return arguments.length?(this._reconnectionDelayMax=e,this.backoff&&this.backoff.setMax(e),this):this._reconnectionDelayMax},d.prototype.timeout=function(e){return arguments.length?(this._timeout=e,this):this._timeout},d.prototype.maybeReconnectOnOpen=function(){!this.reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()},d.prototype.open=d.prototype.connect=function(e,t){if(c("readyState %s",this.readyState),~this.readyState.indexOf("open"))return this;c("opening %s",this.uri),this.engine=r(this.uri,this.opts);var n=this.engine,i=this;this.readyState="opening",this.skipReconnect=!1;var o=a(n,"open",function(){i.onopen(),e&&e()}),s=a(n,"error",function(t){if(c("connect_error"),i.cleanup(),i.readyState="closed",i.emitAll("connect_error",t),e){var n=new Error("Connection error");n.data=t,e(n)}else i.maybeReconnectOnOpen()});if(!1!==this._timeout){var u=this._timeout;c("connect attempt will timeout after %d",u);var h=setTimeout(function(){c("connect attempt timed out after %d",u),o.destroy(),n.close(),n.emit("error","timeout"),i.emitAll("connect_timeout",u)},u);this.subs.push({destroy:function(){clearTimeout(h)}})}return this.subs.push(o),this.subs.push(s),this},d.prototype.onopen=function(){c("open"),this.cleanup(),this.readyState="open",this.emit("open");var e=this.engine;this.subs.push(a(e,"data",u(this,"ondata"))),this.subs.push(a(e,"ping",u(this,"onping"))),this.subs.push(a(e,"pong",u(this,"onpong"))),this.subs.push(a(e,"error",u(this,"onerror"))),this.subs.push(a(e,"close",u(this,"onclose"))),this.subs.push(a(this.decoder,"decoded",u(this,"ondecoded")))},d.prototype.onping=function(){this.lastPing=new Date,this.emitAll("ping")},d.prototype.onpong=function(){this.emitAll("pong",new Date-this.lastPing)},d.prototype.ondata=function(e){this.decoder.add(e)},d.prototype.ondecoded=function(e){this.emit("packet",e)},d.prototype.onerror=function(e){c("error",e),this.emitAll("error",e)},d.prototype.socket=function(e,t){var n=this.nsps[e];if(!n){n=new i(this,e,t),this.nsps[e]=n;var r=this;n.on("connecting",o),n.on("connect",function(){n.id=r.generateId(e)}),this.autoConnect&&o()}function o(){~h(r.connecting,n)||r.connecting.push(n)}return n},d.prototype.destroy=function(e){var t=h(this.connecting,e);~t&&this.connecting.splice(t,1),this.connecting.length||this.close()},d.prototype.packet=function(e){c("writing packet %j",e);var t=this;e.query&&0===e.type&&(e.nsp+="?"+e.query),t.encoding?t.packetBuffer.push(e):(t.encoding=!0,this.encoder.encode(e,function(n){for(var r=0;r<n.length;r++)t.engine.write(n[r],e.options);t.encoding=!1,t.processPacketQueue()}))},d.prototype.processPacketQueue=function(){if(this.packetBuffer.length>0&&!this.encoding){var e=this.packetBuffer.shift();this.packet(e)}},d.prototype.cleanup=function(){c("cleanup");for(var e=this.subs.length,t=0;t<e;t++){this.subs.shift().destroy()}this.packetBuffer=[],this.encoding=!1,this.lastPing=null,this.decoder.destroy()},d.prototype.close=d.prototype.disconnect=function(){c("disconnect"),this.skipReconnect=!0,this.reconnecting=!1,"opening"===this.readyState&&this.cleanup(),this.backoff.reset(),this.readyState="closed",this.engine&&this.engine.close()},d.prototype.onclose=function(e){c("onclose"),this.cleanup(),this.backoff.reset(),this.readyState="closed",this.emit("close",e),this._reconnection&&!this.skipReconnect&&this.reconnect()},d.prototype.reconnect=function(){if(this.reconnecting||this.skipReconnect)return this;var e=this;if(this.backoff.attempts>=this._reconnectionAttempts)c("reconnect failed"),this.backoff.reset(),this.emitAll("reconnect_failed"),this.reconnecting=!1;else{var t=this.backoff.duration();c("will wait %dms before reconnect attempt",t),this.reconnecting=!0;var n=setTimeout(function(){e.skipReconnect||(c("attempting reconnect"),e.emitAll("reconnect_attempt",e.backoff.attempts),e.emitAll("reconnecting",e.backoff.attempts),e.skipReconnect||e.open(function(t){t?(c("reconnect attempt error"),e.reconnecting=!1,e.reconnect(),e.emitAll("reconnect_error",t.data)):(c("reconnect success"),e.onreconnect())}))},t);this.subs.push({destroy:function(){clearTimeout(n)}})}},d.prototype.onreconnect=function(){var e=this.backoff.attempts;this.reconnecting=!1,this.backoff.reset(),this.updateSocketIds(),this.emitAll("reconnect",e)}},"./node_modules/socket.io-client/lib/on.js":function(e,t){e.exports=function(e,t,n){return e.on(t,n),{destroy:function(){e.removeListener(t,n)}}}},"./node_modules/socket.io-client/lib/socket.js":function(e,t,n){var r=n("./node_modules/socket.io-client/node_modules/socket.io-parser/index.js"),i=n("./node_modules/component-emitter/index.js"),o=n("./node_modules/to-array/index.js"),s=n("./node_modules/socket.io-client/lib/on.js"),a=n("./node_modules/component-bind/index.js"),u=n("./node_modules/socket.io-client/node_modules/debug/src/browser.js")("socket.io-client:socket"),c=n("./node_modules/parseqs/index.js"),h=n("./node_modules/has-binary2/index.js");e.exports=d;var l={connect:1,connect_error:1,connect_timeout:1,connecting:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1,ping:1,pong:1},p=i.prototype.emit;function d(e,t,n){this.io=e,this.nsp=t,this.json=this,this.ids=0,this.acks={},this.receiveBuffer=[],this.sendBuffer=[],this.connected=!1,this.disconnected=!0,this.flags={},n&&n.query&&(this.query=n.query),this.io.autoConnect&&this.open()}i(d.prototype),d.prototype.subEvents=function(){if(!this.subs){var e=this.io;this.subs=[s(e,"open",a(this,"onopen")),s(e,"packet",a(this,"onpacket")),s(e,"close",a(this,"onclose"))]}},d.prototype.open=d.prototype.connect=function(){return this.connected?this:(this.subEvents(),this.io.open(),"open"===this.io.readyState&&this.onopen(),this.emit("connecting"),this)},d.prototype.send=function(){var e=o(arguments);return e.unshift("message"),this.emit.apply(this,e),this},d.prototype.emit=function(e){if(l.hasOwnProperty(e))return p.apply(this,arguments),this;var t=o(arguments),n={type:(void 0!==this.flags.binary?this.flags.binary:h(t))?r.BINARY_EVENT:r.EVENT,data:t,options:{}};return n.options.compress=!this.flags||!1!==this.flags.compress,"function"==typeof t[t.length-1]&&(u("emitting packet with ack id %d",this.ids),this.acks[this.ids]=t.pop(),n.id=this.ids++),this.connected?this.packet(n):this.sendBuffer.push(n),this.flags={},this},d.prototype.packet=function(e){e.nsp=this.nsp,this.io.packet(e)},d.prototype.onopen=function(){if(u("transport is open - connecting"),"/"!==this.nsp)if(this.query){var e="object"==typeof this.query?c.encode(this.query):this.query;u("sending connect packet with query %s",e),this.packet({type:r.CONNECT,query:e})}else this.packet({type:r.CONNECT})},d.prototype.onclose=function(e){u("close (%s)",e),this.connected=!1,this.disconnected=!0,delete this.id,this.emit("disconnect",e)},d.prototype.onpacket=function(e){var t=e.nsp===this.nsp,n=e.type===r.ERROR&&"/"===e.nsp;if(t||n)switch(e.type){case r.CONNECT:this.onconnect();break;case r.EVENT:case r.BINARY_EVENT:this.onevent(e);break;case r.ACK:case r.BINARY_ACK:this.onack(e);break;case r.DISCONNECT:this.ondisconnect();break;case r.ERROR:this.emit("error",e.data)}},d.prototype.onevent=function(e){var t=e.data||[];u("emitting event %j",t),null!=e.id&&(u("attaching ack callback to event"),t.push(this.ack(e.id))),this.connected?p.apply(this,t):this.receiveBuffer.push(t)},d.prototype.ack=function(e){var t=this,n=!1;return function(){if(!n){n=!0;var i=o(arguments);u("sending ack %j",i),t.packet({type:h(i)?r.BINARY_ACK:r.ACK,id:e,data:i})}}},d.prototype.onack=function(e){var t=this.acks[e.id];"function"==typeof t?(u("calling ack %s with %j",e.id,e.data),t.apply(this,e.data),delete this.acks[e.id]):u("bad ack %s",e.id)},d.prototype.onconnect=function(){this.connected=!0,this.disconnected=!1,this.emit("connect"),this.emitBuffered()},d.prototype.emitBuffered=function(){var e;for(e=0;e<this.receiveBuffer.length;e++)p.apply(this,this.receiveBuffer[e]);for(this.receiveBuffer=[],e=0;e<this.sendBuffer.length;e++)this.packet(this.sendBuffer[e]);this.sendBuffer=[]},d.prototype.ondisconnect=function(){u("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")},d.prototype.destroy=function(){if(this.subs){for(var e=0;e<this.subs.length;e++)this.subs[e].destroy();this.subs=null}this.io.destroy(this)},d.prototype.close=d.prototype.disconnect=function(){return this.connected&&(u("performing disconnect (%s)",this.nsp),this.packet({type:r.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this},d.prototype.compress=function(e){return this.flags.compress=e,this},d.prototype.binary=function(e){return this.flags.binary=e,this}},"./node_modules/socket.io-client/lib/url.js":function(e,t,n){var r=n("./node_modules/parseuri/index.js"),i=n("./node_modules/socket.io-client/node_modules/debug/src/browser.js")("socket.io-client:url");e.exports=function(e,t){var n=e;t=t||"undefined"!=typeof location&&location,null==e&&(e=t.protocol+"//"+t.host);"string"==typeof e&&("/"===e.charAt(0)&&(e="/"===e.charAt(1)?t.protocol+e:t.host+e),/^(https?|wss?):\/\//.test(e)||(i("protocol-less url %s",e),e=void 0!==t?t.protocol+"//"+e:"https://"+e),i("parse %s",e),n=r(e));n.port||(/^(http|ws)$/.test(n.protocol)?n.port="80":/^(http|ws)s$/.test(n.protocol)&&(n.port="443"));n.path=n.path||"/";var o=-1!==n.host.indexOf(":")?"["+n.host+"]":n.host;return n.id=n.protocol+"://"+o+":"+n.port,n.href=n.protocol+"://"+o+(t&&t.port===n.port?"":":"+n.port),n}},"./node_modules/socket.io-client/node_modules/debug/src/browser.js":function(e,t,n){(function(r){function i(){var e;try{e=t.storage.debug}catch(e){}return!e&&void 0!==r&&"env"in r&&(e=r.env.DEBUG),e}(t=e.exports=n("./node_modules/socket.io-client/node_modules/debug/src/debug.js")).log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},t.formatArgs=function(e){var n=this.useColors;if(e[0]=(n?"%c":"")+this.namespace+(n?" %c":" ")+e[0]+(n?"%c ":" ")+"+"+t.humanize(this.diff),!n)return;var r="color: "+this.color;e.splice(1,0,r,"color: inherit");var i=0,o=0;e[0].replace(/%[a-zA-Z%]/g,function(e){"%%"!==e&&"%c"===e&&(o=++i)}),e.splice(o,0,r)},t.save=function(e){try{null==e?t.storage.removeItem("debug"):t.storage.debug=e}catch(e){}},t.load=i,t.useColors=function(){if("undefined"!=typeof window&&window.process&&"renderer"===window.process.type)return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(e){}}(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}},t.enable(i())}).call(this,n("./node_modules/process/browser.js"))},"./node_modules/socket.io-client/node_modules/debug/src/debug.js":function(e,t,n){function r(e){var n;function r(){if(r.enabled){var e=r,i=+new Date,o=i-(n||i);e.diff=o,e.prev=n,e.curr=i,n=i;for(var s=new Array(arguments.length),a=0;a<s.length;a++)s[a]=arguments[a];s[0]=t.coerce(s[0]),"string"!=typeof s[0]&&s.unshift("%O");var u=0;s[0]=s[0].replace(/%([a-zA-Z%])/g,function(n,r){if("%%"===n)return n;u++;var i=t.formatters[r];if("function"==typeof i){var o=s[u];n=i.call(e,o),s.splice(u,1),u--}return n}),t.formatArgs.call(e,s),(r.log||t.log||console.log.bind(console)).apply(e,s)}}return r.namespace=e,r.enabled=t.enabled(e),r.useColors=t.useColors(),r.color=function(e){var n,r=0;for(n in e)r=(r<<5)-r+e.charCodeAt(n),r|=0;return t.colors[Math.abs(r)%t.colors.length]}(e),r.destroy=i,"function"==typeof t.init&&t.init(r),t.instances.push(r),r}function i(){var e=t.instances.indexOf(this);return-1!==e&&(t.instances.splice(e,1),!0)}(t=e.exports=r.debug=r.default=r).coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){t.enable("")},t.enable=function(e){var n;t.save(e),t.names=[],t.skips=[];var r=("string"==typeof e?e:"").split(/[\s,]+/),i=r.length;for(n=0;n<i;n++)r[n]&&("-"===(e=r[n].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")));for(n=0;n<t.instances.length;n++){var o=t.instances[n];o.enabled=t.enabled(o.namespace)}},t.enabled=function(e){if("*"===e[e.length-1])return!0;var n,r;for(n=0,r=t.skips.length;n<r;n++)if(t.skips[n].test(e))return!1;for(n=0,r=t.names.length;n<r;n++)if(t.names[n].test(e))return!0;return!1},t.humanize=n("./node_modules/ms/index.js"),t.instances=[],t.names=[],t.skips=[],t.formatters={}},"./node_modules/socket.io-client/node_modules/engine.io-client/lib/index.js":function(e,t,n){e.exports=n("./node_modules/socket.io-client/node_modules/engine.io-client/lib/socket.js"),e.exports.parser=n("./node_modules/engine.io-parser/lib/browser.js")},"./node_modules/socket.io-client/node_modules/engine.io-client/lib/socket.js":function(e,t,n){var r=n("./node_modules/socket.io-client/node_modules/engine.io-client/lib/transports/index.js"),i=n("./node_modules/component-emitter/index.js"),o=n("./node_modules/socket.io-client/node_modules/debug/src/browser.js")("engine.io-client:socket"),s=n("./node_modules/indexof/index.js"),a=n("./node_modules/engine.io-parser/lib/browser.js"),u=n("./node_modules/parseuri/index.js"),c=n("./node_modules/parseqs/index.js");function h(e,t){if(!(this instanceof h))return new h(e,t);t=t||{},e&&"object"==typeof e&&(t=e,e=null),e?(e=u(e),t.hostname=e.host,t.secure="https"===e.protocol||"wss"===e.protocol,t.port=e.port,e.query&&(t.query=e.query)):t.host&&(t.hostname=u(t.host).host),this.secure=null!=t.secure?t.secure:"undefined"!=typeof location&&"https:"===location.protocol,t.hostname&&!t.port&&(t.port=this.secure?"443":"80"),this.agent=t.agent||!1,this.hostname=t.hostname||("undefined"!=typeof location?location.hostname:"localhost"),this.port=t.port||("undefined"!=typeof location&&location.port?location.port:this.secure?443:80),this.query=t.query||{},"string"==typeof this.query&&(this.query=c.decode(this.query)),this.upgrade=!1!==t.upgrade,this.path=(t.path||"/engine.io").replace(/\/$/,"")+"/",this.forceJSONP=!!t.forceJSONP,this.jsonp=!1!==t.jsonp,this.forceBase64=!!t.forceBase64,this.enablesXDR=!!t.enablesXDR,this.timestampParam=t.timestampParam||"t",this.timestampRequests=t.timestampRequests,this.transports=t.transports||["polling","websocket"],this.transportOptions=t.transportOptions||{},this.readyState="",this.writeBuffer=[],this.prevBufferLen=0,this.policyPort=t.policyPort||843,this.rememberUpgrade=t.rememberUpgrade||!1,this.binaryType=null,this.onlyBinaryUpgrades=t.onlyBinaryUpgrades,this.perMessageDeflate=!1!==t.perMessageDeflate&&(t.perMessageDeflate||{}),!0===this.perMessageDeflate&&(this.perMessageDeflate={}),this.perMessageDeflate&&null==this.perMessageDeflate.threshold&&(this.perMessageDeflate.threshold=1024),this.pfx=t.pfx||null,this.key=t.key||null,this.passphrase=t.passphrase||null,this.cert=t.cert||null,this.ca=t.ca||null,this.ciphers=t.ciphers||null,this.rejectUnauthorized=void 0===t.rejectUnauthorized||t.rejectUnauthorized,this.forceNode=!!t.forceNode,this.isReactNative="undefined"!=typeof navigator&&"string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase(),("undefined"==typeof self||this.isReactNative)&&(t.extraHeaders&&Object.keys(t.extraHeaders).length>0&&(this.extraHeaders=t.extraHeaders),t.localAddress&&(this.localAddress=t.localAddress)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingIntervalTimer=null,this.pingTimeoutTimer=null,this.open()}e.exports=h,h.priorWebsocketSuccess=!1,i(h.prototype),h.protocol=a.protocol,h.Socket=h,h.Transport=n("./node_modules/socket.io-client/node_modules/engine.io-client/lib/transport.js"),h.transports=n("./node_modules/socket.io-client/node_modules/engine.io-client/lib/transports/index.js"),h.parser=n("./node_modules/engine.io-parser/lib/browser.js"),h.prototype.createTransport=function(e){o('creating transport "%s"',e);var t=function(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}(this.query);t.EIO=a.protocol,t.transport=e;var n=this.transportOptions[e]||{};return this.id&&(t.sid=this.id),new r[e]({query:t,socket:this,agent:n.agent||this.agent,hostname:n.hostname||this.hostname,port:n.port||this.port,secure:n.secure||this.secure,path:n.path||this.path,forceJSONP:n.forceJSONP||this.forceJSONP,jsonp:n.jsonp||this.jsonp,forceBase64:n.forceBase64||this.forceBase64,enablesXDR:n.enablesXDR||this.enablesXDR,timestampRequests:n.timestampRequests||this.timestampRequests,timestampParam:n.timestampParam||this.timestampParam,policyPort:n.policyPort||this.policyPort,pfx:n.pfx||this.pfx,key:n.key||this.key,passphrase:n.passphrase||this.passphrase,cert:n.cert||this.cert,ca:n.ca||this.ca,ciphers:n.ciphers||this.ciphers,rejectUnauthorized:n.rejectUnauthorized||this.rejectUnauthorized,perMessageDeflate:n.perMessageDeflate||this.perMessageDeflate,extraHeaders:n.extraHeaders||this.extraHeaders,forceNode:n.forceNode||this.forceNode,localAddress:n.localAddress||this.localAddress,requestTimeout:n.requestTimeout||this.requestTimeout,protocols:n.protocols||void 0,isReactNative:this.isReactNative})},h.prototype.open=function(){var e;if(this.rememberUpgrade&&h.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))e="websocket";else{if(0===this.transports.length){var t=this;return void setTimeout(function(){t.emit("error","No transports available")},0)}e=this.transports[0]}this.readyState="opening";try{e=this.createTransport(e)}catch(e){return this.transports.shift(),void this.open()}e.open(),this.setTransport(e)},h.prototype.setTransport=function(e){o("setting transport %s",e.name);var t=this;this.transport&&(o("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),this.transport=e,e.on("drain",function(){t.onDrain()}).on("packet",function(e){t.onPacket(e)}).on("error",function(e){t.onError(e)}).on("close",function(){t.onClose("transport close")})},h.prototype.probe=function(e){o('probing transport "%s"',e);var t=this.createTransport(e,{probe:1}),n=!1,r=this;function i(){if(r.onlyBinaryUpgrades){var i=!this.supportsBinary&&r.transport.supportsBinary;n=n||i}n||(o('probe transport "%s" opened',e),t.send([{type:"ping",data:"probe"}]),t.once("packet",function(i){if(!n)if("pong"===i.type&&"probe"===i.data){if(o('probe transport "%s" pong',e),r.upgrading=!0,r.emit("upgrading",t),!t)return;h.priorWebsocketSuccess="websocket"===t.name,o('pausing current transport "%s"',r.transport.name),r.transport.pause(function(){n||"closed"!==r.readyState&&(o("changing transport and sending upgrade packet"),p(),r.setTransport(t),t.send([{type:"upgrade"}]),r.emit("upgrade",t),t=null,r.upgrading=!1,r.flush())})}else{o('probe transport "%s" failed',e);var s=new Error("probe error");s.transport=t.name,r.emit("upgradeError",s)}}))}function s(){n||(n=!0,p(),t.close(),t=null)}function a(n){var i=new Error("probe error: "+n);i.transport=t.name,s(),o('probe transport "%s" failed because of error: %s',e,n),r.emit("upgradeError",i)}function u(){a("transport closed")}function c(){a("socket closed")}function l(e){t&&e.name!==t.name&&(o('"%s" works - aborting "%s"',e.name,t.name),s())}function p(){t.removeListener("open",i),t.removeListener("error",a),t.removeListener("close",u),r.removeListener("close",c),r.removeListener("upgrading",l)}h.priorWebsocketSuccess=!1,t.once("open",i),t.once("error",a),t.once("close",u),this.once("close",c),this.once("upgrading",l),t.open()},h.prototype.onOpen=function(){if(o("socket open"),this.readyState="open",h.priorWebsocketSuccess="websocket"===this.transport.name,this.emit("open"),this.flush(),"open"===this.readyState&&this.upgrade&&this.transport.pause){o("starting upgrade probes");for(var e=0,t=this.upgrades.length;e<t;e++)this.probe(this.upgrades[e])}},h.prototype.onPacket=function(e){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(o('socket receive: type "%s", data "%s"',e.type,e.data),this.emit("packet",e),this.emit("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"pong":this.setPing(),this.emit("pong");break;case"error":var t=new Error("server error");t.code=e.data,this.onError(t);break;case"message":this.emit("data",e.data),this.emit("message",e.data)}else o('packet received with socket readyState "%s"',this.readyState)},h.prototype.onHandshake=function(e){this.emit("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this.upgrades=this.filterUpgrades(e.upgrades),this.pingInterval=e.pingInterval,this.pingTimeout=e.pingTimeout,this.onOpen(),"closed"!==this.readyState&&(this.setPing(),this.removeListener("heartbeat",this.onHeartbeat),this.on("heartbeat",this.onHeartbeat))},h.prototype.onHeartbeat=function(e){clearTimeout(this.pingTimeoutTimer);var t=this;t.pingTimeoutTimer=setTimeout(function(){"closed"!==t.readyState&&t.onClose("ping timeout")},e||t.pingInterval+t.pingTimeout)},h.prototype.setPing=function(){var e=this;clearTimeout(e.pingIntervalTimer),e.pingIntervalTimer=setTimeout(function(){o("writing ping packet - expecting pong within %sms",e.pingTimeout),e.ping(),e.onHeartbeat(e.pingTimeout)},e.pingInterval)},h.prototype.ping=function(){var e=this;this.sendPacket("ping",function(){e.emit("ping")})},h.prototype.onDrain=function(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emit("drain"):this.flush()},h.prototype.flush=function(){"closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(o("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))},h.prototype.write=h.prototype.send=function(e,t,n){return this.sendPacket("message",e,t,n),this},h.prototype.sendPacket=function(e,t,n,r){if("function"==typeof t&&(r=t,t=void 0),"function"==typeof n&&(r=n,n=null),"closing"!==this.readyState&&"closed"!==this.readyState){(n=n||{}).compress=!1!==n.compress;var i={type:e,data:t,options:n};this.emit("packetCreate",i),this.writeBuffer.push(i),r&&this.once("flush",r),this.flush()}},h.prototype.close=function(){if("opening"===this.readyState||"open"===this.readyState){this.readyState="closing";var e=this;this.writeBuffer.length?this.once("drain",function(){this.upgrading?r():t()}):this.upgrading?r():t()}function t(){e.onClose("forced close"),o("socket closing - telling transport to close"),e.transport.close()}function n(){e.removeListener("upgrade",n),e.removeListener("upgradeError",n),t()}function r(){e.once("upgrade",n),e.once("upgradeError",n)}return this},h.prototype.onError=function(e){o("socket error %j",e),h.priorWebsocketSuccess=!1,this.emit("error",e),this.onClose("transport error",e)},h.prototype.onClose=function(e,t){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState){o('socket close with reason: "%s"',e);clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),this.readyState="closed",this.id=null,this.emit("close",e,t),this.writeBuffer=[],this.prevBufferLen=0}},h.prototype.filterUpgrades=function(e){for(var t=[],n=0,r=e.length;n<r;n++)~s(this.transports,e[n])&&t.push(e[n]);return t}},"./node_modules/socket.io-client/node_modules/engine.io-client/lib/transport.js":function(e,t,n){var r=n("./node_modules/engine.io-parser/lib/browser.js"),i=n("./node_modules/component-emitter/index.js");function o(e){this.path=e.path,this.hostname=e.hostname,this.port=e.port,this.secure=e.secure,this.query=e.query,this.timestampParam=e.timestampParam,this.timestampRequests=e.timestampRequests,this.readyState="",this.agent=e.agent||!1,this.socket=e.socket,this.enablesXDR=e.enablesXDR,this.pfx=e.pfx,this.key=e.key,this.passphrase=e.passphrase,this.cert=e.cert,this.ca=e.ca,this.ciphers=e.ciphers,this.rejectUnauthorized=e.rejectUnauthorized,this.forceNode=e.forceNode,this.isReactNative=e.isReactNative,this.extraHeaders=e.extraHeaders,this.localAddress=e.localAddress}e.exports=o,i(o.prototype),o.prototype.onError=function(e,t){var n=new Error(e);return n.type="TransportError",n.description=t,this.emit("error",n),this},o.prototype.open=function(){return"closed"!==this.readyState&&""!==this.readyState||(this.readyState="opening",this.doOpen()),this},o.prototype.close=function(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this},o.prototype.send=function(e){if("open"!==this.readyState)throw new Error("Transport not open");this.write(e)},o.prototype.onOpen=function(){this.readyState="open",this.writable=!0,this.emit("open")},o.prototype.onData=function(e){var t=r.decodePacket(e,this.socket.binaryType);this.onPacket(t)},o.prototype.onPacket=function(e){this.emit("packet",e)},o.prototype.onClose=function(){this.readyState="closed",this.emit("close")}},"./node_modules/socket.io-client/node_modules/engine.io-client/lib/transports/index.js":function(e,t,n){var r=n("./node_modules/socket.io-client/node_modules/engine.io-client/lib/xmlhttprequest.js"),i=n("./node_modules/socket.io-client/node_modules/engine.io-client/lib/transports/polling-xhr.js"),o=n("./node_modules/socket.io-client/node_modules/engine.io-client/lib/transports/polling-jsonp.js"),s=n("./node_modules/socket.io-client/node_modules/engine.io-client/lib/transports/websocket.js");t.polling=function(e){var t=!1,n=!1,s=!1!==e.jsonp;if("undefined"!=typeof location){var a="https:"===location.protocol,u=location.port;u||(u=a?443:80),t=e.hostname!==location.hostname||u!==e.port,n=e.secure!==a}if(e.xdomain=t,e.xscheme=n,"open"in new r(e)&&!e.forceJSONP)return new i(e);if(!s)throw new Error("JSONP disabled");return new o(e)},t.websocket=s},"./node_modules/socket.io-client/node_modules/engine.io-client/lib/transports/polling-jsonp.js":function(e,t,n){(function(t){var r=n("./node_modules/socket.io-client/node_modules/engine.io-client/lib/transports/polling.js"),i=n("./node_modules/component-inherit/index.js");e.exports=h;var o,s=/\n/g,a=/\\n/g;function u(){}function c(){return"undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==t?t:{}}function h(e){if(r.call(this,e),this.query=this.query||{},!o){var t=c();o=t.___eio=t.___eio||[]}this.index=o.length;var n=this;o.push(function(e){n.onData(e)}),this.query.j=this.index,"function"==typeof addEventListener&&addEventListener("beforeunload",function(){n.script&&(n.script.onerror=u)},!1)}i(h,r),h.prototype.supportsBinary=!1,h.prototype.doClose=function(){this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),this.form&&(this.form.parentNode.removeChild(this.form),this.form=null,this.iframe=null),r.prototype.doClose.call(this)},h.prototype.doPoll=function(){var e=this,t=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),t.async=!0,t.src=this.uri(),t.onerror=function(t){e.onError("jsonp poll error",t)};var n=document.getElementsByTagName("script")[0];n?n.parentNode.insertBefore(t,n):(document.head||document.body).appendChild(t),this.script=t,"undefined"!=typeof navigator&&/gecko/i.test(navigator.userAgent)&&setTimeout(function(){var e=document.createElement("iframe");document.body.appendChild(e),document.body.removeChild(e)},100)},h.prototype.doWrite=function(e,t){var n=this;if(!this.form){var r,i=document.createElement("form"),o=document.createElement("textarea"),u=this.iframeId="eio_iframe_"+this.index;i.className="socketio",i.style.position="absolute",i.style.top="-1000px",i.style.left="-1000px",i.target=u,i.method="POST",i.setAttribute("accept-charset","utf-8"),o.name="d",i.appendChild(o),document.body.appendChild(i),this.form=i,this.area=o}function c(){h(),t()}function h(){if(n.iframe)try{n.form.removeChild(n.iframe)}catch(e){n.onError("jsonp polling iframe removal error",e)}try{var e='<iframe src="javascript:0" name="'+n.iframeId+'">';r=document.createElement(e)}catch(e){(r=document.createElement("iframe")).name=n.iframeId,r.src="javascript:0"}r.id=n.iframeId,n.form.appendChild(r),n.iframe=r}this.form.action=this.uri(),h(),e=e.replace(a,"\\\n"),this.area.value=e.replace(s,"\\n");try{this.form.submit()}catch(e){}this.iframe.attachEvent?this.iframe.onreadystatechange=function(){"complete"===n.iframe.readyState&&c()}:this.iframe.onload=c}}).call(this,n("./node_modules/webpack/buildin/global.js"))},"./node_modules/socket.io-client/node_modules/engine.io-client/lib/transports/polling-xhr.js":function(e,t,n){var r=n("./node_modules/socket.io-client/node_modules/engine.io-client/lib/xmlhttprequest.js"),i=n("./node_modules/socket.io-client/node_modules/engine.io-client/lib/transports/polling.js"),o=n("./node_modules/component-emitter/index.js"),s=n("./node_modules/component-inherit/index.js"),a=n("./node_modules/socket.io-client/node_modules/debug/src/browser.js")("engine.io-client:polling-xhr");function u(){}function c(e){if(i.call(this,e),this.requestTimeout=e.requestTimeout,this.extraHeaders=e.extraHeaders,"undefined"!=typeof location){var t="https:"===location.protocol,n=location.port;n||(n=t?443:80),this.xd="undefined"!=typeof location&&e.hostname!==location.hostname||n!==e.port,this.xs=e.secure!==t}}function h(e){this.method=e.method||"GET",this.uri=e.uri,this.xd=!!e.xd,this.xs=!!e.xs,this.async=!1!==e.async,this.data=void 0!==e.data?e.data:null,this.agent=e.agent,this.isBinary=e.isBinary,this.supportsBinary=e.supportsBinary,this.enablesXDR=e.enablesXDR,this.requestTimeout=e.requestTimeout,this.pfx=e.pfx,this.key=e.key,this.passphrase=e.passphrase,this.cert=e.cert,this.ca=e.ca,this.ciphers=e.ciphers,this.rejectUnauthorized=e.rejectUnauthorized,this.extraHeaders=e.extraHeaders,this.create()}if(e.exports=c,e.exports.Request=h,s(c,i),c.prototype.supportsBinary=!0,c.prototype.request=function(e){return(e=e||{}).uri=this.uri(),e.xd=this.xd,e.xs=this.xs,e.agent=this.agent||!1,e.supportsBinary=this.supportsBinary,e.enablesXDR=this.enablesXDR,e.pfx=this.pfx,e.key=this.key,e.passphrase=this.passphrase,e.cert=this.cert,e.ca=this.ca,e.ciphers=this.ciphers,e.rejectUnauthorized=this.rejectUnauthorized,e.requestTimeout=this.requestTimeout,e.extraHeaders=this.extraHeaders,new h(e)},c.prototype.doWrite=function(e,t){var n="string"!=typeof e&&void 0!==e,r=this.request({method:"POST",data:e,isBinary:n}),i=this;r.on("success",t),r.on("error",function(e){i.onError("xhr post error",e)}),this.sendXhr=r},c.prototype.doPoll=function(){a("xhr poll");var e=this.request(),t=this;e.on("data",function(e){t.onData(e)}),e.on("error",function(e){t.onError("xhr poll error",e)}),this.pollXhr=e},o(h.prototype),h.prototype.create=function(){var e={agent:this.agent,xdomain:this.xd,xscheme:this.xs,enablesXDR:this.enablesXDR};e.pfx=this.pfx,e.key=this.key,e.passphrase=this.passphrase,e.cert=this.cert,e.ca=this.ca,e.ciphers=this.ciphers,e.rejectUnauthorized=this.rejectUnauthorized;var t=this.xhr=new r(e),n=this;try{a("xhr open %s: %s",this.method,this.uri),t.open(this.method,this.uri,this.async);try{if(this.extraHeaders)for(var i in t.setDisableHeaderCheck&&t.setDisableHeaderCheck(!0),this.extraHeaders)this.extraHeaders.hasOwnProperty(i)&&t.setRequestHeader(i,this.extraHeaders[i])}catch(e){}if("POST"===this.method)try{this.isBinary?t.setRequestHeader("Content-type","application/octet-stream"):t.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(e){}try{t.setRequestHeader("Accept","*/*")}catch(e){}"withCredentials"in t&&(t.withCredentials=!0),this.requestTimeout&&(t.timeout=this.requestTimeout),this.hasXDR()?(t.onload=function(){n.onLoad()},t.onerror=function(){n.onError(t.responseText)}):t.onreadystatechange=function(){if(2===t.readyState)try{var e=t.getResponseHeader("Content-Type");n.supportsBinary&&"application/octet-stream"===e&&(t.responseType="arraybuffer")}catch(e){}4===t.readyState&&(200===t.status||1223===t.status?n.onLoad():setTimeout(function(){n.onError(t.status)},0))},a("xhr data %s",this.data),t.send(this.data)}catch(e){return void setTimeout(function(){n.onError(e)},0)}"undefined"!=typeof document&&(this.index=h.requestsCount++,h.requests[this.index]=this)},h.prototype.onSuccess=function(){this.emit("success"),this.cleanup()},h.prototype.onData=function(e){this.emit("data",e),this.onSuccess()},h.prototype.onError=function(e){this.emit("error",e),this.cleanup(!0)},h.prototype.cleanup=function(e){if(void 0!==this.xhr&&null!==this.xhr){if(this.hasXDR()?this.xhr.onload=this.xhr.onerror=u:this.xhr.onreadystatechange=u,e)try{this.xhr.abort()}catch(e){}"undefined"!=typeof document&&delete h.requests[this.index],this.xhr=null}},h.prototype.onLoad=function(){var e;try{var t;try{t=this.xhr.getResponseHeader("Content-Type")}catch(e){}e="application/octet-stream"===t&&this.xhr.response||this.xhr.responseText}catch(e){this.onError(e)}null!=e&&this.onData(e)},h.prototype.hasXDR=function(){return"undefined"!=typeof XDomainRequest&&!this.xs&&this.enablesXDR},h.prototype.abort=function(){this.cleanup()},h.requestsCount=0,h.requests={},"undefined"!=typeof document)if("function"==typeof attachEvent)attachEvent("onunload",p);else if("function"==typeof addEventListener){var l="onpagehide"in self?"pagehide":"unload";addEventListener(l,p,!1)}function p(){for(var e in h.requests)h.requests.hasOwnProperty(e)&&h.requests[e].abort()}},"./node_modules/socket.io-client/node_modules/engine.io-client/lib/transports/polling.js":function(e,t,n){var r=n("./node_modules/socket.io-client/node_modules/engine.io-client/lib/transport.js"),i=n("./node_modules/parseqs/index.js"),o=n("./node_modules/engine.io-parser/lib/browser.js"),s=n("./node_modules/component-inherit/index.js"),a=n("./node_modules/yeast/index.js"),u=n("./node_modules/socket.io-client/node_modules/debug/src/browser.js")("engine.io-client:polling");e.exports=h;var c=null!=new(n("./node_modules/socket.io-client/node_modules/engine.io-client/lib/xmlhttprequest.js"))({xdomain:!1}).responseType;function h(e){var t=e&&e.forceBase64;c&&!t||(this.supportsBinary=!1),r.call(this,e)}s(h,r),h.prototype.name="polling",h.prototype.doOpen=function(){this.poll()},h.prototype.pause=function(e){var t=this;function n(){u("paused"),t.readyState="paused",e()}if(this.readyState="pausing",this.polling||!this.writable){var r=0;this.polling&&(u("we are currently polling - waiting to pause"),r++,this.once("pollComplete",function(){u("pre-pause polling complete"),--r||n()})),this.writable||(u("we are currently writing - waiting to pause"),r++,this.once("drain",function(){u("pre-pause writing complete"),--r||n()}))}else n()},h.prototype.poll=function(){u("polling"),this.polling=!0,this.doPoll(),this.emit("poll")},h.prototype.onData=function(e){var t=this;u("polling got data %s",e);o.decodePayload(e,this.socket.binaryType,function(e,n,r){if("opening"===t.readyState&&t.onOpen(),"close"===e.type)return t.onClose(),!1;t.onPacket(e)}),"closed"!==this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"===this.readyState?this.poll():u('ignoring poll - transport state "%s"',this.readyState))},h.prototype.doClose=function(){var e=this;function t(){u("writing close packet"),e.write([{type:"close"}])}"open"===this.readyState?(u("transport open - closing"),t()):(u("transport not open - deferring close"),this.once("open",t))},h.prototype.write=function(e){var t=this;this.writable=!1;var n=function(){t.writable=!0,t.emit("drain")};o.encodePayload(e,this.supportsBinary,function(e){t.doWrite(e,n)})},h.prototype.uri=function(){var e=this.query||{},t=this.secure?"https":"http",n="";return!1!==this.timestampRequests&&(e[this.timestampParam]=a()),this.supportsBinary||e.sid||(e.b64=1),e=i.encode(e),this.port&&("https"===t&&443!==Number(this.port)||"http"===t&&80!==Number(this.port))&&(n=":"+this.port),e.length&&(e="?"+e),t+"://"+(-1!==this.hostname.indexOf(":")?"["+this.hostname+"]":this.hostname)+n+this.path+e}},"./node_modules/socket.io-client/node_modules/engine.io-client/lib/transports/websocket.js":function(e,t,n){(function(t){var r,i,o=n("./node_modules/socket.io-client/node_modules/engine.io-client/lib/transport.js"),s=n("./node_modules/engine.io-parser/lib/browser.js"),a=n("./node_modules/parseqs/index.js"),u=n("./node_modules/component-inherit/index.js"),c=n("./node_modules/yeast/index.js"),h=n("./node_modules/socket.io-client/node_modules/debug/src/browser.js")("engine.io-client:websocket");if("undefined"!=typeof WebSocket)r=WebSocket;else if("undefined"!=typeof self)r=self.WebSocket||self.MozWebSocket;else try{i=n(0)}catch(e){}var l=r||i;function p(e){e&&e.forceBase64&&(this.supportsBinary=!1),this.perMessageDeflate=e.perMessageDeflate,this.usingBrowserWebSocket=r&&!e.forceNode,this.protocols=e.protocols,this.usingBrowserWebSocket||(l=i),o.call(this,e)}e.exports=p,u(p,o),p.prototype.name="websocket",p.prototype.supportsBinary=!0,p.prototype.doOpen=function(){if(this.check()){var e=this.uri(),t=this.protocols,n={agent:this.agent,perMessageDeflate:this.perMessageDeflate};n.pfx=this.pfx,n.key=this.key,n.passphrase=this.passphrase,n.cert=this.cert,n.ca=this.ca,n.ciphers=this.ciphers,n.rejectUnauthorized=this.rejectUnauthorized,this.extraHeaders&&(n.headers=this.extraHeaders),this.localAddress&&(n.localAddress=this.localAddress);try{this.ws=this.usingBrowserWebSocket&&!this.isReactNative?t?new l(e,t):new l(e):new l(e,t,n)}catch(e){return this.emit("error",e)}void 0===this.ws.binaryType&&(this.supportsBinary=!1),this.ws.supports&&this.ws.supports.binary?(this.supportsBinary=!0,this.ws.binaryType="nodebuffer"):this.ws.binaryType="arraybuffer",this.addEventListeners()}},p.prototype.addEventListeners=function(){var e=this;this.ws.onopen=function(){e.onOpen()},this.ws.onclose=function(){e.onClose()},this.ws.onmessage=function(t){e.onData(t.data)},this.ws.onerror=function(t){e.onError("websocket error",t)}},p.prototype.write=function(e){var n=this;this.writable=!1;for(var r=e.length,i=0,o=r;i<o;i++)!function(e){s.encodePacket(e,n.supportsBinary,function(i){if(!n.usingBrowserWebSocket){var o={};if(e.options&&(o.compress=e.options.compress),n.perMessageDeflate)("string"==typeof i?t.byteLength(i):i.length)<n.perMessageDeflate.threshold&&(o.compress=!1)}try{n.usingBrowserWebSocket?n.ws.send(i):n.ws.send(i,o)}catch(e){h("websocket closed before onclose event")}--r||a()})}(e[i]);function a(){n.emit("flush"),setTimeout(function(){n.writable=!0,n.emit("drain")},0)}},p.prototype.onClose=function(){o.prototype.onClose.call(this)},p.prototype.doClose=function(){void 0!==this.ws&&this.ws.close()},p.prototype.uri=function(){var e=this.query||{},t=this.secure?"wss":"ws",n="";return this.port&&("wss"===t&&443!==Number(this.port)||"ws"===t&&80!==Number(this.port))&&(n=":"+this.port),this.timestampRequests&&(e[this.timestampParam]=c()),this.supportsBinary||(e.b64=1),(e=a.encode(e)).length&&(e="?"+e),t+"://"+(-1!==this.hostname.indexOf(":")?"["+this.hostname+"]":this.hostname)+n+this.path+e},p.prototype.check=function(){return!(!l||"__initialize"in l&&this.name===p.prototype.name)}}).call(this,n("./node_modules/node-libs-browser/node_modules/buffer/index.js").Buffer)},"./node_modules/socket.io-client/node_modules/engine.io-client/lib/xmlhttprequest.js":function(e,t,n){var r=n("./node_modules/has-cors/index.js");e.exports=function(e){var t=e.xdomain,n=e.xscheme,i=e.enablesXDR;try{if("undefined"!=typeof XMLHttpRequest&&(!t||r))return new XMLHttpRequest}catch(e){}try{if("undefined"!=typeof XDomainRequest&&!n&&i)return new XDomainRequest}catch(e){}if(!t)try{return new(self[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(e){}}},"./node_modules/socket.io-client/node_modules/isarray/index.js":function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},"./node_modules/socket.io-client/node_modules/socket.io-parser/binary.js":function(e,t,n){var r=n("./node_modules/socket.io-client/node_modules/isarray/index.js"),i=n("./node_modules/socket.io-client/node_modules/socket.io-parser/is-buffer.js"),o=Object.prototype.toString,s="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===o.call(Blob),a="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===o.call(File);t.deconstructPacket=function(e){var t=[],n=e.data,o=e;return o.data=function e(t,n){if(!t)return t;if(i(t)){var o={_placeholder:!0,num:n.length};return n.push(t),o}if(r(t)){for(var s=new Array(t.length),a=0;a<t.length;a++)s[a]=e(t[a],n);return s}if("object"==typeof t&&!(t instanceof Date)){var s={};for(var u in t)s[u]=e(t[u],n);return s}return t}(n,t),o.attachments=t.length,{packet:o,buffers:t}},t.reconstructPacket=function(e,t){return e.data=function e(t,n){if(!t)return t;if(t&&t._placeholder)return n[t.num];if(r(t))for(var i=0;i<t.length;i++)t[i]=e(t[i],n);else if("object"==typeof t)for(var o in t)t[o]=e(t[o],n);return t}(e.data,t),e.attachments=void 0,e},t.removeBlobs=function(e,t){var n=0,o=e;!function e(u,c,h){if(!u)return u;if(s&&u instanceof Blob||a&&u instanceof File){n++;var l=new FileReader;l.onload=function(){h?h[c]=this.result:o=this.result,--n||t(o)},l.readAsArrayBuffer(u)}else if(r(u))for(var p=0;p<u.length;p++)e(u[p],p,u);else if("object"==typeof u&&!i(u))for(var d in u)e(u[d],d,u)}(o),n||t(o)}},"./node_modules/socket.io-client/node_modules/socket.io-parser/index.js":function(e,t,n){var r=n("./node_modules/socket.io-client/node_modules/debug/src/browser.js")("socket.io-parser"),i=n("./node_modules/component-emitter/index.js"),o=n("./node_modules/socket.io-client/node_modules/socket.io-parser/binary.js"),s=n("./node_modules/socket.io-client/node_modules/isarray/index.js"),a=n("./node_modules/socket.io-client/node_modules/socket.io-parser/is-buffer.js");function u(){}t.protocol=4,t.types=["CONNECT","DISCONNECT","EVENT","ACK","ERROR","BINARY_EVENT","BINARY_ACK"],t.CONNECT=0,t.DISCONNECT=1,t.EVENT=2,t.ACK=3,t.ERROR=4,t.BINARY_EVENT=5,t.BINARY_ACK=6,t.Encoder=u,t.Decoder=l;var c=t.ERROR+'"encode error"';function h(e){var n=""+e.type;if(t.BINARY_EVENT!==e.type&&t.BINARY_ACK!==e.type||(n+=e.attachments+"-"),e.nsp&&"/"!==e.nsp&&(n+=e.nsp+","),null!=e.id&&(n+=e.id),null!=e.data){var i=function(e){try{return JSON.stringify(e)}catch(e){return!1}}(e.data);if(!1===i)return c;n+=i}return r("encoded %j as %s",e,n),n}function l(){this.reconstructor=null}function p(e){this.reconPack=e,this.buffers=[]}function d(e){return{type:t.ERROR,data:"parser error: "+e}}u.prototype.encode=function(e,n){(r("encoding packet %j",e),t.BINARY_EVENT===e.type||t.BINARY_ACK===e.type)?function(e,t){o.removeBlobs(e,function(e){var n=o.deconstructPacket(e),r=h(n.packet),i=n.buffers;i.unshift(r),t(i)})}(e,n):n([h(e)])},i(l.prototype),l.prototype.add=function(e){var n;if("string"==typeof e)n=function(e){var n=0,i={type:Number(e.charAt(0))};if(null==t.types[i.type])return d("unknown packet type "+i.type);if(t.BINARY_EVENT===i.type||t.BINARY_ACK===i.type){for(var o="";"-"!==e.charAt(++n)&&(o+=e.charAt(n),n!=e.length););if(o!=Number(o)||"-"!==e.charAt(n))throw new Error("Illegal attachments");i.attachments=Number(o)}if("/"===e.charAt(n+1))for(i.nsp="";++n;){var a=e.charAt(n);if(","===a)break;if(i.nsp+=a,n===e.length)break}else i.nsp="/";var u=e.charAt(n+1);if(""!==u&&Number(u)==u){for(i.id="";++n;){var a=e.charAt(n);if(null==a||Number(a)!=a){--n;break}if(i.id+=e.charAt(n),n===e.length)break}i.id=Number(i.id)}if(e.charAt(++n)){var c=function(e){try{return JSON.parse(e)}catch(e){return!1}}(e.substr(n)),h=!1!==c&&(i.type===t.ERROR||s(c));if(!h)return d("invalid payload");i.data=c}return r("decoded %s as %j",e,i),i}(e),t.BINARY_EVENT===n.type||t.BINARY_ACK===n.type?(this.reconstructor=new p(n),0===this.reconstructor.reconPack.attachments&&this.emit("decoded",n)):this.emit("decoded",n);else{if(!a(e)&&!e.base64)throw new Error("Unknown type: "+e);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");(n=this.reconstructor.takeBinaryData(e))&&(this.reconstructor=null,this.emit("decoded",n))}},l.prototype.destroy=function(){this.reconstructor&&this.reconstructor.finishedReconstruction()},p.prototype.takeBinaryData=function(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){var t=o.reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null},p.prototype.finishedReconstruction=function(){this.reconPack=null,this.buffers=[]}},"./node_modules/socket.io-client/node_modules/socket.io-parser/is-buffer.js":function(e,t,n){(function(t){e.exports=function(e){return n&&t.isBuffer(e)||r&&(e instanceof ArrayBuffer||i(e))};var n="function"==typeof t&&"function"==typeof t.isBuffer,r="function"==typeof ArrayBuffer,i=function(e){return"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(e):e.buffer instanceof ArrayBuffer}}).call(this,n("./node_modules/node-libs-browser/node_modules/buffer/index.js").Buffer)},"./node_modules/strict-uri-encode/index.js":function(e,t,n){"use strict";e.exports=(e=>encodeURIComponent(e).replace(/[!'()*]/g,e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`))},"./node_modules/to-array/index.js":function(e,t){e.exports=function(e,t){for(var n=[],r=(t=t||0)||0;r<e.length;r++)n[r-t]=e[r];return n}},"./node_modules/webpack/buildin/global.js":function(e,t){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(n=window)}e.exports=n},"./node_modules/webpack/buildin/module.js":function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},"./node_modules/yeast/index.js":function(e,t,n){"use strict";var r,i="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),o=64,s={},a=0,u=0;function c(e){var t="";do{t=i[e%o]+t,e=Math.floor(e/o)}while(e>0);return t}function h(){var e=c(+new Date);return e!==r?(a=0,r=e):e+"."+c(a++)}for(;u<o;u++)s[i[u]]=u;h.encode=c,h.decode=function(e){var t=0;for(u=0;u<e.length;u++)t=t*o+s[e.charAt(u)];return t},e.exports=h},"./package.json":function(e){e.exports={name:"skyway-js",version:"1.4.0",description:"The official JavaScript SDK for SkyWay",main:"dist/skyway.js",module:"src/peer.js",scripts:{test:"karma start ./karma.conf.js",clean:"del ./dist",lint:"eslint .",build:"NODE_ENV=production webpack",dev:"webpack -w"},repository:{type:"git",url:"git+https://github.com/skyway/skyway-js-sdk"},files:["dist/skyway.js","LICENSE","CHANGELOG.md","README.md"],author:"NTT Communications Corp.",license:"MIT",devDependencies:{"babel-loader":"^7.1.4","babel-plugin-espower":"^2.4.0","babel-plugin-istanbul":"^4.1.6","babel-preset-es2015":"^6.24.1","del-cli":"^1.1.0",eslint:"^5.0.0","eslint-config-prettier":"^2.9.0","eslint-plugin-prettier":"^2.4.0","inject-loader":"^4.0.1",karma:"^2.0.0","karma-chrome-launcher":"^2.2.0","karma-coverage":"^1.1.2","karma-mocha":"^1.3.0","karma-mocha-reporter":"^2.2.5","karma-sourcemap-loader":"^0.3.7","karma-webpack":"^3.0.0",mocha:"^5.2.0","power-assert":"^1.4.4",prettier:"^1.9.2",sinon:"^6.0.1",webpack:"^4.12.1","webpack-cli":"^3.0.8"},dependencies:{"detect-browser":"^4.2.0",enum:"git+https://github.com/eastandwest/enum.git#react-native",events:"^3.0.0","js-binarypack":"0.0.9","object-sizeof":"^1.3.0","query-string":"^6.4.0","sdp-interop":"^0.1.13","sdp-transform":"^2.7.0","socket.io-client":"^2.2.0"}}},"./src/peer.js":function(e,t,n){"use strict";var r=n("./node_modules/node-libs-browser/node_modules/events/events.js"),i=n.n(r),o=n("./node_modules/enum/index.js"),s=n.n(o),a=n("./node_modules/socket.io-client/lib/index.js"),u=n.n(a),c=n("./node_modules/query-string/index.js"),h=n.n(c);var l={DISPATCHER_HOST:"dispatcher.webrtc.ecl.ntt.com",DISPATCHER_PORT:443,DISPATCHER_SECURE:!0,DISPATCHER_TIMEOUT:1e4,TURN_HOST:"turn.webrtc.ecl.ntt.com",TURN_PORT:443,MESSAGE_TYPES:{CLIENT:new s.a(["SEND_OFFER","SEND_ANSWER","SEND_CANDIDATE","SEND_LEAVE","ROOM_JOIN","ROOM_LEAVE","ROOM_GET_LOGS","ROOM_GET_USERS","ROOM_SEND_DATA","SFU_GET_OFFER","SFU_ANSWER","SFU_CANDIDATE","PING","UPDATE_CREDENTIAL","SEND_FORCE_CLOSE"]),SERVER:new s.a(["OPEN","ERROR","OFFER","ANSWER","CANDIDATE","LEAVE","AUTH_EXPIRES_IN","ROOM_LOGS","ROOM_USERS","ROOM_DATA","ROOM_USER_JOIN","ROOM_USER_LEAVE","SFU_OFFER","FORCE_CLOSE"])},maxChunkSize:16300,reconnectionAttempts:2,numberServersToTry:3,sendInterval:1,pingInterval:25e3,defaultConfig:{iceServers:[{urls:"stun:stun.webrtc.ecl.ntt.com:3478",url:"stun:stun.webrtc.ecl.ntt.com:3478"}],iceTransportPolicy:"all"}};const p="SkyWay: ",d=new s.a({NONE:0,ERROR:1,WARN:2,FULL:3});var f=new class{constructor(){this._logLevel=d.NONE.value,this.LOG_LEVELS=d}setLogLevel(e){switch(e.value&&(e=e.value),parseInt(e,10)){case 0:this._logLevel=d.NONE.value;break;case 1:this._logLevel=d.ERROR.value;break;case 2:this._logLevel=d.WARN.value;break;case 3:this._logLevel=d.FULL.value;break;default:this._logLevel=d.NONE.value}}warn(...e){this._logLevel>=d.WARN.value&&console.warn(p,...e)}error(...e){this._logLevel>=d.ERROR.value&&console.error(p,...e)}log(...e){this._logLevel>=d.FULL.value&&console.log(p,...e)}},m=n("./package.json");var y=class extends i.a{constructor(e,t){if(super(),this._isOpen=!1,this._isPeerIdSet=!1,this._queue=[],this._io=null,this._key=e,this._reconnectAttempts=0,t.host&&t.port){const e=t.secure?"https://":"http://";this.signalingServerUrl=`${e}${t.host}:${t.port}`}else{const e=t.dispatcherHost||l.DISPATCHER_HOST,n=t.dispatcherPort||l.DISPATCHER_PORT,r=t.dispatcherSecure||l.DISPATCHER_SECURE?"https://":"http://";this._dispatcherUrl=`${r}${e}:${n}/signaling`}}get isOpen(){return Boolean(this._io&&this._io.connected&&this._isOpen)}async start(e,t,n){let r=`apiKey=${this._key}&token=${t}`+`&platform=javascript&sdk_version=${m.version}`;if(e&&(r+=`&peerId=${e}`,this._isPeerIdSet=!0),n&&(r+=`&credential=${encodeURIComponent(JSON.stringify(n))}`),this._dispatcherUrl){let e;try{e=await this._getSignalingServer()}catch(e){return void this.emit("error",e)}const t=e.secure?"https://":"http://";this.signalingServerUrl=`${t}${e.host}:${e.port}`}this._io=u()(this.signalingServerUrl,{"force new connection":!0,query:r,reconnectionAttempts:l.reconnectionAttempts}),this._io.on("reconnect_failed",()=>{this._stopPings(),this._connectToNewServer()}),this._io.on("error",e=>{f.error(e)}),this._setupMessageHandlers()}async _connectToNewServer(e=0){if(e>=10||this._reconnectAttempts>=l.numberServersToTry)return void this.emit("error","Could not connect to server.");let t;try{t=await this._getSignalingServer()}catch(e){return void this.emit("error",e)}if(-1===this.signalingServerUrl.indexOf(t.host)){const e=t.secure?"https://":"http://";this.signalingServerUrl=`${e}${t.host}:${t.port}`,this._io.io.uri=this.signalingServerUrl,this._io.connect(),this._reconnectAttempts++}else this._connectToNewServer(++e)}_getSignalingServer(){return new Promise((e,t)=>{const n=new XMLHttpRequest;n.timeout=l.DISPATCHER_TIMEOUT,n.open("GET",this._dispatcherUrl,!0),n.onerror=(()=>{t(new Error("There was a problem with the dispatcher."))}),n.onabort=(()=>{t(new Error("The request was aborted."))}),n.ontimeout=(()=>{t(new Error("The request for the dispather timed out."))}),n.onreadystatechange=(()=>{if(4!==n.readyState)return;if(0===n.status)return void t(new Error("There was a problem with the dispatcher."));let r=null;try{r=JSON.parse(n.responseText)}catch(e){return void t(new Error("The dispatcher server returned an invalid JSON response."))}if(200===n.status&&r&&r.domain)e({host:r.domain,port:443,secure:!0});else if(r.error&&r.error.message){const e=r.error.message;t(new Error(e))}else t(new Error("There was a problem with the dispatcher."))}),n.send(null)})}send(e,t){e?this.isOpen?!0===this._io.connected&&this._io.emit(e,t):this._queue.push({type:e,message:t}):this._io.emit("error","Invalid message")}close(){this.isOpen&&(this._stopPings(),this._io.disconnect(),this._isOpen=!1)}reconnect(){this._io.connect()}updateCredential(e){const t=h.a.parse(this._io.io.opts.query);t.credential?t.credential=encodeURIComponent(JSON.stringify(e)):f.warn("Adding a credential when one wasn't specified before."),this._io.io.opts.query=h.a.stringify(t),this.send(l.MESSAGE_TYPES.CLIENT.UPDATE_CREDENTIAL.key,e)}_setupMessageHandlers(){l.MESSAGE_TYPES.SERVER.enums.forEach(e=>{e.key===l.MESSAGE_TYPES.SERVER.OPEN.key?this._io.on(e.key,t=>{t&&t.peerId&&(this._isPeerIdSet||(this._io.io.opts.query+=`&peerId=${t.peerId}`,this._isPeerIdSet=!0),this._reconnectAttempts=0,this._startPings(),this._sendQueuedMessages(),this._isOpen||(this._isOpen=!0,this.emit(e.key,t)))}):this._io.on(e.key,t=>{this.emit(e.key,t)})})}_sendQueuedMessages(){for(const e of this._queue)this.send(e.type,e.message);this._queue=[]}_startPings(){this._pingIntervalId||(this._pingIntervalId=setInterval(()=>{this.send(l.MESSAGE_TYPES.CLIENT.PING.key)},l.pingInterval))}_stopPings(){clearInterval(this._pingIntervalId),this._pingIntervalId=void 0}},v=n("./node_modules/sdp-transform/lib/index.js"),g=n.n(v),_=n("./node_modules/sdp-interop/lib/index.js");var b=new class{unifiedToPlanB(e){const t=(new _.Interop).toPlanB(e).sdp,n=new Set,r=/a=ssrc:\d+ msid:(\w+)/g;let i;for(;i=r.exec(t);)n.add(i[1]);const o=t.replace("a=msid-semantic:WMS *",`a=msid-semantic:WMS ${Array.from(n).join(" ")}`);return new RTCSessionDescription({type:"offer",sdp:o})}addVideoBandwidth(e,t){return this._validateBandwidth(t),this._addBandwidth(e,t,"video")}addAudioBandwidth(e,t){return this._validateBandwidth(t),this._addBandwidth(e,t,"audio")}filterVideoCodec(e,t){return this._filterCodec(e,t,"video")}filterAudioCodec(e,t){return this._filterCodec(e,t,"audio")}pretendUnifiedPlan(e){return e.split("\r\n").map(e=>e.startsWith("a=msid-semantic")?"a=msid-semantic:WMS *":e).join("\r\n")}_filterCodec(e,t,n){if(void 0===t)throw new Error("codec is not passed");const r=g.a.parse(e);return r.media=r.media.map(e=>{if(e.type===n){e.rtp=e.rtp.filter(e=>e.codec===t);const n=e.rtp.reduce((e,t)=>[...e,t.payload],[]);if(0===e.rtp.length)throw new Error(`${t} does not exist`);e.fmtp&&(e.fmtp=e.fmtp.filter(e=>n.includes(e.payload))),e.rtcpFb&&(e.rtcpFb=e.rtcpFb.filter(e=>n.includes(e.payload))),e.payloads=n.join(" ")}return e}),g.a.write(r)}_addBandwidth(e,t,n){const r=g.a.parse(e);return r.media=r.media.map(e=>(e.type===n&&(e.bandwidth=[{type:"AS",limit:t.toString()},{type:"TIAS",limit:(1e3*t).toString()}]),e)),g.a.write(r)}_validateBandwidth(e){if(void 0===e)throw new Error("bandwidth is not passed");if(!/^\d+$/.test(e))throw new Error(`${e} is not a number`)}},w=n("./node_modules/detect-browser/index.js");function E(){const{name:e,version:t}=Object(w.detect)(),[n,r,i]=t.split(".").map(e=>parseInt(e));return{name:e,major:n,minor:r,patch:i}}var S={validateId:function(e){return!e||/^[A-Za-z0-9_-]+(?:[ _-][A-Za-z0-9]+)*$/.exec(e)},validateKey:function(e){return!e||/^[a-z0-9]{8}(-[a-z0-9]{4}){3}-[a-z0-9]{12}$/.exec(e)},randomId:function(){return(Math.random().toString(36)+"0000000000000000000").substr(2,16)},randomToken:function(){return Math.random().toString(36).substr(2)},joinArrayBuffers:function(e){const t=e.reduce((e,t)=>e+t.byteLength,0),n=new Uint8Array(t);let r=0;for(const t of e)n.set(new Uint8Array(t),r),r+=t.byteLength;return n.buffer},blobToArrayBuffer:function(e,t){const n=new FileReader;n.onload=(e=>{t(e.target.result)}),n.readAsArrayBuffer(e)},isSecure:function(){return"https:"===location.protocol},detectBrowser:E,isUnifiedPlanSafari:function(){const{name:e,major:t,minor:n}=E();return!!(("safari"===e||"ios"===e)&&t>=12&&n>=1&&RTCRtpTransceiver.prototype.hasOwnProperty("currentDirection"))}};const C=new s.a(["addStream","removeStream","dcCreated","offerCreated","answerCreated","iceCandidate","iceCandidatesComplete","iceConnectionFailed","negotiationNeeded","error"]);class T extends i.a{constructor(){super(),this._offerQueue=[],this._isExpectingAnswer=!1,this._replaceStreamCalled=!1,this._isNegotiationAllowed=!0,this.hasRemoteDescription=!1}async startConnection(e={}){if(this._pc=this._createPeerConnection(e.pcConfig),this._setupPCListeners(),this.originator=e.originator,this._audioBandwidth=e.audioBandwidth,this._videoBandwidth=e.videoBandwidth,this._audioCodec=e.audioCodec,this._videoCodec=e.videoCodec,this._type=e.type,this._recvonlyState=this._getReceiveOnlyState(e),"media"===this._type)if(e.stream)e.stream.getTracks().forEach(t=>{this._pc.addTrack(t,e.stream)});else if(this.originator){const e=await this._makeOfferSdp();await this._setLocalDescription(e)}if(this.originator){if("data"===this._type){const t=e.label||"",n=e.dcInit||{},r=this._pc.createDataChannel(t,n);this.emit(T.EVENTS.dcCreated.key,r)}}else await this.handleOffer(e.offer)}replaceStream(e){if(!this._pc)return;this._isNegotiationAllowed=!0;const t=this,n=e.getVideoTracks(),r=e.getAudioTracks(),i=this._pc.getSenders(),o=i.find(e=>e.track&&"video"===e.track.kind),s=i.find(e=>e.track&&"audio"===e.track.kind);function a(e,n,r){void 0===n&&void 0===e||(void 0!==n?void 0!==e?e.track.id!==n.id&&e.replaceTrack(n):t._pc.addTrack(n,r):t._pc.removeTrack(e))}a(o,n[0],e),a(s,r[0],e)}async handleOffer(e){if(this._lastOffer&&e&&this._lastOffer.sdp===e.sdp)return;if(this._isNegotiationAllowed=!0,e||(e=this._lastOffer),this._lastOffer=e,"have-remote-offer"===this._pc.signalingState)return void this._offerQueue.push(e);await this._setRemoteDescription(e);const t=await this._makeAnswerSdp().catch(e=>f.error(e));this.emit(T.EVENTS.answerCreated.key,t)}async handleAnswer(e){this._isNegotiationAllowed=!0,this._isExpectingAnswer?(await this._setRemoteDescription(e),this._isExpectingAnswer=!1):this._pc.onnegotiationneeded&&this._pc.onnegotiationneeded()}async handleCandidate(e){await this._pc.addIceCandidate(new RTCIceCandidate(e)).then(()=>f.log("Successfully added ICE candidate")).catch(e=>f.error("Failed to add ICE candidate",e))}cleanup(){f.log("Cleaning up PeerConnection"),!this._pc||"closed"===this._pc.readyState&&"closed"===this._pc.signalingState||this._pc.close(),this._pc=null}_createPeerConnection(e={}){f.log("Creating RTCPeerConnection");const t=S.detectBrowser();return this._isAddTransceiverAvailable="function"==typeof RTCPeerConnection.prototype.addTransceiver&&"chrome"!==t.name,e.sdpSemantics="plan-b",new RTCPeerConnection(e)}_setupPCListeners(){const e=this._pc;e.ontrack=(e=>{f.log("Received remote media stream track"),e.streams.forEach(e=>{this.emit(T.EVENTS.addStream.key,e)})}),e.ondatachannel=(e=>{f.log("Received data channel");const t=e.channel;this.emit(T.EVENTS.dcCreated.key,t)}),e.onicecandidate=(t=>{const n=t.candidate;n?(f.log("Generated ICE candidate for:",n),this.emit(T.EVENTS.iceCandidate.key,n)):(f.log("ICE candidates gathering complete"),this.emit(T.EVENTS.iceCandidatesComplete.key,e.localDescription))}),e.oniceconnectionstatechange=(()=>{switch(e.iceConnectionState){case"completed":f.log("iceConnectionState is completed"),e.onicecandidate=(()=>{});break;case"disconnected":f.log("iceConnectionState is disconnected, trying reconnect by browser");break;case"failed":f.log("iceConnectionState is failed, closing connection"),this.emit(T.EVENTS.iceConnectionFailed.key);break;default:f.log(`iceConnectionState is ${e.iceConnectionState}`)}}),e.onnegotiationneeded=(async()=>{if(f.log("`negotiationneeded` triggered"),"stable"===e.signalingState&&this._isNegotiationAllowed){if(this._isNegotiationAllowed=!1,this.originator){const e=await this._makeOfferSdp();this._setLocalDescription(e),this.emit(T.EVENTS.negotiationNeeded.key)}else this._replaceStreamCalled&&this.handleOffer();this._replaceStreamCalled=!1}}),e.onremovestream=(e=>{f.log("`removestream` triggered"),this.emit(T.EVENTS.removeStream.key,e.stream)}),e.onsignalingstatechange=(()=>{if(f.log(`signalingState is ${e.signalingState}`),"stable"===e.signalingState){const e=this._offerQueue.shift();e&&this.handleOffer(e)}})}async _makeOfferSdp(){let e;try{if("media"!==this._type)e=await this._pc.createOffer();else if(this._isAddTransceiverAvailable)this._recvonlyState.audio&&this._pc.addTransceiver("audio",{direction:"recvonly"}),this._recvonlyState.video&&this._pc.addTransceiver("video",{direction:"recvonly"}),e=await this._pc.createOffer();else{const t={};this._recvonlyState.audio&&(t.offerToReceiveAudio=!0),this._recvonlyState.video&&(t.offerToReceiveVideo=!0),e=await this._pc.createOffer(t)}}catch(e){throw e.type="webrtc",f.error(e),this.emit(T.EVENTS.error.key,e),f.log("Failed to createOffer, ",e),e}return f.log("Created offer."),this._audioBandwidth&&(e.sdp=b.addAudioBandwidth(e.sdp,this._audioBandwidth)),this._videoBandwidth&&(e.sdp=b.addVideoBandwidth(e.sdp,this._videoBandwidth)),this._audioCodec&&(e.sdp=b.filterAudioCodec(e.sdp,this._audioCodec)),this._videoCodec&&(e.sdp=b.filterVideoCodec(e.sdp,this._videoCodec)),e}async _makeAnswerSdp(){let e;try{e=await this._pc.createAnswer()}catch(e){throw e.type="webrtc",f.error(e),this.emit(T.EVENTS.error.key,e),f.log("Failed to createAnswer, ",e),e}f.log("Created answer."),this._audioBandwidth&&(e.sdp=b.addAudioBandwidth(e.sdp,this._audioBandwidth)),this._videoBandwidth&&(e.sdp=b.addVideoBandwidth(e.sdp,this._videoBandwidth)),this._audioCodec&&(e.sdp=b.filterAudioCodec(e.sdp,this._audioCodec)),this._videoCodec&&(e.sdp=b.filterVideoCodec(e.sdp,this._videoCodec));try{await this._pc.setLocalDescription(e)}catch(e){throw e.type="webrtc",f.error(e),this.emit(T.EVENTS.error.key,e),f.log("Failed to setLocalDescription, ",e),e}return f.log("Set localDescription: answer"),f.log(`Setting local description ${JSON.stringify(e.sdp)}`),e}async _setLocalDescription(e){f.log(`Setting local description ${JSON.stringify(e.sdp)}`);try{await this._pc.setLocalDescription(e)}catch(e){throw e.type="webrtc",f.error(e),this.emit(T.EVENTS.error.key,e),f.log("Failed to setLocalDescription, ",e),e}f.log("Set localDescription: offer"),this._isExpectingAnswer=!0,this.emit(T.EVENTS.offerCreated.key,e)}async _setRemoteDescription(e){f.log(`Setting remote description ${JSON.stringify(e)}`);try{await this._pc.setRemoteDescription(new RTCSessionDescription(e)),this.hasRemoteDescription=!0}catch(e){throw e.type="webrtc",f.error(e),this.emit(T.EVENTS.error.key,e),f.log("Failed to setRemoteDescription: ",e),e}f.log("Set remoteDescription:",e.type)}_getReceiveOnlyState(e={}){const t={audio:!1,video:!1},n=e.stream instanceof MediaStream,r=!!n&&0!==e.stream.getAudioTracks().length,i=!!n&&0!==e.stream.getVideoTracks().length;return!1===n&&void 0===e.audioReceiveEnabled&&void 0===e.videoReceiveEnabled?(t.audio=!0,t.video=!0,t):(e.audioReceiveEnabled&&!1===r&&(t.audio=!0),e.videoReceiveEnabled&&!1===i&&(t.video=!0),!1===e.audioReceiveEnabled&&r&&f.warn("Option audioReceiveEnabled will be treated as true, because passed stream has MediaStreamTrack(kind = audio)"),!1===e.videoReceiveEnabled&&i&&f.warn("Option videoReceiveEnabled will be treated as true, because passed stream has MediaStreamTrack(kind = video)"),t)}static get EVENTS(){return C}}var k=T;const I=new s.a(["candidate","offer","answer","close","forceClose"]);class A extends i.a{constructor(e,t){if(super(),t=t||{},this.constructor===A)throw new TypeError("Cannot construct Connection instances directly");this._options=t,this.open=!1,this.type=void 0,this.metadata=this._options.metadata,this.remoteId=e,this._negotiator=new k,this._idPrefix="c_",this._randomIdSuffix=S.randomToken(),this._setupNegotiatorMessageHandlers()}get id(){return this._options.connectionId||this._idPrefix+this._randomIdSuffix}async handleAnswer(e){this._pcAvailable?(await this._negotiator.handleAnswer(e.answer),this.open=!0,this._handleQueuedMessages()):(f.log(`Queuing ANSWER message in ${this.id} from ${this.remoteId}`),this._queuedMessages.push({type:l.MESSAGE_TYPES.SERVER.ANSWER.key,payload:e}))}handleCandidate(e){!this._negotiator.originator||this._negotiator.hasRemoteDescription?this._pcAvailable?this._negotiator.handleCandidate(e.candidate):(f.log(`Queuing CANDIDATE message in ${this.id} from ${this.remoteId}`),this._queuedMessages.push({type:l.MESSAGE_TYPES.SERVER.CANDIDATE.key,payload:e})):this._queuedMessages.push({type:l.MESSAGE_TYPES.SERVER.CANDIDATE.key,payload:e})}updateOffer(e){this.open?this._negotiator.handleOffer(e.offer):this._options.payload=e}getPeerConnection(){return this.open?this._negotiator._pc:null}_handleQueuedMessages(){for(const e of this._queuedMessages)switch(e.type){case l.MESSAGE_TYPES.SERVER.ANSWER.key:this.handleAnswer(e.payload);break;case l.MESSAGE_TYPES.SERVER.CANDIDATE.key:this.handleCandidate(e.payload);break;default:f.warn("Unrecognized message type:",e.type,"from peer:",this.remoteId)}this._queuedMessages=[]}close(e=!1){this.open&&(this.open=!1,this._negotiator.cleanup(),this.emit(A.EVENTS.close.key),e&&this.emit(A.EVENTS.forceClose.key))}_setupNegotiatorMessageHandlers(){this._negotiator.on(k.EVENTS.answerCreated.key,e=>{const t={answer:e,dst:this.remoteId,connectionId:this.id,connectionType:this.type};this.emit(A.EVENTS.answer.key,t)}),this._negotiator.on(k.EVENTS.offerCreated.key,e=>{const t={offer:e,dst:this.remoteId,connectionId:this.id,connectionType:this.type,metadata:this.metadata};this.serialization&&(t.serialization=this.serialization),this.label&&(t.label=this.label),this.dcInit&&(t.dcInit=this.dcInit),this.emit(A.EVENTS.offer.key,t)}),this._negotiator.on(k.EVENTS.iceCandidate.key,e=>{const t={candidate:e,dst:this.remoteId,connectionId:this.id,connectionType:this.type};this.emit(A.EVENTS.candidate.key,t)}),this._negotiator.on(k.EVENTS.iceConnectionFailed.key,()=>{this.close()})}get peer(){return f.warn(`${this.constructor.name}.peer is deprecated and may be removed from a future version.`+` Please use ${this.constructor.name}.remoteId instead.`),this.remoteId}static get EVENTS(){return I}}var N=A,R=n("./node_modules/js-binarypack/lib/binarypack.js"),O=n.n(R),x=n("./node_modules/object-sizeof/index.js"),P=n.n(x);const D=new s.a(["open","data","error"]);D.extend(N.EVENTS.enums);const M=new s.a(["binary","binary-utf8","json","none"]);class L extends N{constructor(e,t){if(super(e,t),this._idPrefix="dc_",this.type="data",this._isOnOpenCalled=!1,this.label=this._options.label||this.id,this.dcInit=this._options.dcInit||{},this.serialization=L.SERIALIZATIONS.binary.key,this._options.serialization){if(!L.SERIALIZATIONS.get(this._options.serialization))throw new Error("Invalid serialization");this.serialization=this._options.serialization,this._isUnreliableDCInit(this.dcInit)&&(f.warn("You can not specify serialization with unreliable mode enabled."),this.serialization=L.SERIALIZATIONS.binary.key)}this._sendBuffer=[],this._receivedData={},this._queuedMessages=this._options.queuedMessages||[],this._negotiator.on(k.EVENTS.dcCreated.key,e=>{this._dc=e,this._dc.binaryType="arraybuffer",this._setupMessageHandlers(),this._isOnOpenCalled||"open"!==this._dc.readyState||this._dc.onopen()}),this._options.payload&&(this._options.payload.pcConfig=this._options.pcConfig)}async startConnection(){await this._negotiator.startConnection(this._options.payload||{originator:!0,type:"data",label:this.label,dcInit:this.dcInit,pcConfig:this._options.pcConfig}),this._pcAvailable=!0,this._handleQueuedMessages()}_setupMessageHandlers(){this._dc.onopen=(()=>{this._isOnOpenCalled||(f.log("Data channel connection success"),this.open=!0,this._isOnOpenCalled=!0,this.emit(L.EVENTS.open.key))}),this._dc.onmessage=(e=>{this._handleDataMessage(e)}),this._dc.onclose=(()=>{f.log("DataChannel closed for:",this.id),this.close()}),this._dc.onerror=(e=>{f.error(e)})}_handleDataMessage(e){if(this.serialization===L.SERIALIZATIONS.none.key)return void this.emit(L.EVENTS.data.key,e.data);if(this.serialization===L.SERIALIZATIONS.json.key)return void this.emit(L.EVENTS.data.key,JSON.parse(e.data));const t=O.a.unpack(e.data);let n=this._receivedData[t.id];if(n||(n=this._receivedData[t.id]={size:t.size,type:t.type,name:t.name,mimeType:t.mimeType,totalParts:t.totalParts,parts:new Array(t.totalParts),receivedParts:0}),n.receivedParts++,n.parts[t.index]=t.data,n.receivedParts===n.totalParts){delete this._receivedData[t.id];const e=S.joinArrayBuffers(n.parts),r=O.a.unpack(e);let i;switch(n.type){case"Blob":i=new Blob([new Uint8Array(r)],{type:n.mimeType});break;case"File":i=new File([new Uint8Array(r)],n.name,{type:n.mimeType});break;default:i=r}this.emit(L.EVENTS.data.key,i)}}send(e){if(!this.open)return void this.emit(L.EVENTS.error.key,new Error("Connection is not open. You should listen for the `open` event before sending messages."));if(void 0===e||null===e)return;if(this.serialization===L.SERIALIZATIONS.none.key)return this._sendBuffer.push(e),void this._startSendLoop();if(this.serialization===L.SERIALIZATIONS.json.key)return this._sendBuffer.push(JSON.stringify(e)),void this._startSendLoop();const t=O.a.pack(e),n=t.size,r=e.constructor.name,i={id:S.randomId(),type:r,size:n,totalParts:0};"File"===r&&(i.name=e.name),e instanceof Blob&&(i.mimeType=e.type);const o=l.maxChunkSize-P()(i),s=Math.ceil(n/o);i.totalParts=s;for(let e=0;e<s;e++){const n=t.slice(e*o,(e+1)*o);i.index=e,i.data=n,S.blobToArrayBuffer(O.a.pack(i),e=>{this._sendBuffer.push(e),this._startSendLoop()})}}close(e){super.close(e),this._isOnOpenCalled=!1}_startSendLoop(){this.sendInterval||(this.sendInterval=setInterval(()=>{const e=this._sendBuffer.shift();try{this._dc.send(e)}catch(t){this._sendBuffer.push(e)}0===this._sendBuffer.length&&(clearInterval(this.sendInterval),this.sendInterval=void 0)},l.sendInterval))}_isUnreliableDCInit(e){return!!e&&("maxRetransmits"in e||"maxPacketLifeTime"in e)}static get SERIALIZATIONS(){return M}static get EVENTS(){return D}}var j=L;const F=new s.a(["stream","removeStream"]);F.extend(N.EVENTS.enums);class B extends N{constructor(e,t){super(e,t),this._idPrefix="mc_",this.type="media",this.localStream=this._options.stream,this._queuedMessages=this._options.queuedMessages||[],this._pcAvailable=!1}async startConnection(){this._options.originator&&(await this._negotiator.startConnection({type:"media",stream:this.localStream,originator:this._options.originator,pcConfig:this._options.pcConfig,videoBandwidth:this._options.videoBandwidth,audioBandwidth:this._options.audioBandwidth,videoCodec:this._options.videoCodec,audioCodec:this._options.audioCodec,videoReceiveEnabled:this._options.videoReceiveEnabled,audioReceiveEnabled:this._options.audioReceiveEnabled}),this._pcAvailable=!0,this._handleQueuedMessages())}answer(e,t={}){this.localStream?f.warn("localStream already exists on this MediaConnection. Are you answering a call twice?"):(this._options.payload.stream=e,this.localStream=e,this._negotiator.startConnection({type:"media",stream:this.localStream,originator:!1,offer:this._options.payload.offer,pcConfig:this._options.pcConfig,audioBandwidth:t.audioBandwidth,videoBandwidth:t.videoBandwidth,videoCodec:t.videoCodec,audioCodec:t.audioCodec,videoReceiveEnabled:t.videoReceiveEnabled,audioReceiveEnabled:t.audioReceiveEnabled}),this._pcAvailable=!0,this._handleQueuedMessages(),this.open=!0)}replaceStream(e){this._negotiator.replaceStream(e),this.localStream=e}_setupNegotiatorMessageHandlers(){super._setupNegotiatorMessageHandlers(),this._negotiator.on(k.EVENTS.addStream.key,e=>{f.log("Receiving stream",e),this.remoteStream&&this.remoteStream.id===e.id||(this.remoteStream=e,this.emit(B.EVENTS.stream.key,e))}),this._negotiator.on(k.EVENTS.removeStream.key,e=>{f.log("Stream removed",e),this.remoteStream===e&&(this.remoteStream=null),this.emit(B.EVENTS.removeStream.key,e)})}static get EVENTS(){return F}}var U=B;const V=new s.a(["stream","removeStream","open","close","peerJoin","peerLeave","error","data","log"]),q=new s.a(["offer","answer","candidate","leave","close","getLog","broadcast"]);class W extends i.a{constructor(e,t,n={}){if(super(),this.constructor===W)throw new TypeError("Cannot construct Room instances directly");this.name=e,this._options=n,this._peerId=t,this._localStream=this._options.stream,this._pcConfig=this._options.pcConfig}handleData(e){const t={data:e.data,src:e.src};this.emit(W.EVENTS.data.key,t)}handleLog(e){this.emit(W.EVENTS.log.key,e)}getLog(){const e={roomName:this.name};this.emit(W.MESSAGE_EVENTS.getLog.key,e)}static get EVENTS(){return V}static get MESSAGE_EVENTS(){return q}}var H=W;const G=new s.a([]);G.extend(H.EVENTS.enums);const z=new s.a(["offerRequest","candidate"]);z.extend(H.MESSAGE_EVENTS.enums);class Y extends H{constructor(e,t,n){super(e,t,n),this.remoteStreams={},this.members=[],this._open=!1,this._msidMap={},this._unknownStreams={},this._negotiator=new k}call(e){e&&(this._localStream=e);const t={roomName:this.name};this.emit(Y.MESSAGE_EVENTS.offerRequest.key,t)}handleOffer(e){let t=e.offer;"firefox"===S.detectBrowser().name||S.isUnifiedPlanSafari()||(t=b.unifiedToPlanB(t)),this._connectionStarted?this._negotiator.handleOffer(t):(this._negotiator.startConnection({type:"media",stream:this._localStream,pcConfig:this._options.pcConfig,offer:t}),this._setupNegotiatorMessageHandlers(),this._connectionStarted=!0)}_setupNegotiatorMessageHandlers(){this._negotiator.on(k.EVENTS.addStream.key,e=>{const t=e;if(this._msidMap[t.id]){if(t.peerId=this._msidMap[t.id],t.peerId===this._peerId)return;const e=this.remoteStreams[t.id];if(e&&e.id===t.id)return;this.remoteStreams[t.id]=t,this.emit(Y.EVENTS.stream.key,t),f.log(`Received remote media stream for ${t.peerId} in ${this.name}`)}else this._unknownStreams[t.id]=t}),this._negotiator.on(k.EVENTS.removeStream.key,e=>{delete this.remoteStreams[e.id],delete this._msidMap[e.id],delete this._unknownStreams[e.id],this.emit(Y.EVENTS.removeStream.key,e)}),this._negotiator.on(k.EVENTS.negotiationNeeded.key,()=>{const e={roomName:this.name};this.emit(Y.MESSAGE_EVENTS.offerRequest.key,e)}),this._negotiator.on(k.EVENTS.answerCreated.key,e=>{S.isUnifiedPlanSafari()&&(e.sdp=b.pretendUnifiedPlan(e.sdp));const t={roomName:this.name,answer:e};this.emit(Y.MESSAGE_EVENTS.answer.key,t)}),this._negotiator.on(k.EVENTS.iceConnectionFailed.key,()=>{this.close()}),this._negotiator.on(k.EVENTS.iceCandidate.key,e=>{const t={roomName:this.name,candidate:e};this.emit(Y.MESSAGE_EVENTS.candidate.key,t)})}handleJoin(e){const t=e.src;if(t===this._peerId)return this._open=!0,this.call(this._localStream),void this.emit(Y.EVENTS.open.key);this.members.push(t),this.emit(Y.EVENTS.peerJoin.key,t)}handleLeave(e){if(!this._open)return;const t=e.src,n=this.members.indexOf(t);n>=0&&this.members.splice(n,1);for(const e in this.remoteStreams)this.remoteStreams[e].peerId===t&&delete this.remoteStreams[e];this.emit(Y.EVENTS.peerLeave.key,t)}send(e){if(!this._open)return;const t={roomName:this.name,data:e};this.emit(Y.MESSAGE_EVENTS.broadcast.key,t)}close(){if(!this._open)return;this._negotiator&&this._negotiator.cleanup(),this._open=!1;const e={roomName:this.name};this.emit(Y.MESSAGE_EVENTS.leave.key,e),this.emit(Y.EVENTS.close.key)}replaceStream(e){this._localStream=e,this._negotiator.replaceStream(e)}updateMsidMap(e={}){this._msidMap=e;for(const e of Object.keys(this._unknownStreams))if(this._msidMap[e]){const t=this._unknownStreams[e];if(t.peerId=this._msidMap[t.id],delete this._unknownStreams[e],t.peerId===this._peerId)return;this.remoteStreams[t.id]=t,this.emit(Y.EVENTS.stream.key,t)}}static get EVENTS(){return G}static get MESSAGE_EVENTS(){return z}}var Q=Y;const K=new s.a([]);K.extend(H.EVENTS.enums);const $=new s.a(["broadcastByDC","getPeers"]);$.extend(H.MESSAGE_EVENTS.enums);class X extends H{constructor(e,t,n){super(e,t,n),this.connections={},this._queuedMessages={}}call(e){e&&(this._localStream=e);const t={roomName:this.name,type:"media"};this.emit(X.MESSAGE_EVENTS.getPeers.key,t)}connect(){const e={roomName:this.name,type:"data"};this.emit(X.MESSAGE_EVENTS.getPeers.key,e)}makeMediaConnections(e){const t={stream:this._localStream,pcConfig:this._pcConfig,originator:!0,videoBandwidth:this._options.videoBandwidth,audioBandwidth:this._options.audioBandwidth,videoCodec:this._options.videoCodec,audioCodec:this._options.audioCodec,videoReceiveEnabled:this._options.videoReceiveEnabled,audioReceiveEnabled:this._options.audioReceiveEnabled};this._makeConnections(e,"media",t)}makeDataConnections(e){const t={pcConfig:this._pcConfig};this._makeConnections(e,"data",t)}handleJoin(e){const t=e.src;if(t===this._peerId)return this.call(this._localStream),void this.emit(X.EVENTS.open.key);this.emit(X.EVENTS.peerJoin.key,t)}handleLeave(e){const t=e.src;this._deleteConnections(t),this.emit(X.EVENTS.peerLeave.key,t)}handleOffer(e){const t=e.connectionId;let n=this._getConnection(e.src,t);n?n.updateOffer(e):"media"===e.connectionType?((n=new U(e.src,{connectionId:t,payload:e,metadata:e.metadata,queuedMessages:this._queuedMessages[t],pcConfig:this._pcConfig})).startConnection(),f.log("MediaConnection created in OFFER"),this._addConnection(e.src,n),this._setupMessageHandlers(n),n.answer(this._localStream,{videoBandwidth:this._options.videoBandwidth,audioBandwidth:this._options.audioBandwidth,videoCodec:this._options.videoCodec,audioCodec:this._options.audioCodec,videoReceiveEnabled:this._options.videoReceiveEnabled,audioReceiveEnabled:this._options.audioReceiveEnabled})):f.warn(`Received malformed connection type: ${e.connectionType}`)}handleAnswer(e){const t=this._getConnection(e.src,e.connectionId);t&&t.handleAnswer(e)}handleCandidate(e){const t=this._getConnection(e.src,e.connectionId);t?t.handleCandidate(e):(void 0===this._queuedMessages[e.connectionId]&&(this._queuedMessages[e.connectionId]=[]),this._queuedMessages[e.connectionId].push({type:l.MESSAGE_TYPES.SERVER.CANDIDATE.key,payload:e}))}send(e){const t={roomName:this.name,data:e};this.emit(X.MESSAGE_EVENTS.broadcast.key,t)}close(){for(const e in this.connections)this.connections.hasOwnProperty(e)&&this.connections[e].forEach(e=>{e.close()});const e={roomName:this.name};this.emit(X.MESSAGE_EVENTS.leave.key,e),this.emit(X.EVENTS.close.key)}replaceStream(e){this._localStream=e;for(const t in this.connections)this.connections.hasOwnProperty(t)&&this.connections[t].forEach(t=>{"media"===t.type&&t.replaceStream(e)})}_addConnection(e,t){this.connections[e]||(this.connections[e]=[]),this.connections[e].push(t)}_makeConnections(e,t,n){e.filter(e=>e!==this._peerId).forEach(e=>{let r;switch(t){case"data":r=new j(e,n);break;case"media":r=new U(e,n);break;default:return}r.startConnection(),this._addConnection(e,r),this._setupMessageHandlers(r),f.log(`${t} connection to ${e} created in ${this.name}`)})}_deleteConnections(e){this.connections[e]&&delete this.connections[e]}_getConnection(e,t){if(this.connections&&this.connections[e]){return this.connections[e].filter(e=>e.id===t)[0]}return null}_setupMessageHandlers(e){e.on(N.EVENTS.offer.key,e=>{e.roomName=this.name,this.emit(X.MESSAGE_EVENTS.offer.key,e)}),e.on(N.EVENTS.answer.key,e=>{e.roomName=this.name,this.emit(X.MESSAGE_EVENTS.answer.key,e)}),e.on(N.EVENTS.candidate.key,e=>{e.roomName=this.name,this.emit(X.MESSAGE_EVENTS.candidate.key,e)}),"media"===e.type&&(e.on(U.EVENTS.stream.key,t=>{t.peerId=e.remoteId,this.emit(X.EVENTS.stream.key,t)}),e.on(U.EVENTS.removeStream.key,e=>{this.emit(X.EVENTS.removeStream.key,e)}))}static get EVENTS(){return K}static get MESSAGE_EVENTS(){return $}}var J=X;const Z=new s.a(["open","error","call","connection","expiresin","close","disconnected"]);class ee extends i.a{constructor(e,t){super(),this.connections={},this.rooms={},this._queuedMessages={},e&&e.constructor===Object?(t=e,e=void 0):e&&(e=e.toString());const n={debug:f.LOG_LEVELS.NONE,secure:!0,token:S.randomToken(),config:l.defaultConfig,turn:!0,dispatcherSecure:l.DISPATCHER_SECURE,dispatcherHost:l.DISPATCHER_HOST,dispatcherPort:l.DISPATCHER_PORT};this.options=Object.assign({},n,t),f.setLogLevel(this.options.debug),S.validateId(e)?S.validateKey(t.key)?("/"===this.options.host&&(this.options.host=window.location.hostname),void 0===t.secure&&443!==this.options.port&&(this.options.secure=void 0),this._initializeServerConnection(e)):this._abort("invalid-key",`API KEY "${this.options.key}" is invalid`):this._abort("invalid-id",`ID "${e}" is invalid`)}call(e,t,n={}){if(!this._checkOpenStatus())return;n.originator=!0,n.stream=t,n.pcConfig=this._pcConfig;const r=new U(e,n);return r.startConnection(),f.log("MediaConnection created in call method"),this._addConnection(e,r),r}connect(e,t={}){if(!this._checkOpenStatus())return;t.pcConfig=this._pcConfig;const n=new j(e,t);return n.startConnection(),f.log("DataConnection created in connect method"),this._addConnection(e,n),n}joinRoom(e,t={}){if(this._checkOpenStatus()){if(!e){const e=new Error("Room name must be defined.");return e.type="room-error",f.error(e),this.emit(ee.EVENTS.error.key,e),null}return t.pcConfig=this._pcConfig,t.peerId=this.id,"sfu"===t.mode?this._initializeSfuRoom(e,t):this._initializeFullMeshRoom(e,t)}}getConnection(e,t){if(this._checkOpenStatus()){if(this.connections[e])for(const n of this.connections[e])if(n.id===t)return n;return null}}get open(){return this.socket&&this.socket.isOpen}destroy(){this._cleanup(),this.disconnect()}disconnect(){this.open&&(this.socket.close(),this.emit(ee.EVENTS.disconnected.key,this.id))}reconnect(){this.open||this.socket.reconnect()}updateCredential(e){this.socket.updateCredential(e)}listAllPeers(e){if(!this._checkOpenStatus())return;e=e||function(){};const t=this,n=new XMLHttpRequest,r=`${this.socket.signalingServerUrl}/api/apikeys/${this.options.key}/clients/`;n.open("get",r,!0),n.onerror=function(){t._abort("server-error","Could not get peers from the server."),e([])},n.onreadystatechange=function(){if(4===n.readyState)if(401===n.status){e([]);const n=new Error("It doesn't look like you have permission to list peers IDs. Please enable the SkyWay REST API on dashboard");n.type="list-error",f.error(n),t.emit(ee.EVENTS.error.key,n)}else 200===n.status?e(JSON.parse(n.responseText)):e([])},n.send(null)}_checkOpenStatus(){return this.open||this._emitNotConnectedError(),this.open}_emitNotConnectedError(){f.warn("You cannot connect to a new Peer because you are not connecting to SkyWay server now.You can create a new Peer to reconnect, or call reconnect() on this peer if you believe its ID to still be available.");const e=new Error("Cannot connect to new Peer before connecting to SkyWay server or after disconnecting from the server.");e.type="disconnected",f.error(e),this.emit(ee.EVENTS.error.key,e)}_initializeServerConnection(e){this.socket=new y(this.options.key,{secure:this.options.secure,host:this.options.host,port:this.options.port,dispatcherSecure:this.options.dispatcherSecure,dispatcherHost:this.options.dispatcherHost,dispatcherPort:this.options.dispatcherPort}),this._setupMessageHandlers(),this.socket.on("error",e=>{this._abort("socket-error",e)}),this.socket.on("disconnect",()=>{this.disconnect();const e=new Error("Lost connection to server.");e.type="socket-error",f.error(e),this.emit(ee.EVENTS.error.key,e)}),this.socket.start(e,this.options.token,this.options.credential)}_initializeSfuRoom(e,t={}){if(this.rooms[e])return this.rooms[e];const n=new Q(e,this.id,t);this.rooms[e]=n,this._setupSFURoomMessageHandlers(n);const r={roomName:e,roomType:"sfu"};return this.socket.send(l.MESSAGE_TYPES.CLIENT.ROOM_JOIN.key,r),n}_initializeFullMeshRoom(e,t={}){if(this.rooms[e])return this.rooms[e];const n=new J(e,this.id,t);this.rooms[e]=n,this._setupMeshRoomMessageHandlers(n);const r={roomName:e,roomType:"mesh"};return this.socket.send(l.MESSAGE_TYPES.CLIENT.ROOM_JOIN.key,r),n}_setupMessageHandlers(){this.socket.on(l.MESSAGE_TYPES.SERVER.OPEN.key,e=>{this.id=e.peerId,this._pcConfig=Object.assign({},this.options.config);const t=this._pcConfig.iceServers;this._pcConfig.iceServers=t?t.slice():[];const n=e.turnCredential;let r,i;if("object"==typeof n?(r=n.username,i=n.credential):"string"==typeof n&&(r=`${this.options.key}$${this.id}`,i=n),!0===this.options.turn&&r&&i){const e=[{protocol:"turn",transport:"tcp"},{protocol:"turn",transport:"udp"}];"edge"!==S.detectBrowser().name&&e.push({protocol:"turns",transport:"tcp"});for(const t of e){const e=t.protocol,n=t.transport,o={urls:`${e}:${l.TURN_HOST}:${l.TURN_PORT}?transport=${n}`,url:`${e}:${l.TURN_HOST}:${l.TURN_PORT}?transport=${n}`,username:r,credential:i};this._pcConfig.iceServers.push(o)}f.log("SkyWay TURN Server is available")}else f.log("SkyWay TURN Server is unavailable");this.emit(ee.EVENTS.open.key,this.id)}),this.socket.on(l.MESSAGE_TYPES.SERVER.ERROR.key,e=>{const t=new Error(e.message);t.type=e.type,f.error(t),this.emit(ee.EVENTS.error.key,t)}),this.socket.on(l.MESSAGE_TYPES.SERVER.LEAVE.key,e=>{f.log(`Received leave message from ${e}`),this._cleanupPeer(e)}),this.socket.on(l.MESSAGE_TYPES.SERVER.FORCE_CLOSE.key,({src:e,connectionId:t})=>{const n=this.getConnection(e,t);n&&n.close(!1)}),this.socket.on(l.MESSAGE_TYPES.SERVER.AUTH_EXPIRES_IN.key,e=>{f.log(`Credential expires in ${e}`),this.emit(ee.EVENTS.expiresin.key,e)}),this.socket.on(l.MESSAGE_TYPES.SERVER.OFFER.key,e=>{const t=e.roomName;if(t){const n=this.rooms[t];return void(n&&n.handleOffer(e))}const n=e.connectionId;let r=this.getConnection(e.src,n);r?r.updateOffer(e):("media"===e.connectionType?((r=new U(e.src,{connectionId:n,payload:e,metadata:e.metadata,originator:!1,queuedMessages:this._queuedMessages[n],pcConfig:this._pcConfig})).startConnection(),f.log("MediaConnection created in OFFER"),this._addConnection(e.src,r),this.emit(ee.EVENTS.call.key,r)):"data"===e.connectionType?((r=new j(e.src,{connectionId:n,payload:e,metadata:e.metadata,label:e.label,dcInit:e.dcInit,serialization:e.serialization,queuedMessages:this._queuedMessages[n],pcConfig:this._pcConfig})).startConnection(),f.log("DataConnection created in OFFER"),this._addConnection(e.src,r),this.emit(ee.EVENTS.connection.key,r)):f.warn("Received malformed connection type: ",e.connectionType),delete this._queuedMessages[n])}),this.socket.on(l.MESSAGE_TYPES.SERVER.ANSWER.key,e=>{const t=e.roomName;if(t){const n=this.rooms[t];return void(n&&n.handleAnswer(e))}const n=this.getConnection(e.src,e.connectionId);n?n.handleAnswer(e):this._storeMessage(l.MESSAGE_TYPES.SERVER.ANSWER.key,e)}),this.socket.on(l.MESSAGE_TYPES.SERVER.CANDIDATE.key,e=>{const t=e.roomName;if(t){const n=this.rooms[t];return void(n&&n.handleCandidate(e))}const n=this.getConnection(e.src,e.connectionId);n?n.handleCandidate(e):this._storeMessage(l.MESSAGE_TYPES.SERVER.CANDIDATE.key,e)}),this.socket.on(l.MESSAGE_TYPES.SERVER.ROOM_USER_JOIN.key,e=>{const t=this.rooms[e.roomName];t&&t.handleJoin(e)}),this.socket.on(l.MESSAGE_TYPES.SERVER.ROOM_USER_LEAVE.key,e=>{const t=this.rooms[e.roomName];t&&t.handleLeave(e)}),this.socket.on(l.MESSAGE_TYPES.SERVER.ROOM_DATA.key,e=>{const t=this.rooms[e.roomName];t&&t.handleData(e)}),this.socket.on(l.MESSAGE_TYPES.SERVER.ROOM_LOGS.key,e=>{const t=this.rooms[e.roomName];t&&t.handleLog(e.log)}),this.socket.on(l.MESSAGE_TYPES.SERVER.ROOM_USERS.key,e=>{const t=this.rooms[e.roomName];t&&("media"===e.type?t.makeMediaConnections(e.userList):t.makeDataConnections(e.userList))}),this.socket.on(l.MESSAGE_TYPES.SERVER.SFU_OFFER.key,e=>{const t=this.rooms[e.roomName];t&&(t.updateMsidMap(e.msids),t.handleOffer(e))})}_setupConnectionMessageHandlers(e){e.on(N.EVENTS.candidate.key,e=>{this.socket.send(l.MESSAGE_TYPES.CLIENT.SEND_CANDIDATE.key,e)}),e.on(N.EVENTS.answer.key,e=>{this.socket.send(l.MESSAGE_TYPES.CLIENT.SEND_ANSWER.key,e)}),e.on(N.EVENTS.offer.key,e=>{this.socket.send(l.MESSAGE_TYPES.CLIENT.SEND_OFFER.key,e)}),e.on(N.EVENTS.forceClose.key,()=>{const t={dst:e.remoteId,connectionId:e.id};this.socket.send(l.MESSAGE_TYPES.CLIENT.SEND_FORCE_CLOSE.key,t)})}_setupRoomMessageHandlers(e){e.on(Q.MESSAGE_EVENTS.broadcast.key,e=>{this.socket.send(l.MESSAGE_TYPES.CLIENT.ROOM_SEND_DATA.key,e)}),e.on(Q.MESSAGE_EVENTS.getLog.key,e=>{this.socket.send(l.MESSAGE_TYPES.CLIENT.ROOM_GET_LOGS.key,e)}),e.on(Q.MESSAGE_EVENTS.leave.key,t=>{delete this.rooms[e.name],this.socket.send(l.MESSAGE_TYPES.CLIENT.ROOM_LEAVE.key,t)})}_setupSFURoomMessageHandlers(e){this._setupRoomMessageHandlers(e),e.on(Q.MESSAGE_EVENTS.offerRequest.key,e=>{this.socket.send(l.MESSAGE_TYPES.CLIENT.SFU_GET_OFFER.key,e)}),e.on(Q.MESSAGE_EVENTS.answer.key,e=>{this.socket.send(l.MESSAGE_TYPES.CLIENT.SFU_ANSWER.key,e)}),e.on(Q.MESSAGE_EVENTS.candidate.key,e=>{this.socket.send(l.MESSAGE_TYPES.CLIENT.SFU_CANDIDATE.key,e)})}_setupMeshRoomMessageHandlers(e){this._setupRoomMessageHandlers(e),e.on(J.MESSAGE_EVENTS.offer.key,e=>{this.socket.send(l.MESSAGE_TYPES.CLIENT.SEND_OFFER.key,e)}),e.on(J.MESSAGE_EVENTS.answer.key,e=>{this.socket.send(l.MESSAGE_TYPES.CLIENT.SEND_ANSWER.key,e)}),e.on(J.MESSAGE_EVENTS.candidate.key,e=>{this.socket.send(l.MESSAGE_TYPES.CLIENT.SEND_CANDIDATE.key,e)}),e.on(J.MESSAGE_EVENTS.getPeers.key,e=>{this.socket.send(l.MESSAGE_TYPES.CLIENT.ROOM_GET_USERS.key,e)})}_abort(e,t){f.error("Aborting!"),this.disconnect();const n=new Error(t);n.type=e,f.error(n),this.emit(ee.EVENTS.error.key,n)}_addConnection(e,t){this.connections[e]||(this.connections[e]=[]),this.connections[e].push(t),this._setupConnectionMessageHandlers(t)}_storeMessage(e,t){this._queuedMessages[t.connectionId]||(this._queuedMessages[t.connectionId]=[]),this._queuedMessages[t.connectionId].push({type:e,payload:t})}_cleanup(){if(this.connections)for(const e of Object.keys(this.connections))this._cleanupPeer(e);this.emit(ee.EVENTS.close.key)}_cleanupPeer(e){if(this.connections[e])for(const t of this.connections[e])t.close()}static get EVENTS(){return Z}}t.default=ee},0:function(e,t){}}).default})},"10TI":function(e,t,n){"use strict";var r=n("BKox"),i=n("E6AF"),o=!1;var s=function(e){o||n("CtnY")},a=n("VU/8")(r.a,i.a,!1,s,"data-v-53e335da",null);a.options.__file="components/chat.vue",t.a=a.exports},BKox:function(e,t,n){"use strict";var r=n("/5sW"),i=n("j218");t.a=r.default.extend({name:"chat",props:{roomId:String,myNickname:String},data:function(){return{chatCount:0,chats:[],chatInputMessage:""}},mounted:function(){var e=this;i.a.ref("/rooms/"+this.roomId+"/messages").on("child_added",function(t){if(t&&t.val()){var n=t.val();e.chats.push({id:"chatid-"+(e.chatCount+1),nickname:n.name,content:n.content}),e.chatCount++}})},methods:{sendChatMessage:function(){i.a.ref("/rooms/"+this.roomId+"/messages").push({name:this.myNickname,content:this.chatInputMessage}),this.chatInputMessage=""}}})},CtnY:function(e,t,n){var r=n("KDFK");"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);n("rjj0")("80208dc0",r,!1,{sourceMap:!1})},DYVf:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("OAWm"),i=n("JKAN"),o=!1;var s=function(e){o||n("GJb6")},a=n("VU/8")(r.a,i.a,!1,s,"data-v-6ca7c4fe",null);a.options.__file="pages/room/watcher.vue",t.default=a.exports},Du4q:function(e,t,n){(e.exports=n("FZ+f")(!1)).push([e.i,".battle-movie[data-v-6ca7c4fe]{width:100%;height:auto}.display-label[data-v-6ca7c4fe]{margin:.5em 0;width:100%}.margin-0-2[data-v-6ca7c4fe]{margin:.2em}",""])},E6AF:function(e,t,n){"use strict";var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("section",[n("v-layout",{attrs:{row:""}},[n("v-flex",{staticClass:"chat-content-flex",attrs:{xs12:""}},[n("v-card",{staticClass:"chat-contents transparent-panel"},e._l(e.chats,function(t){return n("div",{key:t.id},[n("v-chip",{attrs:{label:"",color:"pink","text-color":"white"}},[e._v("\n            "+e._s(t.nickname)+"\n            ")]),e._v(e._s(t.content)+"\n        ")],1)}),0)],1)],1),n("v-layout",{attrs:{row:""}},[n("v-flex",{staticClass:"chat-input-flex",attrs:{xs12:""}},[n("v-card",{staticClass:"transparent-panel"},[n("v-card-actions",[n("v-text-field",{attrs:{counter:20,"append-icon":"chat",label:"メッセージを入力してください",required:""},on:{"click:append":e.sendChatMessage},model:{value:e.chatInputMessage,callback:function(t){e.chatInputMessage=t},expression:"chatInputMessage"}})],1)],1)],1)],1)],1)};r._withStripped=!0;var i={render:r,staticRenderFns:[]};t.a=i},GJb6:function(e,t,n){var r=n("Du4q");"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);n("rjj0")("13aaef69",r,!1,{sourceMap:!1})},JKAN:function(e,t,n){"use strict";var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("section",[n("v-layout",{attrs:{row:""}},[n("v-flex",{staticClass:"margin-0-2",attrs:{xs6:"","text-xs-center":""}},[n("v-card",{staticClass:"transparent-panel"},["waiting"===e.rappers.A.state?n("div",[n("br"),n("v-progress-circular",{staticClass:"battle-movie",attrs:{size:50,color:"amber",indeterminate:""}})],1):e._e(),n("video",{staticClass:"battle-movie",attrs:{id:"rapper-a",autoplay:"",playsinline:""}}),n("v-card-title",[n("div",[e._v(e._s(e.rappers.A.nickname))])]),n("v-card-actions",[n("v-chip",{attrs:{color:"white",label:"",outline:""},on:{click:e.onClickThumbUpForA}},[n("v-avatar",[n("v-icon",{staticClass:"neon"},[e._v("thumb_up")])],1),n("span",{staticClass:"neon"},[e._v(e._s(e.rappers.A.feedback.thumb_up))])],1),n("v-spacer"),n("v-chip",{attrs:{color:"white",label:"",outline:""},on:{click:e.onClickThumbDownForA}},[n("span",{staticClass:"neon-blue"},[e._v(e._s(e.rappers.A.feedback.thumb_down))]),n("v-avatar",[n("v-icon",{staticClass:"neon-blue thumb_down"},[e._v("thumb_down")])],1)],1)],1)],1)],1),n("v-flex",{staticClass:"margin-0-2",attrs:{xs6:"","text-xs-center":""}},[n("v-card",{staticClass:"transparent-panel"},["waiting"===e.rappers.B.state?n("div",[n("br"),n("v-progress-circular",{staticClass:"battle-movie",attrs:{size:50,color:"amber",indeterminate:""}})],1):e._e(),n("video",{staticClass:"battle-movie",attrs:{id:"rapper-b",autoplay:"",playsinline:""}}),n("v-card-title",[n("div",[e._v(e._s(e.rappers.B.nickname))])]),n("v-card-actions",[n("v-chip",{attrs:{color:"white",label:"",outline:""},on:{click:e.onClickThumbUpForB}},[n("v-avatar",[n("v-icon",{staticClass:"neon"},[e._v("thumb_up")])],1),n("span",{staticClass:"neon"},[e._v(e._s(e.rappers.B.feedback.thumb_up))])],1),n("v-spacer"),n("v-chip",{attrs:{color:"white",label:"",outline:""},on:{click:e.onClickThumbDownForB}},[n("span",{staticClass:"neon-blue"},[e._v(e._s(e.rappers.B.feedback.thumb_down))]),n("v-avatar",[n("v-icon",{staticClass:"neon-blue thumb_down"},[e._v("thumb_down")])],1)],1)],1)],1)],1)],1),n("chat",{attrs:{roomId:e.roomId,myNickname:e.nickname}})],1)};r._withStripped=!0;var i={render:r,staticRenderFns:[]};t.a=i},KDFK:function(e,t,n){(e.exports=n("FZ+f")(!1)).push([e.i,".chat-contents[data-v-53e335da]{max-height:200px;overflow:scroll}.chat-content-flex[data-v-53e335da],.chat-input-flex[data-v-53e335da]{margin:.2em}",""])},O4tu:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=n("TToO"),o=n("Pxmi"),s=n("fjI4"),a=((r={})["no-app"]="No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",r["bad-app-name"]="Illegal App name: '{$appName}",r["duplicate-app"]="Firebase App named '{$appName}' already exists",r["app-deleted"]="Firebase App named '{$appName}' already deleted",r["duplicate-service"]="Firebase service named '{$appName}' already registered",r["invalid-app-argument"]="firebase.{$appName}() takes either no argument or a Firebase App instance.",r),u=new o.ErrorFactory("app","Firebase",a),c="[DEFAULT]",h=[],l=function(){function e(e,t,n){this.firebase_=n,this.isDeleted_=!1,this.services_={},this.name_=t.name,this.automaticDataCollectionEnabled_=t.automaticDataCollectionEnabled||!1,this.options_=o.deepCopy(e),this.INTERNAL={getUid:function(){return null},getToken:function(){return Promise.resolve(null)},addAuthTokenListener:function(e){h.push(e),setTimeout(function(){return e(null)},0)},removeAuthTokenListener:function(e){h=h.filter(function(t){return t!==e})}}}return Object.defineProperty(e.prototype,"automaticDataCollectionEnabled",{get:function(){return this.checkDestroyed_(),this.automaticDataCollectionEnabled_},set:function(e){this.checkDestroyed_(),this.automaticDataCollectionEnabled_=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return this.checkDestroyed_(),this.name_},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"options",{get:function(){return this.checkDestroyed_(),this.options_},enumerable:!0,configurable:!0}),e.prototype.delete=function(){var e=this;return new Promise(function(t){e.checkDestroyed_(),t()}).then(function(){var t,n,r,o;e.firebase_.INTERNAL.removeApp(e.name_);var s=[];try{for(var a=i.__values(Object.keys(e.services_)),u=a.next();!u.done;u=a.next()){var c=u.value;try{for(var h=(r=void 0,i.__values(Object.keys(e.services_[c]))),l=h.next();!l.done;l=h.next()){var p=l.value;s.push(e.services_[c][p])}}catch(e){r={error:e}}finally{try{l&&!l.done&&(o=h.return)&&o.call(h)}finally{if(r)throw r.error}}}}catch(e){t={error:e}}finally{try{u&&!u.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}return Promise.all(s.filter(function(e){return"INTERNAL"in e}).map(function(e){return e.INTERNAL.delete()}))}).then(function(){e.isDeleted_=!0,e.services_={}})},e.prototype._getService=function(e,t){if(void 0===t&&(t=c),this.checkDestroyed_(),this.services_[e]||(this.services_[e]={}),!this.services_[e][t]){var n=t!==c?t:void 0,r=this.firebase_.INTERNAL.factories[e](this,this.extendApp.bind(this),n);this.services_[e][t]=r}return this.services_[e][t]},e.prototype.extendApp=function(e){var t=this;o.deepExtend(this,e),e.INTERNAL&&e.INTERNAL.addAuthTokenListener&&(h.forEach(function(e){t.INTERNAL.addAuthTokenListener(e)}),h=[])},e.prototype.checkDestroyed_=function(){if(this.isDeleted_)throw u.create("app-deleted",{appName:this.name_})},e}();l.prototype.name&&l.prototype.options||l.prototype.delete||console.log("dc");var p="6.3.1";var d=new s.Logger("@firebase/app");if(o.isBrowser()&&void 0!==self.firebase){d.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");var f=self.firebase.SDK_VERSION;f&&f.indexOf("LITE")>=0&&d.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}var m=function e(){var t=function(e){var t={},n={},r={},s={__esModule:!0,initializeApp:function(n,r){if(void 0===r&&(r={}),"object"!=typeof r||null===r){var i=r;r={name:i}}var a=r;void 0===a.name&&(a.name=c);var h=a.name;if("string"!=typeof h||!h)throw u.create("bad-app-name",{appName:String(h)});if(o.contains(t,h))throw u.create("duplicate-app",{appName:h});var p=new e(n,a,s);return t[h]=p,l(p,"create"),p},app:a,apps:null,SDK_VERSION:p,INTERNAL:{registerService:function(t,i,c,l,p){if(void 0===p&&(p=!1),n[t])throw u.create("duplicate-service",{appName:t});function d(e){if(void 0===e&&(e=a()),"function"!=typeof e[t])throw u.create("invalid-app-argument",{appName:t});return e[t]()}return n[t]=i,l&&(r[t]=l,h().forEach(function(e){l("create",e)})),void 0!==c&&o.deepExtend(d,c),s[t]=d,e.prototype[t]=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return this._getService.bind(this,t).apply(this,p?e:[])},d},removeApp:function(e){l(t[e],"delete"),delete t[e]},factories:n,useAsService:d}};function a(e){if(e=e||c,!o.contains(t,e))throw u.create("no-app",{appName:e});return t[e]}function h(){return Object.keys(t).map(function(e){return t[e]})}function l(e,t){var o,s;try{for(var a=i.__values(Object.keys(n)),u=a.next();!u.done;u=a.next()){var c=d(0,u.value);if(null===c)return;r[c]&&r[c](t,e)}}catch(e){o={error:e}}finally{try{u&&!u.done&&(s=a.return)&&s.call(a)}finally{if(o)throw o.error}}}function d(e,t){return"serverAuth"===t?null:t}return s.default=s,Object.defineProperty(s,"apps",{get:h}),a.App=e,s}(l);return t.INTERNAL=i.__assign({},t.INTERNAL,{createFirebaseNamespace:e,extendNamespace:function(e){o.deepExtend(t,e)},createSubscribe:o.createSubscribe,ErrorFactory:o.ErrorFactory,deepExtend:o.deepExtend}),t}(),y=m.initializeApp;m.initializeApp=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return o.isNode()&&d.warn('\n      Warning: This is a browser-targeted Firebase bundle but it appears it is being\n      run in a Node environment.  If running in a Node environment, make sure you\n      are using the bundle specified by the "main" field in package.json.\n      \n      If you are using Webpack, you can specify "main" as the first item in\n      "resolve.mainFields":\n      https://webpack.js.org/configuration/resolve/#resolvemainfields\n      \n      If using Rollup, use the rollup-plugin-node-resolve plugin and specify "main"\n      as the first item in "mainFields", e.g. [\'main\', \'module\'].\n      https://github.com/rollup/rollup-plugin-node-resolve\n      '),y.apply(void 0,e)};var v=m;t.default=v,t.firebase=v},OAWm:function(e,t,n){"use strict";var r=n("/+CH"),i=n.n(r),o=n("/5sW"),s=n("10TI"),a=n("j218");t.a=o.default.extend({components:{Chat:s.a},data:function(){return{roomState:"wating",peer:void 0,rapperStreamA:void 0,rapperStreamB:void 0,rappers:{A:{state:"waiting",nickname:"Waiting...",peerId:void 0,feedback:{thumb_up:0,thumb_down:0}},B:{state:"waiting",nickname:"Waiting...",peerId:void 0,feedback:{thumb_up:0,thumb_down:0}}}}},methods:{sendMessage:function(){a.a.ref("/rooms/"+this.$route.query.roomId+"/messages").push({name:this.nickname,content:this.chatMessage}),this.chatMessage=""},onClickThumbUpForA:function(){a.a.ref("/rooms/"+this.$route.query.roomId+"/rappers/"+this.rappers.A.peerId+"/feedback").transaction(function(e){return e?{thumb_up:e.thumb_up+1,thumb_down:e.thumb_down}:void 0})},onClickThumbDownForA:function(){a.a.ref("/rooms/"+this.$route.query.roomId+"/rappers/"+this.rappers.A.peerId+"/feedback").transaction(function(e){return e?{thumb_up:e.thumb_up,thumb_down:e.thumb_down+1}:void 0})},onClickThumbUpForB:function(){a.a.ref("/rooms/"+this.$route.query.roomId+"/rappers/"+this.rappers.B.peerId+"/feedback").transaction(function(e){return e?{thumb_up:e.thumb_up+1,thumb_down:e.thumb_down}:void 0})},onClickThumbDownForB:function(){a.a.ref("/rooms/"+this.$route.query.roomId+"/rappers/"+this.rappers.B.peerId+"/feedback").transaction(function(e){return e?{thumb_up:e.thumb_up,thumb_down:e.thumb_down+1}:void 0})}},computed:{roomId:function(){return this.$route.query.roomId},roomName:function(){return this.$route.query.roomName},nickname:function(){return this.$route.query.nickname}},mounted:function(){var e=this;this.peer=new i.a({key:"cc6b9988-7335-4bac-93fb-b10792c2c018",debug:3}),this.peer.on("open",function(){var t=e.peer.joinRoom(e.roomId,{mode:"sfu"});t.on("peerJoin",function(){return console.debug("@@ peerJoin")}),t.on("stream",function(t){console.debug("@@ on stream"),e.$coreApi.get("/rooms/"+e.roomId).then(function(n){var r=n.data.rappers.find(function(e){return e.peerId===t.peerId});if(r){if(e.rappers.A.peerId)if(e.rappers.B.peerId)console.debug("Out case");else{e.rappers.B.peerId=r.peerId,e.rappers.B.nickname=r.nickname,a.a.ref("/rooms/"+e.roomId+"/rappers/"+e.rappers.B.peerId+"/feedback").on("value",function(t){t&&t.val()&&(e.rappers.B.feedback=t.val())}),e.rappers.B.state="entered",e.rapperStreamB=t,document.getElementById("rapper-b").srcObject=t}else e.rappers.A.peerId=r.peerId,e.rappers.A.nickname=r.nickname,a.a.ref("/rooms/"+e.roomId+"/rappers/"+e.rappers.A.peerId+"/feedback").on("value",function(t){t&&t.val()&&(e.rappers.A.feedback=t.val())}),e.rappers.A.state="entered",e.rapperStreamA=t,document.getElementById("rapper-a").srcObject=t;e.rappers.A.peerId&&e.rappers.B.peerId&&(e.roomState="started")}})})})}})},Pxmi:function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});var r=n("TToO"),i={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"},o=function(e,t){if(!e)throw s(t)},s=function(e){return new Error("Firebase Database ("+i.SDK_VERSION+") INTERNAL ASSERT FAILED: "+e)},a=function(e){for(var t=[],n=0,r=0;r<e.length;r++){var i=e.charCodeAt(r);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):55296==(64512&i)&&r+1<e.length&&56320==(64512&e.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++r)),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t},u=function(e){try{return c.decodeString(e,!0)}catch(e){console.error("base64Decode failed: ",e)}return null},c=new(function(){function e(){this.byteToCharMap_=null,this.charToByteMap_=null,this.byteToCharMapWebSafe_=null,this.charToByteMapWebSafe_=null,this.ENCODED_VALS_BASE="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",this.HAS_NATIVE_SUPPORT="function"==typeof atob}return Object.defineProperty(e.prototype,"ENCODED_VALS",{get:function(){return this.ENCODED_VALS_BASE+"+/="},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ENCODED_VALS_WEBSAFE",{get:function(){return this.ENCODED_VALS_BASE+"-_."},enumerable:!0,configurable:!0}),e.prototype.encodeByteArray=function(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[],i=0;i<e.length;i+=3){var o=e[i],s=i+1<e.length,a=s?e[i+1]:0,u=i+2<e.length,c=u?e[i+2]:0,h=o>>2,l=(3&o)<<4|a>>4,p=(15&a)<<2|c>>6,d=63&c;u||(d=64,s||(p=64)),r.push(n[h],n[l],n[p],n[d])}return r.join("")},e.prototype.encodeString=function(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(a(e),t)},e.prototype.decodeString=function(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){for(var t=[],n=0,r=0;n<e.length;){var i=e[n++];if(i<128)t[r++]=String.fromCharCode(i);else if(i>191&&i<224){var o=e[n++];t[r++]=String.fromCharCode((31&i)<<6|63&o)}else if(i>239&&i<365){var s=((7&i)<<18|(63&(o=e[n++]))<<12|(63&(a=e[n++]))<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(s>>10)),t[r++]=String.fromCharCode(56320+(1023&s))}else{o=e[n++];var a=e[n++];t[r++]=String.fromCharCode((15&i)<<12|(63&o)<<6|63&a)}}return t.join("")}(this.decodeStringToByteArray(e,t))},e.prototype.decodeStringToByteArray=function(e,t){this.init_();for(var n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[],i=0;i<e.length;){var o=n[e.charAt(i++)],s=i<e.length?n[e.charAt(i)]:0,a=++i<e.length?n[e.charAt(i)]:64,u=++i<e.length?n[e.charAt(i)]:64;if(++i,null==o||null==s||null==a||null==u)throw Error();var c=o<<2|s>>4;if(r.push(c),64!==a){var h=s<<4&240|a>>2;if(r.push(h),64!==u){var l=a<<6&192|u;r.push(l)}}}return r},e.prototype.init_=function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}},e}());function h(e,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:return new Date(t.getTime());case Object:void 0===e&&(e={});break;case Array:e=[];break;default:return t}for(var n in t)t.hasOwnProperty(n)&&(e[n]=h(e[n],t[n]));return e}var l=function(){function e(){var e=this;this.reject=function(){},this.resolve=function(){},this.promise=new Promise(function(t,n){e.resolve=t,e.reject=n})}return e.prototype.wrapCallback=function(e){var t=this;return function(n,r){n?t.reject(n):t.resolve(r),"function"==typeof e&&(t.promise.catch(function(){}),1===e.length?e(n):e(n,r))}},e}();function p(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var d="FirebaseError",f=function(e){function t(n,r){var i=e.call(this,r)||this;return i.code=n,i.name=d,Object.setPrototypeOf(i,t.prototype),Error.captureStackTrace&&Error.captureStackTrace(i,m.prototype.create),i}return r.__extends(t,e),t}(Error),m=function(){function e(e,t,n){this.service=e,this.serviceName=t,this.errors=n}return e.prototype.create=function(e){for(var t,n,i=[],o=1;o<arguments.length;o++)i[o-1]=arguments[o];var s=i[0]||{},a=this.service+"/"+e,u=this.errors[e],c=u?function(e,t){return e.replace(y,function(e,n){var r=t[n];return null!=r?r.toString():"<"+n+"?>"})}(u,s):"Error",h=this.serviceName+": "+c+" ("+a+").",l=new f(a,h);try{for(var p=r.__values(Object.keys(s)),d=p.next();!d.done;d=p.next()){var m=d.value;"_"!==m.slice(-1)&&(m in l&&console.warn('Overwriting FirebaseError base field "'+m+'" can cause unexpected behavior.'),l[m]=s[m])}}catch(e){t={error:e}}finally{try{d&&!d.done&&(n=p.return)&&n.call(p)}finally{if(t)throw t.error}}return l},e}();var y=/\{\$([^}]+)}/g;function v(e){return JSON.parse(e)}var g=function(e){var t={},n={},r={},i="";try{var o=e.split(".");t=v(u(o[0])||""),n=v(u(o[1])||""),i=o[2],r=n.d||{},delete n.d}catch(e){}return{header:t,claims:n,data:r,signature:i}};var _=function(){function e(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(var e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}return e.prototype.reset=function(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0},e.prototype.compress_=function(e,t){t||(t=0);var n=this.W_;if("string"==typeof e)for(var r=0;r<16;r++)n[r]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(r=0;r<16;r++)n[r]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(r=16;r<80;r++){var i=n[r-3]^n[r-8]^n[r-14]^n[r-16];n[r]=4294967295&(i<<1|i>>>31)}var o,s,a=this.chain_[0],u=this.chain_[1],c=this.chain_[2],h=this.chain_[3],l=this.chain_[4];for(r=0;r<80;r++){r<40?r<20?(o=h^u&(c^h),s=1518500249):(o=u^c^h,s=1859775393):r<60?(o=u&c|h&(u|c),s=2400959708):(o=u^c^h,s=3395469782);i=(a<<5|a>>>27)+o+l+s+n[r]&4294967295;l=h,h=c,c=4294967295&(u<<30|u>>>2),u=a,a=i}this.chain_[0]=this.chain_[0]+a&4294967295,this.chain_[1]=this.chain_[1]+u&4294967295,this.chain_[2]=this.chain_[2]+c&4294967295,this.chain_[3]=this.chain_[3]+h&4294967295,this.chain_[4]=this.chain_[4]+l&4294967295},e.prototype.update=function(e,t){if(null!=e){void 0===t&&(t=e.length);for(var n=t-this.blockSize,r=0,i=this.buf_,o=this.inbuf_;r<t;){if(0===o)for(;r<=n;)this.compress_(e,r),r+=this.blockSize;if("string"==typeof e){for(;r<t;)if(i[o]=e.charCodeAt(r),++r,++o===this.blockSize){this.compress_(i),o=0;break}}else for(;r<t;)if(i[o]=e[r],++r,++o===this.blockSize){this.compress_(i),o=0;break}}this.inbuf_=o,this.total_+=t}},e.prototype.digest=function(){var e=[],t=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(var n=this.blockSize-1;n>=56;n--)this.buf_[n]=255&t,t/=256;this.compress_(this.buf_);var r=0;for(n=0;n<5;n++)for(var i=24;i>=0;i-=8)e[r]=this.chain_[n]>>i&255,++r;return e},e}();var b=function(){function e(e,t){var n=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(function(){e(n)}).catch(function(e){n.error(e)})}return e.prototype.next=function(e){this.forEachObserver(function(t){t.next(e)})},e.prototype.error=function(e){this.forEachObserver(function(t){t.error(e)}),this.close(e)},e.prototype.complete=function(){this.forEachObserver(function(e){e.complete()}),this.close()},e.prototype.subscribe=function(e,t,n){var i,o=this;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");void 0===(i=function(e,t){var n,i;if("object"!=typeof e||null===e)return!1;try{for(var o=r.__values(t),s=o.next();!s.done;s=o.next()){var a=s.value;if(a in e&&"function"==typeof e[a])return!0}}catch(e){n={error:e}}finally{try{s&&!s.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}return!1}(e,["next","error","complete"])?e:{next:e,error:t,complete:n}).next&&(i.next=w),void 0===i.error&&(i.error=w),void 0===i.complete&&(i.complete=w);var s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(function(){try{o.finalError?i.error(o.finalError):i.complete()}catch(e){}}),this.observers.push(i),s},e.prototype.unsubscribeOne=function(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))},e.prototype.forEachObserver=function(e){if(!this.finalized)for(var t=0;t<this.observers.length;t++)this.sendOne(t,e)},e.prototype.sendOne=function(e,t){var n=this;this.task.then(function(){if(void 0!==n.observers&&void 0!==n.observers[e])try{t(n.observers[e])}catch(e){"undefined"!=typeof console&&console.error&&console.error(e)}})},e.prototype.close=function(e){var t=this;this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then(function(){t.observers=void 0,t.onNoObservers=void 0}))},e}();function w(){}function E(e,t,n){var r="";switch(t){case 1:r=n?"first":"First";break;case 2:r=n?"second":"Second";break;case 3:r=n?"third":"Third";break;case 4:r=n?"fourth":"Fourth";break;default:throw new Error("errorPrefix called with argumentNumber > 4.  Need to update it?")}var i=e+" failed: ";return i+=r+" argument "}t.CONSTANTS=i,t.Deferred=l,t.ErrorFactory=m,t.FirebaseError=f,t.Sha1=_,t.assert=o,t.assertionError=s,t.async=function(e,t){return function(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];Promise.resolve(!0).then(function(){e.apply(void 0,r.__spread(n))}).catch(function(e){t&&t(e)})}},t.base64=c,t.base64Decode=u,t.base64Encode=function(e){var t=a(e);return c.encodeByteArray(t,!0)},t.contains=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.createSubscribe=function(e,t){var n=new b(e,t);return n.subscribe.bind(n)},t.decode=g,t.deepCopy=function(e){return h(void 0,e)},t.deepExtend=h,t.errorPrefix=E,t.getUA=p,t.isAdmin=function(e){var t=g(e).claims;return"object"==typeof t&&!0===t.admin},t.isBrowser=function(){return"object"==typeof self&&self.self===self},t.isEmpty=function(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0},t.isMobileCordova=function(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(p())},t.isNode=function(){try{return"[object process]"===Object.prototype.toString.call(e.process)}catch(e){return!1}},t.isNodeSdk=function(){return!0===i.NODE_CLIENT||!0===i.NODE_ADMIN},t.isReactNative=function(){return"object"==typeof navigator&&"ReactNative"===navigator.product},t.isValidFormat=function(e){var t=g(e).claims;return!!t&&"object"==typeof t&&t.hasOwnProperty("iat")},t.isValidTimestamp=function(e){var t=g(e).claims,n=Math.floor((new Date).getTime()/1e3),r=0,i=0;return"object"==typeof t&&(t.hasOwnProperty("nbf")?r=t.nbf:t.hasOwnProperty("iat")&&(r=t.iat),i=t.hasOwnProperty("exp")?t.exp:r+86400),!!n&&!!r&&!!i&&n>=r&&n<=i},t.issuedAtTime=function(e){var t=g(e).claims;return"object"==typeof t&&t.hasOwnProperty("iat")?t.iat:null},t.jsonEval=v,t.map=function(e,t,n){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=t.call(n,e[i],i,e));return r},t.querystring=function(e){var t,n,i=[],o=function(e,t){Array.isArray(t)?t.forEach(function(t){i.push(encodeURIComponent(e)+"="+encodeURIComponent(t))}):i.push(encodeURIComponent(e)+"="+encodeURIComponent(t))};try{for(var s=r.__values(Object.entries(e)),a=s.next();!a.done;a=s.next()){var u=r.__read(a.value,2);o(u[0],u[1])}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=s.return)&&n.call(s)}finally{if(t)throw t.error}}return i.length?"&"+i.join("&"):""},t.querystringDecode=function(e){var t={};return e.replace(/^\?/,"").split("&").forEach(function(e){if(e){var n=e.split("=");t[n[0]]=n[1]}}),t},t.safeGet=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)?e[t]:void 0},t.stringLength=function(e){for(var t=0,n=0;n<e.length;n++){var r=e.charCodeAt(n);r<128?t++:r<2048?t+=2:r>=55296&&r<=56319?(t+=4,n++):t+=3}return t},t.stringToByteArray=function(e){for(var t=[],n=0,r=0;r<e.length;r++){var i=e.charCodeAt(r);if(i>=55296&&i<=56319){var s=i-55296;o(++r<e.length,"Surrogate pair missing trail surrogate."),i=65536+(s<<10)+(e.charCodeAt(r)-56320)}i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):i<65536?(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t},t.stringify=function(e){return JSON.stringify(e)},t.validateArgCount=function(e,t,n,r){var i;if(r<t?i="at least "+t:r>n&&(i=0===n?"none":"no more than "+n),i)throw new Error(e+" failed: Was called with "+r+(1===r?" argument.":" arguments.")+" Expects "+i+".")},t.validateCallback=function(e,t,n,r){if((!r||n)&&"function"!=typeof n)throw new Error(E(e,t,r)+"must be a valid function.")},t.validateContextObject=function(e,t,n,r){if((!r||n)&&("object"!=typeof n||null===n))throw new Error(E(e,t,r)+"must be a valid context object.")},t.validateNamespace=function(e,t,n,r){if((!r||n)&&"string"!=typeof n)throw new Error(E(e,t,r)+"must be a valid firebase namespace.")}}).call(t,n("DuR2"))},TToO:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.__extends=function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},n.d(t,"__assign",function(){return i}),t.__rest=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n},t.__decorate=function(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},t.__param=function(e,t){return function(n,r){t(n,r,e)}},t.__metadata=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},t.__awaiter=function(e,t,n,r){return new(n||(n=Promise))(function(i,o){function s(e){try{u(r.next(e))}catch(e){o(e)}}function a(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(s,a)}u((r=r.apply(e,t||[])).next())})},t.__generator=function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},t.__exportStar=function(e,t){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])},t.__values=o,t.__read=s,t.__spread=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(s(arguments[t]));return e},t.__spreadArrays=function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;for(var r=Array(e),i=0,t=0;t<n;t++)for(var o=arguments[t],s=0,a=o.length;s<a;s++,i++)r[i]=o[s];return r},t.__await=a,t.__asyncGenerator=function(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=n.apply(e,t||[]),o=[];return r={},s("next"),s("throw"),s("return"),r[Symbol.asyncIterator]=function(){return this},r;function s(e){i[e]&&(r[e]=function(t){return new Promise(function(n,r){o.push([e,t,n,r])>1||u(e,t)})})}function u(e,t){try{!function(e){e.value instanceof a?Promise.resolve(e.value.v).then(c,h):l(o[0][2],e)}(i[e](t))}catch(e){l(o[0][3],e)}}function c(e){u("next",e)}function h(e){u("throw",e)}function l(e,t){e(t),o.shift(),o.length&&u(o[0][0],o[0][1])}},t.__asyncDelegator=function(e){var t,n;return t={},r("next"),r("throw",function(e){throw e}),r("return"),t[Symbol.iterator]=function(){return this},t;function r(r,i){t[r]=e[r]?function(t){return(n=!n)?{value:a(e[r](t)),done:"return"===r}:i?i(t):t}:i}},t.__asyncValues=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=o(e),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(n){t[n]=e[n]&&function(t){return new Promise(function(r,i){t=e[n](t),function(e,t,n,r){Promise.resolve(r).then(function(t){e({value:t,done:n})},t)}(r,i,t.done,t.value)})}}},t.__makeTemplateObject=function(e,t){Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t;return e},t.__importStar=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t},t.__importDefault=function(e){return e&&e.__esModule?e:{default:e}};var r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};var i=function(){return(i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function o(e){var t="function"==typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}function s(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s}function a(e){return this instanceof a?(this.v=e,this):new a(e)}},dih4:function(e,t,n){"use strict";n("fqSz")},fjI4:function(e,t,n){"use strict";function r(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s}function i(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(r(arguments[t]));return e}Object.defineProperty(t,"__esModule",{value:!0}),n.d(t,"LogLevel",function(){return o}),n.d(t,"Logger",function(){return c}),n.d(t,"setLogLevel",function(){return h});var o,s=[];!function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(o||(o={}));var a=o.INFO,u=function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(t<e.logLevel)){var s=(new Date).toISOString();switch(t){case o.DEBUG:case o.VERBOSE:console.log.apply(console,i(["["+s+"]  "+e.name+":"],n));break;case o.INFO:console.info.apply(console,i(["["+s+"]  "+e.name+":"],n));break;case o.WARN:console.warn.apply(console,i(["["+s+"]  "+e.name+":"],n));break;case o.ERROR:console.error.apply(console,i(["["+s+"]  "+e.name+":"],n));break;default:throw new Error("Attempted to log a message with an invalid logType (value: "+t+")")}}},c=function(){function e(e){this.name=e,this._logLevel=a,this._logHandler=u,s.push(this)}return Object.defineProperty(e.prototype,"logLevel",{get:function(){return this._logLevel},set:function(e){if(!(e in o))throw new TypeError("Invalid value assigned to `logLevel`");this._logLevel=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"logHandler",{get:function(){return this._logHandler},set:function(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e},enumerable:!0,configurable:!0}),e.prototype.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._logHandler.apply(this,i([this,o.DEBUG],e))},e.prototype.log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._logHandler.apply(this,i([this,o.VERBOSE],e))},e.prototype.info=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._logHandler.apply(this,i([this,o.INFO],e))},e.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._logHandler.apply(this,i([this,o.WARN],e))},e.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._logHandler.apply(this,i([this,o.ERROR],e))},e}();function h(e){s.forEach(function(t){t.logLevel=e})}},fqSz:function(e,t,n){"use strict";(function(e){var t=n("O4tu"),r=n.n(t);(function(){var t,n="function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,n){e!=Array.prototype&&e!=Object.prototype&&(e[t]=n.value)},i="undefined"!=typeof window&&window===this?this:void 0!==e&&null!=e?e:this;function o(e){var t="undefined"!=typeof Symbol&&Symbol.iterator&&e[Symbol.iterator];return t?t.call(e):{next:function(e){var t=0;return function(){return t<e.length?{done:!1,value:e[t++]}:{done:!0}}}(e)}}!function(e,t){if(t){var r=i;e=e.split(".");for(var o=0;o<e.length-1;o++){var s=e[o];s in r||(r[s]={}),r=r[s]}(t=t(o=r[e=e[e.length-1]]))!=o&&null!=t&&n(r,e,{configurable:!0,writable:!0,value:t})}}("Promise",function(e){function t(e){this.b=0,this.c=void 0,this.a=[];var t=this.f();try{e(t.resolve,t.reject)}catch(e){t.reject(e)}}function n(){this.a=null}function r(e){return e instanceof t?e:new t(function(t){t(e)})}if(e)return e;n.prototype.b=function(e){if(null==this.a){this.a=[];var t=this;this.c(function(){t.g()})}this.a.push(e)};var s=i.setTimeout;n.prototype.c=function(e){s(e,0)},n.prototype.g=function(){for(;this.a&&this.a.length;){var e=this.a;this.a=[];for(var t=0;t<e.length;++t){var n=e[t];e[t]=null;try{n()}catch(e){this.f(e)}}}this.a=null},n.prototype.f=function(e){this.c(function(){throw e})},t.prototype.f=function(){function e(e){return function(r){n||(n=!0,e.call(t,r))}}var t=this,n=!1;return{resolve:e(this.o),reject:e(this.g)}},t.prototype.o=function(e){if(e===this)this.g(new TypeError("A Promise cannot resolve to itself"));else if(e instanceof t)this.u(e);else{e:switch(typeof e){case"object":var n=null!=e;break e;case"function":n=!0;break e;default:n=!1}n?this.l(e):this.h(e)}},t.prototype.l=function(e){var t=void 0;try{t=e.then}catch(e){return void this.g(e)}"function"==typeof t?this.v(t,e):this.h(e)},t.prototype.g=function(e){this.i(2,e)},t.prototype.h=function(e){this.i(1,e)},t.prototype.i=function(e,t){if(0!=this.b)throw Error("Cannot settle("+e+", "+t+"): Promise already settled in state"+this.b);this.b=e,this.c=t,this.m()},t.prototype.m=function(){if(null!=this.a){for(var e=0;e<this.a.length;++e)a.b(this.a[e]);this.a=null}};var a=new n;return t.prototype.u=function(e){var t=this.f();e.Ja(t.resolve,t.reject)},t.prototype.v=function(e,t){var n=this.f();try{e.call(t,n.resolve,n.reject)}catch(e){n.reject(e)}},t.prototype.then=function(e,n){function r(e,t){return"function"==typeof e?function(t){try{i(e(t))}catch(e){o(e)}}:t}var i,o,s=new t(function(e,t){i=e,o=t});return this.Ja(r(e,i),r(n,o)),s},t.prototype.catch=function(e){return this.then(void 0,e)},t.prototype.Ja=function(e,t){function n(){switch(r.b){case 1:e(r.c);break;case 2:t(r.c);break;default:throw Error("Unexpected state: "+r.b)}}var r=this;null==this.a?a.b(n):this.a.push(n)},t.resolve=r,t.reject=function(e){return new t(function(t,n){n(e)})},t.race=function(e){return new t(function(t,n){for(var i=o(e),s=i.next();!s.done;s=i.next())r(s.value).Ja(t,n)})},t.all=function(e){var n=o(e),i=n.next();return i.done?r([]):new t(function(e,t){function o(t){return function(n){s[t]=n,0==--a&&e(s)}}var s=[],a=0;do{s.push(void 0),a++,r(i.value).Ja(o(s.length-1),t),i=n.next()}while(!i.done)})},t});var s=s||{},a=this;function u(e){return"string"==typeof e}function c(e){return"boolean"==typeof e}var h=/^[\w+/_-]+[=]{0,2}$/,l=null;function p(){}function d(e){var t=typeof e;if("object"==t){if(!e)return"null";if(e instanceof Array)return"array";if(e instanceof Object)return t;var n=Object.prototype.toString.call(e);if("[object Window]"==n)return"object";if("[object Array]"==n||"number"==typeof e.length&&void 0!==e.splice&&void 0!==e.propertyIsEnumerable&&!e.propertyIsEnumerable("splice"))return"array";if("[object Function]"==n||void 0!==e.call&&void 0!==e.propertyIsEnumerable&&!e.propertyIsEnumerable("call"))return"function"}else if("function"==t&&void 0===e.call)return"object";return t}function f(e){return null===e}function m(e){return"array"==d(e)}function y(e){var t=d(e);return"array"==t||"object"==t&&"number"==typeof e.length}function v(e){return"function"==d(e)}function g(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}var _="closure_uid_"+(1e9*Math.random()>>>0),b=0;function w(e,t,n){return e.call.apply(e.bind,arguments)}function E(e,t,n){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function S(e,t,n){return(S=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?w:E).apply(null,arguments)}function C(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}var T=Date.now||function(){return+new Date};function k(e,t){function n(){}n.prototype=t.prototype,e.qb=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.cd=function(e,n,r){for(var i=Array(arguments.length-2),o=2;o<arguments.length;o++)i[o-2]=arguments[o];return t.prototype[n].apply(e,i)}}function I(e){if(!e)return!1;try{return!!e.$goog_Thenable}catch(e){return!1}}function A(e){if(Error.captureStackTrace)Error.captureStackTrace(this,A);else{var t=Error().stack;t&&(this.stack=t)}e&&(this.message=String(e))}function N(e,t){for(var n="",r=(e=e.split("%s")).length-1,i=0;i<r;i++)n+=e[i]+(i<t.length?t[i]:"%s");A.call(this,n+e[r])}function R(e,t){throw new N("Failure"+(e?": "+e:""),Array.prototype.slice.call(arguments,1))}function O(e,t){this.c=e,this.f=t,this.b=0,this.a=null}function x(e,t){e.f(t),100>e.b&&(e.b++,t.next=e.a,e.a=t)}function P(){this.b=this.a=null}k(A,Error),A.prototype.name="CustomError",k(N,A),N.prototype.name="AssertionError",O.prototype.get=function(){if(0<this.b){this.b--;var e=this.a;this.a=e.next,e.next=null}else e=this.c();return e};var D=new O(function(){return new L},function(e){e.reset()});function M(){var e=ge,t=null;return e.a&&(t=e.a,e.a=e.a.next,e.a||(e.b=null),t.next=null),t}function L(){this.next=this.b=this.a=null}P.prototype.add=function(e,t){var n=D.get();n.set(e,t),this.b?this.b.next=n:this.a=n,this.b=n},L.prototype.set=function(e,t){this.a=e,this.b=t,this.next=null},L.prototype.reset=function(){this.next=this.b=this.a=null};var j=Array.prototype.indexOf?function(e,t){return Array.prototype.indexOf.call(e,t,void 0)}:function(e,t){if(u(e))return u(t)&&1==t.length?e.indexOf(t,0):-1;for(var n=0;n<e.length;n++)if(n in e&&e[n]===t)return n;return-1},F=Array.prototype.forEach?function(e,t,n){Array.prototype.forEach.call(e,t,n)}:function(e,t,n){for(var r=e.length,i=u(e)?e.split(""):e,o=0;o<r;o++)o in i&&t.call(n,i[o],o,e)};var B=Array.prototype.map?function(e,t){return Array.prototype.map.call(e,t,void 0)}:function(e,t){for(var n=e.length,r=Array(n),i=u(e)?e.split(""):e,o=0;o<n;o++)o in i&&(r[o]=t.call(void 0,i[o],o,e));return r},U=Array.prototype.some?function(e,t){return Array.prototype.some.call(e,t,void 0)}:function(e,t){for(var n=e.length,r=u(e)?e.split(""):e,i=0;i<n;i++)if(i in r&&t.call(void 0,r[i],i,e))return!0;return!1};function V(e,t){return 0<=j(e,t)}function q(e,t){var n;return(n=0<=(t=j(e,t)))&&Array.prototype.splice.call(e,t,1),n}function W(e,t){!function(e,t){for(var n=u(e)?e.split(""):e,r=e.length-1;0<=r;--r)r in n&&t.call(void 0,n[r],r,e)}(e,function(n,r){t.call(void 0,n,r,e)&&1==Array.prototype.splice.call(e,r,1).length&&0})}function H(e){return Array.prototype.concat.apply([],arguments)}function G(e){var t=e.length;if(0<t){for(var n=Array(t),r=0;r<t;r++)n[r]=e[r];return n}return[]}var z,Y=String.prototype.trim?function(e){return e.trim()}:function(e){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(e)[1]},Q=/&/g,K=/</g,$=/>/g,X=/"/g,J=/'/g,Z=/\x00/g,ee=/[\x00&<>"']/;function te(e,t){return-1!=e.indexOf(t)}function ne(e,t){return e<t?-1:e>t?1:0}e:{var re=a.navigator;if(re){var ie=re.userAgent;if(ie){z=ie;break e}}z=""}function oe(e){return te(z,e)}function se(e,t){for(var n in e)t.call(void 0,e[n],n,e)}function ae(e){for(var t in e)return!1;return!0}function ue(e){var t,n={};for(t in e)n[t]=e[t];return n}var ce,he,le="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function pe(e,t){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])e[n]=r[n];for(var o=0;o<le.length;o++)n=le[o],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function de(e,t){for(var n=e.split("%s"),r="",i=Array.prototype.slice.call(arguments,1);i.length&&1<n.length;)r+=n.shift()+i.shift();return r+n.join("%s")}function fe(e){return ee.test(e)&&(-1!=e.indexOf("&")&&(e=e.replace(Q,"&amp;")),-1!=e.indexOf("<")&&(e=e.replace(K,"&lt;")),-1!=e.indexOf(">")&&(e=e.replace($,"&gt;")),-1!=e.indexOf('"')&&(e=e.replace(X,"&quot;")),-1!=e.indexOf("'")&&(e=e.replace(J,"&#39;")),-1!=e.indexOf("\0")&&(e=e.replace(Z,"&#0;"))),e}function me(e){a.setTimeout(function(){throw e},0)}function ye(e,t){he||function(){if(a.Promise&&a.Promise.resolve){var e=a.Promise.resolve(void 0);he=function(){e.then(_e)}}else he=function(){var e=_e;!v(a.setImmediate)||a.Window&&a.Window.prototype&&!oe("Edge")&&a.Window.prototype.setImmediate==a.setImmediate?(ce||(ce=function(){var e=a.MessageChannel;if(void 0===e&&"undefined"!=typeof window&&window.postMessage&&window.addEventListener&&!oe("Presto")&&(e=function(){var e=document.createElement("IFRAME");e.style.display="none",e.src="",document.documentElement.appendChild(e);var t=e.contentWindow;(e=t.document).open(),e.write(""),e.close();var n="callImmediate"+Math.random(),r="file:"==t.location.protocol?"*":t.location.protocol+"//"+t.location.host;e=S(function(e){"*"!=r&&e.origin!=r||e.data!=n||this.port1.onmessage()},this),t.addEventListener("message",e,!1),this.port1={},this.port2={postMessage:function(){t.postMessage(n,r)}}}),void 0!==e&&!oe("Trident")&&!oe("MSIE")){var t=new e,n={},r=n;return t.port1.onmessage=function(){if(void 0!==n.next){var e=(n=n.next).yb;n.yb=null,e()}},function(e){r.next={yb:e},r=r.next,t.port2.postMessage(0)}}return"undefined"!=typeof document&&"onreadystatechange"in document.createElement("SCRIPT")?function(e){var t=document.createElement("SCRIPT");t.onreadystatechange=function(){t.onreadystatechange=null,t.parentNode.removeChild(t),t=null,e(),e=null},document.documentElement.appendChild(t)}:function(e){a.setTimeout(e,0)}}()),ce(e)):a.setImmediate(e)}}(),ve||(he(),ve=!0),ge.add(e,t)}var ve=!1,ge=new P;function _e(){for(var e;e=M();){try{e.a.call(e.b)}catch(e){me(e)}x(D,e)}ve=!1}function be(e,t){if(this.a=we,this.i=void 0,this.f=this.b=this.c=null,this.g=this.h=!1,e!=p)try{var n=this;e.call(t,function(e){Pe(n,Ee,e)},function(e){if(!(e instanceof Ue))try{if(e instanceof Error)throw e;throw Error("Promise rejected.")}catch(e){}Pe(n,Se,e)})}catch(e){Pe(this,Se,e)}}var we=0,Ee=2,Se=3;function Ce(){this.next=this.f=this.b=this.g=this.a=null,this.c=!1}Ce.prototype.reset=function(){this.f=this.b=this.g=this.a=null,this.c=!1};var Te=new O(function(){return new Ce},function(e){e.reset()});function ke(e,t,n){var r=Te.get();return r.g=e,r.b=t,r.f=n,r}function Ie(e){if(e instanceof be)return e;var t=new be(p);return Pe(t,Ee,e),t}function Ae(e){return new be(function(t,n){n(e)})}function Ne(e,t,n){De(e,t,n,null)||ye(C(t,e))}function Re(e){return new be(function(t){var n=e.length,r=[];if(n)for(var i=function(e,i,o){n--,r[e]=i?{Eb:!0,value:o}:{Eb:!1,reason:o},0==n&&t(r)},o=0;o<e.length;o++)Ne(e[o],C(i,o,!0),C(i,o,!1));else t(r)})}function Oe(e,t){e.b||e.a!=Ee&&e.a!=Se||Me(e),e.f?e.f.next=t:e.b=t,e.f=t}function xe(e,t,n,r){var i=ke(null,null,null);return i.a=new be(function(e,o){i.g=t?function(n){try{var i=t.call(r,n);e(i)}catch(e){o(e)}}:e,i.b=n?function(t){try{var i=n.call(r,t);void 0===i&&t instanceof Ue?o(t):e(i)}catch(e){o(e)}}:o}),i.a.c=e,Oe(e,i),i.a}function Pe(e,t,n){e.a==we&&(e===n&&(t=Se,n=new TypeError("Promise cannot resolve to itself")),e.a=1,De(n,e.Lc,e.Mc,e)||(e.i=n,e.a=t,e.c=null,Me(e),t!=Se||n instanceof Ue||function(e,t){e.g=!0,ye(function(){e.g&&Be.call(null,t)})}(e,n)))}function De(e,t,n,r){if(e instanceof be)return Oe(e,ke(t||p,n||null,r)),!0;if(I(e))return e.then(t,n,r),!0;if(g(e))try{var i=e.then;if(v(i))return function(e,t,n,r,i){function o(e){s||(s=!0,r.call(i,e))}var s=!1;try{t.call(e,function(e){s||(s=!0,n.call(i,e))},o)}catch(e){o(e)}}(e,i,t,n,r),!0}catch(e){return n.call(r,e),!0}return!1}function Me(e){e.h||(e.h=!0,ye(e.Wb,e))}function Le(e){var t=null;return e.b&&(t=e.b,e.b=t.next,t.next=null),e.b||(e.f=null),t}function je(e,t,n,r){if(n==Se&&t.b&&!t.c)for(;e&&e.g;e=e.c)e.g=!1;if(t.a)t.a.c=null,Fe(t,n,r);else try{t.c?t.g.call(t.f):Fe(t,n,r)}catch(e){Be.call(null,e)}x(Te,t)}function Fe(e,t,n){t==Ee?e.g.call(e.f,n):e.b&&e.b.call(e.f,n)}be.prototype.then=function(e,t,n){return xe(this,v(e)?e:null,v(t)?t:null,n)},be.prototype.$goog_Thenable=!0,(t=be.prototype).ia=function(e,t){return(e=ke(e,e,t)).c=!0,Oe(this,e),this},t.s=function(e,t){return xe(this,null,e,t)},t.cancel=function(e){this.a==we&&ye(function(){!function e(t,n){if(t.a==we)if(t.c){var r=t.c;if(r.b){for(var i=0,o=null,s=null,a=r.b;a&&(a.c||(i++,a.a==t&&(o=a),!(o&&1<i)));a=a.next)o||(s=a);o&&(r.a==we&&1==i?e(r,n):(s?((i=s).next==r.f&&(r.f=i),i.next=i.next.next):Le(r),je(r,o,Se,n)))}t.c=null}else Pe(t,Se,n)}(this,new Ue(e))},this)},t.Lc=function(e){this.a=we,Pe(this,Ee,e)},t.Mc=function(e){this.a=we,Pe(this,Se,e)},t.Wb=function(){for(var e;e=Le(this);)je(this,e,this.a,this.i);this.h=!1};var Be=me;function Ue(e){A.call(this,e)}function Ve(){0!=qe&&(We[this[_]||(this[_]=++b)]=this),this.qa=this.qa,this.ja=this.ja}k(Ue,A),Ue.prototype.name="cancel";var qe=0,We={};function He(e){if(!e.qa&&(e.qa=!0,e.va(),0!=qe)){var t=e[_]||(e[_]=++b);if(0!=qe&&e.ja&&0<e.ja.length)throw Error(e+" did not empty its onDisposeCallbacks queue. This probably means it overrode dispose() or disposeInternal() without calling the superclass' method.");delete We[t]}}function Ge(e){return Ge[" "](e),e}Ve.prototype.qa=!1,Ve.prototype.va=function(){if(this.ja)for(;this.ja.length;)this.ja.shift()()},Ge[" "]=p;var ze,Ye=oe("Opera"),Qe=oe("Trident")||oe("MSIE"),Ke=oe("Edge"),$e=Ke||Qe,Xe=oe("Gecko")&&!(te(z.toLowerCase(),"webkit")&&!oe("Edge"))&&!(oe("Trident")||oe("MSIE"))&&!oe("Edge"),Je=te(z.toLowerCase(),"webkit")&&!oe("Edge");function Ze(){var e=a.document;return e?e.documentMode:void 0}e:{var et="",tt=function(){var e=z;return Xe?/rv:([^\);]+)(\)|;)/.exec(e):Ke?/Edge\/([\d\.]+)/.exec(e):Qe?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(e):Je?/WebKit\/(\S+)/.exec(e):Ye?/(?:Version)[ \/]?(\S+)/.exec(e):void 0}();if(tt&&(et=tt?tt[1]:""),Qe){var nt=Ze();if(null!=nt&&nt>parseFloat(et)){ze=String(nt);break e}}ze=et}var rt,it={};function ot(e){return function(e,t){var n=it;return Object.prototype.hasOwnProperty.call(n,e)?n[e]:n[e]=t(e)}(e,function(){for(var t=0,n=Y(String(ze)).split("."),r=Y(String(e)).split("."),i=Math.max(n.length,r.length),o=0;0==t&&o<i;o++){var s=n[o]||"",a=r[o]||"";do{if(s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],0==s[0].length&&0==a[0].length)break;t=ne(0==s[1].length?0:parseInt(s[1],10),0==a[1].length?0:parseInt(a[1],10))||ne(0==s[2].length,0==a[2].length)||ne(s[2],a[2]),s=s[3],a=a[3]}while(0==t)}return 0<=t})}var st=a.document;rt=st&&Qe?Ze()||("CSS1Compat"==st.compatMode?parseInt(ze,10):5):void 0;var at=Object.freeze||function(e){return e},ut=!Qe||9<=Number(rt),ct=Qe&&!ot("9"),ht=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{a.addEventListener("test",p,t),a.removeEventListener("test",p,t)}catch(e){}return e}();function lt(e,t){this.type=e,this.b=this.target=t,this.Kb=!0}function pt(e,t){if(lt.call(this,e?e.type:""),this.relatedTarget=this.b=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.a=null,e){var n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.b=t,t=e.relatedTarget){if(Xe){e:{try{Ge(t.nodeName);var i=!0;break e}catch(e){}i=!1}i||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType=u(e.pointerType)?e.pointerType:dt[e.pointerType]||"",this.a=e,e.defaultPrevented&&this.preventDefault()}}lt.prototype.preventDefault=function(){this.Kb=!1},k(pt,lt);var dt=at({2:"touch",3:"pen",4:"mouse"});pt.prototype.preventDefault=function(){pt.qb.preventDefault.call(this);var e=this.a;if(e.preventDefault)e.preventDefault();else if(e.returnValue=!1,ct)try{(e.ctrlKey||112<=e.keyCode&&123>=e.keyCode)&&(e.keyCode=-1)}catch(e){}},pt.prototype.f=function(){return this.a};var ft="closure_listenable_"+(1e6*Math.random()|0),mt=0;function yt(e){e.oa=!0,e.listener=null,e.proxy=null,e.src=null,e.Na=null}function vt(e){this.src=e,this.a={},this.b=0}function gt(e,t){var n=t.type;n in e.a&&q(e.a[n],t)&&(yt(t),0==e.a[n].length&&(delete e.a[n],e.b--))}function _t(e,t,n,r){for(var i=0;i<e.length;++i){var o=e[i];if(!o.oa&&o.listener==t&&o.capture==!!n&&o.Na==r)return i}return-1}vt.prototype.add=function(e,t,n,r,i){var o=e.toString();(e=this.a[o])||(e=this.a[o]=[],this.b++);var s=_t(e,t,r,i);return-1<s?(t=e[s],n||(t.Ia=!1)):((t=new function(e,t,n,r,i){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.Na=i,this.key=++mt,this.oa=this.Ia=!1}(t,this.src,o,!!r,i)).Ia=n,e.push(t)),t};var bt="closure_lm_"+(1e6*Math.random()|0),wt={};function Et(e,t,n,r,i){if(r&&r.once)Ct(e,t,n,r,i);else if(m(t))for(var o=0;o<t.length;o++)Et(e,t[o],n,r,i);else n=Pt(n),e&&e[ft]?Mt(e,t,n,g(r)?!!r.capture:!!r,i):St(e,t,n,!1,r,i)}function St(e,t,n,r,i,o){if(!t)throw Error("Invalid event type");var s=g(i)?!!i.capture:!!i,a=Ot(e);if(a||(e[bt]=a=new vt(e)),!(n=a.add(t,n,r,s,o)).proxy){if(r=function(){var e=Rt,t=ut?function(n){return e.call(t.src,t.listener,n)}:function(n){if(!(n=e.call(t.src,t.listener,n)))return n};return t}(),n.proxy=r,r.src=e,r.listener=n,e.addEventListener)ht||(i=s),void 0===i&&(i=!1),e.addEventListener(t.toString(),r,i);else if(e.attachEvent)e.attachEvent(It(t.toString()),r);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(r)}0}}function Ct(e,t,n,r,i){if(m(t))for(var o=0;o<t.length;o++)Ct(e,t[o],n,r,i);else n=Pt(n),e&&e[ft]?Lt(e,t,n,g(r)?!!r.capture:!!r,i):St(e,t,n,!0,r,i)}function Tt(e,t,n,r,i){if(m(t))for(var o=0;o<t.length;o++)Tt(e,t[o],n,r,i);else r=g(r)?!!r.capture:!!r,n=Pt(n),e&&e[ft]?(e=e.m,(t=String(t).toString())in e.a&&(-1<(n=_t(o=e.a[t],n,r,i))&&(yt(o[n]),Array.prototype.splice.call(o,n,1),0==o.length&&(delete e.a[t],e.b--)))):e&&(e=Ot(e))&&(t=e.a[t.toString()],e=-1,t&&(e=_t(t,n,r,i)),(n=-1<e?t[e]:null)&&kt(n))}function kt(e){if("number"!=typeof e&&e&&!e.oa){var t=e.src;if(t&&t[ft])gt(t.m,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(It(n),r):t.addListener&&t.removeListener&&t.removeListener(r),0,(n=Ot(t))?(gt(n,e),0==n.b&&(n.src=null,t[bt]=null)):yt(e)}}}function It(e){return e in wt?wt[e]:wt[e]="on"+e}function At(e,t,n,r){var i=!0;if((e=Ot(e))&&(t=e.a[t.toString()]))for(t=t.concat(),e=0;e<t.length;e++){var o=t[e];o&&o.capture==n&&!o.oa&&(o=Nt(o,r),i=i&&!1!==o)}return i}function Nt(e,t){var n=e.listener,r=e.Na||e.src;return e.Ia&&kt(e),n.call(r,t)}function Rt(e,t){if(e.oa)return!0;if(!ut){if(!t)e:{t=["window","event"];for(var n=a,r=0;r<t.length;r++)if(null==(n=n[t[r]])){t=null;break e}t=n}if(t=new pt(r=t,this),n=!0,!(0>r.keyCode||void 0!=r.returnValue)){e:{var i=!1;if(0==r.keyCode)try{r.keyCode=-1;break e}catch(e){i=!0}(i||void 0==r.returnValue)&&(r.returnValue=!0)}for(r=[],i=t.b;i;i=i.parentNode)r.push(i);for(e=e.type,i=r.length-1;0<=i;i--){t.b=r[i];var o=At(r[i],e,!0,t);n=n&&o}for(i=0;i<r.length;i++)t.b=r[i],o=At(r[i],e,!1,t),n=n&&o}return n}return Nt(e,new pt(t,this))}function Ot(e){return(e=e[bt])instanceof vt?e:null}var xt="__closure_events_fn_"+(1e9*Math.random()>>>0);function Pt(e){return v(e)?e:(e[xt]||(e[xt]=function(t){return e.handleEvent(t)}),e[xt])}function Dt(){Ve.call(this),this.m=new vt(this),this.Pb=this,this.Wa=null}function Mt(e,t,n,r,i){e.m.add(String(t),n,!1,r,i)}function Lt(e,t,n,r,i){e.m.add(String(t),n,!0,r,i)}function jt(e,t,n,r){if(!(t=e.m.a[String(t)]))return!0;t=t.concat();for(var i=!0,o=0;o<t.length;++o){var s=t[o];if(s&&!s.oa&&s.capture==n){var a=s.listener,u=s.Na||s.src;s.Ia&&gt(e.m,s),i=!1!==a.call(u,r)&&i}}return i&&0!=r.Kb}function Ft(e,t,n){if(v(e))n&&(e=S(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=S(e.handleEvent,e)}return 2147483647<Number(t)?-1:a.setTimeout(e,t||0)}function Bt(e){var t=null;return new be(function(n,r){-1==(t=Ft(function(){n(void 0)},e))&&r(Error("Failed to schedule timer."))}).s(function(e){throw a.clearTimeout(t),e})}function Ut(e){if(e.S&&"function"==typeof e.S)return e.S();if(u(e))return e.split("");if(y(e)){for(var t=[],n=e.length,r=0;r<n;r++)t.push(e[r]);return t}for(r in t=[],n=0,e)t[n++]=e[r];return t}function Vt(e){if(e.U&&"function"==typeof e.U)return e.U();if(!e.S||"function"!=typeof e.S){if(y(e)||u(e)){var t=[];e=e.length;for(var n=0;n<e;n++)t.push(n);return t}for(var r in t=[],n=0,e)t[n++]=r;return t}}function qt(e,t){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(e)if(e instanceof qt)for(n=e.U(),r=0;r<n.length;r++)this.set(n[r],e.get(n[r]));else for(r in e)this.set(r,e[r])}function Wt(e){if(e.c!=e.a.length){for(var t=0,n=0;t<e.a.length;){var r=e.a[t];Ht(e.b,r)&&(e.a[n++]=r),t++}e.a.length=n}if(e.c!=e.a.length){var i={};for(n=t=0;t<e.a.length;)Ht(i,r=e.a[t])||(e.a[n++]=r,i[r]=1),t++;e.a.length=n}}function Ht(e,t){return Object.prototype.hasOwnProperty.call(e,t)}k(Dt,Ve),Dt.prototype[ft]=!0,Dt.prototype.addEventListener=function(e,t,n,r){Et(this,e,t,n,r)},Dt.prototype.removeEventListener=function(e,t,n,r){Tt(this,e,t,n,r)},Dt.prototype.dispatchEvent=function(e){var t,n=this.Wa;if(n)for(t=[];n;n=n.Wa)t.push(n);n=this.Pb;var r=e.type||e;if(u(e))e=new lt(e,n);else if(e instanceof lt)e.target=e.target||n;else{var i=e;pe(e=new lt(r,n),i)}if(i=!0,t)for(var o=t.length-1;0<=o;o--){var s=e.b=t[o];i=jt(s,r,!0,e)&&i}if(i=jt(s=e.b=n,r,!0,e)&&i,i=jt(s,r,!1,e)&&i,t)for(o=0;o<t.length;o++)i=jt(s=e.b=t[o],r,!1,e)&&i;return i},Dt.prototype.va=function(){if(Dt.qb.va.call(this),this.m){var e,t=this.m;for(e in t.a){for(var n=t.a[e],r=0;r<n.length;r++)0,yt(n[r]);delete t.a[e],t.b--}}this.Wa=null},(t=qt.prototype).S=function(){Wt(this);for(var e=[],t=0;t<this.a.length;t++)e.push(this.b[this.a[t]]);return e},t.U=function(){return Wt(this),this.a.concat()},t.clear=function(){this.b={},this.c=this.a.length=0},t.get=function(e,t){return Ht(this.b,e)?this.b[e]:t},t.set=function(e,t){Ht(this.b,e)||(this.c++,this.a.push(e)),this.b[e]=t},t.forEach=function(e,t){for(var n=this.U(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);e.call(t,o,i,this)}};var Gt=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function zt(e,t){var n;this.b=this.i=this.f="",this.m=null,this.g=this.c="",this.h=!1,e instanceof zt?(this.h=void 0!==t?t:e.h,Yt(this,e.f),this.i=e.i,this.b=e.b,Qt(this,e.m),this.c=e.c,Kt(this,mn(e.a)),this.g=e.g):e&&(n=String(e).match(Gt))?(this.h=!!t,Yt(this,n[1]||"",!0),this.i=en(n[2]||""),this.b=en(n[3]||"",!0),Qt(this,n[4]),this.c=en(n[5]||"",!0),Kt(this,n[6]||"",!0),this.g=en(n[7]||"")):(this.h=!!t,this.a=new cn(null,this.h))}function Yt(e,t,n){e.f=n?en(t,!0):t,e.f&&(e.f=e.f.replace(/:$/,""))}function Qt(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.m=t}else e.m=null}function Kt(e,t,n){t instanceof cn?(e.a=t,function(e,t){t&&!e.f&&(hn(e),e.c=null,e.a.forEach(function(e,t){var n=t.toLowerCase();t!=n&&(pn(this,t),fn(this,n,e))},e)),e.f=t}(e.a,e.h)):(n||(t=tn(t,an)),e.a=new cn(t,e.h))}function $t(e,t,n){e.a.set(t,n)}function Xt(e,t){return e.a.get(t)}function Jt(e){return e instanceof zt?new zt(e):new zt(e,void 0)}function Zt(e,t){var n=new zt(null,void 0);return Yt(n,"https"),e&&(n.b=e),t&&(n.c=t),n}function en(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function tn(e,t,n){return u(e)?(e=encodeURI(e).replace(t,nn),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function nn(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}zt.prototype.toString=function(){var e=[],t=this.f;t&&e.push(tn(t,rn,!0),":");var n=this.b;return(n||"file"==t)&&(e.push("//"),(t=this.i)&&e.push(tn(t,rn,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&e.push(":",String(n))),(n=this.c)&&(this.b&&"/"!=n.charAt(0)&&e.push("/"),e.push(tn(n,"/"==n.charAt(0)?sn:on,!0))),(n=this.a.toString())&&e.push("?",n),(n=this.g)&&e.push("#",tn(n,un)),e.join("")},zt.prototype.resolve=function(e){var t=new zt(this),n=!!e.f;n?Yt(t,e.f):n=!!e.i,n?t.i=e.i:n=!!e.b,n?t.b=e.b:n=null!=e.m;var r=e.c;if(n)Qt(t,e.m);else if(n=!!e.c){if("/"!=r.charAt(0))if(this.b&&!this.c)r="/"+r;else{var i=t.c.lastIndexOf("/");-1!=i&&(r=t.c.substr(0,i+1)+r)}if(".."==(i=r)||"."==i)r="";else if(te(i,"./")||te(i,"/.")){r=0==i.lastIndexOf("/",0),i=i.split("/");for(var o=[],s=0;s<i.length;){var a=i[s++];"."==a?r&&s==i.length&&o.push(""):".."==a?((1<o.length||1==o.length&&""!=o[0])&&o.pop(),r&&s==i.length&&o.push("")):(o.push(a),r=!0)}r=o.join("/")}else r=i}return n?t.c=r:n=""!==e.a.toString(),n?Kt(t,mn(e.a)):n=!!e.g,n&&(t.g=e.g),t};var rn=/[#\/\?@]/g,on=/[#\?:]/g,sn=/[#\?]/g,an=/[#\?@]/g,un=/#/g;function cn(e,t){this.b=this.a=null,this.c=e||null,this.f=!!t}function hn(e){e.a||(e.a=new qt,e.b=0,e.c&&function(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var r=e[n].indexOf("="),i=null;if(0<=r){var o=e[n].substring(0,r);i=e[n].substring(r+1)}else o=e[n];t(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(e.c,function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)}))}function ln(e){var t=Vt(e);if(void 0===t)throw Error("Keys are undefined");var n=new cn(null,void 0);e=Ut(e);for(var r=0;r<t.length;r++){var i=t[r],o=e[r];m(o)?fn(n,i,o):n.add(i,o)}return n}function pn(e,t){hn(e),t=yn(e,t),Ht(e.a.b,t)&&(e.c=null,e.b-=e.a.get(t).length,Ht((e=e.a).b,t)&&(delete e.b[t],e.c--,e.a.length>2*e.c&&Wt(e)))}function dn(e,t){return hn(e),t=yn(e,t),Ht(e.a.b,t)}function fn(e,t,n){pn(e,t),0<n.length&&(e.c=null,e.a.set(yn(e,t),G(n)),e.b+=n.length)}function mn(e){var t=new cn;return t.c=e.c,e.a&&(t.a=new qt(e.a),t.b=e.b),t}function yn(e,t){return t=String(t),e.f&&(t=t.toLowerCase()),t}(t=cn.prototype).add=function(e,t){hn(this),this.c=null,e=yn(this,e);var n=this.a.get(e);return n||this.a.set(e,n=[]),n.push(t),this.b+=1,this},t.clear=function(){this.a=this.c=null,this.b=0},t.forEach=function(e,t){hn(this),this.a.forEach(function(n,r){F(n,function(n){e.call(t,n,r,this)},this)},this)},t.U=function(){hn(this);for(var e=this.a.S(),t=this.a.U(),n=[],r=0;r<t.length;r++)for(var i=e[r],o=0;o<i.length;o++)n.push(t[r]);return n},t.S=function(e){hn(this);var t=[];if(u(e))dn(this,e)&&(t=H(t,this.a.get(yn(this,e))));else{e=this.a.S();for(var n=0;n<e.length;n++)t=H(t,e[n])}return t},t.set=function(e,t){return hn(this),this.c=null,dn(this,e=yn(this,e))&&(this.b-=this.a.get(e).length),this.a.set(e,[t]),this.b+=1,this},t.get=function(e,t){return e&&0<(e=this.S(e)).length?String(e[0]):t},t.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var e=[],t=this.a.U(),n=0;n<t.length;n++){var r=t[n],i=encodeURIComponent(String(r));r=this.S(r);for(var o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),e.push(s)}}return this.c=e.join("&")};var vn=!Qe||9<=Number(rt);function gn(e,t){this.a=e===wn&&t||"",this.b=bn}function _n(e){return e instanceof gn&&e.constructor===gn&&e.b===bn?e.a:(R("expected object of type Const, got '"+e+"'"),"type_error:Const")}gn.prototype.na=!0,gn.prototype.ma=function(){return this.a},gn.prototype.toString=function(){return"Const{"+this.a+"}"};var bn={},wn={};function En(){this.a="",this.b=In}function Sn(e){return e instanceof En&&e.constructor===En&&e.b===In?e.a:(R("expected object of type TrustedResourceUrl, got '"+e+"' of type "+d(e)),"type_error:TrustedResourceUrl")}function Cn(e,t){var n=_n(e);if(!kn.test(n))throw Error("Invalid TrustedResourceUrl format: "+n);return function(e){var t=new En;return t.a=e,t}(e=n.replace(Tn,function(e,r){if(!Object.prototype.hasOwnProperty.call(t,r))throw Error('Found marker, "'+r+'", in format string, "'+n+'", but no valid label mapping found in args: '+JSON.stringify(t));return(e=t[r])instanceof gn?_n(e):encodeURIComponent(String(e))}))}En.prototype.na=!0,En.prototype.ma=function(){return this.a.toString()},En.prototype.toString=function(){return"TrustedResourceUrl{"+this.a+"}"};var Tn=/%{(\w+)}/g,kn=/^((https:)?\/\/[0-9a-z.:[\]-]+\/|\/[^/\\]|[^:/\\%]+\/|[^:/\\%]*[?#]|about:blank#)/i,In={};function An(){this.a="",this.b=xn}function Nn(e){return e instanceof An&&e.constructor===An&&e.b===xn?e.a:(R("expected object of type SafeUrl, got '"+e+"' of type "+d(e)),"type_error:SafeUrl")}An.prototype.na=!0,An.prototype.ma=function(){return this.a.toString()},An.prototype.toString=function(){return"SafeUrl{"+this.a+"}"};var Rn=/^(?:(?:https?|mailto|ftp):|[^:/?#]*(?:[/?#]|$))/i;function On(e){return e instanceof An?e:(e="object"==typeof e&&e.na?e.ma():String(e),Rn.test(e)||(e="about:invalid#zClosurez"),Pn(e))}var xn={};function Pn(e){var t=new An;return t.a=e,t}function Dn(){this.a="",this.b=Mn}Pn("about:blank"),Dn.prototype.na=!0,Dn.prototype.ma=function(){return this.a.toString()},Dn.prototype.toString=function(){return"SafeHtml{"+this.a+"}"};var Mn={};function Ln(e){var t=new Dn;return t.a=e,t}function jn(e){var t=document;return u(e)?t.getElementById(e):e}function Fn(e,t){se(t,function(t,n){t&&"object"==typeof t&&t.na&&(t=t.ma()),"style"==n?e.style.cssText=t:"class"==n?e.className=t:"for"==n?e.htmlFor=t:Bn.hasOwnProperty(n)?e.setAttribute(Bn[n],t):0==n.lastIndexOf("aria-",0)||0==n.lastIndexOf("data-",0)?e.setAttribute(n,t):e[n]=t})}Ln("<!DOCTYPE html>"),Ln(""),Ln("<br>");var Bn={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",frameborder:"frameBorder",height:"height",maxlength:"maxLength",nonce:"nonce",role:"role",rowspan:"rowSpan",type:"type",usemap:"useMap",valign:"vAlign",width:"width"};function Un(e,t,n){var r=arguments,i=document,o=String(r[0]),s=r[1];if(!vn&&s&&(s.name||s.type)){if(o=["<",o],s.name&&o.push(' name="',fe(s.name),'"'),s.type){o.push(' type="',fe(s.type),'"');var a={};pe(a,s),delete a.type,s=a}o.push(">"),o=o.join("")}return o=i.createElement(o),s&&(u(s)?o.className=s:m(s)?o.className=s.join(" "):Fn(o,s)),2<r.length&&function(e,t,n){function r(n){n&&t.appendChild(u(n)?e.createTextNode(n):n)}for(var i=2;i<n.length;i++){var o=n[i];!y(o)||g(o)&&0<o.nodeType?r(o):F(Vn(o)?G(o):o,r)}}(i,o,r),o}function Vn(e){if(e&&"number"==typeof e.length){if(g(e))return"function"==typeof e.item||"string"==typeof e.item;if(v(e))return"function"==typeof e.item}return!1}function qn(e){var t=[];return function e(t,n,r){if(null==n)r.push("null");else{if("object"==typeof n){if(m(n)){var i=n;n=i.length,r.push("[");for(var o="",s=0;s<n;s++)r.push(o),e(t,i[s],r),o=",";return void r.push("]")}if(!(n instanceof String||n instanceof Number||n instanceof Boolean)){for(i in r.push("{"),o="",n)Object.prototype.hasOwnProperty.call(n,i)&&("function"!=typeof(s=n[i])&&(r.push(o),Gn(i,r),r.push(":"),e(t,s,r),o=","));return void r.push("}")}n=n.valueOf()}switch(typeof n){case"string":Gn(n,r);break;case"number":r.push(isFinite(n)&&!isNaN(n)?String(n):"null");break;case"boolean":r.push(String(n));break;case"function":r.push("null");break;default:throw Error("Unknown type: "+typeof n)}}}(new function(){},e,t),t.join("")}var Wn={'"':'\\"',"\\":"\\\\","/":"\\/","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\v":"\\u000b"},Hn=/\uffff/.test("￿")?/[\\"\x00-\x1f\x7f-\uffff]/g:/[\\"\x00-\x1f\x7f-\xff]/g;function Gn(e,t){t.push('"',e.replace(Hn,function(e){var t=Wn[e];return t||(t="\\u"+(65536|e.charCodeAt(0)).toString(16).substr(1),Wn[e]=t),t}),'"')}function zn(){var e=lr();return Qe&&!!rt&&11==rt||/Edge\/\d+/.test(e)}function Yn(){return a.window&&a.window.location.href||self&&self.location&&self.location.href||""}function Qn(e,t){t=t||a.window;var n="about:blank";e&&(n=Nn(On(e)).toString()),t.location.href=n}function Kn(e){return!!((e=(e||lr()).toLowerCase()).match(/android/)||e.match(/webos/)||e.match(/iphone|ipad|ipod/)||e.match(/blackberry/)||e.match(/windows phone/)||e.match(/iemobile/))}function $n(e){e=e||a.window;try{e.close()}catch(e){}}function Xn(e,t,n){var r=Math.floor(1e9*Math.random()).toString();t=t||500,n=n||600;var i=(window.screen.availHeight-n)/2,o=(window.screen.availWidth-t)/2;for(s in t={width:t,height:n,top:0<i?i:0,left:0<o?o:0,location:!0,resizable:!0,statusbar:!0,toolbar:!1},n=lr().toLowerCase(),r&&(t.target=r,te(n,"crios/")&&(t.target="_blank")),ur(lr())==sr&&(e=e||"http://localhost",t.scrollbars=!0),n=e||"",(e=t)||(e={}),r=window,t=n instanceof An?n:On(void 0!==n.href?n.href:String(n)),n=e.target||n.target,i=[],e)switch(s){case"width":case"height":case"top":case"left":i.push(s+"="+e[s]);break;case"target":case"noopener":case"noreferrer":break;default:i.push(s+"="+(e[s]?1:0))}var s=i.join(",");if((oe("iPhone")&&!oe("iPod")&&!oe("iPad")||oe("iPad")||oe("iPod"))&&r.navigator&&r.navigator.standalone&&n&&"_self"!=n?(s=r.document.createElement("A"),t instanceof An||t instanceof An||(t="object"==typeof t&&t.na?t.ma():String(t),Rn.test(t)||(t="about:invalid#zClosurez"),t=Pn(t)),s.href=Nn(t),s.setAttribute("target",n),e.noreferrer&&s.setAttribute("rel","noreferrer"),(e=document.createEvent("MouseEvent")).initMouseEvent("click",!0,!0,r,1),s.dispatchEvent(e),s={}):e.noreferrer?(s=r.open("",n,s),e=Nn(t).toString(),s&&($e&&te(e,";")&&(e="'"+e.replace(/'/g,"%27")+"'"),s.opener=null,e=Ln('<meta name="referrer" content="no-referrer"><meta http-equiv="refresh" content="0; url='+fe(e)+'">'),s.document.write(function(e){return e instanceof Dn&&e.constructor===Dn&&e.b===Mn?e.a:(R("expected object of type SafeHtml, got '"+e+"' of type "+d(e)),"type_error:SafeHtml")}(e)),s.document.close())):(s=r.open(Nn(t).toString(),n,s))&&e.noopener&&(s.opener=null),s)try{s.focus()}catch(e){}return s}var Jn=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Zn=/^[^@]+@[^@]+$/;function er(){var e=null;return new be(function(t){"complete"==a.document.readyState?t():(e=function(){t()},Ct(window,"load",e))}).s(function(t){throw Tt(window,"load",e),t})}function tr(e){return e=e||lr(),!("file:"!==yr()||!e.toLowerCase().match(/iphone|ipad|ipod|android/))}function nr(){var e=a.window;try{return!(!e||e==e.top)}catch(e){return!1}}function rr(){return void 0!==a.WorkerGlobalScope&&"function"==typeof a.importScripts}function ir(){return r.a.INTERNAL.hasOwnProperty("reactNative")?"ReactNative":r.a.INTERNAL.hasOwnProperty("node")?"Node":rr()?"Worker":"Browser"}function or(){var e=ir();return"ReactNative"===e||"Node"===e}var sr="Firefox",ar="Chrome";function ur(e){var t=e.toLowerCase();return te(t,"opera/")||te(t,"opr/")||te(t,"opios/")?"Opera":te(t,"iemobile")?"IEMobile":te(t,"msie")||te(t,"trident/")?"IE":te(t,"edge/")?"Edge":te(t,"firefox/")?sr:te(t,"silk/")?"Silk":te(t,"blackberry")?"Blackberry":te(t,"webos")?"Webos":!te(t,"safari/")||te(t,"chrome/")||te(t,"crios/")||te(t,"android")?!te(t,"chrome/")&&!te(t,"crios/")||te(t,"edge/")?te(t,"android")?"Android":(e=e.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/))&&2==e.length?e[1]:"Other":ar:"Safari"}var cr={Sc:"FirebaseCore-web",Uc:"FirebaseUI-web"};function hr(e,t){t=t||[];var n,r=[],i={};for(n in cr)i[cr[n]]=!0;for(n=0;n<t.length;n++)void 0!==i[t[n]]&&(delete i[t[n]],r.push(t[n]));return r.sort(),(t=r).length||(t=["FirebaseCore-web"]),"Browser"===(r=ir())?r=ur(i=lr()):"Worker"===r&&(r=ur(i=lr())+"-"+r),r+"/JsCore/"+e+"/"+t.join(",")}function lr(){return a.navigator&&a.navigator.userAgent||""}function pr(e,t){e=e.split("."),t=t||a;for(var n=0;n<e.length&&"object"==typeof t&&null!=t;n++)t=t[e[n]];return n!=e.length&&(t=void 0),t}function dr(){try{var e=a.localStorage,t=wr();if(e)return e.setItem(t,"1"),e.removeItem(t),!zn()||!!a.indexedDB}catch(e){return rr()&&!!a.indexedDB}return!1}function fr(){return(mr()||"chrome-extension:"===yr()||tr())&&!or()&&dr()&&!rr()}function mr(){return"http:"===yr()||"https:"===yr()}function yr(){return a.location&&a.location.protocol||null}function vr(e){return!Kn(e=e||lr())&&ur(e)!=sr}function gr(e){return void 0===e?null:qn(e)}function _r(e){var t,n={};for(t in e)e.hasOwnProperty(t)&&null!==e[t]&&void 0!==e[t]&&(n[t]=e[t]);return n}function br(e){if(null!==e)return JSON.parse(e)}function wr(e){return e||Math.floor(1e9*Math.random()).toString()}function Er(e){return"Safari"!=ur(e=e||lr())&&!e.toLowerCase().match(/iphone|ipad|ipod/)}function Sr(){var e=a.___jsl;if(e&&e.H)for(var t in e.H)if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=e.H[t].L.concat(),e.CP)for(var n=0;n<e.CP.length;n++)e.CP[n]=null}function Cr(e,t){if(e>t)throw Error("Short delay should be less than long delay!");this.a=e,this.c=t,e=lr(),t=ir(),this.b=Kn(e)||"ReactNative"===t}function Tr(){var e=a.document;return!e||void 0===e.visibilityState||"visible"==e.visibilityState}function kr(e){try{var t=new Date(parseInt(e,10));if(!isNaN(t.getTime())&&!/[^0-9]/.test(e))return t.toUTCString()}catch(e){}return null}function Ir(){return!(!pr("fireauth.oauthhelper",a)&&!pr("fireauth.iframe",a))}Cr.prototype.get=function(){var e=a.navigator;return!e||"boolean"!=typeof e.onLine||!mr()&&"chrome-extension:"!==yr()&&void 0===e.connection||e.onLine?this.b?this.c:this.a:Math.min(5e3,this.a)};var Ar,Nr={};function Rr(e){Nr[e]||(Nr[e]=!0,"undefined"!=typeof console&&"function"==typeof console.warn&&console.warn(e))}try{var Or={};Object.defineProperty(Or,"abcd",{configurable:!0,enumerable:!0,value:1}),Object.defineProperty(Or,"abcd",{configurable:!0,enumerable:!0,value:2}),Ar=2==Or.abcd}catch(e){Ar=!1}function xr(e,t,n){Ar?Object.defineProperty(e,t,{configurable:!0,enumerable:!0,value:n}):e[t]=n}function Pr(e,t){if(t)for(var n in t)t.hasOwnProperty(n)&&xr(e,n,t[n])}function Dr(e){var t={};return Pr(t,e),t}function Mr(e){var t=e;if("object"==typeof e&&null!=e)for(var n in t="length"in e?[]:{},e)xr(t,n,Mr(e[n]));return t}var Lr="EMAIL_SIGNIN",jr="email",Fr="newEmail",Br="requestType",Ur="email",Vr="fromEmail",qr="data",Wr="operation";function Hr(e,t){this.code=zr+e,this.message=t||Yr[e]||""}function Gr(e){var t=e&&e.code;return t?new Hr(t.substring(zr.length),e.message):null}k(Hr,Error),Hr.prototype.w=function(){return{code:this.code,message:this.message}},Hr.prototype.toJSON=function(){return this.w()};var zr="auth/",Yr={"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-already-in-use":"The email address is already in use by another account.","expired-action-code":"The action code has expired. ","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal error has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal error has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal error has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The OIDC ID token requires a valid unhashed nonce.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network error (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal error has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","user-cancelled":"User did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled."};function Qr(e){var t=e[Zr];if(void 0===t)throw new Hr("missing-continue-uri");if("string"!=typeof t||"string"==typeof t&&!t.length)throw new Hr("invalid-continue-uri");this.h=t,this.b=this.a=null,this.g=!1;var n=e[Kr];if(n&&"object"==typeof n){t=n[ni];var r=n[ei];if(n=n[ti],"string"==typeof t&&t.length){if(this.a=t,void 0!==r&&"boolean"!=typeof r)throw new Hr("argument-error",ei+" property must be a boolean when specified.");if(this.g=!!r,void 0!==n&&("string"!=typeof n||"string"==typeof n&&!n.length))throw new Hr("argument-error",ti+" property must be a non empty string when specified.");this.b=n||null}else{if(void 0!==t)throw new Hr("argument-error",ni+" property must be a non empty string when specified.");if(void 0!==r||void 0!==n)throw new Hr("missing-android-pkg-name")}}else if(void 0!==n)throw new Hr("argument-error",Kr+" property must be a non null object when specified.");if(this.f=null,(t=e[Jr])&&"object"==typeof t){if("string"==typeof(t=t[ri])&&t.length)this.f=t;else if(void 0!==t)throw new Hr("argument-error",ri+" property must be a non empty string when specified.")}else if(void 0!==t)throw new Hr("argument-error",Jr+" property must be a non null object when specified.");if(void 0!==(t=e[Xr])&&"boolean"!=typeof t)throw new Hr("argument-error",Xr+" property must be a boolean when specified.");if(this.c=!!t,void 0!==(e=e[$r])&&("string"!=typeof e||"string"==typeof e&&!e.length))throw new Hr("argument-error",$r+" property must be a non empty string when specified.");this.i=e||null}var Kr="android",$r="dynamicLinkDomain",Xr="handleCodeInApp",Jr="iOS",Zr="url",ei="installApp",ti="minimumVersion",ni="packageName",ri="bundleId";function ii(e){var t={};for(var n in t.continueUrl=e.h,t.canHandleCodeInApp=e.c,(t.androidPackageName=e.a)&&(t.androidMinimumVersion=e.b,t.androidInstallApp=e.g),t.iOSBundleId=e.f,t.dynamicLinkDomain=e.i,t)null===t[n]&&delete t[n];return t}var oi=null,si=null;function ai(e){var t="";return function(e,t){function n(t){for(;r<e.length;){var n=e.charAt(r++),i=si[n];if(null!=i)return i;if(!/^[\s\xa0]*$/.test(n))throw Error("Unknown base64 encoding at char: "+n)}return t}!function(){if(!oi){oi={},si={};for(var e=0;65>e;e++)oi[e]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(e),si[oi[e]]=e,62<=e&&(si["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_.".charAt(e)]=e)}}();for(var r=0;;){var i=n(-1),o=n(0),s=n(64),a=n(64);if(64===a&&-1===i)break;t(i<<2|o>>4),64!=s&&(t(o<<4&240|s>>2),64!=a&&t(s<<6&192|a))}}(e,function(e){t+=String.fromCharCode(e)}),t}function ui(e){this.c=e.sub,T(),this.a=e.provider_id||e.firebase&&e.firebase.sign_in_provider||null,this.b=!!e.is_anonymous||"anonymous"==this.a}function ci(e){return(e=hi(e))&&e.sub&&e.iss&&e.aud&&e.exp?new ui(e):null}function hi(e){if(!e)return null;if(3!=(e=e.split(".")).length)return null;for(var t=(4-(e=e[1]).length%4)%4,n=0;n<t;n++)e+=".";try{return JSON.parse(ai(e))}catch(e){}return null}ui.prototype.f=function(){return this.b};var li,pi={Yc:{bb:"https://www.googleapis.com/identitytoolkit/v3/relyingparty/",jb:"https://securetoken.googleapis.com/v1/token",id:"p"},$c:{bb:"https://staging-www.sandbox.googleapis.com/identitytoolkit/v3/relyingparty/",jb:"https://staging-securetoken.sandbox.googleapis.com/v1/token",id:"s"},ad:{bb:"https://www-googleapis-test.sandbox.google.com/identitytoolkit/v3/relyingparty/",jb:"https://test-securetoken.sandbox.googleapis.com/v1/token",id:"t"}};function di(e){for(var t in pi)if(pi[t].id===e)return{firebaseEndpoint:(e=pi[t]).bb,secureTokenEndpoint:e.jb};return null}li=di("__EID__")?"__EID__":void 0;var fi="oauth_consumer_key oauth_nonce oauth_signature oauth_signature_method oauth_timestamp oauth_token oauth_version".split(" "),mi=["client_id","response_type","scope","redirect_uri","state"],yi={Tc:{Oa:"locale",Ba:500,Aa:600,Pa:"facebook.com",ib:mi},Vc:{Oa:null,Ba:500,Aa:620,Pa:"github.com",ib:mi},Wc:{Oa:"hl",Ba:515,Aa:680,Pa:"google.com",ib:mi},bd:{Oa:"lang",Ba:485,Aa:705,Pa:"twitter.com",ib:fi}};function vi(e){for(var t in yi)if(yi[t].Pa==e)return yi[t];return null}function gi(e){var t={};t["facebook.com"]=Si,t["google.com"]=Ti,t["github.com"]=Ci,t["twitter.com"]=ki;var n=e&&e[bi];try{if(n)return t[n]?new t[n](e):new Ei(e);if(void 0!==e[_i])return new wi(e)}catch(e){}return null}var _i="idToken",bi="providerId";function wi(e){var t=e[bi];if(!t&&e[_i]){var n=ci(e[_i]);n&&n.a&&(t=n.a)}if(!t)throw Error("Invalid additional user info!");"anonymous"!=t&&"custom"!=t||(t=null),n=!1,void 0!==e.isNewUser?n=!!e.isNewUser:"identitytoolkit#SignupNewUserResponse"===e.kind&&(n=!0),xr(this,"providerId",t),xr(this,"isNewUser",n)}function Ei(e){wi.call(this,e),xr(this,"profile",Mr((e=br(e.rawUserInfo||"{}"))||{}))}function Si(e){if(Ei.call(this,e),"facebook.com"!=this.providerId)throw Error("Invalid provider ID!")}function Ci(e){if(Ei.call(this,e),"github.com"!=this.providerId)throw Error("Invalid provider ID!");xr(this,"username",this.profile&&this.profile.login||null)}function Ti(e){if(Ei.call(this,e),"google.com"!=this.providerId)throw Error("Invalid provider ID!")}function ki(e){if(Ei.call(this,e),"twitter.com"!=this.providerId)throw Error("Invalid provider ID!");xr(this,"username",e.screenName||null)}function Ii(e){var t=Jt(e),n=Xt(t,"link"),r=Xt(Jt(n),"link");return Xt(Jt(t=Xt(t,"deep_link_id")),"link")||t||r||n||e}function Ai(){}function Ni(e,t){return e.then(function(e){if(e[vs]){var n=ci(e[vs]);if(!n||t!=n.c)throw new Hr("user-mismatch");return e}throw new Hr("user-mismatch")}).s(function(e){throw e&&e.code&&e.code==zr+"user-not-found"?new Hr("user-mismatch"):e})}function Ri(e,t){if(!t)throw new Hr("internal-error","failed to construct a credential");this.a=t,xr(this,"providerId",e),xr(this,"signInMethod",e)}function Oi(e){return{pendingToken:e.a,requestUri:"http://localhost"}}function xi(e){if(e&&e.providerId&&e.signInMethod&&0==e.providerId.indexOf("saml.")&&e.pendingToken)try{return new Ri(e.providerId,e.pendingToken)}catch(e){}return null}function Pi(e,t,n){if(this.a=null,t.idToken||t.accessToken)t.idToken&&xr(this,"idToken",t.idToken),t.accessToken&&xr(this,"accessToken",t.accessToken),t.nonce&&!t.pendingToken&&xr(this,"nonce",t.nonce),t.pendingToken&&(this.a=t.pendingToken);else{if(!t.oauthToken||!t.oauthTokenSecret)throw new Hr("internal-error","failed to construct a credential");xr(this,"accessToken",t.oauthToken),xr(this,"secret",t.oauthTokenSecret)}xr(this,"providerId",e),xr(this,"signInMethod",n)}function Di(e){var t={};return e.idToken&&(t.id_token=e.idToken),e.accessToken&&(t.access_token=e.accessToken),e.secret&&(t.oauth_token_secret=e.secret),t.providerId=e.providerId,e.nonce&&!e.a&&(t.nonce=e.nonce),t={postBody:ln(t).toString(),requestUri:"http://localhost"},e.a&&(delete t.postBody,t.pendingToken=e.a),t}function Mi(e){if(e&&e.providerId&&e.signInMethod){var t={idToken:e.oauthIdToken,accessToken:e.oauthTokenSecret?null:e.oauthAccessToken,oauthTokenSecret:e.oauthTokenSecret,oauthToken:e.oauthTokenSecret&&e.oauthAccessToken,nonce:e.nonce,pendingToken:e.pendingToken};try{return new Pi(e.providerId,t,e.signInMethod)}catch(e){}}return null}function Li(e,t){this.Cc=t||[],Pr(this,{providerId:e,isOAuthProvider:!0}),this.zb={},this.eb=(vi(e)||{}).Oa||null,this.ab=null}function ji(e){if("string"!=typeof e||0!=e.indexOf("saml."))throw new Hr("argument-error",'SAML provider IDs must be prefixed with "saml."');Li.call(this,e,[])}function Fi(e){Li.call(this,e,mi),this.a=[]}function Bi(){Fi.call(this,"facebook.com")}function Ui(e){if(!e)throw new Hr("argument-error","credential failed: expected 1 argument (the OAuth access token).");var t=e;return g(e)&&(t=e.accessToken),(new Bi).credential({accessToken:t})}function Vi(){Fi.call(this,"github.com")}function qi(e){if(!e)throw new Hr("argument-error","credential failed: expected 1 argument (the OAuth access token).");var t=e;return g(e)&&(t=e.accessToken),(new Vi).credential({accessToken:t})}function Wi(){Fi.call(this,"google.com"),this.ua("profile")}function Hi(e,t){var n=e;return g(e)&&(n=e.idToken,t=e.accessToken),(new Wi).credential({idToken:n,accessToken:t})}function Gi(){Li.call(this,"twitter.com",fi)}function zi(e,t){var n=e;if(g(n)||(n={oauthToken:e,oauthTokenSecret:t}),!n.oauthToken||!n.oauthTokenSecret)throw new Hr("argument-error","credential failed: expected 2 arguments (the OAuth access token and secret).");return new Pi("twitter.com",n,"twitter.com")}function Yi(e,t,n){this.a=e,this.c=t,xr(this,"providerId","password"),xr(this,"signInMethod",n===Ki.EMAIL_LINK_SIGN_IN_METHOD?Ki.EMAIL_LINK_SIGN_IN_METHOD:Ki.EMAIL_PASSWORD_SIGN_IN_METHOD)}function Qi(e){return e&&e.email&&e.password?new Yi(e.email,e.password,e.signInMethod):null}function Ki(){Pr(this,{providerId:"password",isOAuthProvider:!1})}function $i(e,t){if(!(t=Xi(t)))throw new Hr("argument-error","Invalid email link!");return new Yi(e,t,Ki.EMAIL_LINK_SIGN_IN_METHOD)}function Xi(e){var t=Xt((e=new function(e){this.a=Jt(e)}(e=Ii(e))).a,"oobCode")||null;return"signIn"===(Xt(e.a,"mode")||null)&&t?t:null}function Ji(e){if(!(e.Ua&&e.Ta||e.Fa&&e.$))throw new Hr("internal-error");this.a=e,xr(this,"providerId","phone"),xr(this,"signInMethod","phone")}function Zi(e){if(e&&"phone"===e.providerId&&(e.verificationId&&e.verificationCode||e.temporaryProof&&e.phoneNumber)){var t={};return F(["verificationId","verificationCode","temporaryProof","phoneNumber"],function(n){e[n]&&(t[n]=e[n])}),new Ji(t)}return null}function eo(e){return e.a.Fa&&e.a.$?{temporaryProof:e.a.Fa,phoneNumber:e.a.$}:{sessionInfo:e.a.Ua,code:e.a.Ta}}function to(e){try{this.a=e||r.a.auth()}catch(e){throw new Hr("argument-error","Either an instance of firebase.auth.Auth must be passed as an argument to the firebase.auth.PhoneAuthProvider constructor, or the default firebase App instance must be initialized via firebase.initializeApp().")}Pr(this,{providerId:"phone",isOAuthProvider:!1})}function no(e,t){if(!e)throw new Hr("missing-verification-id");if(!t)throw new Hr("missing-verification-code");return new Ji({Ua:e,Ta:t})}function ro(e){if(e.temporaryProof&&e.phoneNumber)return new Ji({Fa:e.temporaryProof,$:e.phoneNumber});var t=e&&e.providerId;if(!t||"password"===t)return null;var n=e&&e.oauthAccessToken,r=e&&e.oauthTokenSecret,i=e&&e.nonce,o=e&&e.oauthIdToken,s=e&&e.pendingToken;try{switch(t){case"google.com":return Hi(o,n);case"facebook.com":return Ui(n);case"github.com":return qi(n);case"twitter.com":return zi(n,r);default:return n||r||o||s?s?0==t.indexOf("saml.")?new Ri(t,s):new Pi(t,{pendingToken:s,idToken:e.oauthIdToken,accessToken:e.oauthAccessToken},t):new Fi(t).credential({idToken:o,accessToken:n,rawNonce:i}):null}}catch(e){return null}}function io(e){if(!e.isOAuthProvider)throw new Hr("invalid-oauth-provider")}function oo(e,t,n,r,i,o){if(this.c=e,this.b=t||null,this.g=n||null,this.f=r||null,this.h=o||null,this.a=i||null,!this.g&&!this.a)throw new Hr("invalid-auth-event");if(this.g&&this.a)throw new Hr("invalid-auth-event");if(this.g&&!this.f)throw new Hr("invalid-auth-event")}function so(e){return(e=e||{}).type?new oo(e.type,e.eventId,e.urlResponse,e.sessionId,e.error&&Gr(e.error),e.postBody):null}function ao(){this.b=null,this.a=[]}k(Ei,wi),k(Si,Ei),k(Ci,Ei),k(Ti,Ei),k(ki,Ei),Ri.prototype.la=function(e){return Ms(e,Oi(this))},Ri.prototype.b=function(e,t){var n=Oi(this);return n.idToken=t,Ls(e,n)},Ri.prototype.f=function(e,t){return Ni(js(e,Oi(this)),t)},Ri.prototype.w=function(){return{providerId:this.providerId,signInMethod:this.signInMethod,pendingToken:this.a}},Pi.prototype.la=function(e){return Ms(e,Di(this))},Pi.prototype.b=function(e,t){var n=Di(this);return n.idToken=t,Ls(e,n)},Pi.prototype.f=function(e,t){return Ni(js(e,Di(this)),t)},Pi.prototype.w=function(){var e={providerId:this.providerId,signInMethod:this.signInMethod};return this.idToken&&(e.oauthIdToken=this.idToken),this.accessToken&&(e.oauthAccessToken=this.accessToken),this.secret&&(e.oauthTokenSecret=this.secret),this.nonce&&(e.nonce=this.nonce),this.a&&(e.pendingToken=this.a),e},Li.prototype.Da=function(e){return this.zb=ue(e),this},k(ji,Li),k(Fi,Li),Fi.prototype.ua=function(e){return V(this.a,e)||this.a.push(e),this},Fi.prototype.Fb=function(){return G(this.a)},Fi.prototype.credential=function(e,t){var n;if(!(n=g(e)?{idToken:e.idToken||null,accessToken:e.accessToken||null,nonce:e.rawNonce||null}:{idToken:e||null,accessToken:t||null}).idToken&&!n.accessToken)throw new Hr("argument-error","credential failed: must provide the ID token and/or the access token.");return new Pi(this.providerId,n,this.providerId)},k(Bi,Fi),xr(Bi,"PROVIDER_ID","facebook.com"),xr(Bi,"FACEBOOK_SIGN_IN_METHOD","facebook.com"),k(Vi,Fi),xr(Vi,"PROVIDER_ID","github.com"),xr(Vi,"GITHUB_SIGN_IN_METHOD","github.com"),k(Wi,Fi),xr(Wi,"PROVIDER_ID","google.com"),xr(Wi,"GOOGLE_SIGN_IN_METHOD","google.com"),k(Gi,Li),xr(Gi,"PROVIDER_ID","twitter.com"),xr(Gi,"TWITTER_SIGN_IN_METHOD","twitter.com"),Yi.prototype.la=function(e){return this.signInMethod==Ki.EMAIL_LINK_SIGN_IN_METHOD?pa(e,Gs,{email:this.a,oobCode:this.c}):pa(e,ua,{email:this.a,password:this.c})},Yi.prototype.b=function(e,t){return this.signInMethod==Ki.EMAIL_LINK_SIGN_IN_METHOD?pa(e,zs,{idToken:t,email:this.a,oobCode:this.c}):pa(e,na,{idToken:t,email:this.a,password:this.c})},Yi.prototype.f=function(e,t){return Ni(this.la(e),t)},Yi.prototype.w=function(){return{email:this.a,password:this.c,signInMethod:this.signInMethod}},Pr(Ki,{PROVIDER_ID:"password"}),Pr(Ki,{EMAIL_LINK_SIGN_IN_METHOD:"emailLink"}),Pr(Ki,{EMAIL_PASSWORD_SIGN_IN_METHOD:"password"}),Ji.prototype.la=function(e){return e.Va(eo(this))},Ji.prototype.b=function(e,t){var n=eo(this);return n.idToken=t,pa(e,ha,n)},Ji.prototype.f=function(e,t){var n=eo(this);return n.operation="REAUTH",Ni(e=pa(e,la,n),t)},Ji.prototype.w=function(){var e={providerId:"phone"};return this.a.Ua&&(e.verificationId=this.a.Ua),this.a.Ta&&(e.verificationCode=this.a.Ta),this.a.Fa&&(e.temporaryProof=this.a.Fa),this.a.$&&(e.phoneNumber=this.a.$),e},to.prototype.Va=function(e,t){var n=this.a.c;return Ie(t.verify()).then(function(r){if(!u(r))throw new Hr("argument-error","An implementation of firebase.auth.ApplicationVerifier.prototype.verify() must return a firebase.Promise that resolves with a string.");switch(t.type){case"recaptcha":return function(e,t){return pa(e,ea,t)}(n,{phoneNumber:e,recaptchaToken:r}).then(function(e){return"function"==typeof t.reset&&t.reset(),e},function(e){throw"function"==typeof t.reset&&t.reset(),e});default:throw new Hr("argument-error",'Only firebase.auth.ApplicationVerifiers with type="recaptcha" are currently supported.')}})},Pr(to,{PROVIDER_ID:"phone"}),Pr(to,{PHONE_SIGN_IN_METHOD:"phone"}),oo.prototype.getUid=function(){var e=[];return e.push(this.c),this.b&&e.push(this.b),this.f&&e.push(this.f),this.i&&e.push(this.i),e.join("-")},oo.prototype.w=function(){return{type:this.c,eventId:this.b,urlResponse:this.g,sessionId:this.f,postBody:this.h,error:this.a&&this.a.w()}};var uo,co=null;function ho(e){var t="unauthorized-domain",n=void 0,r=Jt(e);e=r.b,"chrome-extension"==(r=r.f)?n=de("This chrome extension ID (chrome-extension://%s) is not authorized to run this operation. Add it to the OAuth redirect domains list in the Firebase console -> Auth section -> Sign in method tab.",e):"http"==r||"https"==r?n=de("This domain (%s) is not authorized to run this operation. Add it to the OAuth redirect domains list in the Firebase console -> Auth section -> Sign in method tab.",e):t="operation-not-supported-in-this-environment",Hr.call(this,t,n)}function lo(e,t,n){Hr.call(this,e,n),(e=t||{}).Ab&&xr(this,"email",e.Ab),e.$&&xr(this,"phoneNumber",e.$),e.credential&&xr(this,"credential",e.credential)}function po(e){if(e.code){var t=e.code||"";0==t.indexOf(zr)&&(t=t.substring(zr.length));var n={credential:ro(e)};if(e.email)n.Ab=e.email;else if(e.phoneNumber)n.$=e.phoneNumber;else if(!n.credential)return new Hr(t,e.message||void 0);return new lo(t,n,e.message)}return null}function fo(){}function mo(e){return e.c||(e.c=e.b())}function yo(){}function vo(e){if(!e.f&&"undefined"==typeof XMLHttpRequest&&"undefined"!=typeof ActiveXObject){for(var t=["MSXML2.XMLHTTP.6.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],n=0;n<t.length;n++){var r=t[n];try{return new ActiveXObject(r),e.f=r}catch(e){}}throw Error("Could not create ActiveXObject. ActiveX might be disabled, or MSXML might not be installed")}return e.f}function go(){}function _o(){this.a=new XDomainRequest,this.readyState=0,this.onreadystatechange=null,this.responseType=this.responseText=this.response="",this.status=-1,this.statusText="",this.a.onload=S(this.cc,this),this.a.onerror=S(this.Gb,this),this.a.onprogress=S(this.dc,this),this.a.ontimeout=S(this.hc,this)}function bo(e,t){e.readyState=t,e.onreadystatechange&&e.onreadystatechange()}function wo(e,t,n){this.reset(e,t,n,void 0,void 0)}ao.prototype.subscribe=function(e){var t=this;this.a.push(e),this.b||(this.b=function(e){for(var n=0;n<t.a.length;n++)t.a[n](e)},"function"==typeof(e=pr("universalLinks.subscribe",a))&&e(null,this.b))},ao.prototype.unsubscribe=function(e){W(this.a,function(t){return t==e})},k(ho,Hr),k(lo,Hr),lo.prototype.w=function(){var e={code:this.code,message:this.message};this.email&&(e.email=this.email),this.phoneNumber&&(e.phoneNumber=this.phoneNumber);var t=this.credential&&this.credential.w();return t&&pe(e,t),e},lo.prototype.toJSON=function(){return this.w()},fo.prototype.c=null,k(yo,fo),yo.prototype.a=function(){var e=vo(this);return e?new ActiveXObject(e):new XMLHttpRequest},yo.prototype.b=function(){var e={};return vo(this)&&(e[0]=!0,e[1]=!0),e},uo=new yo,k(go,fo),go.prototype.a=function(){var e=new XMLHttpRequest;if("withCredentials"in e)return e;if("undefined"!=typeof XDomainRequest)return new _o;throw Error("Unsupported browser")},go.prototype.b=function(){return{}},(t=_o.prototype).open=function(e,t,n){if(null!=n&&!n)throw Error("Only async requests are supported.");this.a.open(e,t)},t.send=function(e){if(e){if("string"!=typeof e)throw Error("Only string data is supported");this.a.send(e)}else this.a.send()},t.abort=function(){this.a.abort()},t.setRequestHeader=function(){},t.getResponseHeader=function(e){return"content-type"==e.toLowerCase()?this.a.contentType:""},t.cc=function(){this.status=200,this.response=this.responseText=this.a.responseText,bo(this,4)},t.Gb=function(){this.status=500,this.response=this.responseText="",bo(this,4)},t.hc=function(){this.Gb()},t.dc=function(){this.status=200,bo(this,1)},t.getAllResponseHeaders=function(){return"content-type: "+this.a.contentType},wo.prototype.a=null;function Eo(e){this.f=e,this.b=this.c=this.a=null}function So(e,t){this.name=e,this.value=t}wo.prototype.reset=function(e,t,n,r,i){"number"==typeof i||0,r||T(),delete this.a},So.prototype.toString=function(){return this.name};var Co=new So("SEVERE",1e3),To=new So("WARNING",900),ko=new So("CONFIG",700),Io=new So("FINE",500);Eo.prototype.log=function(e,t,n){if(e.value>=function e(t){return t.c?t.c:t.a?e(t.a):(R("Root logger has no level set."),null)}(this).value)for(v(t)&&(t=t()),e=new wo(e,String(t),this.f),n&&(e.a=n),n=this;n;)n=n.a};var Ao={},No=null;function Ro(e){var t;if(No||(No=new Eo(""),Ao[""]=No,No.c=ko),!(t=Ao[e])){t=new Eo(e);var n=e.lastIndexOf("."),r=e.substr(n+1);(n=Ro(e.substr(0,n))).b||(n.b={}),n.b[r]=t,t.a=n,Ao[e]=t}return t}function Oo(e,t){e&&e.log(Io,t,void 0)}function xo(e){this.f=e}function Po(e){Dt.call(this),this.u=e,this.readyState=Do,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.i=new Headers,this.b=null,this.o="GET",this.g="",this.a=!1,this.h=Ro("goog.net.FetchXmlHttp"),this.l=this.c=this.f=null}k(xo,fo),xo.prototype.a=function(){return new Po(this.f)},xo.prototype.b=function(e){return function(){return e}}({}),k(Po,Dt);var Do=0;function Mo(e){e.c.read().then(e.bc.bind(e)).catch(e.Ma.bind(e))}function Lo(e,t){t&&e.f&&(e.status=e.f.status,e.statusText=e.f.statusText),e.readyState=4,e.f=null,e.c=null,e.l=null,jo(e)}function jo(e){e.onreadystatechange&&e.onreadystatechange.call(e)}function Fo(e){Dt.call(this),this.headers=new qt,this.D=e||null,this.c=!1,this.A=this.a=null,this.h=this.N=this.l="",this.f=this.I=this.i=this.G=!1,this.g=0,this.u=null,this.o=Bo,this.v=this.O=!1}(t=Po.prototype).open=function(e,t){if(this.readyState!=Do)throw this.abort(),Error("Error reopening a connection");this.o=e,this.g=t,this.readyState=1,jo(this)},t.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.a=!0;var t={headers:this.i,method:this.o,credentials:void 0,cache:void 0};e&&(t.body=e),this.u.fetch(new Request(this.g,t)).then(this.gc.bind(this),this.Ma.bind(this))},t.abort=function(){this.response=this.responseText="",this.i=new Headers,this.status=0,this.c&&this.c.cancel("Request was aborted."),1<=this.readyState&&this.a&&4!=this.readyState&&(this.a=!1,Lo(this,!1)),this.readyState=Do},t.gc=function(e){this.a&&(this.f=e,this.b||(this.b=e.headers,this.readyState=2,jo(this)),this.a&&(this.readyState=3,jo(this),this.a&&("arraybuffer"===this.responseType?e.arrayBuffer().then(this.ec.bind(this),this.Ma.bind(this)):void 0!==a.ReadableStream&&"body"in e?(this.response=this.responseText="",this.c=e.body.getReader(),this.l=new TextDecoder,Mo(this)):e.text().then(this.fc.bind(this),this.Ma.bind(this)))))},t.bc=function(e){if(this.a){var t=this.l.decode(e.value?e.value:new Uint8Array(0),{stream:!e.done});t&&(this.response=this.responseText+=t),e.done?Lo(this,!0):jo(this),3==this.readyState&&Mo(this)}},t.fc=function(e){this.a&&(this.response=this.responseText=e,Lo(this,!0))},t.ec=function(e){this.a&&(this.response=e,Lo(this,!0))},t.Ma=function(e){var t=this.h;t&&t.log(To,"Failed to fetch url "+this.g,e instanceof Error?e:Error(e)),this.a&&Lo(this,!0)},t.setRequestHeader=function(e,t){this.i.append(e,t)},t.getResponseHeader=function(e){return this.b?this.b.get(e.toLowerCase())||"":((e=this.h)&&e.log(To,"Attempting to get response header but no headers have been received for url: "+this.g,void 0),"")},t.getAllResponseHeaders=function(){if(!this.b){var e=this.h;return e&&e.log(To,"Attempting to get all response headers but no headers have been received for url: "+this.g,void 0),""}e=[];for(var t=this.b.entries(),n=t.next();!n.done;)n=n.value,e.push(n[0]+": "+n[1]),n=t.next();return e.join("\r\n")},k(Fo,Dt);var Bo="";Fo.prototype.b=Ro("goog.net.XhrIo");var Uo=/^https?$/i,Vo=["POST","PUT"];function qo(e,t,n,r,i){if(e.a)throw Error("[goog.net.XhrIo] Object is active with another request="+e.l+"; newUri="+t);n=n?n.toUpperCase():"GET",e.l=t,e.h="",e.N=n,e.G=!1,e.c=!0,e.a=e.D?e.D.a():uo.a(),e.A=e.D?mo(e.D):mo(uo),e.a.onreadystatechange=S(e.Jb,e);try{Oo(e.b,Xo(e,"Opening Xhr")),e.I=!0,e.a.open(n,String(t),!0),e.I=!1}catch(t){return Oo(e.b,Xo(e,"Error opening Xhr: "+t.message)),void Ho(e,t)}t=r||"";var o=new qt(e.headers);i&&function(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(y(e)||u(e))F(e,t,void 0);else for(var n=Vt(e),r=Ut(e),i=r.length,o=0;o<i;o++)t.call(void 0,r[o],n&&n[o],e)}(i,function(e,t){o.set(t,e)}),i=function(e){e:{for(var t=Wo,n=e.length,r=u(e)?e.split(""):e,i=0;i<n;i++)if(i in r&&t.call(void 0,r[i],i,e)){t=i;break e}t=-1}return 0>t?null:u(e)?e.charAt(t):e[t]}(o.U()),r=a.FormData&&t instanceof a.FormData,!V(Vo,n)||i||r||o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(e,t){this.a.setRequestHeader(t,e)},e),e.o&&(e.a.responseType=e.o),"withCredentials"in e.a&&e.a.withCredentials!==e.O&&(e.a.withCredentials=e.O);try{Qo(e),0<e.g&&(e.v=function(e){return Qe&&ot(9)&&"number"==typeof e.timeout&&void 0!==e.ontimeout}(e.a),Oo(e.b,Xo(e,"Will abort after "+e.g+"ms if incomplete, xhr2 "+e.v)),e.v?(e.a.timeout=e.g,e.a.ontimeout=S(e.Ga,e)):e.u=Ft(e.Ga,e.g,e)),Oo(e.b,Xo(e,"Sending request")),e.i=!0,e.a.send(t),e.i=!1}catch(t){Oo(e.b,Xo(e,"Send error: "+t.message)),Ho(e,t)}}function Wo(e){return"content-type"==e.toLowerCase()}function Ho(e,t){e.c=!1,e.a&&(e.f=!0,e.a.abort(),e.f=!1),e.h=t,Go(e),Yo(e)}function Go(e){e.G||(e.G=!0,e.dispatchEvent("complete"),e.dispatchEvent("error"))}function zo(e){if(e.c&&void 0!==s)if(e.A[1]&&4==Ko(e)&&2==$o(e))Oo(e.b,Xo(e,"Local request error detected and ignored"));else if(e.i&&4==Ko(e))Ft(e.Jb,0,e);else if(e.dispatchEvent("readystatechange"),4==Ko(e)){Oo(e.b,Xo(e,"Request complete")),e.c=!1;try{var t,n=$o(e);e:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break e;default:r=!1}if(!(t=r)){var i;if(i=0===n){var o=String(e.l).match(Gt)[1]||null;if(!o&&a.self&&a.self.location){var u=a.self.location.protocol;o=u.substr(0,u.length-1)}i=!Uo.test(o?o.toLowerCase():"")}t=i}if(t)e.dispatchEvent("complete"),e.dispatchEvent("success");else{try{var c=2<Ko(e)?e.a.statusText:""}catch(t){Oo(e.b,"Can not get status: "+t.message),c=""}e.h=c+" ["+$o(e)+"]",Go(e)}}finally{Yo(e)}}}function Yo(e,t){if(e.a){Qo(e);var n=e.a,r=e.A[0]?p:null;e.a=null,e.A=null,t||e.dispatchEvent("ready");try{n.onreadystatechange=r}catch(t){(e=e.b)&&e.log(Co,"Problem encountered resetting onreadystatechange: "+t.message,void 0)}}}function Qo(e){e.a&&e.v&&(e.a.ontimeout=null),e.u&&(a.clearTimeout(e.u),e.u=null)}function Ko(e){return e.a?e.a.readyState:0}function $o(e){try{return 2<Ko(e)?e.a.status:-1}catch(e){return-1}}function Xo(e,t){return t+" ["+e.N+" "+e.l+" "+$o(e)+"]"}function Jo(e){var t=cs;this.g=[],this.v=t,this.u=e||null,this.f=this.a=!1,this.c=void 0,this.l=this.A=this.i=!1,this.h=0,this.b=null,this.m=0}function Zo(e,t,n){e.a=!0,e.c=n,e.f=!t,rs(e)}function es(e){if(e.a){if(!e.l)throw new is(e);e.l=!1}}function ts(e,t,n,r){e.g.push([t,n,r]),e.a&&rs(e)}function ns(e){return U(e.g,function(e){return v(e[1])})}function rs(e){if(e.h&&e.a&&ns(e)){var t=e.h,n=as[t];n&&(a.clearTimeout(n.a),delete as[t]),e.h=0}e.b&&(e.b.m--,delete e.b),t=e.c;for(var r=n=!1;e.g.length&&!e.i;){var i=e.g.shift(),o=i[0],s=i[1];if(i=i[2],o=e.f?s:o)try{var u=o.call(i||e.u,t);void 0!==u&&(e.f=e.f&&(u==t||u instanceof Error),e.c=t=u),(I(t)||"function"==typeof a.Promise&&t instanceof a.Promise)&&(r=!0,e.i=!0)}catch(r){t=r,e.f=!0,ns(e)||(n=!0)}}e.c=t,r&&(u=S(e.o,e,!0),r=S(e.o,e,!1),t instanceof Jo?(ts(t,u,r),t.A=!0):t.then(u,r)),n&&(t=new ss(t),as[t.a]=t,e.h=t.a)}function is(){A.call(this)}function os(){A.call(this)}function ss(e){this.a=a.setTimeout(S(this.c,this),0),this.b=e}(t=Fo.prototype).Ga=function(){void 0!==s&&this.a&&(this.h="Timed out after "+this.g+"ms, aborting",Oo(this.b,Xo(this,this.h)),this.dispatchEvent("timeout"),this.abort(8))},t.abort=function(){this.a&&this.c&&(Oo(this.b,Xo(this,"Aborting")),this.c=!1,this.f=!0,this.a.abort(),this.f=!1,this.dispatchEvent("complete"),this.dispatchEvent("abort"),Yo(this))},t.va=function(){this.a&&(this.c&&(this.c=!1,this.f=!0,this.a.abort(),this.f=!1),Yo(this,!0)),Fo.qb.va.call(this)},t.Jb=function(){this.qa||(this.I||this.i||this.f?zo(this):this.vc())},t.vc=function(){zo(this)},t.getResponse=function(){try{if(!this.a)return null;if("response"in this.a)return this.a.response;switch(this.o){case Bo:case"text":return this.a.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in this.a)return this.a.mozResponseArrayBuffer}var e=this.b;return e&&e.log(Co,"Response type "+this.o+" is not supported on this browser",void 0),null}catch(e){return Oo(this.b,"Can not get response: "+e.message),null}},Jo.prototype.cancel=function(e){if(this.a)this.c instanceof Jo&&this.c.cancel();else{if(this.b){var t=this.b;delete this.b,e?t.cancel(e):(t.m--,0>=t.m&&t.cancel())}this.v?this.v.call(this.u,this):this.l=!0,this.a||(e=new os(this),es(this),Zo(this,!1,e))}},Jo.prototype.o=function(e,t){this.i=!1,Zo(this,e,t)},Jo.prototype.then=function(e,t,n){var r,i,o=new be(function(e,t){r=e,i=t});return ts(this,r,function(e){e instanceof os?o.cancel():i(e)}),o.then(e,t,n)},Jo.prototype.$goog_Thenable=!0,k(is,A),is.prototype.message="Deferred has already fired",is.prototype.name="AlreadyCalledError",k(os,A),os.prototype.message="Deferred was canceled",os.prototype.name="CanceledError",ss.prototype.c=function(){throw delete as[this.a],this.b};var as={};function us(e){var t={},n=t.document||document,r=Sn(e).toString(),i=document.createElement("SCRIPT"),o={Lb:i,Ga:void 0},s=new Jo(o),u=null,c=null!=t.timeout?t.timeout:5e3;return 0<c&&(u=window.setTimeout(function(){hs(i,!0);var e=new ds(ps,"Timeout reached for loading script "+r);es(s),Zo(s,!1,e)},c),o.Ga=u),i.onload=i.onreadystatechange=function(){i.readyState&&"loaded"!=i.readyState&&"complete"!=i.readyState||(hs(i,t.dd||!1,u),es(s),Zo(s,!0,null))},i.onerror=function(){hs(i,!0,u);var e=new ds(ls,"Error while loading script "+r);es(s),Zo(s,!1,e)},pe(o=t.attributes||{},{type:"text/javascript",charset:"UTF-8"}),Fn(i,o),function(e,t){e.src=Sn(t),null===l&&(l=(t=(t=a.document).querySelector&&t.querySelector("script[nonce]"))&&(t=t.nonce||t.getAttribute("nonce"))&&h.test(t)?t:""),(t=l)&&e.setAttribute("nonce",t)}(i,e),function(e){var t;return(t=(e||document).getElementsByTagName("HEAD"))&&0!=t.length?t[0]:e.documentElement}(n).appendChild(i),s}function cs(){if(this&&this.Lb){var e=this.Lb;e&&"SCRIPT"==e.tagName&&hs(e,!0,this.Ga)}}function hs(e,t,n){null!=n&&a.clearTimeout(n),e.onload=p,e.onerror=p,e.onreadystatechange=p,t&&window.setTimeout(function(){e&&e.parentNode&&e.parentNode.removeChild(e)},0)}var ls=0,ps=1;function ds(e,t){var n="Jsloader error (code #"+e+")";t&&(n+=": "+t),A.call(this,n),this.code=e}function fs(e){this.f=e}function ms(e,t,n){if(this.b=e,e=t||{},this.i=e.secureTokenEndpoint||"https://securetoken.googleapis.com/v1/token",this.m=e.secureTokenTimeout||gs,this.f=ue(e.secureTokenHeaders||_s),this.g=e.firebaseEndpoint||"https://www.googleapis.com/identitytoolkit/v3/relyingparty/",this.h=e.firebaseTimeout||bs,this.a=ue(e.firebaseHeaders||ws),n&&(this.a["X-Client-Version"]=n,this.f["X-Client-Version"]=n),n="Node"==ir(),!(n=a.XMLHttpRequest||n&&r.a.INTERNAL.node&&r.a.INTERNAL.node.XMLHttpRequest)&&!rr())throw new Hr("internal-error","The XMLHttpRequest compatibility library was not found.");this.c=void 0,rr()?this.c=new xo(self):or()?this.c=new fs(n):this.c=new go}k(ds,A),k(fs,fo),fs.prototype.a=function(){return new this.f},fs.prototype.b=function(){return{}};var ys,vs="idToken",gs=new Cr(3e4,6e4),_s={"Content-Type":"application/x-www-form-urlencoded"},bs=new Cr(3e4,6e4),ws={"Content-Type":"application/json"};function Es(e,t){t?e.a["X-Firebase-Locale"]=t:delete e.a["X-Firebase-Locale"]}function Ss(e,t){t?(e.a["X-Client-Version"]=t,e.f["X-Client-Version"]=t):(delete e.a["X-Client-Version"],delete e.f["X-Client-Version"])}function Cs(e,t,n,r,i,o,s){(function(){var e=lr();return!((e=ur(e)!=ar?null:(e=e.match(/\sChrome\/(\d+)/i))&&2==e.length?parseInt(e[1],10):null)&&30>e||Qe&&rt&&!(9<rt))})()||rr()?e=S(e.o,e):(ys||(ys=new be(function(e,t){!function(e,t){if(((window.gapi||{}).client||{}).request)e();else{a[ks]=function(){((window.gapi||{}).client||{}).request?e():t(Error("CORS_UNSUPPORTED"))};var n=Cn(Ts,{onload:ks});!function(e,t){ts(e,null,t,void 0)}(us(n),function(){t(Error("CORS_UNSUPPORTED"))})}}(e,t)})),e=S(e.l,e)),e(t,n,r,i,o,s)}ms.prototype.o=function(e,t,n,r,i,o){if(rr()&&(void 0===a.fetch||void 0===a.Headers||void 0===a.Request))throw new Hr("operation-not-supported-in-this-environment","fetch, Headers and Request native APIs or equivalent Polyfills must be available to support HTTP requests from a Worker environment.");var s=new Fo(this.c);if(o){s.g=Math.max(0,o);var u=setTimeout(function(){s.dispatchEvent("timeout")},o)}Mt(s,"complete",function(){u&&clearTimeout(u);var e=null;try{e=JSON.parse(function(e){try{return e.a?e.a.responseText:""}catch(t){return Oo(e.b,"Can not get responseText: "+t.message),""}}(this))||null}catch(t){e=null}t&&t(e)}),Lt(s,"ready",function(){u&&clearTimeout(u),He(this)}),Lt(s,"timeout",function(){u&&clearTimeout(u),He(this),t&&t(null)}),qo(s,e,n,r,i)};var Ts=new gn(wn,"https://apis.google.com/js/client.js?onload=%{onload}"),ks="__fcb"+Math.floor(1e6*Math.random()).toString();function Is(e){if(!u(e=e.email)||!Zn.test(e))throw new Hr("invalid-email")}function As(e){"email"in e&&Is(e)}function Ns(e){if(!e[vs])throw new Hr("internal-error")}function Rs(e){if(e.phoneNumber||e.temporaryProof){if(!e.phoneNumber||!e.temporaryProof)throw new Hr("internal-error")}else{if(!e.sessionInfo)throw new Hr("missing-verification-id");if(!e.code)throw new Hr("missing-verification-code")}}ms.prototype.l=function(e,t,n,r,i){var o=this;ys.then(function(){window.gapi.client.setApiKey(o.b);var s=window.gapi.auth.getToken();window.gapi.auth.setToken(null),window.gapi.client.request({path:e,method:n,body:r,headers:i,authType:"none",callback:function(e){window.gapi.auth.setToken(s),t&&t(e)}})}).s(function(e){t&&t({error:{message:e&&e.message||"CORS_UNSUPPORTED"}})})},ms.prototype.ob=function(){return pa(this,ra,{})},ms.prototype.rb=function(e,t){return pa(this,ta,{idToken:e,email:t})},ms.prototype.sb=function(e,t){return pa(this,na,{idToken:e,password:t})};var Os={displayName:"DISPLAY_NAME",photoUrl:"PHOTO_URL"};function xs(e){if(!e.requestUri||!e.sessionId&&!e.postBody&&!e.pendingToken)throw new Hr("internal-error")}function Ps(e,t){return t.oauthIdToken&&t.providerId&&0==t.providerId.indexOf("oidc.")&&!t.pendingToken&&(e.sessionId?t.nonce=e.sessionId:e.postBody&&(dn(e=new cn(e.postBody),"nonce")&&(t.nonce=e.get("nonce")))),t}function Ds(e){var t=null;if(e.needConfirmation?(e.code="account-exists-with-different-credential",t=po(e)):"FEDERATED_USER_ID_ALREADY_LINKED"==e.errorMessage?(e.code="credential-already-in-use",t=po(e)):"EMAIL_EXISTS"==e.errorMessage?(e.code="email-already-in-use",t=po(e)):e.errorMessage&&(t=da(e.errorMessage)),t)throw t;if(!e[vs])throw new Hr("internal-error")}function Ms(e,t){return t.returnIdpCredential=!0,pa(e,ia,t)}function Ls(e,t){return t.returnIdpCredential=!0,pa(e,sa,t)}function js(e,t){return t.returnIdpCredential=!0,t.autoCreate=!1,pa(e,oa,t)}function Fs(e){if(!e.oobCode)throw new Hr("invalid-action-code")}(t=ms.prototype).tb=function(e,t){var n={idToken:e},r=[];return se(Os,function(e,i){var o=t[i];null===o?r.push(e):i in t&&(n[i]=o)}),r.length&&(n.deleteAttribute=r),pa(this,ta,n)},t.lb=function(e,t){return pe(e={requestType:"PASSWORD_RESET",email:e},t),pa(this,$s,e)},t.mb=function(e,t){return pe(e={requestType:"EMAIL_SIGNIN",email:e},t),pa(this,Qs,e)},t.kb=function(e,t){return pe(e={requestType:"VERIFY_EMAIL",idToken:e},t),pa(this,Ks,e)},t.Va=function(e){return pa(this,ca,e)},t.$a=function(e,t){return pa(this,Zs,{oobCode:e,newPassword:t})},t.Ka=function(e){return pa(this,Us,{oobCode:e})},t.Xa=function(e){return pa(this,Bs,{oobCode:e})};var Bs={endpoint:"setAccountInfo",C:Fs,da:"email"},Us={endpoint:"resetPassword",C:Fs,J:function(e){var t=e.requestType;if(!t||!e.email&&"EMAIL_SIGNIN"!=t)throw new Hr("internal-error")}},Vs={endpoint:"signupNewUser",C:function(e){if(Is(e),!e.password)throw new Hr("weak-password")},J:Ns,R:!0},qs={endpoint:"createAuthUri"},Ws={endpoint:"deleteAccount",T:["idToken"]},Hs={endpoint:"setAccountInfo",T:["idToken","deleteProvider"],C:function(e){if(!m(e.deleteProvider))throw new Hr("internal-error")}},Gs={endpoint:"emailLinkSignin",T:["email","oobCode"],C:Is,J:Ns,R:!0},zs={endpoint:"emailLinkSignin",T:["idToken","email","oobCode"],C:Is,J:Ns,R:!0},Ys={endpoint:"getAccountInfo"},Qs={endpoint:"getOobConfirmationCode",T:["requestType"],C:function(e){if("EMAIL_SIGNIN"!=e.requestType)throw new Hr("internal-error");Is(e)},da:"email"},Ks={endpoint:"getOobConfirmationCode",T:["idToken","requestType"],C:function(e){if("VERIFY_EMAIL"!=e.requestType)throw new Hr("internal-error")},da:"email"},$s={endpoint:"getOobConfirmationCode",T:["requestType"],C:function(e){if("PASSWORD_RESET"!=e.requestType)throw new Hr("internal-error");Is(e)},da:"email"},Xs={wb:!0,endpoint:"getProjectConfig",Ib:"GET"},Js={wb:!0,endpoint:"getRecaptchaParam",Ib:"GET",J:function(e){if(!e.recaptchaSiteKey)throw new Hr("internal-error")}},Zs={endpoint:"resetPassword",C:Fs,da:"email"},ea={endpoint:"sendVerificationCode",T:["phoneNumber","recaptchaToken"],da:"sessionInfo"},ta={endpoint:"setAccountInfo",T:["idToken"],C:As,R:!0},na={endpoint:"setAccountInfo",T:["idToken"],C:function(e){if(As(e),!e.password)throw new Hr("weak-password")},J:Ns,R:!0},ra={endpoint:"signupNewUser",J:Ns,R:!0},ia={endpoint:"verifyAssertion",C:xs,Qa:Ps,J:Ds,R:!0},oa={endpoint:"verifyAssertion",C:xs,Qa:Ps,J:function(e){if(e.errorMessage&&"USER_NOT_FOUND"==e.errorMessage)throw new Hr("user-not-found");if(e.errorMessage)throw da(e.errorMessage);if(!e[vs])throw new Hr("internal-error")},R:!0},sa={endpoint:"verifyAssertion",C:function(e){if(xs(e),!e.idToken)throw new Hr("internal-error")},Qa:Ps,J:Ds,R:!0},aa={endpoint:"verifyCustomToken",C:function(e){if(!e.token)throw new Hr("invalid-custom-token")},J:Ns,R:!0},ua={endpoint:"verifyPassword",C:function(e){if(Is(e),!e.password)throw new Hr("wrong-password")},J:Ns,R:!0},ca={endpoint:"verifyPhoneNumber",C:Rs,J:Ns},ha={endpoint:"verifyPhoneNumber",C:function(e){if(!e.idToken)throw new Hr("internal-error");Rs(e)},J:function(e){if(e.temporaryProof)throw e.code="credential-already-in-use",po(e);Ns(e)}},la={Vb:{USER_NOT_FOUND:"user-not-found"},endpoint:"verifyPhoneNumber",C:Rs,J:Ns};function pa(e,t,n){if(!function(e,t){if(!t||!t.length)return!0;if(!e)return!1;for(var n=0;n<t.length;n++){var r=e[t[n]];if(void 0===r||null===r||""===r)return!1}return!0}(n,t.T))return Ae(new Hr("internal-error"));var r,i=t.Ib||"POST";return Ie(n).then(t.C).then(function(){return t.R&&(n.returnSecureToken=!0),function(e,t,n,r,i,o){var s=Jt(e.g+t);$t(s,"key",e.b),o&&$t(s,"cb",T().toString());var a="GET"==n;if(a)for(var u in r)r.hasOwnProperty(u)&&$t(s,u,r[u]);return new be(function(t,o){Cs(e,s.toString(),function(e){e?e.error?o(fa(e,i||{})):t(e):o(new Hr("network-request-failed"))},n,a?void 0:qn(_r(r)),e.a,e.h.get())})}(e,t.endpoint,i,n,t.Vb,t.wb||!1)}).then(function(e){return r=e,t.Qa?t.Qa(n,r):r}).then(t.J).then(function(){if(!t.da)return r;if(!(t.da in r))throw new Hr("internal-error");return r[t.da]})}function da(e){return fa({error:{errors:[{message:e}],code:400,message:e}})}function fa(e,t){var n=(e.error&&e.error.errors&&e.error.errors[0]||{}).reason||"",r={keyInvalid:"invalid-api-key",ipRefererBlocked:"app-not-authorized"};if(n=r[n]?new Hr(r[n]):null)return n;for(var i in n=e.error&&e.error.message||"",pe(r={INVALID_CUSTOM_TOKEN:"invalid-custom-token",CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_EMAIL:"invalid-email",INVALID_PASSWORD:"wrong-password",USER_DISABLED:"user-disabled",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_OR_INVALID_NONCE:"missing-or-invalid-nonce",INVALID_MESSAGE_PAYLOAD:"invalid-message-payload",INVALID_RECIPIENT_EMAIL:"invalid-recipient-email",INVALID_SENDER:"invalid-sender",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",INVALID_PROVIDER_ID:"invalid-provider-id",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",CORS_UNSUPPORTED:"cors-unsupported",DYNAMIC_LINK_NOT_ACTIVATED:"dynamic-link-not-activated",INVALID_APP_ID:"invalid-app-id",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",WEAK_PASSWORD:"weak-password",OPERATION_NOT_ALLOWED:"operation-not-allowed",USER_CANCELLED:"user-cancelled",CAPTCHA_CHECK_FAILED:"captcha-check-failed",INVALID_APP_CREDENTIAL:"invalid-app-credential",INVALID_CODE:"invalid-verification-code",INVALID_PHONE_NUMBER:"invalid-phone-number",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_APP_CREDENTIAL:"missing-app-credential",MISSING_CODE:"missing-verification-code",MISSING_PHONE_NUMBER:"missing-phone-number",MISSING_SESSION_INFO:"missing-verification-id",QUOTA_EXCEEDED:"quota-exceeded",SESSION_EXPIRED:"code-expired",REJECTED_CREDENTIAL:"rejected-credential",INVALID_CONTINUE_URI:"invalid-continue-uri",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",MISSING_IOS_BUNDLE_ID:"missing-ios-bundle-id",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_DYNAMIC_LINK_DOMAIN:"invalid-dynamic-link-domain",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",INVALID_CERT_HASH:"invalid-cert-hash",ADMIN_ONLY_OPERATION:"admin-restricted-operation"},t||{}),t=(t=n.match(/^[^\s]+\s*:\s*(.*)$/))&&1<t.length?t[1]:void 0,r)if(0===n.indexOf(i))return new Hr(r[i],t);return!t&&e&&(t=gr(e)),new Hr("internal-error",t)}function ma(e){this.b=e,this.a=null,this.gb=function(e){return(_a||(_a=new be(function(e,t){function n(){Sr(),pr("gapi.load")("gapi.iframes",{callback:e,ontimeout:function(){Sr(),t(Error("Network Error"))},timeout:va.get()})}if(pr("gapi.iframes.Iframe"))e();else if(pr("gapi.load"))n();else{var r="__iframefcb"+Math.floor(1e6*Math.random()).toString();a[r]=function(){pr("gapi.load")?n():t(Error("Network Error"))},Ie(us(r=Cn(ya,{onload:r}))).s(function(){t(Error("Network Error"))})}}).s(function(e){throw _a=null,e}))).then(function(){return new be(function(t,n){pr("gapi.iframes.getContext")().open({where:document.body,url:e.b,messageHandlersFilter:pr("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"),attributes:{style:{position:"absolute",top:"-100px",width:"1px",height:"1px"}},dontclear:!0},function(r){function i(){clearTimeout(o),t()}e.a=r,e.a.restyle({setHideOnLeave:!1});var o=setTimeout(function(){n(Error("Network Error"))},ga.get());r.ping(i).then(i,function(){n(Error("Network Error"))})})})})}(this)}var ya=new gn(wn,"https://apis.google.com/js/api.js?onload=%{onload}"),va=new Cr(3e4,6e4),ga=new Cr(5e3,15e3),_a=null;function ba(e,t,n){this.i=e,this.g=t,this.h=n,this.f=null,this.a=Zt(this.i,"/__/auth/iframe"),$t(this.a,"apiKey",this.g),$t(this.a,"appName",this.h),this.b=null,this.c=[]}function wa(e,t,n,r,i){this.o=e,this.l=t,this.c=n,this.m=r,this.h=this.g=this.i=null,this.a=i,this.f=null}function Ea(e){try{return r.a.app(e).auth().ya()}catch(e){return[]}}function Sa(e,t,n,r,i){this.l=e,this.f=t,this.b=n,this.c=r||null,this.h=i||null,this.o=this.u=this.v=null,this.g=[],this.m=this.a=null}function Ca(e){var t=Yn();return function(e){return pa(e,Xs,{}).then(function(e){return e.authorizedDomains||[]})}(e).then(function(e){e:{var n=Jt(t),r=n.f;n=n.b;for(var i=0;i<e.length;i++){var o=e[i],s=n,a=r;if(0==o.indexOf("chrome-extension://")?s=Jt(o).b==s&&"chrome-extension"==a:"http"!=a&&"https"!=a?s=!1:Jn.test(o)?s=s==o:(o=o.split(".").join("\\."),s=new RegExp("^(.+\\."+o+"|"+o+")$","i").test(s)),s){e=!0;break e}}e=!1}if(!e)throw new ho(Yn())})}function Ta(e){return e.m?e.m:(e.m=er().then(function(){if(!e.u){var t=e.c,n=e.h,r=Ea(e.b),i=new ba(e.l,e.f,e.b);i.f=t,i.b=n,i.c=G(r||[]),e.u=i.toString()}e.i=new ma(e.u),function(e){if(!e.i)throw Error("IfcHandler must be initialized!");!function(e,t){e.gb.then(function(){e.a.register("authEvent",t,pr("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"))})}(e.i,function(t){var n={};if(t&&t.authEvent){var r=!1;for(t=so(t.authEvent),n=0;n<e.g.length;n++)r=e.g[n](t)||r;return(n={}).status=r?"ACK":"ERROR",Ie(n)}return n.status="ERROR",Ie(n)})}(e)}),e.m)}function ka(e){return e.o||(e.v=e.c?hr(e.c,Ea(e.b)):null,e.o=new ms(e.f,di(e.h),e.v)),e.o}function Ia(e,t,n,r,i,o,s,a,u,c){return(e=new wa(e,t,n,r,i)).i=o,e.g=s,e.h=a,e.b=ue(u||null),e.f=c,e.toString()}function Aa(e){if(this.a=e||r.a.INTERNAL.reactNative&&r.a.INTERNAL.reactNative.AsyncStorage,!this.a)throw new Hr("internal-error","The React Native compatibility library was not found.");this.type="asyncStorage"}function Na(e){this.b=e,this.a={},this.c=S(this.f,this)}ba.prototype.toString=function(){return this.f?$t(this.a,"v",this.f):pn(this.a.a,"v"),this.b?$t(this.a,"eid",this.b):pn(this.a.a,"eid"),this.c.length?$t(this.a,"fw",this.c.join(",")):pn(this.a.a,"fw"),this.a.toString()},wa.prototype.toString=function(){var e=Zt(this.o,"/__/auth/handler");if($t(e,"apiKey",this.l),$t(e,"appName",this.c),$t(e,"authType",this.m),this.a.isOAuthProvider){var t=this.a;try{var n=r.a.app(this.c).auth().ea()}catch(e){n=null}for(var i in t.ab=n,$t(e,"providerId",this.a.providerId),n=_r((t=this.a).zb))n[i]=n[i].toString();i=t.Cc,n=ue(n);for(var o=0;o<i.length;o++){var s=i[o];s in n&&delete n[s]}t.eb&&t.ab&&!n[t.eb]&&(n[t.eb]=t.ab),ae(n)||$t(e,"customParameters",gr(n))}if("function"==typeof this.a.Fb&&((t=this.a.Fb()).length&&$t(e,"scopes",t.join(","))),this.i?$t(e,"redirectUrl",this.i):pn(e.a,"redirectUrl"),this.g?$t(e,"eventId",this.g):pn(e.a,"eventId"),this.h?$t(e,"v",this.h):pn(e.a,"v"),this.b)for(var a in this.b)this.b.hasOwnProperty(a)&&!Xt(e,a)&&$t(e,a,this.b[a]);return this.f?$t(e,"eid",this.f):pn(e.a,"eid"),(a=Ea(this.c)).length&&$t(e,"fw",a.join(",")),e.toString()},(t=Sa.prototype).Ea=function(e,t,n){var r=new Hr("popup-closed-by-user"),i=new Hr("web-storage-unsupported"),o=this,s=!1;return this.ga().then(function(){(function(e){var t={type:"webStorageSupport"};return Ta(e).then(function(){return function(e,t){return e.gb.then(function(){return new be(function(n){e.a.send(t.type,t,n,pr("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"))})})}(e.i,t)}).then(function(e){if(e&&e.length&&void 0!==e[0].webStorageSupport)return e[0].webStorageSupport;throw Error()})})(o).then(function(n){n||(e&&$n(e),t(i),s=!0)})}).s(function(){}).then(function(){if(!s)return function(e){return new be(function(t){return function n(){Bt(2e3).then(function(){if(e&&!e.closed)return n();t()})}()})}(e)}).then(function(){if(!s)return Bt(n).then(function(){t(r)})})},t.Mb=function(){var e=lr();return!vr(e)&&!Er(e)},t.Hb=function(){return!1},t.Db=function(e,t,n,r,i,o,s){if(!e)return Ae(new Hr("popup-blocked"));if(s&&!vr())return this.ga().s(function(t){$n(e),i(t)}),r(),Ie();this.a||(this.a=Ca(ka(this)));var a=this;return this.a.then(function(){var t=a.ga().s(function(t){throw $n(e),i(t),t});return r(),t}).then(function(){(io(n),s)||Qn(Ia(a.l,a.f,a.b,t,n,null,o,a.c,void 0,a.h),e)}).s(function(e){throw"auth/network-request-failed"==e.code&&(a.a=null),e})},t.Ca=function(e,t,n){this.a||(this.a=Ca(ka(this)));var r=this;return this.a.then(function(){io(t),Qn(Ia(r.l,r.f,r.b,e,t,Yn(),n,r.c,void 0,r.h))}).s(function(e){throw"auth/network-request-failed"==e.code&&(r.a=null),e})},t.ga=function(){var e=this;return Ta(this).then(function(){return e.i.gb}).s(function(){throw e.a=null,new Hr("network-request-failed")})},t.Ob=function(){return!0},t.wa=function(e){this.g.push(e)},t.La=function(e){W(this.g,function(t){return t==e})},(t=Aa.prototype).get=function(e){return Ie(this.a.getItem(e)).then(function(e){return e&&br(e)})},t.set=function(e,t){return Ie(this.a.setItem(e,gr(t)))},t.P=function(e){return Ie(this.a.removeItem(e))},t.Y=function(){},t.ca=function(){};var Ra,Oa=[];function xa(e){this.a=e}function Pa(e){this.c=e,this.b=!1,this.a=[]}function Da(e,t,n,r){var i,o,s,a,u=n||{},c=null;if(e.b)return Ae(Error("connection_unavailable"));var h=r?800:50,l="undefined"!=typeof MessageChannel?new MessageChannel:null;return new be(function(n,r){l?(i=Math.floor(Math.random()*Math.pow(10,20)).toString(),l.port1.start(),s=setTimeout(function(){r(Error("unsupported_event"))},h),c={messageChannel:l,onMessage:o=function(e){e.data.eventId===i&&("ack"===e.data.status?(clearTimeout(s),a=setTimeout(function(){r(Error("timeout"))},3e3)):"done"===e.data.status?(clearTimeout(a),void 0!==e.data.response?n(e.data.response):r(Error("unknown_error"))):(clearTimeout(s),clearTimeout(a),r(Error("invalid_response"))))}},e.a.push(c),l.port1.addEventListener("message",o),e.c.postMessage({eventType:t,eventId:i,data:u},[l.port2])):r(Error("connection_unavailable"))}).then(function(t){return Ma(e,c),t}).s(function(t){throw Ma(e,c),t})}function Ma(e,t){if(t){var n=t.messageChannel,r=t.onMessage;n&&(n.port1.removeEventListener("message",r),n.port1.close()),W(e.a,function(e){return e==t})}}function La(){if(!Ba())throw new Hr("web-storage-unsupported");this.c={},this.a=[],this.b=0,this.l=a.indexedDB,this.type="indexedDB",this.g=this.m=this.f=this.i=null,this.u=!1,this.h=null;var e=this;rr()&&self?(this.m=function(){var e=rr()?self:null;if(F(Oa,function(n){n.b==e&&(t=n)}),!t){var t=new Na(e);Oa.push(t)}return t}(),this.m.subscribe("keyChanged",function(t,n){return Ha(e).then(function(t){return 0<t.length&&F(e.a,function(e){e(t)}),{keyProcessed:V(t,n.key)}})}),this.m.subscribe("ping",function(){return Ie(["keyChanged"])})):function(){var e=a.navigator;return e&&e.serviceWorker?Ie().then(function(){return e.serviceWorker.ready}).then(function(e){return e.active||null}).s(function(){return null}):Ie(null)}().then(function(t){(e.h=t)&&(e.g=new Pa(new xa(t)),Da(e.g,"ping",null,!0).then(function(t){t[0].fulfilled&&V(t[0].value,"keyChanged")&&(e.u=!0)}).s(function(){}))})}function ja(e){return new be(function(t,n){var r=e.l.open("firebaseLocalStorageDb",1);r.onerror=function(e){try{e.preventDefault()}catch(e){}n(Error(e.target.error))},r.onupgradeneeded=function(e){e=e.target.result;try{e.createObjectStore("firebaseLocalStorage",{keyPath:"fbase_key"})}catch(e){n(e)}},r.onsuccess=function(r){(r=r.target.result).objectStoreNames.contains("firebaseLocalStorage")?t(r):function(e){return new be(function(t,n){var r=e.l.deleteDatabase("firebaseLocalStorageDb");r.onsuccess=function(){t()},r.onerror=function(e){n(Error(e.target.error))}})}(e).then(function(){return ja(e)}).then(function(e){t(e)}).s(function(e){n(e)})}})}function Fa(e){return e.o||(e.o=ja(e)),e.o}function Ba(){try{return!!a.indexedDB}catch(e){return!1}}function Ua(e){return e.objectStore("firebaseLocalStorage")}function Va(e,t){return e.transaction(["firebaseLocalStorage"],t?"readwrite":"readonly")}function qa(e){return new be(function(t,n){e.onsuccess=function(e){e&&e.target?t(e.target.result):t()},e.onerror=function(e){n(e.target.error)}})}function Wa(e,t){return e.g&&e.h&&function(){var e=a.navigator;return e&&e.serviceWorker&&e.serviceWorker.controller||null}()===e.h?Da(e.g,"keyChanged",{key:t},e.u).then(function(){}).s(function(){}):Ie()}function Ha(e){return Fa(e).then(function(e){var t=Ua(Va(e,!1));return t.getAll?qa(t.getAll()):new be(function(e,n){var r=[],i=t.openCursor();i.onsuccess=function(t){(t=t.target.result)?(r.push(t.value),t.continue()):e(r)},i.onerror=function(e){n(e.target.error)}})}).then(function(t){var n={},r=[];if(0==e.b){for(r=0;r<t.length;r++)n[t[r].fbase_key]=t[r].value;r=function e(t,n){var r,i=[];for(r in t)r in n?typeof t[r]!=typeof n[r]?i.push(r):"object"==typeof t[r]&&null!=t[r]&&null!=n[r]?0<e(t[r],n[r]).length&&i.push(r):t[r]!==n[r]&&i.push(r):i.push(r);for(r in n)r in t||i.push(r);return i}(e.c,n),e.c=n}return r})}function Ga(e){e.i&&e.i.cancel("STOP_EVENT"),e.f&&(clearTimeout(e.f),e.f=null)}function za(e){var t=this,n=null;this.a=[],this.type="indexedDB",this.c=e,this.b=Ie().then(function(){if(Ba()){var e=wr(),r="__sak"+e;return Ra||(Ra=new La),(n=Ra).set(r,e).then(function(){return n.get(r)}).then(function(t){if(t!==e)throw Error("indexedDB not supported!");return n.P(r)}).then(function(){return n}).s(function(){return t.c})}return t.c}).then(function(e){return t.type=e.type,e.Y(function(e){F(t.a,function(t){t(e)})}),e})}function Ya(){this.a={},this.type="inMemory"}function Qa(){if(!function(){var e="Node"==ir();if(!(e=Ka()||e&&r.a.INTERNAL.node&&r.a.INTERNAL.node.localStorage))return!1;try{return e.setItem("__sak","1"),e.removeItem("__sak"),!0}catch(e){return!1}}()){if("Node"==ir())throw new Hr("internal-error","The LocalStorage compatibility library was not found.");throw new Hr("web-storage-unsupported")}this.a=Ka()||r.a.INTERNAL.node.localStorage,this.type="localStorage"}function Ka(){try{var e=a.localStorage,t=wr();return e&&(e.setItem(t,"1"),e.removeItem(t)),e}catch(e){return null}}function $a(){this.type="nullStorage"}function Xa(){if(!function(){var e="Node"==ir();if(!(e=Ja()||e&&r.a.INTERNAL.node&&r.a.INTERNAL.node.sessionStorage))return!1;try{return e.setItem("__sak","1"),e.removeItem("__sak"),!0}catch(e){return!1}}()){if("Node"==ir())throw new Hr("internal-error","The SessionStorage compatibility library was not found.");throw new Hr("web-storage-unsupported")}this.a=Ja()||r.a.INTERNAL.node.sessionStorage,this.type="sessionStorage"}function Ja(){try{var e=a.sessionStorage,t=wr();return e&&(e.setItem(t,"1"),e.removeItem(t)),e}catch(e){return null}}Na.prototype.f=function(e){var t=e.data.eventType,n=e.data.eventId,r=this.a[t];if(r&&0<r.length){e.ports[0].postMessage({status:"ack",eventId:n,eventType:t,response:null});var i=[];F(r,function(t){i.push(Ie().then(function(){return t(e.origin,e.data.data)}))}),Re(i).then(function(r){var i=[];F(r,function(e){i.push({fulfilled:e.Eb,value:e.value,reason:e.reason?e.reason.message:void 0})}),F(i,function(e){for(var t in e)void 0===e[t]&&delete e[t]}),e.ports[0].postMessage({status:"done",eventId:n,eventType:t,response:i})})}},Na.prototype.subscribe=function(e,t){ae(this.a)&&this.b.addEventListener("message",this.c),void 0===this.a[e]&&(this.a[e]=[]),this.a[e].push(t)},Na.prototype.unsubscribe=function(e,t){void 0!==this.a[e]&&t?(W(this.a[e],function(e){return e==t}),0==this.a[e].length&&delete this.a[e]):t||delete this.a[e],ae(this.a)&&this.b.removeEventListener("message",this.c)},xa.prototype.postMessage=function(e,t){this.a.postMessage(e,t)},Pa.prototype.close=function(){for(;0<this.a.length;)Ma(this,this.a[0]);this.b=!0},(t=La.prototype).set=function(e,t){var n,r=!1,i=this;return Fa(this).then(function(t){return qa((t=Ua(Va(n=t,!0))).get(e))}).then(function(o){var s=Ua(Va(n,!0));return o?(o.value=t,qa(s.put(o))):(i.b++,r=!0,(o={}).fbase_key=e,o.value=t,qa(s.add(o)))}).then(function(){return i.c[e]=t,Wa(i,e)}).ia(function(){r&&i.b--})},t.get=function(e){return Fa(this).then(function(t){return qa(Ua(Va(t,!1)).get(e))}).then(function(e){return e&&e.value})},t.P=function(e){var t=!1,n=this;return Fa(this).then(function(r){return t=!0,n.b++,qa(Ua(Va(r,!0)).delete(e))}).then(function(){return delete n.c[e],Wa(n,e)}).ia(function(){t&&n.b--})},t.Y=function(e){0==this.a.length&&function(e){Ga(e),function t(){e.f=setTimeout(function(){e.i=Ha(e).then(function(t){0<t.length&&F(e.a,function(e){e(t)})}).then(function(){t()}).s(function(e){"STOP_EVENT"!=e.message&&t()})},800)}()}(this),this.a.push(e)},t.ca=function(e){W(this.a,function(t){return t==e}),0==this.a.length&&Ga(this)},(t=za.prototype).get=function(e){return this.b.then(function(t){return t.get(e)})},t.set=function(e,t){return this.b.then(function(n){return n.set(e,t)})},t.P=function(e){return this.b.then(function(t){return t.P(e)})},t.Y=function(e){this.a.push(e)},t.ca=function(e){W(this.a,function(t){return t==e})},(t=Ya.prototype).get=function(e){return Ie(this.a[e])},t.set=function(e,t){return this.a[e]=t,Ie()},t.P=function(e){return delete this.a[e],Ie()},t.Y=function(){},t.ca=function(){},(t=Qa.prototype).get=function(e){var t=this;return Ie().then(function(){return br(t.a.getItem(e))})},t.set=function(e,t){var n=this;return Ie().then(function(){var r=gr(t);null===r?n.P(e):n.a.setItem(e,r)})},t.P=function(e){var t=this;return Ie().then(function(){t.a.removeItem(e)})},t.Y=function(e){a.window&&Et(a.window,"storage",e)},t.ca=function(e){a.window&&Tt(a.window,"storage",e)},(t=$a.prototype).get=function(){return Ie(null)},t.set=function(){return Ie()},t.P=function(){return Ie()},t.Y=function(){},t.ca=function(){},(t=Xa.prototype).get=function(e){var t=this;return Ie().then(function(){return br(t.a.getItem(e))})},t.set=function(e,t){var n=this;return Ie().then(function(){var r=gr(t);null===r?n.P(e):n.a.setItem(e,r)})},t.P=function(e){var t=this;return Ie().then(function(){t.a.removeItem(e)})},t.Y=function(){},t.ca=function(){};var Za,eu,tu={B:Qa,Sa:Xa},nu={B:Qa,Sa:Xa},ru={B:Aa,Sa:$a},iu={B:Qa,Sa:$a},ou={Xc:"local",NONE:"none",Zc:"session"};function su(){var e=!(Er(lr())||!nr()),t=vr(),n=dr();this.o=e,this.h=t,this.m=n,this.a={},Za||(Za=new function(){var e={};e.Browser=tu,e.Node=nu,e.ReactNative=ru,e.Worker=iu,this.a=e[ir()]}),e=Za;try{this.g=!zn()&&Ir()||!a.indexedDB?new e.a.B:new za(rr()?new Ya:new e.a.B)}catch(e){this.g=new Ya,this.h=!0}try{this.i=new e.a.Sa}catch(e){this.i=new Ya}this.l=new Ya,this.f=S(this.Nb,this),this.b={}}function au(){return eu||(eu=new su),eu}function uu(e,t){switch(t){case"session":return e.i;case"none":return e.l;default:return e.g}}function cu(e,t){return"firebase:"+e.name+(t?":"+t:"")}function hu(e,t,n){return n=cu(t,n),"local"==t.B&&(e.b[n]=null),uu(e,t.B).P(n)}function lu(e){e.c&&(clearInterval(e.c),e.c=null)}(t=su.prototype).get=function(e,t){return uu(this,e.B).get(cu(e,t))},t.set=function(e,t,n){var r=cu(e,n),i=this,o=uu(this,e.B);return o.set(r,t).then(function(){return o.get(r)}).then(function(t){"local"==e.B&&(i.b[r]=t)})},t.addListener=function(e,t,n){e=cu(e,t),this.m&&(this.b[e]=a.localStorage.getItem(e)),ae(this.a)&&(uu(this,"local").Y(this.f),this.h||(zn()||!Ir())&&a.indexedDB||!this.m||function(e){lu(e),e.c=setInterval(function(){for(var t in e.a){var n=a.localStorage.getItem(t),r=e.b[t];n!=r&&(e.b[t]=n,n=new pt({type:"storage",key:t,target:window,oldValue:r,newValue:n,a:!0}),e.Nb(n))}},1e3)}(this)),this.a[e]||(this.a[e]=[]),this.a[e].push(n)},t.removeListener=function(e,t,n){e=cu(e,t),this.a[e]&&(W(this.a[e],function(e){return e==n}),0==this.a[e].length&&delete this.a[e]),ae(this.a)&&(uu(this,"local").ca(this.f),lu(this))},t.Nb=function(e){if(e&&e.f){var t=e.a.key;if(null==t)for(var n in this.a){var r=this.b[n];void 0===r&&(r=null);var i=a.localStorage.getItem(n);i!==r&&(this.b[n]=i,this.Ya(n))}else if(0==t.indexOf("firebase:")&&this.a[t]){if(void 0!==e.a.a?uu(this,"local").ca(this.f):lu(this),this.o)if(n=a.localStorage.getItem(t),(r=e.a.newValue)!==n)null!==r?a.localStorage.setItem(t,r):a.localStorage.removeItem(t);else if(this.b[t]===r&&void 0===e.a.a)return;var o=this;n=function(){void 0===e.a.a&&o.b[t]===a.localStorage.getItem(t)||(o.b[t]=a.localStorage.getItem(t),o.Ya(t))},Qe&&rt&&10==rt&&a.localStorage.getItem(t)!==e.a.newValue&&e.a.newValue!==e.a.oldValue?setTimeout(n,10):n()}}else F(e,S(this.Ya,this))},t.Ya=function(e){this.a[e]&&F(this.a[e],function(e){e()})};var pu,du={name:"authEvent",B:"local"};function fu(e,t){this.b=mu,this.f=a.Uint8Array?new Uint8Array(this.b):Array(this.b),this.g=this.c=0,this.a=[],this.i=e,this.h=t,this.m=a.Int32Array?new Int32Array(64):Array(64),void 0!==pu||(pu=a.Int32Array?new Int32Array(Eu):Eu),this.reset()}k(fu,function(){this.b=-1});for(var mu=64,yu=mu-1,vu=[],gu=0;gu<yu;gu++)vu[gu]=0;var _u=H(128,vu);function bu(e){for(var t=e.f,n=e.m,r=0,i=0;i<t.length;)n[r++]=t[i]<<24|t[i+1]<<16|t[i+2]<<8|t[i+3],i=4*r;for(t=16;64>t;t++){i=0|n[t-15],r=0|n[t-2];var o=(0|n[t-16])+((i>>>7|i<<25)^(i>>>18|i<<14)^i>>>3)|0,s=(0|n[t-7])+((r>>>17|r<<15)^(r>>>19|r<<13)^r>>>10)|0;n[t]=o+s|0}r=0|e.a[0],i=0|e.a[1];var a=0|e.a[2],u=0|e.a[3],c=0|e.a[4],h=0|e.a[5],l=0|e.a[6];for(o=0|e.a[7],t=0;64>t;t++){var p=((r>>>2|r<<30)^(r>>>13|r<<19)^(r>>>22|r<<10))+(r&i^r&a^i&a)|0;s=(o=o+((c>>>6|c<<26)^(c>>>11|c<<21)^(c>>>25|c<<7))|0)+((s=(s=c&h^~c&l)+(0|pu[t])|0)+(0|n[t])|0)|0,o=l,l=h,h=c,c=u+s|0,u=a,a=i,i=r,r=s+p|0}e.a[0]=e.a[0]+r|0,e.a[1]=e.a[1]+i|0,e.a[2]=e.a[2]+a|0,e.a[3]=e.a[3]+u|0,e.a[4]=e.a[4]+c|0,e.a[5]=e.a[5]+h|0,e.a[6]=e.a[6]+l|0,e.a[7]=e.a[7]+o|0}function wu(e,t,n){void 0===n&&(n=t.length);var r=0,i=e.c;if(u(t))for(;r<n;)e.f[i++]=t.charCodeAt(r++),i==e.b&&(bu(e),i=0);else{if(!y(t))throw Error("message must be string or array");for(;r<n;){var o=t[r++];if(!("number"==typeof o&&0<=o&&255>=o&&o==(0|o)))throw Error("message must be a byte array");e.f[i++]=o,i==e.b&&(bu(e),i=0)}}e.c=i,e.g+=n}fu.prototype.reset=function(){this.g=this.c=0,this.a=a.Int32Array?new Int32Array(this.h):G(this.h)};var Eu=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function Su(){fu.call(this,8,Cu)}k(Su,fu);var Cu=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225];function Tu(e,t,n,r,i){this.l=e,this.i=t,this.m=n,this.o=r||null,this.u=i||null,this.h=t+":"+n,this.v=new function(){this.a=au()},this.g=new function(e){this.a=e,this.b=au()}(this.h),this.f=null,this.b=[],this.a=this.c=null}function ku(e){return new Hr("invalid-cordova-configuration",e)}function Iu(e){var t=new Su;wu(t,e),e=[];var n=8*t.g;56>t.c?wu(t,_u,56-t.c):wu(t,_u,t.b-(t.c-56));for(var r=63;56<=r;r--)t.f[r]=255&n,n/=256;for(bu(t),r=n=0;r<t.i;r++)for(var i=24;0<=i;i-=8)e[n++]=t.a[r]>>i&255;return function(e){return B(e,function(e){return 1<(e=e.toString(16)).length?e:"0"+e}).join("")}(e)}function Au(e,t){for(var n=0;n<e.b.length;n++)try{e.b[n](t)}catch(e){}}function Nu(e){return e.f||(e.f=e.ga().then(function(){return new be(function(t){e.wa(function n(r){return t(r),e.La(n),!1}),function(e){function t(t){r=!0,i&&i.cancel(),Ru(e).then(function(r){var i=n;if(r&&t&&t.url){var o=null;-1!=(i=Ii(t.url)).indexOf("/__/auth/callback")&&(o=(o="object"==typeof(o=br(Xt(o=Jt(i),"firebaseError")||null))?Gr(o):null)?new oo(r.c,r.b,null,null,o):new oo(r.c,r.b,i,r.f)),i=o||n}Au(e,i)})}var n=new oo("unknown",null,null,null,new Hr("no-auth-event")),r=!1,i=Bt(500).then(function(){return Ru(e).then(function(){r||Au(e,n)})}),o=a.handleOpenURL;a.handleOpenURL=function(e){if(0==e.toLowerCase().indexOf(pr("BuildInfo.packageName",a).toLowerCase()+"://")&&t({url:e}),"function"==typeof o)try{o(e)}catch(e){console.error(e)}},co||(co=new ao),co.subscribe(t)}(e)})})),e.f}function Ru(e){var t=null;return function(e){return e.b.get(du,e.a).then(function(e){return so(e)})}(e.g).then(function(n){return t=n,hu((n=e.g).b,du,n.a)}).then(function(){return t})}(t=Tu.prototype).ga=function(){return this.za?this.za:this.za=(tr(void 0)?er().then(function(){return new be(function(e,t){var n=a.document,r=setTimeout(function(){t(Error("Cordova framework is not ready."))},1e3);n.addEventListener("deviceready",function(){clearTimeout(r),e()},!1)})}):Ae(Error("Cordova must run in an Android or iOS file scheme."))).then(function(){if("function"!=typeof pr("universalLinks.subscribe",a))throw ku("cordova-universal-links-plugin-fix is not installed");if(void 0===pr("BuildInfo.packageName",a))throw ku("cordova-plugin-buildinfo is not installed");if("function"!=typeof pr("cordova.plugins.browsertab.openUrl",a))throw ku("cordova-plugin-browsertab is not installed");if("function"!=typeof pr("cordova.InAppBrowser.open",a))throw ku("cordova-plugin-inappbrowser is not installed")},function(){throw new Hr("cordova-not-ready")})},t.Ea=function(e,t){return t(new Hr("operation-not-supported-in-this-environment")),Ie()},t.Db=function(){return Ae(new Hr("operation-not-supported-in-this-environment"))},t.Ob=function(){return!1},t.Mb=function(){return!0},t.Hb=function(){return!0},t.Ca=function(e,t,n){if(this.c)return Ae(new Hr("redirect-operation-pending"));var r=this,i=a.document,o=null,s=null,u=null,c=null;return this.c=Ie().then(function(){return io(t),Nu(r)}).then(function(){return function(e,t,n,r){var i=function(){for(var e=20,t=[];0<e;)t.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(Math.floor(62*Math.random()))),e--;return t.join("")}(),o=new oo(t,r,null,i,new Hr("no-auth-event")),s=pr("BuildInfo.packageName",a);if("string"!=typeof s)throw new Hr("invalid-cordova-configuration");var u=pr("BuildInfo.displayName",a),c={};if(lr().toLowerCase().match(/iphone|ipad|ipod/))c.ibi=s;else{if(!lr().toLowerCase().match(/android/))return Ae(new Hr("operation-not-supported-in-this-environment"));c.apn=s}u&&(c.appDisplayName=u),i=Iu(i),c.sessionId=i;var h=Ia(e.l,e.i,e.m,t,n,null,r,e.o,c,e.u);return e.ga().then(function(){var t=e.h;return e.v.a.set(du,o.w(),t)}).then(function(){var t=pr("cordova.plugins.browsertab.isAvailable",a);if("function"!=typeof t)throw new Hr("invalid-cordova-configuration");var n=null;t(function(t){if(t){if("function"!=typeof(n=pr("cordova.plugins.browsertab.openUrl",a)))throw new Hr("invalid-cordova-configuration");n(h)}else{if("function"!=typeof(n=pr("cordova.InAppBrowser.open",a)))throw new Hr("invalid-cordova-configuration");t=lr(),e.a=n(h,t.match(/(iPad|iPhone|iPod).*OS 7_\d/i)||t.match(/(iPad|iPhone|iPod).*OS 8_\d/i)?"_blank":"_system","location=yes")}})})}(r,e,t,n)}).then(function(){return new be(function(e,t){s=function(){var t=pr("cordova.plugins.browsertab.close",a);return e(),"function"==typeof t&&t(),r.a&&"function"==typeof r.a.close&&(r.a.close(),r.a=null),!1},r.wa(s),u=function(){o||(o=Bt(2e3).then(function(){t(new Hr("redirect-cancelled-by-user"))}))},c=function(){Tr()&&u()},i.addEventListener("resume",u,!1),lr().toLowerCase().match(/android/)||i.addEventListener("visibilitychange",c,!1)}).s(function(e){return Ru(r).then(function(){throw e})})}).ia(function(){u&&i.removeEventListener("resume",u,!1),c&&i.removeEventListener("visibilitychange",c,!1),o&&o.cancel(),s&&r.La(s),r.c=null})},t.wa=function(e){this.b.push(e),Nu(this).s(function(t){"auth/invalid-cordova-configuration"===t.code&&(t=new oo("unknown",null,null,null,new Hr("no-auth-event")),e(t))})},t.La=function(e){W(this.b,function(t){return t==e})};var Ou={name:"pendingRedirect",B:"session"};function xu(e){return hu(e.b,Ou,e.a)}function Pu(e,t,n){this.i={},this.u=0,this.A=e,this.l=t,this.o=n,this.h=[],this.f=!1,this.m=S(this.cb,this),this.b=new Wu,this.v=new Yu,this.g=new function(e){this.a=e,this.b=au()}(this.l+":"+this.o),this.c={},this.c.unknown=this.b,this.c.signInViaRedirect=this.b,this.c.linkViaRedirect=this.b,this.c.reauthViaRedirect=this.b,this.c.signInViaPopup=this.v,this.c.linkViaPopup=this.v,this.c.reauthViaPopup=this.v,this.a=Du(this.A,this.l,this.o,li)}function Du(e,t,n,i){var o=r.a.SDK_VERSION||null;return tr()?new Tu(e,t,n,o,i):new Sa(e,t,n,o,i)}function Mu(e){e.f||(e.f=!0,e.a.wa(e.m));var t=e.a;return e.a.ga().s(function(n){throw e.a==t&&e.reset(),n})}function Lu(e){e.a.Mb()&&Mu(e).s(function(t){var n=new oo("unknown",null,null,null,new Hr("operation-not-supported-in-this-environment"));Uu(t)&&e.cb(n)}),e.a.Hb()||Hu(e.b)}(t=Pu.prototype).reset=function(){this.f=!1,this.a.La(this.m),this.a=Du(this.A,this.l,this.o),this.i={}},t.Za=function(){this.b.Za()},t.subscribe=function(e){if(V(this.h,e)||this.h.push(e),!this.f){var t=this;(function(e){return e.b.get(Ou,e.a).then(function(e){return"pending"==e})})(this.g).then(function(e){e?xu(t.g).then(function(){Mu(t).s(function(e){var n=new oo("unknown",null,null,null,new Hr("operation-not-supported-in-this-environment"));Uu(e)&&t.cb(n)})}):Lu(t)}).s(function(){Lu(t)})}},t.unsubscribe=function(e){W(this.h,function(t){return t==e})},t.cb=function(e){if(!e)throw new Hr("invalid-auth-event");if(6e5<=T()-this.u&&(this.i={},this.u=0),e&&e.getUid()&&this.i.hasOwnProperty(e.getUid()))return!1;for(var t=!1,n=0;n<this.h.length;n++){var r=this.h[n];if(r.xb(e.c,e.b)){(t=this.c[e.c])&&(t.h(e,r),e&&(e.f||e.b)&&(this.i[e.getUid()]=!0,this.u=T())),t=!0;break}}return Hu(this.b),t};var ju=new Cr(2e3,1e4),Fu=new Cr(3e4,6e4);function Bu(e,t,n,r,i,o){return e.a.Db(t,n,r,function(){e.f||(e.f=!0,e.a.wa(e.m))},function(){e.reset()},i,o)}function Uu(e){return!(!e||"auth/cordova-not-ready"!=e.code)}Pu.prototype.fa=function(){return this.b.fa()},Pu.prototype.Ca=function(e,t,n){var r,i=this;return function(e){return e.b.set(Ou,"pending",e.a)}(this.g).then(function(){return i.a.Ca(e,t,n).s(function(e){if(Uu(e))throw new Hr("operation-not-supported-in-this-environment");return r=e,xu(i.g).then(function(){throw r})}).then(function(){return i.a.Ob()?new be(function(){}):xu(i.g).then(function(){return i.fa()}).then(function(){}).s(function(){})})})},Pu.prototype.Ea=function(e,t,n,r){return this.a.Ea(n,function(n){e.ha(t,null,n,r)},ju.get())};var Vu={};function qu(e,t,n){var r=t+":"+n;return Vu[r]||(Vu[r]=new Pu(e,t,n)),Vu[r]}function Wu(){this.b=null,this.f=[],this.c=[],this.a=null,this.i=this.g=!1}function Hu(e){e.g||(e.g=!0,zu(e,!1,null,null))}function Gu(e,t){if(e.b=function(){return Ie(t)},e.f.length)for(var n=0;n<e.f.length;n++)e.f[n](t)}function zu(e,t,n,r){t?r?function(e,t){if(e.b=function(){return Ae(t)},e.c.length)for(var n=0;n<e.c.length;n++)e.c[n](t)}(e,r):Gu(e,n):Gu(e,{user:null}),e.f=[],e.c=[]}function Yu(){}function Qu(){this.ub=!1,Object.defineProperty(this,"appVerificationDisabled",{get:function(){return this.ub},set:function(e){this.ub=e},enumerable:!1})}function Ku(e,t){this.a=t,xr(this,"verificationId",e)}function $u(e,t,n,r){return new to(e).Va(t,n).then(function(e){return new Ku(e,r)})}function Xu(e,t,n){if(this.h=e,this.i=t,this.g=n,this.c=3e4,this.f=96e4,this.b=null,this.a=this.c,this.f<this.c)throw Error("Proactive refresh lower bound greater than upper bound!")}function Ju(e){this.f=e,this.b=this.a=null,this.c=0}function Zu(e,t){var n=t[vs],r=t.refreshToken;t=ec(t.expiresIn),e.b=n,e.c=t,e.a=r}function ec(e){return T()+1e3*parseInt(e,10)}function tc(e,t){return function(e,t){return new be(function(n,r){"refresh_token"==t.grant_type&&t.refresh_token||"authorization_code"==t.grant_type&&t.code?Cs(e,e.i+"?key="+encodeURIComponent(e.b),function(e){e?e.error?r(fa(e)):e.access_token&&e.refresh_token?n(e):r(new Hr("internal-error")):r(new Hr("network-request-failed"))},"POST",ln(t).toString(),e.f,e.m.get()):r(new Hr("internal-error"))})}(e.f,t).then(function(t){return e.b=t.access_token,e.c=ec(t.expires_in),e.a=t.refresh_token,{accessToken:e.b,expirationTime:e.c,refreshToken:e.a}}).s(function(t){throw"auth/user-token-expired"==t.code&&(e.a=null),t})}function nc(e,t){this.a=e||null,this.b=t||null,Pr(this,{lastSignInTime:kr(t||null),creationTime:kr(e||null)})}function rc(e,t){for(var n in lt.call(this,e),t)this[n]=t[n]}function ic(e,t,n){this.G=[],this.l=e.apiKey,this.o=e.appName,this.u=e.authDomain||null,e=r.a.SDK_VERSION?hr(r.a.SDK_VERSION):null,this.c=new ms(this.l,di(li),e),this.h=new Ju(this.c),lc(this,t[vs]),Zu(this.h,t),xr(this,"refreshToken",this.h.a),fc(this,n||{}),Dt.call(this),this.I=!1,this.u&&fr()&&(this.a=qu(this.u,this.l,this.o)),this.N=[],this.i=null,this.A=function(e){return new Xu(function(){return e.F(!0)},function(e){return!(!e||"auth/network-request-failed"!=e.code)},function(){var t=e.h.c-T()-3e5;return 0<t?t:0})}(this),this.V=S(this.Ha,this);var i=this;this.ka=null,this.ta=function(e){i.pa(e.g)},this.X=null,this.O=[],this.sa=function(e){sc(i,e.c)},this.W=null}function oc(e,t){e.X&&Tt(e.X,"languageCodeChanged",e.ta),(e.X=t)&&Et(t,"languageCodeChanged",e.ta)}function sc(e,t){e.O=t,Ss(e.c,r.a.SDK_VERSION?hr(r.a.SDK_VERSION,e.O):null)}function ac(e,t){e.W&&Tt(e.W,"frameworkChanged",e.sa),(e.W=t)&&Et(t,"frameworkChanged",e.sa)}function uc(e){try{return r.a.app(e.o).auth()}catch(t){throw new Hr("internal-error","No firebase.auth.Auth instance is available for the Firebase App '"+e.o+"'!")}}function cc(e){e.D||e.A.b||(e.A.start(),Tt(e,"tokenChanged",e.V),Et(e,"tokenChanged",e.V))}function hc(e){Tt(e,"tokenChanged",e.V),e.A.stop()}function lc(e,t){e.ra=t,xr(e,"_lat",t)}function pc(e){for(var t=[],n=0;n<e.N.length;n++)t.push(e.N[n](e));return Re(t).then(function(){return e})}function dc(e){e.a&&!e.I&&(e.I=!0,e.a.subscribe(e))}function fc(e,t){Pr(e,{uid:t.uid,displayName:t.displayName||null,photoURL:t.photoURL||null,email:t.email||null,emailVerified:t.emailVerified||!1,phoneNumber:t.phoneNumber||null,isAnonymous:t.isAnonymous||!1,metadata:new nc(t.createdAt,t.lastLoginAt),providerData:[]})}function mc(){}function yc(e){return Ie().then(function(){if(e.D)throw new Hr("app-deleted")})}function vc(e){return B(e.providerData,function(e){return e.providerId})}function gc(e,t){t&&(_c(e,t.providerId),e.providerData.push(t))}function _c(e,t){W(e.providerData,function(e){return e.providerId==t})}function bc(e,t,n){("uid"!=t||n)&&e.hasOwnProperty(t)&&xr(e,t,n)}function wc(e,t){e!=t&&(Pr(e,{uid:t.uid,displayName:t.displayName,photoURL:t.photoURL,email:t.email,emailVerified:t.emailVerified,phoneNumber:t.phoneNumber,isAnonymous:t.isAnonymous,providerData:[]}),t.metadata?xr(e,"metadata",function(e){return new nc(e.a,e.b)}(t.metadata)):xr(e,"metadata",new nc),F(t.providerData,function(t){gc(e,t)}),function(e,t){e.b=t.b,e.a=t.a,e.c=t.c}(e.h,t.h),xr(e,"refreshToken",e.h.a))}function Ec(e){return e.F().then(function(t){var n=e.isAnonymous;return function(e,t){return pa(e.c,Ys,{idToken:t}).then(S(e.wc,e))}(e,t).then(function(){return n||bc(e,"isAnonymous",!1),t})})}function Sc(e,t){t[vs]&&e.ra!=t[vs]&&(Zu(e.h,t),e.dispatchEvent(new rc("tokenChanged")),lc(e,t[vs]),bc(e,"refreshToken",e.h.a))}function Cc(e,t){return Ec(e).then(function(){if(V(vc(e),t))return pc(e).then(function(){throw new Hr("provider-already-linked")})})}function Tc(e,t,n){return Dr({user:e,credential:ro(t),additionalUserInfo:t=gi(t),operationType:n})}function kc(e,t){return Sc(e,t),e.reload().then(function(){return e})}function Ic(e,t,n,i,o){if(!fr())return Ae(new Hr("operation-not-supported-in-this-environment"));if(e.i&&!o)return Ae(e.i);var s=vi(n.providerId),a=wr(e.uid+":::"),u=null;(!vr()||nr())&&e.u&&n.isOAuthProvider&&(u=Ia(e.u,e.l,e.o,t,n,null,a,r.a.SDK_VERSION||null));var c=Xn(u,s&&s.Ba,s&&s.Aa);return i=i().then(function(){if(Nc(e),!o)return e.F().then(function(){})}).then(function(){return Bu(e.a,c,t,n,a,!!u)}).then(function(){return new be(function(n,r){e.ha(t,null,new Hr("cancelled-popup-request"),e.g||null),e.f=n,e.v=r,e.g=a,e.b=e.a.Ea(e,t,c,a)})}).then(function(e){return c&&$n(c),e?Dr(e):null}).s(function(e){throw c&&$n(c),e}),Rc(e,i,o)}function Ac(e,t,n,r,i){if(!fr())return Ae(new Hr("operation-not-supported-in-this-environment"));if(e.i&&!i)return Ae(e.i);var o=null,s=wr(e.uid+":::");return r=r().then(function(){if(Nc(e),!i)return e.F().then(function(){})}).then(function(){return e.aa=s,pc(e)}).then(function(t){return e.ba&&(t=(t=e.ba).b.set(xc,e.w(),t.a)),t}).then(function(){return e.a.Ca(t,n,s)}).s(function(t){if(o=t,e.ba)return Pc(e.ba);throw o}).then(function(){if(o)throw o}),Rc(e,r,i)}function Nc(e){if(!e.a||!e.I){if(e.a&&!e.I)throw new Hr("internal-error");throw new Hr("auth-domain-config-required")}}function Rc(e,t,n){var r=function(e,t,n){return e.i&&!n?(t.cancel(),Ae(e.i)):t.s(function(t){throw!t||"auth/user-disabled"!=t.code&&"auth/user-token-expired"!=t.code||(e.i||e.dispatchEvent(new rc("userInvalidated")),e.i=t),t})}(e,t,n);return e.G.push(r),r.ia(function(){q(e.G,r)}),r}function Oc(e){if(!e.apiKey)return null;var t={apiKey:e.apiKey,authDomain:e.authDomain,appName:e.appName},n={};if(!(e.stsTokenManager&&e.stsTokenManager.accessToken&&e.stsTokenManager.expirationTime))return null;n[vs]=e.stsTokenManager.accessToken,n.refreshToken=e.stsTokenManager.refreshToken||null,n.expiresIn=(e.stsTokenManager.expirationTime-T())/1e3;var r=new ic(t,n,e);return e.providerData&&F(e.providerData,function(e){e&&gc(r,Dr(e))}),e.redirectEventId&&(r.aa=e.redirectEventId),r}Wu.prototype.reset=function(){this.b=null,this.a&&(this.a.cancel(),this.a=null)},Wu.prototype.h=function(e,t){if(e){this.reset(),this.g=!0;var n=e.c,r=e.b,i=e.a&&"auth/web-storage-unsupported"==e.a.code,o=e.a&&"auth/operation-not-supported-in-this-environment"==e.a.code;this.i=!(!i&&!o),"unknown"!=n||i||o?e.a?(zu(this,!0,null,e.a),Ie()):t.xa(n,r)?function(e,t,n){n=n.xa(t.c,t.b);var r=t.g,i=t.f,o=t.h,s=!!t.c.match(/Redirect$/);n(r,i,o).then(function(t){zu(e,s,t,null)}).s(function(t){zu(e,s,null,t)})}(this,e,t):Ae(new Hr("invalid-auth-event")):(zu(this,!1,null,null),Ie())}else Ae(new Hr("invalid-auth-event"))},Wu.prototype.Za=function(){this.g&&!this.i&&zu(this,!1,null,null)},Wu.prototype.fa=function(){var e=this;return new be(function(t,n){e.b?e.b().then(t,n):(e.f.push(t),e.c.push(n),function(e){var t=new Hr("timeout");e.a&&e.a.cancel(),e.a=Bt(Fu.get()).then(function(){e.b||(e.g=!0,zu(e,!0,null,t))})}(e))})},Yu.prototype.h=function(e,t){if(e){var n=e.c,r=e.b;e.a?(t.ha(e.c,null,e.a,e.b),Ie()):t.xa(n,r)?function(e,t){var n=e.b,r=e.c;t.xa(r,n)(e.g,e.f,e.h).then(function(e){t.ha(r,e,null,n)}).s(function(e){t.ha(r,null,e,n)})}(e,t):Ae(new Hr("invalid-auth-event"))}else Ae(new Hr("invalid-auth-event"))},Ku.prototype.confirm=function(e){return e=no(this.verificationId,e),this.a(e)},Xu.prototype.start=function(){this.a=this.c,function e(t,n){t.stop();t.b=Bt(function(e,t){return t?(e.a=e.c,e.g()):(t=e.a,e.a*=2,e.a>e.f&&(e.a=e.f),t)}(t,n)).then(function(){return function(){var e=a.document,t=null;return Tr()||!e?Ie():new be(function(n){t=function(){Tr()&&(e.removeEventListener("visibilitychange",t,!1),n())},e.addEventListener("visibilitychange",t,!1)}).s(function(n){throw e.removeEventListener("visibilitychange",t,!1),n})}()}).then(function(){return t.h()}).then(function(){e(t,!0)}).s(function(n){t.i(n)&&e(t,!1)})}(this,!0)},Xu.prototype.stop=function(){this.b&&(this.b.cancel(),this.b=null)},Ju.prototype.w=function(){return{apiKey:this.f.b,refreshToken:this.a,accessToken:this.b,expirationTime:this.c}},Ju.prototype.getToken=function(e){return e=!!e,this.b&&!this.a?Ae(new Hr("user-token-expired")):e||!this.b||T()>this.c-3e4?this.a?tc(this,{grant_type:"refresh_token",refresh_token:this.a}):Ie(null):Ie({accessToken:this.b,expirationTime:this.c,refreshToken:this.a})},nc.prototype.w=function(){return{lastLoginAt:this.b,createdAt:this.a}},k(rc,lt),k(ic,Dt),ic.prototype.pa=function(e){this.ka=e,Es(this.c,e)},ic.prototype.ea=function(){return this.ka},ic.prototype.ya=function(){return G(this.O)},ic.prototype.Ha=function(){this.A.b&&(this.A.stop(),this.A.start())},xr(ic.prototype,"providerId","firebase"),(t=ic.prototype).reload=function(){var e=this;return Rc(this,yc(this).then(function(){return Ec(e).then(function(){return pc(e)}).then(mc)}))},t.ac=function(e){return this.F(e).then(function(e){return new function(e){var t=hi(e);if(!(t&&t.exp&&t.auth_time&&t.iat))throw new Hr("internal-error","An internal error occurred. The token obtained by Firebase appears to be malformed. Please retry the operation.");Pr(this,{token:e,expirationTime:kr(1e3*t.exp),authTime:kr(1e3*t.auth_time),issuedAtTime:kr(1e3*t.iat),signInProvider:t.firebase&&t.firebase.sign_in_provider?t.firebase.sign_in_provider:null,claims:t})}(e)})},t.F=function(e){var t=this;return Rc(this,yc(this).then(function(){return t.h.getToken(e)}).then(function(e){if(!e)throw new Hr("internal-error");return e.accessToken!=t.ra&&(lc(t,e.accessToken),t.dispatchEvent(new rc("tokenChanged"))),bc(t,"refreshToken",e.refreshToken),e.accessToken}))},t.wc=function(e){if(!(e=e.users)||!e.length)throw new Hr("internal-error");fc(this,{uid:(e=e[0]).localId,displayName:e.displayName,photoURL:e.photoUrl,email:e.email,emailVerified:!!e.emailVerified,phoneNumber:e.phoneNumber,lastLoginAt:e.lastLoginAt,createdAt:e.createdAt});for(var t=function(e){return(e=e.providerUserInfo)&&e.length?B(e,function(e){return new function(e,t,n,r,i,o){Pr(this,{uid:e,displayName:r||null,photoURL:i||null,email:n||null,phoneNumber:o||null,providerId:t})}(e.rawId,e.providerId,e.email,e.displayName,e.photoUrl,e.phoneNumber)}):[]}(e),n=0;n<t.length;n++)gc(this,t[n]);bc(this,"isAnonymous",!(this.email&&e.passwordHash||this.providerData&&this.providerData.length))},t.xc=function(e){return Rr("firebase.User.prototype.reauthenticateAndRetrieveDataWithCredential is deprecated. Please use firebase.User.prototype.reauthenticateWithCredential instead."),this.hb(e)},t.hb=function(e){var t=this,n=null;return Rc(this,e.f(this.c,this.uid).then(function(e){return Sc(t,e),n=Tc(t,e,"reauthenticate"),t.i=null,t.reload()}).then(function(){return n}),!0)},t.oc=function(e){return Rr("firebase.User.prototype.linkAndRetrieveDataWithCredential is deprecated. Please use firebase.User.prototype.linkWithCredential instead."),this.fb(e)},t.fb=function(e){var t=this,n=null;return Rc(this,Cc(this,e.providerId).then(function(){return t.F()}).then(function(n){return e.b(t.c,n)}).then(function(e){return n=Tc(t,e,"link"),kc(t,e)}).then(function(){return n}))},t.pc=function(e,t){var n=this;return Rc(this,Cc(this,"phone").then(function(){return $u(uc(n),e,t,S(n.fb,n))}))},t.yc=function(e,t){var n=this;return Rc(this,Ie().then(function(){return $u(uc(n),e,t,S(n.hb,n))}),!0)},t.rb=function(e){var t=this;return Rc(this,this.F().then(function(n){return t.c.rb(n,e)}).then(function(e){return Sc(t,e),t.reload()}))},t.Pc=function(e){var t=this;return Rc(this,this.F().then(function(n){return e.b(t.c,n)}).then(function(e){return Sc(t,e),t.reload()}))},t.sb=function(e){var t=this;return Rc(this,this.F().then(function(n){return t.c.sb(n,e)}).then(function(e){return Sc(t,e),t.reload()}))},t.tb=function(e){if(void 0===e.displayName&&void 0===e.photoURL)return yc(this);var t=this;return Rc(this,this.F().then(function(n){return t.c.tb(n,{displayName:e.displayName,photoUrl:e.photoURL})}).then(function(e){return Sc(t,e),bc(t,"displayName",e.displayName||null),bc(t,"photoURL",e.photoUrl||null),F(t.providerData,function(e){"password"===e.providerId&&(xr(e,"displayName",t.displayName),xr(e,"photoURL",t.photoURL))}),pc(t)}).then(mc))},t.Nc=function(e){var t=this;return Rc(this,Ec(this).then(function(n){return V(vc(t),e)?function(e,t,n){return pa(e,Hs,{idToken:t,deleteProvider:n})}(t.c,n,[e]).then(function(e){var n={};return F(e.providerUserInfo||[],function(e){n[e.providerId]=!0}),F(vc(t),function(e){n[e]||_c(t,e)}),n[to.PROVIDER_ID]||xr(t,"phoneNumber",null),pc(t)}):pc(t).then(function(){throw new Hr("no-such-provider")})}))},t.delete=function(){var e=this;return Rc(this,this.F().then(function(t){return pa(e.c,Ws,{idToken:t})}).then(function(){e.dispatchEvent(new rc("userDeleted"))})).then(function(){for(var t=0;t<e.G.length;t++)e.G[t].cancel("app-deleted");oc(e,null),ac(e,null),e.G=[],e.D=!0,hc(e),xr(e,"refreshToken",null),e.a&&e.a.unsubscribe(e)})},t.xb=function(e,t){return!!("linkViaPopup"==e&&(this.g||null)==t&&this.f||"reauthViaPopup"==e&&(this.g||null)==t&&this.f||"linkViaRedirect"==e&&(this.aa||null)==t||"reauthViaRedirect"==e&&(this.aa||null)==t)},t.ha=function(e,t,n,r){"linkViaPopup"!=e&&"reauthViaPopup"!=e||r!=(this.g||null)||(n&&this.v?this.v(n):t&&!n&&this.f&&this.f(t),this.b&&(this.b.cancel(),this.b=null),delete this.f,delete this.v)},t.xa=function(e,t){return"linkViaPopup"==e&&t==(this.g||null)?S(this.Bb,this):"reauthViaPopup"==e&&t==(this.g||null)?S(this.Cb,this):"linkViaRedirect"==e&&(this.aa||null)==t?S(this.Bb,this):"reauthViaRedirect"==e&&(this.aa||null)==t?S(this.Cb,this):null},t.qc=function(e){var t=this;return Ic(this,"linkViaPopup",e,function(){return Cc(t,e.providerId).then(function(){return pc(t)})},!1)},t.zc=function(e){return Ic(this,"reauthViaPopup",e,function(){return Ie()},!0)},t.rc=function(e){var t=this;return Ac(this,"linkViaRedirect",e,function(){return Cc(t,e.providerId)},!1)},t.Ac=function(e){return Ac(this,"reauthViaRedirect",e,function(){return Ie()},!0)},t.Bb=function(e,t,n){var r=this;this.b&&(this.b.cancel(),this.b=null);var i=null;return Rc(this,this.F().then(function(i){return Ls(r.c,{requestUri:e,postBody:n,sessionId:t,idToken:i})}).then(function(e){return i=Tc(r,e,"link"),kc(r,e)}).then(function(){return i}))},t.Cb=function(e,t,n){var r=this;this.b&&(this.b.cancel(),this.b=null);var i=null;return Rc(this,Ie().then(function(){return Ni(js(r.c,{requestUri:e,sessionId:t,postBody:n}),r.uid)}).then(function(e){return i=Tc(r,e,"reauthenticate"),Sc(r,e),r.i=null,r.reload()}).then(function(){return i}),!0)},t.kb=function(e){var t=this,n=null;return Rc(this,this.F().then(function(t){return n=t,void 0===e||ae(e)?{}:ii(new Qr(e))}).then(function(e){return t.c.kb(n,e)}).then(function(e){if(t.email!=e)return t.reload()}).then(function(){}))},t.toJSON=function(){return this.w()},t.w=function(){var e={uid:this.uid,displayName:this.displayName,photoURL:this.photoURL,email:this.email,emailVerified:this.emailVerified,phoneNumber:this.phoneNumber,isAnonymous:this.isAnonymous,providerData:[],apiKey:this.l,appName:this.o,authDomain:this.u,stsTokenManager:this.h.w(),redirectEventId:this.aa||null};return this.metadata&&pe(e,this.metadata.w()),F(this.providerData,function(t){e.providerData.push(function(e){var t,n={};for(t in e)e.hasOwnProperty(t)&&(n[t]=e[t]);return n}(t))}),e};var xc={name:"redirectUser",B:"session"};function Pc(e){return hu(e.b,xc,e.a)}function Dc(e){this.a=e,this.b=au(),this.c=null,this.f=function(e){var t=jc("local"),n=jc("session"),r=jc("none");return function(e,t,n){var r=cu(t,n),i=uu(e,t.B);return e.get(t,n).then(function(o){var s=null;try{s=br(a.localStorage.getItem(r))}catch(e){}if(s&&!o)return a.localStorage.removeItem(r),e.set(t,s,n);s&&o&&"localStorage"!=i.type&&a.localStorage.removeItem(r)})}(e.b,t,e.a).then(function(){return e.b.get(n,e.a)}).then(function(i){return i?n:e.b.get(r,e.a).then(function(n){return n?r:e.b.get(t,e.a).then(function(n){return n?t:e.b.get(Lc,e.a).then(function(e){return e?jc(e):t})})})}).then(function(t){return e.c=t,Mc(e,t.B)}).s(function(){e.c||(e.c=t)})}(this),this.b.addListener(jc("local"),this.a,S(this.g,this))}function Mc(e,t){var n,r=[];for(n in ou)ou[n]!==t&&r.push(hu(e.b,jc(ou[n]),e.a));return r.push(hu(e.b,Lc,e.a)),function(e){return new be(function(t,n){var r=e.length,i=[];if(r)for(var o=function(e,n){r--,i[e]=n,0==r&&t(i)},s=function(e){n(e)},a=0;a<e.length;a++)Ne(e[a],C(o,a),s);else t(i)})}(r)}Dc.prototype.g=function(){var e=this,t=jc("local");Vc(this,function(){return Ie().then(function(){return e.c&&"local"!=e.c.B?e.b.get(t,e.a):null}).then(function(n){if(n)return Mc(e,"local").then(function(){e.c=t})})})};var Lc={name:"persistence",B:"session"};function jc(e){return{name:"authUser",B:e}}function Fc(e,t){return Vc(e,function(){return e.b.set(e.c,t.w(),e.a)})}function Bc(e){return Vc(e,function(){return hu(e.b,e.c,e.a)})}function Uc(e,t){return Vc(e,function(){return e.b.get(e.c,e.a).then(function(e){return e&&t&&(e.authDomain=t),Oc(e||{})})})}function Vc(e,t){return e.f=e.f.then(t,t),e.f}function qc(e){if(this.l=!1,xr(this,"settings",new Qu),xr(this,"app",e),!Kc(this).options||!Kc(this).options.apiKey)throw new Hr("invalid-api-key");e=r.a.SDK_VERSION?hr(r.a.SDK_VERSION):null,this.c=new ms(Kc(this).options&&Kc(this).options.apiKey,di(li),e),this.N=[],this.o=[],this.I=[],this.Rb=r.a.INTERNAL.createSubscribe(S(this.kc,this)),this.O=void 0,this.Sb=r.a.INTERNAL.createSubscribe(S(this.mc,this)),Yc(this,null),this.h=new Dc(Kc(this).options.apiKey+":"+Kc(this).name),this.A=new function(e){this.a=e,this.b=au()}(Kc(this).options.apiKey+":"+Kc(this).name),this.V=Zc(this,function(e){var t=Kc(e).options.authDomain,n=function(e){var t=function(e,t){return e.b.get(xc,e.a).then(function(e){return e&&t&&(e.authDomain=t),Oc(e||{})})}(e.A,Kc(e).options.authDomain).then(function(t){return(e.D=t)&&(t.ba=e.A),Pc(e.A)});return Zc(e,t)}(e).then(function(){return Uc(e.h,t)}).then(function(t){return t?(t.ba=e.A,e.D&&(e.D.aa||null)==(t.aa||null)?t:t.reload().then(function(){return Fc(e.h,t).then(function(){return t})}).s(function(n){return"auth/network-request-failed"==n.code?t:Bc(e.h)})):null}).then(function(t){Yc(e,t||null)});return Zc(e,n)}(this)),this.i=Zc(this,function(e){return e.V.then(function(){return e.fa()}).s(function(){}).then(function(){if(!e.l)return e.ka()}).s(function(){}).then(function(){if(!e.l){e.X=!0;var t=e.h;t.b.addListener(jc("local"),t.a,e.ka)}})}(this)),this.X=!1,this.ka=S(this.Kc,this),this.Ha=S(this.Z,this),this.ra=S(this.Zb,this),this.sa=S(this.ic,this),this.ta=S(this.jc,this),function(e){var t=Kc(e).options.authDomain,n=Kc(e).options.apiKey;t&&fr()&&(e.Qb=e.V.then(function(){if(!e.l){if(e.a=qu(t,n,Kc(e).name),e.a.subscribe(e),$c(e)&&dc($c(e)),e.D){dc(e.D);var r=e.D;r.pa(e.ea()),oc(r,e),sc(r=e.D,e.G),ac(r,e),e.D=null}return e.a}}))}(this),this.INTERNAL={},this.INTERNAL.delete=S(this.delete,this),this.INTERNAL.logFramework=S(this.sc,this),this.u=0,Dt.call(this),function(e){Object.defineProperty(e,"lc",{get:function(){return this.ea()},set:function(e){this.pa(e)},enumerable:!1}),e.W=null}(this),this.G=[]}function Wc(e){lt.call(this,"languageCodeChanged"),this.g=e}function Hc(e){lt.call(this,"frameworkChanged"),this.c=e}function Gc(e){return e.Qb||Ae(new Hr("auth-domain-config-required"))}function zc(e,t){var n={};return n.apiKey=Kc(e).options.apiKey,n.authDomain=Kc(e).options.authDomain,n.appName=Kc(e).name,e.V.then(function(){return function(e,t,n,r){var i=new ic(e,t);return n&&(i.ba=n),r&&sc(i,r),i.reload().then(function(){return i})}(n,t,e.A,e.ya())}).then(function(t){return $c(e)&&t.uid==$c(e).uid?(wc($c(e),t),e.Z(t)):(Yc(e,t),dc(t),e.Z(t))}).then(function(){Jc(e)})}function Yc(e,t){$c(e)&&(function(e,t){W(e.N,function(e){return e==t})}($c(e),e.Ha),Tt($c(e),"tokenChanged",e.ra),Tt($c(e),"userDeleted",e.sa),Tt($c(e),"userInvalidated",e.ta),hc($c(e))),t&&(t.N.push(e.Ha),Et(t,"tokenChanged",e.ra),Et(t,"userDeleted",e.sa),Et(t,"userInvalidated",e.ta),0<e.u&&cc(t)),xr(e,"currentUser",t),t&&(t.pa(e.ea()),oc(t,e),sc(t,e.G),ac(t,e))}function Qc(e,t){var n=null,r=null;return Zc(e,t.then(function(t){return n=ro(t),r=gi(t),zc(e,t)}).then(function(){return Dr({user:$c(e),credential:n,additionalUserInfo:r,operationType:"signIn"})}))}function Kc(e){return e.app}function $c(e){return e.currentUser}function Xc(e){return $c(e)&&$c(e)._lat||null}function Jc(e){if(e.X){for(var t=0;t<e.o.length;t++)e.o[t]&&e.o[t](Xc(e));if(e.O!==e.getUid()&&e.I.length)for(e.O=e.getUid(),t=0;t<e.I.length;t++)e.I[t]&&e.I[t](Xc(e))}}function Zc(e,t){return e.N.push(t),t.ia(function(){q(e.N,t)}),t}function eh(){}function th(){this.a={},this.b=1e12}Dc.prototype.nb=function(e){var t=null,n=this;return function(e){var t=new Hr("invalid-persistence-type"),n=new Hr("unsupported-persistence-type");e:{for(r in ou)if(ou[r]==e){var r=!0;break e}r=!1}if(!r||"string"!=typeof e)throw t;switch(ir()){case"ReactNative":if("session"===e)throw n;break;case"Node":if("none"!==e)throw n;break;default:if(!dr()&&"none"!==e)throw n}}(e),Vc(this,function(){return e!=n.c.B?n.b.get(n.c,n.a).then(function(r){return t=r,Mc(n,e)}).then(function(){if(n.c=jc(e),t)return n.b.set(n.c,t,n.a)}):Ie()})},k(qc,Dt),k(Wc,lt),k(Hc,lt),(t=qc.prototype).nb=function(e){return Zc(this,e=this.h.nb(e))},t.pa=function(e){this.W===e||this.l||(this.W=e,Es(this.c,this.W),this.dispatchEvent(new Wc(this.ea())))},t.ea=function(){return this.W},t.Qc=function(){var e=a.navigator;this.pa(e&&(e.languages&&e.languages[0]||e.language||e.userLanguage)||null)},t.sc=function(e){this.G.push(e),Ss(this.c,r.a.SDK_VERSION?hr(r.a.SDK_VERSION,this.G):null),this.dispatchEvent(new Hc(this.G))},t.ya=function(){return G(this.G)},t.toJSON=function(){return{apiKey:Kc(this).options.apiKey,authDomain:Kc(this).options.authDomain,appName:Kc(this).name,currentUser:$c(this)&&$c(this).w()}},t.xb=function(e,t){switch(e){case"unknown":case"signInViaRedirect":return!0;case"signInViaPopup":return this.g==t&&!!this.f;default:return!1}},t.ha=function(e,t,n,r){"signInViaPopup"==e&&this.g==r&&(n&&this.v?this.v(n):t&&!n&&this.f&&this.f(t),this.b&&(this.b.cancel(),this.b=null),delete this.f,delete this.v)},t.xa=function(e,t){return"signInViaRedirect"==e||"signInViaPopup"==e&&this.g==t&&this.f?S(this.Yb,this):null},t.Yb=function(e,t,n){var r=this;e={requestUri:e,postBody:n,sessionId:t},this.b&&(this.b.cancel(),this.b=null);var i=null,o=null,s=Ms(r.c,e).then(function(e){return i=ro(e),o=gi(e),e});return Zc(this,e=r.V.then(function(){return s}).then(function(e){return zc(r,e)}).then(function(){return Dr({user:$c(r),credential:i,additionalUserInfo:o,operationType:"signIn"})}))},t.Ic=function(e){if(!fr())return Ae(new Hr("operation-not-supported-in-this-environment"));var t=this,n=vi(e.providerId),i=wr(),o=null;(!vr()||nr())&&Kc(this).options.authDomain&&e.isOAuthProvider&&(o=Ia(Kc(this).options.authDomain,Kc(this).options.apiKey,Kc(this).name,"signInViaPopup",e,null,i,r.a.SDK_VERSION||null));var s=Xn(o,n&&n.Ba,n&&n.Aa);return Zc(this,n=Gc(this).then(function(t){return Bu(t,s,"signInViaPopup",e,i,!!o)}).then(function(){return new be(function(e,n){t.ha("signInViaPopup",null,new Hr("cancelled-popup-request"),t.g),t.f=e,t.v=n,t.g=i,t.b=t.a.Ea(t,"signInViaPopup",s,i)})}).then(function(e){return s&&$n(s),e?Dr(e):null}).s(function(e){throw s&&$n(s),e}))},t.Jc=function(e){if(!fr())return Ae(new Hr("operation-not-supported-in-this-environment"));var t=this;return Zc(this,Gc(this).then(function(){return function(e){return Vc(e,function(){return e.b.set(Lc,e.c.B,e.a)})}(t.h)}).then(function(){return t.a.Ca("signInViaRedirect",e)}))},t.fa=function(){if(!fr())return Ae(new Hr("operation-not-supported-in-this-environment"));var e=this;return Zc(this,Gc(this).then(function(){return e.a.fa()}).then(function(e){return e?Dr(e):null}))},t.Oc=function(e){if(!e)return Ae(new Hr("null-user"));var t=this,n={};n.apiKey=Kc(this).options.apiKey,n.authDomain=Kc(this).options.authDomain,n.appName=Kc(this).name;var r=function(e,t,n,r){t=t||{apiKey:e.l,authDomain:e.u,appName:e.o};var i=e.h,o={};return o[vs]=i.b,o.refreshToken=i.a,o.expiresIn=(i.c-T())/1e3,t=new ic(t,o),n&&(t.ba=n),r&&sc(t,r),wc(t,e),t}(e,n,t.A,t.ya());return Zc(this,this.i.then(function(){if(Kc(t).options.apiKey!=e.l)return r.reload()}).then(function(){return $c(t)&&e.uid==$c(t).uid?(wc($c(t),e),t.Z(e)):(Yc(t,r),dc(r),t.Z(r))}).then(function(){Jc(t)}))},t.pb=function(){var e=this;return Zc(this,this.i.then(function(){return $c(e)?(Yc(e,null),Bc(e.h).then(function(){Jc(e)})):Ie()}))},t.Kc=function(){var e=this;return Uc(this.h,Kc(this).options.authDomain).then(function(t){if(!e.l){var n;if(n=$c(e)&&t){n=$c(e).uid;var r=t.uid;n=void 0!==n&&null!==n&&""!==n&&void 0!==r&&null!==r&&""!==r&&n==r}if(n)return wc($c(e),t),$c(e).F();($c(e)||t)&&(Yc(e,t),t&&(dc(t),t.ba=e.A),e.a&&e.a.subscribe(e),Jc(e))}})},t.Z=function(e){return Fc(this.h,e)},t.Zb=function(){Jc(this),this.Z($c(this))},t.ic=function(){this.pb()},t.jc=function(){this.pb()},t.kc=function(e){var t=this;this.addAuthTokenListener(function(){e.next($c(t))})},t.mc=function(e){var t=this;!function(e,t){e.I.push(t),Zc(e,e.i.then(function(){!e.l&&V(e.I,t)&&e.O!==e.getUid()&&(e.O=e.getUid(),t(Xc(e)))}))}(this,function(){e.next($c(t))})},t.uc=function(e,t,n){var r=this;return this.X&&Promise.resolve().then(function(){v(e)?e($c(r)):v(e.next)&&e.next($c(r))}),this.Rb(e,t,n)},t.tc=function(e,t,n){var r=this;return this.X&&Promise.resolve().then(function(){r.O=r.getUid(),v(e)?e($c(r)):v(e.next)&&e.next($c(r))}),this.Sb(e,t,n)},t.$b=function(e){var t=this;return Zc(this,this.i.then(function(){return $c(t)?$c(t).F(e).then(function(e){return{accessToken:e}}):null}))},t.Ec=function(e){var t=this;return this.i.then(function(){return Qc(t,pa(t.c,aa,{token:e}))}).then(function(e){var n=e.user;return bc(n,"isAnonymous",!1),t.Z(n),e})},t.Fc=function(e,t){var n=this;return this.i.then(function(){return Qc(n,pa(n.c,ua,{email:e,password:t}))})},t.Ub=function(e,t){var n=this;return this.i.then(function(){return Qc(n,pa(n.c,Vs,{email:e,password:t}))})},t.Ra=function(e){var t=this;return this.i.then(function(){return Qc(t,e.la(t.c))})},t.Dc=function(e){return Rr("firebase.auth.Auth.prototype.signInAndRetrieveDataWithCredential is deprecated. Please use firebase.auth.Auth.prototype.signInWithCredential instead."),this.Ra(e)},t.ob=function(){var e=this;return this.i.then(function(){var t=$c(e);return t&&t.isAnonymous?Dr({user:t,credential:null,additionalUserInfo:Dr({providerId:null,isNewUser:!1}),operationType:"signIn"}):Qc(e,e.c.ob()).then(function(t){var n=t.user;return bc(n,"isAnonymous",!0),e.Z(n),t})})},t.getUid=function(){return $c(this)&&$c(this).uid||null},t.Tb=function(e){this.addAuthTokenListener(e),this.u++,0<this.u&&$c(this)&&cc($c(this))},t.Bc=function(e){var t=this;F(this.o,function(n){n==e&&t.u--}),0>this.u&&(this.u=0),0==this.u&&$c(this)&&hc($c(this)),this.removeAuthTokenListener(e)},t.addAuthTokenListener=function(e){var t=this;this.o.push(e),Zc(this,this.i.then(function(){t.l||V(t.o,e)&&e(Xc(t))}))},t.removeAuthTokenListener=function(e){W(this.o,function(t){return t==e})},t.delete=function(){this.l=!0;for(var e=0;e<this.N.length;e++)this.N[e].cancel("app-deleted");return this.N=[],this.h&&(e=this.h).b.removeListener(jc("local"),e.a,this.ka),this.a&&(this.a.unsubscribe(this),this.a.Za()),Promise.resolve()},t.Xb=function(e){return Zc(this,function(e,t){return pa(e,qs,{identifier:t,continueUri:mr()?Yn():"http://localhost"}).then(function(e){return e.signinMethods||[]})}(this.c,e))},t.nc=function(e){return!!Xi(e)},t.mb=function(e,t){var n=this;return Zc(this,Ie().then(function(){var e=new Qr(t);if(!e.c)throw new Hr("argument-error",Xr+" must be true when sending sign in link to email");return ii(e)}).then(function(t){return n.c.mb(e,t)}).then(function(){}))},t.Rc=function(e){return this.Ka(e).then(function(e){return e.data.email})},t.$a=function(e,t){return Zc(this,this.c.$a(e,t).then(function(){}))},t.Ka=function(e){return Zc(this,this.c.Ka(e).then(function(e){return new function(e){var t={},n=e[jr],r=e[Fr];if(!(e=e[Br])||e!=Lr&&!n)throw Error("Invalid provider user info!");t[Vr]=r||null,t[Ur]=n||null,xr(this,Wr,e),xr(this,qr,Mr(t))}(e)}))},t.Xa=function(e){return Zc(this,this.c.Xa(e).then(function(){}))},t.lb=function(e,t){var n=this;return Zc(this,Ie().then(function(){return void 0===t||ae(t)?{}:ii(new Qr(t))}).then(function(t){return n.c.lb(e,t)}).then(function(){}))},t.Hc=function(e,t){return Zc(this,$u(this,e,t,S(this.Ra,this)))},t.Gc=function(e,t){var n=this;return Zc(this,Ie().then(function(){var r=$i(e,t||Yn());return n.Ra(r)}))},eh.prototype.render=function(){},eh.prototype.reset=function(){},eh.prototype.getResponse=function(){},eh.prototype.execute=function(){};var nh=null;function rh(e,t){return(t=ih(t))&&e.a[t]||null}function ih(e){return(e=void 0===e?1e12:e)?e.toString():null}function oh(e,t){this.g=!1,this.c=t,this.a=this.b=null,this.h="invisible"!==this.c.size,this.f=jn(e);var n=this;this.i=function(){n.execute()},this.h?this.execute():Et(this.f,"click",this.i)}function sh(e){if(e.g)throw Error("reCAPTCHA mock was already deleted!")}function ah(){}th.prototype.render=function(e,t){return this.a[this.b.toString()]=new oh(e,t),this.b++},th.prototype.reset=function(e){var t=rh(this,e);e=ih(e),t&&e&&(t.delete(),delete this.a[e])},th.prototype.getResponse=function(e){return(e=rh(this,e))?e.getResponse():null},th.prototype.execute=function(e){(e=rh(this,e))&&e.execute()},oh.prototype.getResponse=function(){return sh(this),this.b},oh.prototype.execute=function(){sh(this);var e=this;this.a||(this.a=setTimeout(function(){e.b=function(){for(var e=50,t=[];0<e;)t.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(Math.floor(62*Math.random()))),e--;return t.join("")}();var t=e.c.callback,n=e.c["expired-callback"];if(t)try{t(e.b)}catch(e){}e.a=setTimeout(function(){if(e.a=null,e.b=null,n)try{n()}catch(e){}e.h&&e.execute()},6e4)},500))},oh.prototype.delete=function(){sh(this),this.g=!0,clearTimeout(this.a),this.a=null,Tt(this.f,"click",this.i)},ah.prototype.g=function(){return nh||(nh=new th),Ie(nh)},ah.prototype.c=function(){};var uh=null;function ch(){this.b=a.grecaptcha?1/0:0,this.f=null,this.a="__rcb"+Math.floor(1e6*Math.random()).toString()}var hh=new gn(wn,"https://www.google.com/recaptcha/api.js?onload=%{onload}&render=explicit&hl=%{hl}"),lh=new Cr(3e4,6e4);ch.prototype.g=function(e){var t=this;return new be(function(n,r){var i=setTimeout(function(){r(new Hr("network-request-failed"))},lh.get());!a.grecaptcha||e!==t.f&&!t.b?(a[t.a]=function(){if(a.grecaptcha){t.f=e;var o=a.grecaptcha.render;a.grecaptcha.render=function(e,n){return e=o(e,n),t.b++,e},clearTimeout(i),n(a.grecaptcha)}else clearTimeout(i),r(new Hr("internal-error"));delete a[t.a]},Ie(us(Cn(hh,{onload:t.a,hl:e||""}))).s(function(){clearTimeout(i),r(new Hr("internal-error","Unable to load external reCAPTCHA dependencies!"))})):(clearTimeout(i),n(a.grecaptcha))})},ch.prototype.c=function(){this.b--};var ph=null;function dh(e,t,n,r,i,o,s){if(xr(this,"type","recaptcha"),this.c=this.f=null,this.D=!1,this.l=t,this.g=null,s?(uh||(uh=new ah),s=uh):(ph||(ph=new ch),s=ph),this.o=s,this.a=n||{theme:"light",type:"image"},this.h=[],this.a[yh])throw new Hr("argument-error","sitekey should not be provided for reCAPTCHA as one is automatically provisioned for the current project.");if(this.i="invisible"===this.a[vh],!a.document)throw new Hr("operation-not-supported-in-this-environment","RecaptchaVerifier is only supported in a browser HTTP/HTTPS environment with DOM support.");if(!jn(t)||!this.i&&jn(t).hasChildNodes())throw new Hr("argument-error","reCAPTCHA container is either not found or already contains inner elements!");this.u=new ms(e,o||null,i||null),this.v=r||function(){return null};var u=this;this.m=[];var c=this.a[fh];this.a[fh]=function(e){if(gh(u,e),"function"==typeof c)c(e);else if("string"==typeof c){var t=pr(c,a);"function"==typeof t&&t(e)}};var h=this.a[mh];this.a[mh]=function(){if(gh(u,null),"function"==typeof h)h();else if("string"==typeof h){var e=pr(h,a);"function"==typeof e&&e()}}}var fh="callback",mh="expired-callback",yh="sitekey",vh="size";function gh(e,t){for(var n=0;n<e.m.length;n++)try{e.m[n](t)}catch(e){}}function _h(e,t){return e.h.push(t),t.ia(function(){q(e.h,t)}),t}function bh(e){if(e.D)throw new Hr("internal-error","RecaptchaVerifier instance has been destroyed.")}function wh(e,t,n){var i=!1;try{this.b=n||r.a.app()}catch(e){throw new Hr("argument-error","No firebase.app.App instance is currently initialized.")}if(!this.b.options||!this.b.options.apiKey)throw new Hr("invalid-api-key");n=this.b.options.apiKey;var o=this,s=null;try{s=this.b.auth().ya()}catch(e){}try{i=this.b.auth().settings.appVerificationDisabledForTesting}catch(e){}s=r.a.SDK_VERSION?hr(r.a.SDK_VERSION,s):null,dh.call(this,n,e,t,function(){try{var e=o.b.auth().ea()}catch(t){e=null}return e},s,di(li),i)}function Eh(e,t,n,r){e:{n=Array.prototype.slice.call(n);for(var i=0,o=!1,s=0;s<t.length;s++)if(t[s].optional)o=!0;else{if(o)throw new Hr("internal-error","Argument validator encountered a required argument after an optional argument.");i++}if(o=t.length,n.length<i||o<n.length)r="Expected "+(i==o?1==i?"1 argument":i+" arguments":i+"-"+o+" arguments")+" but got "+n.length+".";else{for(i=0;i<n.length;i++)if(o=t[i].optional&&void 0===n[i],!t[i].M(n[i])&&!o){if(t=t[i],0>i||i>=Sh.length)throw new Hr("internal-error","Argument validator received an unsupported number of arguments.");n=Sh[i],r=(r?"":n+" argument ")+(t.name?'"'+t.name+'" ':"")+"must be "+t.K+".";break e}r=null}}if(r)throw new Hr("argument-error",e+" failed: "+r)}(t=dh.prototype).za=function(){var e=this;return this.f?this.f:this.f=_h(this,Ie().then(function(){if(mr()&&!rr())return er();throw new Hr("operation-not-supported-in-this-environment","RecaptchaVerifier is only supported in a browser HTTP/HTTPS environment.")}).then(function(){return e.o.g(e.v())}).then(function(t){return e.g=t,pa(e.u,Js,{})}).then(function(t){e.a[yh]=t.recaptchaSiteKey}).s(function(t){throw e.f=null,t}))},t.render=function(){bh(this);var e=this;return _h(this,this.za().then(function(){if(null===e.c){var t=e.l;if(!e.i){var n=jn(t);t=Un("DIV"),n.appendChild(t)}e.c=e.g.render(t,e.a)}return e.c}))},t.verify=function(){bh(this);var e=this;return _h(this,this.render().then(function(t){return new be(function(n){var r=e.g.getResponse(t);if(r)n(r);else{var i=function(t){t&&(function(e,t){W(e.m,function(e){return e==t})}(e,i),n(t))};e.m.push(i),e.i&&e.g.execute(e.c)}})}))},t.reset=function(){bh(this),null!==this.c&&this.g.reset(this.c)},t.clear=function(){bh(this),this.D=!0,this.o.c();for(var e=0;e<this.h.length;e++)this.h[e].cancel("RecaptchaVerifier instance has been destroyed.");if(!this.i){e=jn(this.l);for(var t;t=e.firstChild;)e.removeChild(t)}},k(wh,dh);var Sh="First Second Third Fourth Fifth Sixth Seventh Eighth Ninth".split(" ");function Ch(e,t){return{name:e||"",K:"a valid string",optional:!!t,M:u}}function Th(e,t){return{name:e||"",K:"a boolean",optional:!!t,M:c}}function kh(e,t){return{name:e||"",K:"a valid object",optional:!!t,M:g}}function Ih(e,t){return{name:e||"",K:"a function",optional:!!t,M:v}}function Ah(e,t){return{name:e||"",K:"null",optional:!!t,M:f}}function Nh(e){return{name:e?e+"Credential":"credential",K:e?"a valid "+e+" credential":"a valid credential",optional:!1,M:function(t){if(!t)return!1;var n=!e||t.providerId===e;return!(!t.la||!n)}}}function Rh(){return{name:"applicationVerifier",K:"an implementation of firebase.auth.ApplicationVerifier",optional:!1,M:function(e){return!!(e&&u(e.type)&&v(e.verify))}}}function Oh(e,t,n,r){return{name:n||"",K:e.K+" or "+t.K,optional:!!r,M:function(n){return e.M(n)||t.M(n)}}}function xh(e,t){for(var n in t){var r=t[n].name;e[r]=Mh(r,e[n],t[n].j)}}function Ph(e,t){for(var n in t){var r=t[n].name;r!==n&&Object.defineProperty(e,r,{get:C(function(e){return this[e]},n),set:C(function(e,t,n,r){Eh(e,[n],[r],!0),this[t]=r},r,n,t[n].vb),enumerable:!0})}}function Dh(e,t,n,r){e[t]=Mh(t,n,r)}function Mh(e,t,n){function r(){var e=Array.prototype.slice.call(arguments);return Eh(o,n,e),t.apply(this,e)}if(!n)return t;var i,o=function(e){return(e=e.split("."))[e.length-1]}(e);for(i in t)r[i]=t[i];for(i in t.prototype)r.prototype[i]=t.prototype[i];return r}xh(qc.prototype,{Xa:{name:"applyActionCode",j:[Ch("code")]},Ka:{name:"checkActionCode",j:[Ch("code")]},$a:{name:"confirmPasswordReset",j:[Ch("code"),Ch("newPassword")]},Ub:{name:"createUserWithEmailAndPassword",j:[Ch("email"),Ch("password")]},Xb:{name:"fetchSignInMethodsForEmail",j:[Ch("email")]},fa:{name:"getRedirectResult",j:[]},nc:{name:"isSignInWithEmailLink",j:[Ch("emailLink")]},tc:{name:"onAuthStateChanged",j:[Oh(kh(),Ih(),"nextOrObserver"),Ih("opt_error",!0),Ih("opt_completed",!0)]},uc:{name:"onIdTokenChanged",j:[Oh(kh(),Ih(),"nextOrObserver"),Ih("opt_error",!0),Ih("opt_completed",!0)]},lb:{name:"sendPasswordResetEmail",j:[Ch("email"),Oh(kh("opt_actionCodeSettings",!0),Ah(null,!0),"opt_actionCodeSettings",!0)]},mb:{name:"sendSignInLinkToEmail",j:[Ch("email"),kh("actionCodeSettings")]},nb:{name:"setPersistence",j:[Ch("persistence")]},Dc:{name:"signInAndRetrieveDataWithCredential",j:[Nh()]},ob:{name:"signInAnonymously",j:[]},Ra:{name:"signInWithCredential",j:[Nh()]},Ec:{name:"signInWithCustomToken",j:[Ch("token")]},Fc:{name:"signInWithEmailAndPassword",j:[Ch("email"),Ch("password")]},Gc:{name:"signInWithEmailLink",j:[Ch("email"),Ch("emailLink",!0)]},Hc:{name:"signInWithPhoneNumber",j:[Ch("phoneNumber"),Rh()]},Ic:{name:"signInWithPopup",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(e){return!!(e&&e.providerId&&e.hasOwnProperty&&e.hasOwnProperty("isOAuthProvider"))}}]},Jc:{name:"signInWithRedirect",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(e){return!!(e&&e.providerId&&e.hasOwnProperty&&e.hasOwnProperty("isOAuthProvider"))}}]},Oc:{name:"updateCurrentUser",j:[Oh({name:"user",K:"an instance of Firebase User",optional:!1,M:function(e){return!!(e&&e instanceof ic)}},Ah(),"user")]},pb:{name:"signOut",j:[]},toJSON:{name:"toJSON",j:[Ch(null,!0)]},Qc:{name:"useDeviceLanguage",j:[]},Rc:{name:"verifyPasswordResetCode",j:[Ch("code")]}}),Ph(qc.prototype,{lc:{name:"languageCode",vb:Oh(Ch(),Ah(),"languageCode")}}),qc.Persistence=ou,qc.Persistence.LOCAL="local",qc.Persistence.SESSION="session",qc.Persistence.NONE="none",xh(ic.prototype,{delete:{name:"delete",j:[]},ac:{name:"getIdTokenResult",j:[Th("opt_forceRefresh",!0)]},F:{name:"getIdToken",j:[Th("opt_forceRefresh",!0)]},oc:{name:"linkAndRetrieveDataWithCredential",j:[Nh()]},fb:{name:"linkWithCredential",j:[Nh()]},pc:{name:"linkWithPhoneNumber",j:[Ch("phoneNumber"),Rh()]},qc:{name:"linkWithPopup",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(e){return!!(e&&e.providerId&&e.hasOwnProperty&&e.hasOwnProperty("isOAuthProvider"))}}]},rc:{name:"linkWithRedirect",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(e){return!!(e&&e.providerId&&e.hasOwnProperty&&e.hasOwnProperty("isOAuthProvider"))}}]},xc:{name:"reauthenticateAndRetrieveDataWithCredential",j:[Nh()]},hb:{name:"reauthenticateWithCredential",j:[Nh()]},yc:{name:"reauthenticateWithPhoneNumber",j:[Ch("phoneNumber"),Rh()]},zc:{name:"reauthenticateWithPopup",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(e){return!!(e&&e.providerId&&e.hasOwnProperty&&e.hasOwnProperty("isOAuthProvider"))}}]},Ac:{name:"reauthenticateWithRedirect",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(e){return!!(e&&e.providerId&&e.hasOwnProperty&&e.hasOwnProperty("isOAuthProvider"))}}]},reload:{name:"reload",j:[]},kb:{name:"sendEmailVerification",j:[Oh(kh("opt_actionCodeSettings",!0),Ah(null,!0),"opt_actionCodeSettings",!0)]},toJSON:{name:"toJSON",j:[Ch(null,!0)]},Nc:{name:"unlink",j:[Ch("provider")]},rb:{name:"updateEmail",j:[Ch("email")]},sb:{name:"updatePassword",j:[Ch("password")]},Pc:{name:"updatePhoneNumber",j:[Nh("phone")]},tb:{name:"updateProfile",j:[kh("profile")]}}),xh(th.prototype,{execute:{name:"execute"},render:{name:"render"},reset:{name:"reset"},getResponse:{name:"getResponse"}}),xh(eh.prototype,{execute:{name:"execute"},render:{name:"render"},reset:{name:"reset"},getResponse:{name:"getResponse"}}),xh(be.prototype,{ia:{name:"finally"},s:{name:"catch"},then:{name:"then"}}),Ph(Qu.prototype,{appVerificationDisabled:{name:"appVerificationDisabledForTesting",vb:Th("appVerificationDisabledForTesting")}}),xh(Ku.prototype,{confirm:{name:"confirm",j:[Ch("verificationCode")]}}),Dh(Ai,"fromJSON",function(e){e=u(e)?JSON.parse(e):e;for(var t,n=[Mi,Qi,Zi,xi],r=0;r<n.length;r++)if(t=n[r](e))return t;return null},[Oh(Ch(),kh(),"json")]),Dh(Ki,"credential",function(e,t){return new Yi(e,t)},[Ch("email"),Ch("password")]),xh(Yi.prototype,{w:{name:"toJSON",j:[Ch(null,!0)]}}),xh(Bi.prototype,{ua:{name:"addScope",j:[Ch("scope")]},Da:{name:"setCustomParameters",j:[kh("customOAuthParameters")]}}),Dh(Bi,"credential",Ui,[Oh(Ch(),kh(),"token")]),Dh(Ki,"credentialWithLink",$i,[Ch("email"),Ch("emailLink")]),xh(Vi.prototype,{ua:{name:"addScope",j:[Ch("scope")]},Da:{name:"setCustomParameters",j:[kh("customOAuthParameters")]}}),Dh(Vi,"credential",qi,[Oh(Ch(),kh(),"token")]),xh(Wi.prototype,{ua:{name:"addScope",j:[Ch("scope")]},Da:{name:"setCustomParameters",j:[kh("customOAuthParameters")]}}),Dh(Wi,"credential",Hi,[Oh(Ch(),Oh(kh(),Ah()),"idToken"),Oh(Ch(),Ah(),"accessToken",!0)]),xh(Gi.prototype,{Da:{name:"setCustomParameters",j:[kh("customOAuthParameters")]}}),Dh(Gi,"credential",zi,[Oh(Ch(),kh(),"token"),Ch("secret",!0)]),xh(Fi.prototype,{ua:{name:"addScope",j:[Ch("scope")]},credential:{name:"credential",j:[Oh(Ch(),Oh(kh(),Ah()),"optionsOrIdToken"),Oh(Ch(),Ah(),"accessToken",!0)]},Da:{name:"setCustomParameters",j:[kh("customOAuthParameters")]}}),xh(Pi.prototype,{w:{name:"toJSON",j:[Ch(null,!0)]}}),xh(Ri.prototype,{w:{name:"toJSON",j:[Ch(null,!0)]}}),Dh(to,"credential",no,[Ch("verificationId"),Ch("verificationCode")]),xh(to.prototype,{Va:{name:"verifyPhoneNumber",j:[Ch("phoneNumber"),Rh()]}}),xh(Ji.prototype,{w:{name:"toJSON",j:[Ch(null,!0)]}}),xh(Hr.prototype,{toJSON:{name:"toJSON",j:[Ch(null,!0)]}}),xh(lo.prototype,{toJSON:{name:"toJSON",j:[Ch(null,!0)]}}),xh(ho.prototype,{toJSON:{name:"toJSON",j:[Ch(null,!0)]}}),xh(wh.prototype,{clear:{name:"clear",j:[]},render:{name:"render",j:[]},verify:{name:"verify",j:[]}}),function(){if(void 0===r.a||!r.a.INTERNAL||!r.a.INTERNAL.registerService)throw Error("Cannot find the firebase namespace; be sure to include firebase-app.js before this library.");var e={Auth:qc,AuthCredential:Ai,Error:Hr};Dh(e,"EmailAuthProvider",Ki,[]),Dh(e,"FacebookAuthProvider",Bi,[]),Dh(e,"GithubAuthProvider",Vi,[]),Dh(e,"GoogleAuthProvider",Wi,[]),Dh(e,"TwitterAuthProvider",Gi,[]),Dh(e,"OAuthProvider",Fi,[Ch("providerId")]),Dh(e,"SAMLAuthProvider",ji,[Ch("providerId")]),Dh(e,"PhoneAuthProvider",to,[{name:"auth",K:"an instance of Firebase Auth",optional:!0,M:function(e){return!!(e&&e instanceof qc)}}]),Dh(e,"RecaptchaVerifier",wh,[Oh(Ch(),{name:"",K:"an HTML element",optional:!1,M:function(e){return!!(e&&e instanceof Element)}},"recaptchaContainer"),kh("recaptchaParameters",!0),{name:"app",K:"an instance of Firebase App",optional:!0,M:function(e){return!!(e&&e instanceof r.a.app.App)}}]),r.a.INTERNAL.registerService("auth",function(e,t){return t({INTERNAL:{getUid:S((e=new qc(e)).getUid,e),getToken:S(e.$b,e),addAuthTokenListener:S(e.Tb,e),removeAuthTokenListener:S(e.Bc,e)}}),e},e,function(e,t){if("create"===e)try{t.auth()}catch(e){}}),r.a.INTERNAL.extendNamespace({User:ic})}()}).apply(void 0!==e?e:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})}).call(t,n("DuR2"))},hZls:function(e,t,n){"use strict";var r=n("jE0U");n.n(r)},j218:function(e,t,n){"use strict";var r=n("yviF"),i=n.n(r);n("dih4"),n("hZls");i.a.initializeApp({apiKey:"AIzaSyBxQQufPDG2M3GF4V-qDfsJJ_5kGeNWzuE",authDomain:"rap-tap-app.firebaseapp.com",databaseURL:"https://rap-tap-app.firebaseio.com"}),i.a.auth().signInAnonymously();var o=i.a.database();t.a=o},jE0U:function(e,t,n){"use strict";(function(r){Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){return e&&"object"==typeof e&&"default"in e?e.default:e}(n("O4tu")),o=n("TToO"),s=n("Pxmi"),a=n("fjI4"),u=function(){function e(e){this.domStorage_=e,this.prefix_="firebase:"}return e.prototype.set=function(e,t){null==t?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),s.stringify(t))},e.prototype.get=function(e){var t=this.domStorage_.getItem(this.prefixedName_(e));return null==t?null:s.jsonEval(t)},e.prototype.remove=function(e){this.domStorage_.removeItem(this.prefixedName_(e))},e.prototype.prefixedName_=function(e){return this.prefix_+e},e.prototype.toString=function(){return this.domStorage_.toString()},e}(),c=function(){function e(){this.cache_={},this.isInMemoryStorage=!0}return e.prototype.set=function(e,t){null==t?delete this.cache_[e]:this.cache_[e]=t},e.prototype.get=function(e){return s.contains(this.cache_,e)?this.cache_[e]:null},e.prototype.remove=function(e){delete this.cache_[e]},e}(),h=function(e){try{if("undefined"!=typeof window&&void 0!==window[e]){var t=window[e];return t.setItem("firebase:sentinel","cache"),t.removeItem("firebase:sentinel"),new u(t)}}catch(e){}return new c},l=h("localStorage"),p=h("sessionStorage"),d=new a.Logger("@firebase/database"),f=function(){var e=1;return function(){return e++}}(),m=function(e){var t=s.stringToByteArray(e),n=new s.Sha1;n.update(t);var r=n.digest();return s.base64.encodeByteArray(r)},y=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n="",r=0;r<e.length;r++)Array.isArray(e[r])||e[r]&&"object"==typeof e[r]&&"number"==typeof e[r].length?n+=y.apply(null,e[r]):"object"==typeof e[r]?n+=s.stringify(e[r]):n+=e[r],n+=" ";return n},v=null,g=!0,_=function(e,t){s.assert(!t||!0===e||!1===e,"Can't turn on custom loggers persistently."),!0===e?(d.logLevel=a.LogLevel.VERBOSE,v=d.log.bind(d),t&&p.set("logging_enabled",!0)):"function"==typeof e?v=e:(v=null,p.remove("logging_enabled"))},b=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(!0===g&&(g=!1,null===v&&!0===p.get("logging_enabled")&&_(!0)),v){var n=y.apply(null,e);v(n)}},w=function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];b.apply(void 0,o.__spread([e],t))}},E=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n="FIREBASE INTERNAL ERROR: "+y.apply(void 0,o.__spread(e));d.error(n)},S=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n="FIREBASE FATAL ERROR: "+y.apply(void 0,o.__spread(e));throw d.error(n),new Error(n)},C=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n="FIREBASE WARNING: "+y.apply(void 0,o.__spread(e));d.warn(n)},T=function(e){return"number"==typeof e&&(e!=e||e==Number.POSITIVE_INFINITY||e==Number.NEGATIVE_INFINITY)},k="[MIN_NAME]",I="[MAX_NAME]",A=function(e,t){if(e===t)return 0;if(e===k||t===I)return-1;if(t===k||e===I)return 1;var n=L(e),r=L(t);return null!==n?null!==r?n-r==0?e.length-t.length:n-r:-1:null!==r?1:e<t?-1:1},N=function(e,t){return e===t?0:e<t?-1:1},R=function(e,t){if(t&&e in t)return t[e];throw new Error("Missing required key ("+e+") in object: "+s.stringify(t))},O=function(e){if("object"!=typeof e||null===e)return s.stringify(e);var t=[];for(var n in e)t.push(n);t.sort();for(var r="{",i=0;i<t.length;i++)0!==i&&(r+=","),r+=s.stringify(t[i]),r+=":",r+=O(e[t[i]]);return r+="}"},x=function(e,t){var n=e.length;if(n<=t)return[e];for(var r=[],i=0;i<n;i+=t)i+t>n?r.push(e.substring(i,n)):r.push(e.substring(i,i+t));return r};function P(e,t){for(var n in e)e.hasOwnProperty(n)&&t(n,e[n])}var D=function(e){s.assert(!T(e),"Invalid JSON number");var t,n,r,i,o,a,u;for(0===e?(n=0,r=0,t=1/e==-1/0?1:0):(t=e<0,(e=Math.abs(e))>=Math.pow(2,-1022)?(n=(i=Math.min(Math.floor(Math.log(e)/Math.LN2),1023))+1023,r=Math.round(e*Math.pow(2,52-i)-Math.pow(2,52))):(n=0,r=Math.round(e/Math.pow(2,-1074)))),a=[],o=52;o;o-=1)a.push(r%2?1:0),r=Math.floor(r/2);for(o=11;o;o-=1)a.push(n%2?1:0),n=Math.floor(n/2);a.push(t?1:0),a.reverse(),u=a.join("");var c="";for(o=0;o<64;o+=8){var h=parseInt(u.substr(o,8),2).toString(16);1===h.length&&(h="0"+h),c+=h}return c.toLowerCase()},M=new RegExp("^-?\\d{1,10}$"),L=function(e){if(M.test(e)){var t=Number(e);if(t>=-2147483648&&t<=2147483647)return t}return null},j=function(e){try{e()}catch(e){setTimeout(function(){var t=e.stack||"";throw C("Exception was thrown by user callback.",t),e},Math.floor(0))}},F=function(){return("object"==typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},B=function(e,t){var n=setTimeout(e,t);return"object"==typeof n&&n.unref&&n.unref(),n},U=function(){function e(e,t){if(void 0===t){this.pieces_=e.split("/");for(var n=0,r=0;r<this.pieces_.length;r++)this.pieces_[r].length>0&&(this.pieces_[n]=this.pieces_[r],n++);this.pieces_.length=n,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}return Object.defineProperty(e,"Empty",{get:function(){return new e("")},enumerable:!0,configurable:!0}),e.prototype.getFront=function(){return this.pieceNum_>=this.pieces_.length?null:this.pieces_[this.pieceNum_]},e.prototype.getLength=function(){return this.pieces_.length-this.pieceNum_},e.prototype.popFront=function(){var t=this.pieceNum_;return t<this.pieces_.length&&t++,new e(this.pieces_,t)},e.prototype.getBack=function(){return this.pieceNum_<this.pieces_.length?this.pieces_[this.pieces_.length-1]:null},e.prototype.toString=function(){for(var e="",t=this.pieceNum_;t<this.pieces_.length;t++)""!==this.pieces_[t]&&(e+="/"+this.pieces_[t]);return e||"/"},e.prototype.toUrlEncodedString=function(){for(var e="",t=this.pieceNum_;t<this.pieces_.length;t++)""!==this.pieces_[t]&&(e+="/"+encodeURIComponent(String(this.pieces_[t])));return e||"/"},e.prototype.slice=function(e){return void 0===e&&(e=0),this.pieces_.slice(this.pieceNum_+e)},e.prototype.parent=function(){if(this.pieceNum_>=this.pieces_.length)return null;for(var t=[],n=this.pieceNum_;n<this.pieces_.length-1;n++)t.push(this.pieces_[n]);return new e(t,0)},e.prototype.child=function(t){for(var n=[],r=this.pieceNum_;r<this.pieces_.length;r++)n.push(this.pieces_[r]);if(t instanceof e)for(r=t.pieceNum_;r<t.pieces_.length;r++)n.push(t.pieces_[r]);else{var i=t.split("/");for(r=0;r<i.length;r++)i[r].length>0&&n.push(i[r])}return new e(n,0)},e.prototype.isEmpty=function(){return this.pieceNum_>=this.pieces_.length},e.relativePath=function(t,n){var r=t.getFront(),i=n.getFront();if(null===r)return n;if(r===i)return e.relativePath(t.popFront(),n.popFront());throw new Error("INTERNAL ERROR: innerPath ("+n+") is not within outerPath ("+t+")")},e.comparePaths=function(e,t){for(var n=e.slice(),r=t.slice(),i=0;i<n.length&&i<r.length;i++){var o=A(n[i],r[i]);if(0!==o)return o}return n.length===r.length?0:n.length<r.length?-1:1},e.prototype.equals=function(e){if(this.getLength()!==e.getLength())return!1;for(var t=this.pieceNum_,n=e.pieceNum_;t<=this.pieces_.length;t++,n++)if(this.pieces_[t]!==e.pieces_[n])return!1;return!0},e.prototype.contains=function(e){var t=this.pieceNum_,n=e.pieceNum_;if(this.getLength()>e.getLength())return!1;for(;t<this.pieces_.length;){if(this.pieces_[t]!==e.pieces_[n])return!1;++t,++n}return!0},e}(),V=function(){function e(e,t){this.errorPrefix_=t,this.parts_=e.slice(),this.byteLength_=Math.max(1,this.parts_.length);for(var n=0;n<this.parts_.length;n++)this.byteLength_+=s.stringLength(this.parts_[n]);this.checkValid_()}return Object.defineProperty(e,"MAX_PATH_DEPTH",{get:function(){return 32},enumerable:!0,configurable:!0}),Object.defineProperty(e,"MAX_PATH_LENGTH_BYTES",{get:function(){return 768},enumerable:!0,configurable:!0}),e.prototype.push=function(e){this.parts_.length>0&&(this.byteLength_+=1),this.parts_.push(e),this.byteLength_+=s.stringLength(e),this.checkValid_()},e.prototype.pop=function(){var e=this.parts_.pop();this.byteLength_-=s.stringLength(e),this.parts_.length>0&&(this.byteLength_-=1)},e.prototype.checkValid_=function(){if(this.byteLength_>e.MAX_PATH_LENGTH_BYTES)throw new Error(this.errorPrefix_+"has a key path longer than "+e.MAX_PATH_LENGTH_BYTES+" bytes ("+this.byteLength_+").");if(this.parts_.length>e.MAX_PATH_DEPTH)throw new Error(this.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+e.MAX_PATH_DEPTH+") or object contains a cycle "+this.toErrorString())},e.prototype.toErrorString=function(){return 0==this.parts_.length?"":"in property '"+this.parts_.join(".")+"'"},e}(),q="long_polling",W=function(){function e(e,t,n,r,i){void 0===i&&(i=""),this.secure=t,this.namespace=n,this.webSocketOnly=r,this.persistenceKey=i,this.host=e.toLowerCase(),this.domain=this.host.substr(this.host.indexOf(".")+1),this.internalHost=l.get("host:"+e)||this.host}return e.prototype.needsQueryParam=function(){return this.host!==this.internalHost||this.isCustomHost()},e.prototype.isCacheableHost=function(){return"s-"===this.internalHost.substr(0,2)},e.prototype.isDemoHost=function(){return"firebaseio-demo.com"===this.domain},e.prototype.isCustomHost=function(){return"firebaseio.com"!==this.domain&&"firebaseio-demo.com"!==this.domain},e.prototype.updateHost=function(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&l.set("host:"+this.host,this.internalHost))},e.prototype.connectionURL=function(e,t){var n;if(s.assert("string"==typeof e,"typeof type must == string"),s.assert("object"==typeof t,"typeof params must == object"),"websocket"===e)n=(this.secure?"wss://":"ws://")+this.internalHost+"/.ws?";else{if(e!==q)throw new Error("Unknown connection type: "+e);n=(this.secure?"https://":"http://")+this.internalHost+"/.lp?"}this.needsQueryParam()&&(t.ns=this.namespace);var r=[];return P(t,function(e,t){r.push(e+"="+t)}),n+r.join("&")},e.prototype.toString=function(){var e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e},e.prototype.toURLString=function(){return(this.secure?"https://":"http://")+this.host},e}();var H,G,z=function(e){var t=Y(e),n=t.subdomain;"firebase"===t.domain&&S(t.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),n&&"undefined"!=n||"localhost"===t.domain||S("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),t.secure||"undefined"!=typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&C("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().");var r="ws"===t.scheme||"wss"===t.scheme;return{repoInfo:new W(t.host,t.secure,n,r),path:new U(t.pathString)}},Y=function(e){var t="",n="",r="",i="",s=!0,a="https",u=443;if("string"==typeof e){var c=e.indexOf("//");c>=0&&(a=e.substring(0,c-1),e=e.substring(c+2));var h=e.indexOf("/");-1===h&&(h=e.length);var l=e.indexOf("?");-1===l&&(l=e.length),t=e.substring(0,Math.min(h,l)),h<l&&(i=function(e){for(var t="",n=e.split("/"),r=0;r<n.length;r++)if(n[r].length>0){var i=n[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch(e){}t+="/"+i}return t}(e.substring(h,l)));var p=function(e){var t,n,r={};"?"===e.charAt(0)&&(e=e.substring(1));try{for(var i=o.__values(e.split("&")),s=i.next();!s.done;s=i.next()){var a=s.value;if(0!==a.length){var u=a.split("=");2===u.length?r[decodeURIComponent(u[0])]=decodeURIComponent(u[1]):C("Invalid query segment '"+a+"' in query '"+e+"'")}}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return r}(e.substring(Math.min(e.length,l)));(c=t.indexOf(":"))>=0?(s="https"===a||"wss"===a,u=parseInt(t.substring(c+1),10)):c=e.length;var d=t.split(".");3===d.length?(n=d[1],r=d[0].toLowerCase()):2===d.length?n=d[0]:"localhost"===d[0].slice(0,c).toLowerCase()&&(n="localhost"),""===r&&"ns"in p&&(r=p.ns)}return{host:t,port:u,domain:n,subdomain:r,secure:s,scheme:a,pathString:i}},Q=/[\[\].#$\/\u0000-\u001F\u007F]/,K=/[\[\].#$\u0000-\u001F\u007F]/,$=function(e){return"string"==typeof e&&0!==e.length&&!Q.test(e)},X=function(e){return"string"==typeof e&&0!==e.length&&!K.test(e)},J=function(e){return null===e||"string"==typeof e||"number"==typeof e&&!T(e)||e&&"object"==typeof e&&s.contains(e,".sv")},Z=function(e,t,n,r,i){i&&void 0===n||ee(s.errorPrefix(e,t,i),n,r)},ee=function(e,t,n){var r=n instanceof U?new V(n,e):n;if(void 0===t)throw new Error(e+"contains undefined "+r.toErrorString());if("function"==typeof t)throw new Error(e+"contains a function "+r.toErrorString()+" with contents = "+t.toString());if(T(t))throw new Error(e+"contains "+t.toString()+" "+r.toErrorString());if("string"==typeof t&&t.length>10485760/3&&s.stringLength(t)>10485760)throw new Error(e+"contains a string greater than 10485760 utf8 bytes "+r.toErrorString()+" ('"+t.substring(0,50)+"...')");if(t&&"object"==typeof t){var i=!1,o=!1;if(P(t,function(t,n){if(".value"===t)i=!0;else if(".priority"!==t&&".sv"!==t&&(o=!0,!$(t)))throw new Error(e+" contains an invalid key ("+t+") "+r.toErrorString()+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');r.push(t),ee(e,n,r),r.pop()}),i&&o)throw new Error(e+' contains ".value" child '+r.toErrorString()+" in addition to actual children.")}},te=function(e,t,n,r,i){if(!i||void 0!==n){var o=s.errorPrefix(e,t,i);if(!n||"object"!=typeof n||Array.isArray(n))throw new Error(o+" must be an object containing the children to replace.");var a=[];P(n,function(e,t){var n=new U(e);if(ee(o,t,r.child(n)),".priority"===n.getBack()&&!J(t))throw new Error(o+"contains an invalid value for '"+n.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");a.push(n)}),function(e,t){var n,r;for(n=0;n<t.length;n++)for(var i=(r=t[n]).slice(),o=0;o<i.length;o++)if(".priority"===i[o]&&o===i.length-1);else if(!$(i[o]))throw new Error(e+"contains an invalid key ("+i[o]+") in path "+r.toString()+'. Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');t.sort(U.comparePaths);var s=null;for(n=0;n<t.length;n++){if(r=t[n],null!==s&&s.contains(r))throw new Error(e+"contains a path "+s.toString()+" that is ancestor of another path "+r.toString());s=r}}(o,a)}},ne=function(e,t,n,r){if(!r||void 0!==n){if(T(n))throw new Error(s.errorPrefix(e,t,r)+"is "+n.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!J(n))throw new Error(s.errorPrefix(e,t,r)+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},re=function(e,t,n,r){if(!r||void 0!==n)switch(n){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error(s.errorPrefix(e,t,r)+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}},ie=function(e,t,n,r){if(!(r&&void 0===n||$(n)))throw new Error(s.errorPrefix(e,t,r)+'was an invalid key = "'+n+'".  Firebase keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]").')},oe=function(e,t,n,r){if(!(r&&void 0===n||X(n)))throw new Error(s.errorPrefix(e,t,r)+'was an invalid path = "'+n+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},se=function(e,t){if(".info"===t.getFront())throw new Error(e+" failed = Can't modify data under /.info/")},ae=function(e,t,n){var r=n.path.toString();if("string"!=typeof n.repoInfo.host||0===n.repoInfo.host.length||!$(n.repoInfo.namespace)&&"localhost"!==n.repoInfo.host.split(":")[0]||0!==r.length&&!function(e){return e&&(e=e.replace(/^\/*\.info(\/|$)/,"/")),X(e)}(r))throw new Error(s.errorPrefix(e,t,!1)+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')},ue=function(){function e(e,t){this.repo_=e,this.path_=t}return e.prototype.cancel=function(e){s.validateArgCount("OnDisconnect.cancel",0,1,arguments.length),s.validateCallback("OnDisconnect.cancel",1,e,!0);var t=new s.Deferred;return this.repo_.onDisconnectCancel(this.path_,t.wrapCallback(e)),t.promise},e.prototype.remove=function(e){s.validateArgCount("OnDisconnect.remove",0,1,arguments.length),se("OnDisconnect.remove",this.path_),s.validateCallback("OnDisconnect.remove",1,e,!0);var t=new s.Deferred;return this.repo_.onDisconnectSet(this.path_,null,t.wrapCallback(e)),t.promise},e.prototype.set=function(e,t){s.validateArgCount("OnDisconnect.set",1,2,arguments.length),se("OnDisconnect.set",this.path_),Z("OnDisconnect.set",1,e,this.path_,!1),s.validateCallback("OnDisconnect.set",2,t,!0);var n=new s.Deferred;return this.repo_.onDisconnectSet(this.path_,e,n.wrapCallback(t)),n.promise},e.prototype.setWithPriority=function(e,t,n){s.validateArgCount("OnDisconnect.setWithPriority",2,3,arguments.length),se("OnDisconnect.setWithPriority",this.path_),Z("OnDisconnect.setWithPriority",1,e,this.path_,!1),ne("OnDisconnect.setWithPriority",2,t,!1),s.validateCallback("OnDisconnect.setWithPriority",3,n,!0);var r=new s.Deferred;return this.repo_.onDisconnectSetWithPriority(this.path_,e,t,r.wrapCallback(n)),r.promise},e.prototype.update=function(e,t){if(s.validateArgCount("OnDisconnect.update",1,2,arguments.length),se("OnDisconnect.update",this.path_),Array.isArray(e)){for(var n={},r=0;r<e.length;++r)n[""+r]=e[r];e=n,C("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}te("OnDisconnect.update",1,e,this.path_,!1),s.validateCallback("OnDisconnect.update",2,t,!0);var i=new s.Deferred;return this.repo_.onDisconnectUpdate(this.path_,e,i.wrapCallback(t)),i.promise},e}(),ce=function(){function e(e,t){this.committed=e,this.snapshot=t}return e.prototype.toJSON=function(){return s.validateArgCount("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}},e}(),he=function(){var e="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",t=0,n=[];return function(r){var i,o=r===t;t=r;var a=new Array(8);for(i=7;i>=0;i--)a[i]=e.charAt(r%64),r=Math.floor(r/64);s.assert(0===r,"Cannot push at time == 0");var u=a.join("");if(o){for(i=11;i>=0&&63===n[i];i--)n[i]=0;n[i]++}else for(i=0;i<12;i++)n[i]=Math.floor(64*Math.random());for(i=0;i<12;i++)u+=e.charAt(n[i]);return s.assert(20===u.length,"nextPushId: Length should be 20."),u}}(),le=function(){function e(e,t){this.name=e,this.node=t}return e.Wrap=function(t,n){return new e(t,n)},e}(),pe=function(){function e(){}return e.prototype.getCompare=function(){return this.compare.bind(this)},e.prototype.indexedValueChanged=function(e,t){var n=new le(k,e),r=new le(k,t);return 0!==this.compare(n,r)},e.prototype.minPost=function(){return le.MIN},e}(),de=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o.__extends(t,e),Object.defineProperty(t,"__EMPTY_NODE",{get:function(){return H},set:function(e){H=e},enumerable:!0,configurable:!0}),t.prototype.compare=function(e,t){return A(e.name,t.name)},t.prototype.isDefinedOn=function(e){throw s.assertionError("KeyIndex.isDefinedOn not expected to be called.")},t.prototype.indexedValueChanged=function(e,t){return!1},t.prototype.minPost=function(){return le.MIN},t.prototype.maxPost=function(){return new le(I,H)},t.prototype.makePost=function(e,t){return s.assert("string"==typeof e,"KeyIndex indexValue must always be a string."),new le(e,H)},t.prototype.toString=function(){return".key"},t}(pe),fe=new de;var me,ye,ve,ge=function(e){return"number"==typeof e?"number:"+D(e):"string:"+e},_e=function(e){if(e.isLeafNode()){var t=e.val();s.assert("string"==typeof t||"number"==typeof t||"object"==typeof t&&s.contains(t,".sv"),"Priority must be a string or number.")}else s.assert(e===G||e.isEmpty(),"priority of unexpected type.");s.assert(e===G||e.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")},be=function(){function e(t,n){void 0===n&&(n=e.__childrenNodeConstructor.EMPTY_NODE),this.value_=t,this.priorityNode_=n,this.lazyHash_=null,s.assert(void 0!==this.value_&&null!==this.value_,"LeafNode shouldn't be created with null/undefined value."),_e(this.priorityNode_)}return Object.defineProperty(e,"__childrenNodeConstructor",{get:function(){return me},set:function(e){me=e},enumerable:!0,configurable:!0}),e.prototype.isLeafNode=function(){return!0},e.prototype.getPriority=function(){return this.priorityNode_},e.prototype.updatePriority=function(t){return new e(this.value_,t)},e.prototype.getImmediateChild=function(t){return".priority"===t?this.priorityNode_:e.__childrenNodeConstructor.EMPTY_NODE},e.prototype.getChild=function(t){return t.isEmpty()?this:".priority"===t.getFront()?this.priorityNode_:e.__childrenNodeConstructor.EMPTY_NODE},e.prototype.hasChild=function(){return!1},e.prototype.getPredecessorChildName=function(e,t){return null},e.prototype.updateImmediateChild=function(t,n){return".priority"===t?this.updatePriority(n):n.isEmpty()&&".priority"!==t?this:e.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(t,n).updatePriority(this.priorityNode_)},e.prototype.updateChild=function(t,n){var r=t.getFront();return null===r?n:n.isEmpty()&&".priority"!==r?this:(s.assert(".priority"!==r||1===t.getLength(),".priority must be the last token in a path"),this.updateImmediateChild(r,e.__childrenNodeConstructor.EMPTY_NODE.updateChild(t.popFront(),n)))},e.prototype.isEmpty=function(){return!1},e.prototype.numChildren=function(){return 0},e.prototype.forEachChild=function(e,t){return!1},e.prototype.val=function(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()},e.prototype.hash=function(){if(null===this.lazyHash_){var e="";this.priorityNode_.isEmpty()||(e+="priority:"+ge(this.priorityNode_.val())+":");var t=typeof this.value_;e+=t+":",e+="number"===t?D(this.value_):this.value_,this.lazyHash_=m(e)}return this.lazyHash_},e.prototype.getValue=function(){return this.value_},e.prototype.compareTo=function(t){return t===e.__childrenNodeConstructor.EMPTY_NODE?1:t instanceof e.__childrenNodeConstructor?-1:(s.assert(t.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(t))},e.prototype.compareToLeafNode_=function(t){var n=typeof t.value_,r=typeof this.value_,i=e.VALUE_TYPE_ORDER.indexOf(n),o=e.VALUE_TYPE_ORDER.indexOf(r);return s.assert(i>=0,"Unknown leaf type: "+n),s.assert(o>=0,"Unknown leaf type: "+r),i===o?"object"===r?0:this.value_<t.value_?-1:this.value_===t.value_?0:1:o-i},e.prototype.withIndex=function(){return this},e.prototype.isIndexed=function(){return!0},e.prototype.equals=function(e){if(e===this)return!0;if(e.isLeafNode()){var t=e;return this.value_===t.value_&&this.priorityNode_.equals(t.priorityNode_)}return!1},e.VALUE_TYPE_ORDER=["object","boolean","number","string"],e}();var we,Ee,Se=new(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o.__extends(t,e),t.prototype.compare=function(e,t){var n=e.node.getPriority(),r=t.node.getPriority(),i=n.compareTo(r);return 0===i?A(e.name,t.name):i},t.prototype.isDefinedOn=function(e){return!e.getPriority().isEmpty()},t.prototype.indexedValueChanged=function(e,t){return!e.getPriority().equals(t.getPriority())},t.prototype.minPost=function(){return le.MIN},t.prototype.maxPost=function(){return new le(I,new be("[PRIORITY-POST]",ve))},t.prototype.makePost=function(e,t){var n=ye(e);return new le(t,new be("[PRIORITY-POST]",n))},t.prototype.toString=function(){return".priority"},t}(pe)),Ce=function(){function e(e,t,n,r,i){void 0===i&&(i=null),this.isReverse_=r,this.resultGenerator_=i,this.nodeStack_=[];for(var o=1;!e.isEmpty();)if(e=e,o=t?n(e.key,t):1,r&&(o*=-1),o<0)e=this.isReverse_?e.left:e.right;else{if(0===o){this.nodeStack_.push(e);break}this.nodeStack_.push(e),e=this.isReverse_?e.right:e.left}}return e.prototype.getNext=function(){if(0===this.nodeStack_.length)return null;var e,t=this.nodeStack_.pop();if(e=this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value},this.isReverse_)for(t=t.left;!t.isEmpty();)this.nodeStack_.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack_.push(t),t=t.left;return e},e.prototype.hasNext=function(){return this.nodeStack_.length>0},e.prototype.peek=function(){if(0===this.nodeStack_.length)return null;var e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}},e}(),Te=function(){function e(t,n,r,i,o){this.key=t,this.value=n,this.color=null!=r?r:e.RED,this.left=null!=i?i:Ie.EMPTY_NODE,this.right=null!=o?o:Ie.EMPTY_NODE}return e.prototype.copy=function(t,n,r,i,o){return new e(null!=t?t:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},e.prototype.count=function(){return this.left.count()+1+this.right.count()},e.prototype.isEmpty=function(){return!1},e.prototype.inorderTraversal=function(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)},e.prototype.reverseTraversal=function(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)},e.prototype.min_=function(){return this.left.isEmpty()?this:this.left.min_()},e.prototype.minKey=function(){return this.min_().key},e.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},e.prototype.insert=function(e,t,n){var r,i;return(i=(r=n(e,(i=this).key))<0?i.copy(null,null,null,i.left.insert(e,t,n),null):0===r?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,n))).fixUp_()},e.prototype.removeMin_=function(){if(this.left.isEmpty())return Ie.EMPTY_NODE;var e=this;return e.left.isRed_()||e.left.left.isRed_()||(e=e.moveRedLeft_()),(e=e.copy(null,null,null,e.left.removeMin_(),null)).fixUp_()},e.prototype.remove=function(e,t){var n,r;if(t(e,(n=this).key)<0)n.left.isEmpty()||n.left.isRed_()||n.left.left.isRed_()||(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.remove(e,t),null);else{if(n.left.isRed_()&&(n=n.rotateRight_()),n.right.isEmpty()||n.right.isRed_()||n.right.left.isRed_()||(n=n.moveRedRight_()),0===t(e,n.key)){if(n.right.isEmpty())return Ie.EMPTY_NODE;r=n.right.min_(),n=n.copy(r.key,r.value,null,null,n.right.removeMin_())}n=n.copy(null,null,null,null,n.right.remove(e,t))}return n.fixUp_()},e.prototype.isRed_=function(){return this.color},e.prototype.fixUp_=function(){var e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e},e.prototype.moveRedLeft_=function(){var e=this.colorFlip_();return e.right.left.isRed_()&&(e=(e=(e=e.copy(null,null,null,null,e.right.rotateRight_())).rotateLeft_()).colorFlip_()),e},e.prototype.moveRedRight_=function(){var e=this.colorFlip_();return e.left.left.isRed_()&&(e=(e=e.rotateRight_()).colorFlip_()),e},e.prototype.rotateLeft_=function(){var t=this.copy(null,null,e.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},e.prototype.rotateRight_=function(){var t=this.copy(null,null,e.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},e.prototype.colorFlip_=function(){var e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)},e.prototype.checkMaxDepth_=function(){var e=this.check_();return Math.pow(2,e)<=this.count()+1},e.prototype.check_=function(){var e;if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");if((e=this.left.check_())!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)},e.RED=!0,e.BLACK=!1,e}(),ke=function(){function e(){}return e.prototype.copy=function(e,t,n,r,i){return this},e.prototype.insert=function(e,t,n){return new Te(e,t,null)},e.prototype.remove=function(e,t){return this},e.prototype.count=function(){return 0},e.prototype.isEmpty=function(){return!0},e.prototype.inorderTraversal=function(e){return!1},e.prototype.reverseTraversal=function(e){return!1},e.prototype.minKey=function(){return null},e.prototype.maxKey=function(){return null},e.prototype.check_=function(){return 0},e.prototype.isRed_=function(){return!1},e}(),Ie=function(){function e(t,n){void 0===n&&(n=e.EMPTY_NODE),this.comparator_=t,this.root_=n}return e.prototype.insert=function(t,n){return new e(this.comparator_,this.root_.insert(t,n,this.comparator_).copy(null,null,Te.BLACK,null,null))},e.prototype.remove=function(t){return new e(this.comparator_,this.root_.remove(t,this.comparator_).copy(null,null,Te.BLACK,null,null))},e.prototype.get=function(e){for(var t,n=this.root_;!n.isEmpty();){if(0===(t=this.comparator_(e,n.key)))return n.value;t<0?n=n.left:t>0&&(n=n.right)}return null},e.prototype.getPredecessorKey=function(e){for(var t,n=this.root_,r=null;!n.isEmpty();){if(0===(t=this.comparator_(e,n.key))){if(n.left.isEmpty())return r?r.key:null;for(n=n.left;!n.right.isEmpty();)n=n.right;return n.key}t<0?n=n.left:t>0&&(r=n,n=n.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")},e.prototype.isEmpty=function(){return this.root_.isEmpty()},e.prototype.count=function(){return this.root_.count()},e.prototype.minKey=function(){return this.root_.minKey()},e.prototype.maxKey=function(){return this.root_.maxKey()},e.prototype.inorderTraversal=function(e){return this.root_.inorderTraversal(e)},e.prototype.reverseTraversal=function(e){return this.root_.reverseTraversal(e)},e.prototype.getIterator=function(e){return new Ce(this.root_,null,this.comparator_,!1,e)},e.prototype.getIteratorFrom=function(e,t){return new Ce(this.root_,e,this.comparator_,!1,t)},e.prototype.getReverseIteratorFrom=function(e,t){return new Ce(this.root_,e,this.comparator_,!0,t)},e.prototype.getReverseIterator=function(e){return new Ce(this.root_,null,this.comparator_,!0,e)},e.EMPTY_NODE=new ke,e}(),Ae=Math.log(2),Ne=function(){function e(e){this.count=function(e){return parseInt(Math.log(e)/Ae,10)}(e+1),this.current_=this.count-1;var t=function(e){return parseInt(Array(e+1).join("1"),2)}(this.count);this.bits_=e+1&t}return e.prototype.nextBitIsOne=function(){var e=!(this.bits_&1<<this.current_);return this.current_--,e},e}(),Re=function(e,t,n,r){e.sort(t);var i=function(t,r){var o,s,a=r-t;if(0==a)return null;if(1==a)return o=e[t],s=n?n(o):o,new Te(s,o.node,Te.BLACK,null,null);var u=parseInt(a/2,10)+t,c=i(t,u),h=i(u+1,r);return o=e[u],s=n?n(o):o,new Te(s,o.node,Te.BLACK,c,h)},o=function(t){for(var r=null,o=null,s=e.length,a=function(t,r){var o=s-t,a=s;s-=t;var c=i(o+1,a),h=e[o],l=n?n(h):h;u(new Te(l,h.node,r,null,c))},u=function(e){r?(r.left=e,r=e):(o=e,r=e)},c=0;c<t.count;++c){var h=t.nextBitIsOne(),l=Math.pow(2,t.count-(c+1));h?a(l,Te.BLACK):(a(l,Te.BLACK),a(l,Te.RED))}return o}(new Ne(e.length));return new Ie(r||t,o)},Oe={},xe=function(){function e(e,t){this.indexes_=e,this.indexSet_=t}return Object.defineProperty(e,"Default",{get:function(){return s.assert(Oe&&Se,"ChildrenNode.ts has not been loaded"),we=we||new e({".priority":Oe},{".priority":Se})},enumerable:!0,configurable:!0}),e.prototype.get=function(e){var t=s.safeGet(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof Ie?t:null},e.prototype.hasIndex=function(e){return s.contains(this.indexSet_,e.toString())},e.prototype.addIndex=function(t,n){s.assert(t!==fe,"KeyIndex always exists and isn't meant to be added to the IndexMap.");for(var r,i=[],a=!1,u=n.getIterator(le.Wrap),c=u.getNext();c;)a=a||t.isDefinedOn(c.node),i.push(c),c=u.getNext();r=a?Re(i,t.getCompare()):Oe;var h=t.toString(),l=o.__assign({},this.indexSet_);l[h]=t;var p=o.__assign({},this.indexes_);return p[h]=r,new e(p,l)},e.prototype.addToIndexes=function(t,n){var r=this;return new e(s.map(this.indexes_,function(e,i){var o=s.safeGet(r.indexSet_,i);if(s.assert(o,"Missing index implementation for "+i),e===Oe){if(o.isDefinedOn(t.node)){for(var a=[],u=n.getIterator(le.Wrap),c=u.getNext();c;)c.name!=t.name&&a.push(c),c=u.getNext();return a.push(t),Re(a,o.getCompare())}return Oe}var h=n.get(t.name),l=e;return h&&(l=l.remove(new le(t.name,h))),l.insert(t,t.node)}),this.indexSet_)},e.prototype.removeFromIndexes=function(t,n){return new e(s.map(this.indexes_,function(e){if(e===Oe)return e;var r=n.get(t.name);return r?e.remove(new le(t.name,r)):e}),this.indexSet_)},e}();function Pe(e,t){return A(e.name,t.name)}function De(e,t){return A(e,t)}var Me=function(){function e(e,t,n){this.children_=e,this.priorityNode_=t,this.indexMap_=n,this.lazyHash_=null,this.priorityNode_&&_e(this.priorityNode_),this.children_.isEmpty()&&s.assert(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}return Object.defineProperty(e,"EMPTY_NODE",{get:function(){return Ee||(Ee=new e(new Ie(De),null,xe.Default))},enumerable:!0,configurable:!0}),e.prototype.isLeafNode=function(){return!1},e.prototype.getPriority=function(){return this.priorityNode_||Ee},e.prototype.updatePriority=function(t){return this.children_.isEmpty()?this:new e(this.children_,t,this.indexMap_)},e.prototype.getImmediateChild=function(e){if(".priority"===e)return this.getPriority();var t=this.children_.get(e);return null===t?Ee:t},e.prototype.getChild=function(e){var t=e.getFront();return null===t?this:this.getImmediateChild(t).getChild(e.popFront())},e.prototype.hasChild=function(e){return null!==this.children_.get(e)},e.prototype.updateImmediateChild=function(t,n){if(s.assert(n,"We should always be passing snapshot nodes"),".priority"===t)return this.updatePriority(n);var r=new le(t,n),i=void 0,o=void 0;return n.isEmpty()?(i=this.children_.remove(t),o=this.indexMap_.removeFromIndexes(r,this.children_)):(i=this.children_.insert(t,n),o=this.indexMap_.addToIndexes(r,this.children_)),new e(i,i.isEmpty()?Ee:this.priorityNode_,o)},e.prototype.updateChild=function(e,t){var n=e.getFront();if(null===n)return t;s.assert(".priority"!==e.getFront()||1===e.getLength(),".priority must be the last token in a path");var r=this.getImmediateChild(n).updateChild(e.popFront(),t);return this.updateImmediateChild(n,r)},e.prototype.isEmpty=function(){return this.children_.isEmpty()},e.prototype.numChildren=function(){return this.children_.count()},e.prototype.val=function(t){if(this.isEmpty())return null;var n={},r=0,i=0,o=!0;if(this.forEachChild(Se,function(s,a){n[s]=a.val(t),r++,o&&e.INTEGER_REGEXP_.test(s)?i=Math.max(i,Number(s)):o=!1}),!t&&o&&i<2*r){var s=[];for(var a in n)s[a]=n[a];return s}return t&&!this.getPriority().isEmpty()&&(n[".priority"]=this.getPriority().val()),n},e.prototype.hash=function(){if(null===this.lazyHash_){var e="";this.getPriority().isEmpty()||(e+="priority:"+ge(this.getPriority().val())+":"),this.forEachChild(Se,function(t,n){var r=n.hash();""!==r&&(e+=":"+t+":"+r)}),this.lazyHash_=""===e?"":m(e)}return this.lazyHash_},e.prototype.getPredecessorChildName=function(e,t,n){var r=this.resolveIndex_(n);if(r){var i=r.getPredecessorKey(new le(e,t));return i?i.name:null}return this.children_.getPredecessorKey(e)},e.prototype.getFirstChildName=function(e){var t=this.resolveIndex_(e);if(t){var n=t.minKey();return n&&n.name}return this.children_.minKey()},e.prototype.getFirstChild=function(e){var t=this.getFirstChildName(e);return t?new le(t,this.children_.get(t)):null},e.prototype.getLastChildName=function(e){var t=this.resolveIndex_(e);if(t){var n=t.maxKey();return n&&n.name}return this.children_.maxKey()},e.prototype.getLastChild=function(e){var t=this.getLastChildName(e);return t?new le(t,this.children_.get(t)):null},e.prototype.forEachChild=function(e,t){var n=this.resolveIndex_(e);return n?n.inorderTraversal(function(e){return t(e.name,e.node)}):this.children_.inorderTraversal(t)},e.prototype.getIterator=function(e){return this.getIteratorFrom(e.minPost(),e)},e.prototype.getIteratorFrom=function(e,t){var n=this.resolveIndex_(t);if(n)return n.getIteratorFrom(e,function(e){return e});for(var r=this.children_.getIteratorFrom(e.name,le.Wrap),i=r.peek();null!=i&&t.compare(i,e)<0;)r.getNext(),i=r.peek();return r},e.prototype.getReverseIterator=function(e){return this.getReverseIteratorFrom(e.maxPost(),e)},e.prototype.getReverseIteratorFrom=function(e,t){var n=this.resolveIndex_(t);if(n)return n.getReverseIteratorFrom(e,function(e){return e});for(var r=this.children_.getReverseIteratorFrom(e.name,le.Wrap),i=r.peek();null!=i&&t.compare(i,e)>0;)r.getNext(),i=r.peek();return r},e.prototype.compareTo=function(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===Le?-1:0},e.prototype.withIndex=function(t){if(t===fe||this.indexMap_.hasIndex(t))return this;var n=this.indexMap_.addIndex(t,this.children_);return new e(this.children_,this.priorityNode_,n)},e.prototype.isIndexed=function(e){return e===fe||this.indexMap_.hasIndex(e)},e.prototype.equals=function(e){if(e===this)return!0;if(e.isLeafNode())return!1;var t=e;if(this.getPriority().equals(t.getPriority())){if(this.children_.count()===t.children_.count()){for(var n=this.getIterator(Se),r=t.getIterator(Se),i=n.getNext(),o=r.getNext();i&&o;){if(i.name!==o.name||!i.node.equals(o.node))return!1;i=n.getNext(),o=r.getNext()}return null===i&&null===o}return!1}return!1},e.prototype.resolveIndex_=function(e){return e===fe?null:this.indexMap_.get(e.toString())},e.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,e}(),Le=new(function(e){function t(){return e.call(this,new Ie(De),Me.EMPTY_NODE,xe.Default)||this}return o.__extends(t,e),t.prototype.compareTo=function(e){return e===this?0:1},t.prototype.equals=function(e){return e===this},t.prototype.getPriority=function(){return this},t.prototype.getImmediateChild=function(e){return Me.EMPTY_NODE},t.prototype.isEmpty=function(){return!1},t}(Me));Object.defineProperties(le,{MIN:{value:new le(k,Me.EMPTY_NODE)},MAX:{value:new le(I,Le)}}),de.__EMPTY_NODE=Me.EMPTY_NODE,be.__childrenNodeConstructor=Me,function(e){G=e}(Le),function(e){ve=e}(Le);var je=!0;function Fe(e,t){if(void 0===t&&(t=null),null===e)return Me.EMPTY_NODE;if("object"==typeof e&&".priority"in e&&(t=e[".priority"]),s.assert(null===t||"string"==typeof t||"number"==typeof t||"object"==typeof t&&".sv"in t,"Invalid priority type found: "+typeof t),"object"==typeof e&&".value"in e&&null!==e[".value"]&&(e=e[".value"]),"object"!=typeof e||".sv"in e)return new be(e,Fe(t));if(e instanceof Array||!je){var n=Me.EMPTY_NODE;return P(e,function(t,r){if(s.contains(e,t)&&"."!==t.substring(0,1)){var i=Fe(r);!i.isLeafNode()&&i.isEmpty()||(n=n.updateImmediateChild(t,i))}}),n.updatePriority(Fe(t))}var r=[],i=!1;if(P(e,function(e,t){if("."!==e.substring(0,1)){var n=Fe(t);n.isEmpty()||(i=i||!n.getPriority().isEmpty(),r.push(new le(e,n)))}}),0==r.length)return Me.EMPTY_NODE;var o=Re(r,Pe,function(e){return e.name},De);if(i){var a=Re(r,Se.getCompare());return new Me(o,Fe(t),new xe({".priority":a},{".priority":Se}))}return new Me(o,Fe(t),xe.Default)}!function(e){ye=e}(Fe);var Be,Ue,Ve=new(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o.__extends(t,e),t.prototype.compare=function(e,t){var n=e.node.compareTo(t.node);return 0===n?A(e.name,t.name):n},t.prototype.isDefinedOn=function(e){return!0},t.prototype.indexedValueChanged=function(e,t){return!e.equals(t)},t.prototype.minPost=function(){return le.MIN},t.prototype.maxPost=function(){return le.MAX},t.prototype.makePost=function(e,t){var n=Fe(e);return new le(t,n)},t.prototype.toString=function(){return".value"},t}(pe)),qe=function(e){function t(t){var n=e.call(this)||this;return n.indexPath_=t,s.assert(!t.isEmpty()&&".priority"!==t.getFront(),"Can't create PathIndex with empty path or .priority key"),n}return o.__extends(t,e),t.prototype.extractChild=function(e){return e.getChild(this.indexPath_)},t.prototype.isDefinedOn=function(e){return!e.getChild(this.indexPath_).isEmpty()},t.prototype.compare=function(e,t){var n=this.extractChild(e.node),r=this.extractChild(t.node),i=n.compareTo(r);return 0===i?A(e.name,t.name):i},t.prototype.makePost=function(e,t){var n=Fe(e),r=Me.EMPTY_NODE.updateChild(this.indexPath_,n);return new le(t,r)},t.prototype.maxPost=function(){var e=Me.EMPTY_NODE.updateChild(this.indexPath_,Le);return new le(I,e)},t.prototype.toString=function(){return this.indexPath_.slice().join("/")},t}(pe),We=function(){function e(e,t,n){this.node_=e,this.ref_=t,this.index_=n}return e.prototype.val=function(){return s.validateArgCount("DataSnapshot.val",0,0,arguments.length),this.node_.val()},e.prototype.exportVal=function(){return s.validateArgCount("DataSnapshot.exportVal",0,0,arguments.length),this.node_.val(!0)},e.prototype.toJSON=function(){return s.validateArgCount("DataSnapshot.toJSON",0,1,arguments.length),this.exportVal()},e.prototype.exists=function(){return s.validateArgCount("DataSnapshot.exists",0,0,arguments.length),!this.node_.isEmpty()},e.prototype.child=function(t){s.validateArgCount("DataSnapshot.child",0,1,arguments.length),t=String(t),oe("DataSnapshot.child",1,t,!1);var n=new U(t),r=this.ref_.child(n);return new e(this.node_.getChild(n),r,Se)},e.prototype.hasChild=function(e){s.validateArgCount("DataSnapshot.hasChild",1,1,arguments.length),oe("DataSnapshot.hasChild",1,e,!1);var t=new U(e);return!this.node_.getChild(t).isEmpty()},e.prototype.getPriority=function(){return s.validateArgCount("DataSnapshot.getPriority",0,0,arguments.length),this.node_.getPriority().val()},e.prototype.forEach=function(t){var n=this;return s.validateArgCount("DataSnapshot.forEach",1,1,arguments.length),s.validateCallback("DataSnapshot.forEach",1,t,!1),!this.node_.isLeafNode()&&!!this.node_.forEachChild(this.index_,function(r,i){return t(new e(i,n.ref_.child(r),Se))})},e.prototype.hasChildren=function(){return s.validateArgCount("DataSnapshot.hasChildren",0,0,arguments.length),!this.node_.isLeafNode()&&!this.node_.isEmpty()},Object.defineProperty(e.prototype,"key",{get:function(){return this.ref_.getKey()},enumerable:!0,configurable:!0}),e.prototype.numChildren=function(){return s.validateArgCount("DataSnapshot.numChildren",0,0,arguments.length),this.node_.numChildren()},e.prototype.getRef=function(){return s.validateArgCount("DataSnapshot.ref",0,0,arguments.length),this.ref_},Object.defineProperty(e.prototype,"ref",{get:function(){return this.getRef()},enumerable:!0,configurable:!0}),e}(),He=function(){function e(e,t,n,r){this.eventType=e,this.eventRegistration=t,this.snapshot=n,this.prevName=r}return e.prototype.getPath=function(){var e=this.snapshot.getRef();return"value"===this.eventType?e.path:e.getParent().path},e.prototype.getEventType=function(){return this.eventType},e.prototype.getEventRunner=function(){return this.eventRegistration.getEventRunner(this)},e.prototype.toString=function(){return this.getPath().toString()+":"+this.eventType+":"+s.stringify(this.snapshot.exportVal())},e}(),Ge=function(){function e(e,t,n){this.eventRegistration=e,this.error=t,this.path=n}return e.prototype.getPath=function(){return this.path},e.prototype.getEventType=function(){return"cancel"},e.prototype.getEventRunner=function(){return this.eventRegistration.getEventRunner(this)},e.prototype.toString=function(){return this.path.toString()+":cancel"},e}(),ze=function(){function e(e,t,n){this.callback_=e,this.cancelCallback_=t,this.context_=n}return e.prototype.respondsTo=function(e){return"value"===e},e.prototype.createEvent=function(e,t){var n=t.getQueryParams().getIndex();return new He("value",this,new We(e.snapshotNode,t.getRef(),n))},e.prototype.getEventRunner=function(e){var t=this.context_;if("cancel"===e.getEventType()){s.assert(this.cancelCallback_,"Raising a cancel event on a listener with no cancel callback");var n=this.cancelCallback_;return function(){n.call(t,e.error)}}var r=this.callback_;return function(){r.call(t,e.snapshot)}},e.prototype.createCancelEvent=function(e,t){return this.cancelCallback_?new Ge(this,e,t):null},e.prototype.matches=function(t){return t instanceof e&&(!t.callback_||!this.callback_||t.callback_===this.callback_&&t.context_===this.context_)},e.prototype.hasAnyCallback=function(){return null!==this.callback_},e}(),Ye=function(){function e(e,t,n){this.callbacks_=e,this.cancelCallback_=t,this.context_=n}return e.prototype.respondsTo=function(e){var t="children_added"===e?"child_added":e;return t="children_removed"===t?"child_removed":t,s.contains(this.callbacks_,t)},e.prototype.createCancelEvent=function(e,t){return this.cancelCallback_?new Ge(this,e,t):null},e.prototype.createEvent=function(e,t){s.assert(null!=e.childName,"Child events should have a childName.");var n=t.getRef().child(e.childName),r=t.getQueryParams().getIndex();return new He(e.type,this,new We(e.snapshotNode,n,r),e.prevName)},e.prototype.getEventRunner=function(e){var t=this.context_;if("cancel"===e.getEventType()){s.assert(this.cancelCallback_,"Raising a cancel event on a listener with no cancel callback");var n=this.cancelCallback_;return function(){n.call(t,e.error)}}var r=this.callbacks_[e.eventType];return function(){r.call(t,e.snapshot,e.prevName)}},e.prototype.matches=function(t){var n=this;if(t instanceof e){if(!this.callbacks_||!t.callbacks_)return!0;if(this.context_===t.context_){var r=Object.keys(t.callbacks_),i=Object.keys(this.callbacks_),o=r.length;if(o===i.length){if(1===o){var s=r[0],a=i[0];return!(a!==s||t.callbacks_[s]&&this.callbacks_[a]&&t.callbacks_[s]!==this.callbacks_[a])}return i.every(function(e){return t.callbacks_[e]===n.callbacks_[e]})}}}return!1},e.prototype.hasAnyCallback=function(){return null!==this.callbacks_},e}(),Qe=function(){function e(e,t,n,r){this.repo=e,this.path=t,this.queryParams_=n,this.orderByCalled_=r}return Object.defineProperty(e,"__referenceConstructor",{get:function(){return s.assert(Be,"Reference.ts has not been loaded"),Be},set:function(e){Be=e},enumerable:!0,configurable:!0}),e.validateQueryEndpoints_=function(e){var t=null,n=null;if(e.hasStart()&&(t=e.getIndexStartValue()),e.hasEnd()&&(n=e.getIndexEndValue()),e.getIndex()===fe){var r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",i="Query: When ordering by key, the argument passed to startAt(), endAt(),or equalTo() must be a string.";if(e.hasStart()){if(e.getIndexStartName()!=k)throw new Error(r);if("string"!=typeof t)throw new Error(i)}if(e.hasEnd()){if(e.getIndexEndName()!=I)throw new Error(r);if("string"!=typeof n)throw new Error(i)}}else if(e.getIndex()===Se){if(null!=t&&!J(t)||null!=n&&!J(n))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), endAt(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(s.assert(e.getIndex()instanceof qe||e.getIndex()===Ve,"unknown index type."),null!=t&&"object"==typeof t||null!=n&&"object"==typeof n)throw new Error("Query: First argument passed to startAt(), endAt(), or equalTo() cannot be an object.")},e.validateLimit_=function(e){if(e.hasStart()&&e.hasEnd()&&e.hasLimit()&&!e.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), endAt(), and limit(). Use limitToFirst() or limitToLast() instead.")},e.prototype.validateNoPreviousOrderByCall_=function(e){if(!0===this.orderByCalled_)throw new Error(e+": You can't combine multiple orderBy calls.")},e.prototype.getQueryParams=function(){return this.queryParams_},e.prototype.getRef=function(){return s.validateArgCount("Query.ref",0,0,arguments.length),new e.__referenceConstructor(this.repo,this.path)},e.prototype.on=function(t,n,r,i){s.validateArgCount("Query.on",2,4,arguments.length),re("Query.on",1,t,!1),s.validateCallback("Query.on",2,n,!1);var o=e.getCancelAndContextArgs_("Query.on",r,i);if("value"===t)this.onValueEvent(n,o.cancel,o.context);else{var a={};a[t]=n,this.onChildEvent(a,o.cancel,o.context)}return n},e.prototype.onValueEvent=function(e,t,n){var r=new ze(e,t||null,n||null);this.repo.addEventCallbackForQuery(this,r)},e.prototype.onChildEvent=function(e,t,n){var r=new Ye(e,t,n);this.repo.addEventCallbackForQuery(this,r)},e.prototype.off=function(e,t,n){s.validateArgCount("Query.off",0,3,arguments.length),re("Query.off",1,e,!0),s.validateCallback("Query.off",2,t,!0),s.validateContextObject("Query.off",3,n,!0);var r=null,i=null;"value"===e?r=new ze(t||null,null,n||null):e&&(t&&((i={})[e]=t),r=new Ye(i,null,n||null));this.repo.removeEventCallbackForQuery(this,r)},e.prototype.once=function(t,n,r,i){var o=this;s.validateArgCount("Query.once",1,4,arguments.length),re("Query.once",1,t,!1),s.validateCallback("Query.once",2,n,!0);var a=e.getCancelAndContextArgs_("Query.once",r,i),u=!0,c=new s.Deferred;c.promise.catch(function(){});var h=function(e){u&&(u=!1,o.off(t,h),n&&n.bind(a.context)(e),c.resolve(e))};return this.on(t,h,function(e){o.off(t,h),a.cancel&&a.cancel.bind(a.context)(e),c.reject(e)}),c.promise},e.prototype.limitToFirst=function(t){if(s.validateArgCount("Query.limitToFirst",1,1,arguments.length),"number"!=typeof t||Math.floor(t)!==t||t<=0)throw new Error("Query.limitToFirst: First argument must be a positive integer.");if(this.queryParams_.hasLimit())throw new Error("Query.limitToFirst: Limit was already set (by another call to limit, limitToFirst, or limitToLast).");return new e(this.repo,this.path,this.queryParams_.limitToFirst(t),this.orderByCalled_)},e.prototype.limitToLast=function(t){if(s.validateArgCount("Query.limitToLast",1,1,arguments.length),"number"!=typeof t||Math.floor(t)!==t||t<=0)throw new Error("Query.limitToLast: First argument must be a positive integer.");if(this.queryParams_.hasLimit())throw new Error("Query.limitToLast: Limit was already set (by another call to limit, limitToFirst, or limitToLast).");return new e(this.repo,this.path,this.queryParams_.limitToLast(t),this.orderByCalled_)},e.prototype.orderByChild=function(t){if(s.validateArgCount("Query.orderByChild",1,1,arguments.length),"$key"===t)throw new Error('Query.orderByChild: "$key" is invalid.  Use Query.orderByKey() instead.');if("$priority"===t)throw new Error('Query.orderByChild: "$priority" is invalid.  Use Query.orderByPriority() instead.');if("$value"===t)throw new Error('Query.orderByChild: "$value" is invalid.  Use Query.orderByValue() instead.');oe("Query.orderByChild",1,t,!1),this.validateNoPreviousOrderByCall_("Query.orderByChild");var n=new U(t);if(n.isEmpty())throw new Error("Query.orderByChild: cannot pass in empty path.  Use Query.orderByValue() instead.");var r=new qe(n),i=this.queryParams_.orderBy(r);return e.validateQueryEndpoints_(i),new e(this.repo,this.path,i,!0)},e.prototype.orderByKey=function(){s.validateArgCount("Query.orderByKey",0,0,arguments.length),this.validateNoPreviousOrderByCall_("Query.orderByKey");var t=this.queryParams_.orderBy(fe);return e.validateQueryEndpoints_(t),new e(this.repo,this.path,t,!0)},e.prototype.orderByPriority=function(){s.validateArgCount("Query.orderByPriority",0,0,arguments.length),this.validateNoPreviousOrderByCall_("Query.orderByPriority");var t=this.queryParams_.orderBy(Se);return e.validateQueryEndpoints_(t),new e(this.repo,this.path,t,!0)},e.prototype.orderByValue=function(){s.validateArgCount("Query.orderByValue",0,0,arguments.length),this.validateNoPreviousOrderByCall_("Query.orderByValue");var t=this.queryParams_.orderBy(Ve);return e.validateQueryEndpoints_(t),new e(this.repo,this.path,t,!0)},e.prototype.startAt=function(t,n){void 0===t&&(t=null),s.validateArgCount("Query.startAt",0,2,arguments.length),Z("Query.startAt",1,t,this.path,!0),ie("Query.startAt",2,n,!0);var r=this.queryParams_.startAt(t,n);if(e.validateLimit_(r),e.validateQueryEndpoints_(r),this.queryParams_.hasStart())throw new Error("Query.startAt: Starting point was already set (by another call to startAt or equalTo).");return void 0===t&&(t=null,n=null),new e(this.repo,this.path,r,this.orderByCalled_)},e.prototype.endAt=function(t,n){void 0===t&&(t=null),s.validateArgCount("Query.endAt",0,2,arguments.length),Z("Query.endAt",1,t,this.path,!0),ie("Query.endAt",2,n,!0);var r=this.queryParams_.endAt(t,n);if(e.validateLimit_(r),e.validateQueryEndpoints_(r),this.queryParams_.hasEnd())throw new Error("Query.endAt: Ending point was already set (by another call to endAt or equalTo).");return new e(this.repo,this.path,r,this.orderByCalled_)},e.prototype.equalTo=function(e,t){if(s.validateArgCount("Query.equalTo",1,2,arguments.length),Z("Query.equalTo",1,e,this.path,!1),ie("Query.equalTo",2,t,!0),this.queryParams_.hasStart())throw new Error("Query.equalTo: Starting point was already set (by another call to startAt or equalTo).");if(this.queryParams_.hasEnd())throw new Error("Query.equalTo: Ending point was already set (by another call to endAt or equalTo).");return this.startAt(e,t).endAt(e,t)},e.prototype.toString=function(){return s.validateArgCount("Query.toString",0,0,arguments.length),this.repo.toString()+this.path.toUrlEncodedString()},e.prototype.toJSON=function(){return s.validateArgCount("Query.toJSON",0,1,arguments.length),this.toString()},e.prototype.queryObject=function(){return this.queryParams_.getQueryObject()},e.prototype.queryIdentifier=function(){var e=this.queryObject(),t=O(e);return"{}"===t?"default":t},e.prototype.isEqual=function(t){if(s.validateArgCount("Query.isEqual",1,1,arguments.length),!(t instanceof e)){throw new Error("Query.isEqual failed: First argument must be an instance of firebase.database.Query.")}var n=this.repo===t.repo,r=this.path.equals(t.path),i=this.queryIdentifier()===t.queryIdentifier();return n&&r&&i},e.getCancelAndContextArgs_=function(e,t,n){var r={cancel:null,context:null};if(t&&n)r.cancel=t,s.validateCallback(e,3,r.cancel,!0),r.context=n,s.validateContextObject(e,4,r.context,!0);else if(t)if("object"==typeof t&&null!==t)r.context=t;else{if("function"!=typeof t)throw new Error(s.errorPrefix(e,3,!0)+" must either be a cancel callback or a context object.");r.cancel=t}return r},Object.defineProperty(e.prototype,"ref",{get:function(){return this.getRef()},enumerable:!0,configurable:!0}),e}(),Ke=function(){function e(){this.value=null,this.children=new Map}return e.prototype.find=function(e){if(null!=this.value)return this.value.getChild(e);if(!e.isEmpty()&&this.children.size>0){var t=e.getFront();return e=e.popFront(),this.children.has(t)?this.children.get(t).find(e):null}return null},e.prototype.remember=function(t,n){if(t.isEmpty())this.value=n,this.children.clear();else if(null!==this.value)this.value=this.value.updateChild(t,n);else{var r=t.getFront();this.children.has(r)||this.children.set(r,new e);var i=this.children.get(r);t=t.popFront(),i.remember(t,n)}},e.prototype.forget=function(e){if(e.isEmpty())return this.value=null,this.children.clear(),!0;if(null!==this.value){if(this.value.isLeafNode())return!1;var t=this.value;this.value=null;var n=this;return t.forEachChild(Se,function(e,t){n.remember(new U(e),t)}),this.forget(e)}if(this.children.size>0){var r=e.getFront();if(e=e.popFront(),this.children.has(r))this.children.get(r).forget(e)&&this.children.delete(r);return 0===this.children.size}return!0},e.prototype.forEachTree=function(e,t){null!==this.value?t(e,this.value):this.forEachChild(function(n,r){var i=new U(e.toString()+"/"+n);r.forEachTree(i,t)})},e.prototype.forEachChild=function(e){this.children.forEach(function(t,n){e(n,t)})},e}(),$e=function(e,t){return e&&"object"==typeof e?(s.assert(".sv"in e,"Unexpected leaf node or priority contents"),t[e[".sv"]]):e},Xe=function(e,t){var n,r=e.getPriority().val(),i=$e(r,t);if(e.isLeafNode()){var o=e,s=$e(o.getValue(),t);return s!==o.getValue()||i!==o.getPriority().val()?new be(s,Fe(i)):e}var a=e;return n=a,i!==a.getPriority().val()&&(n=n.updatePriority(new be(i))),a.forEachChild(Se,function(e,r){var i=Xe(r,t);i!==r&&(n=n.updateImmediateChild(e,i))}),n};!function(e){e[e.OVERWRITE=0]="OVERWRITE",e[e.MERGE=1]="MERGE",e[e.ACK_USER_WRITE=2]="ACK_USER_WRITE",e[e.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"}(Ue||(Ue={}));var Je,Ze,et=function(){function e(e,t,n,r){this.fromUser=e,this.fromServer=t,this.queryId=n,this.tagged=r,s.assert(!r||t,"Tagged queries must be from server.")}return e.User=new e(!0,!1,null,!1),e.Server=new e(!1,!0,null,!1),e.forServerTaggedQuery=function(t){return new e(!1,!0,t,!0)},e}(),tt=function(){function e(e,t,n){this.path=e,this.affectedTree=t,this.revert=n,this.type=Ue.ACK_USER_WRITE,this.source=et.User}return e.prototype.operationForChild=function(t){if(this.path.isEmpty()){if(null!=this.affectedTree.value)return s.assert(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;var n=this.affectedTree.subtree(new U(t));return new e(U.Empty,n,this.revert)}return s.assert(this.path.getFront()===t,"operationForChild called for unrelated child."),new e(this.path.popFront(),this.affectedTree,this.revert)},e}(),nt=function(){return Je||(Je=new Ie(N)),Je},rt=function(){function e(e,t){void 0===t&&(t=nt()),this.value=e,this.children=t}return e.fromObject=function(t){var n=e.Empty;return P(t,function(e,t){n=n.set(new U(e),t)}),n},e.prototype.isEmpty=function(){return null===this.value&&this.children.isEmpty()},e.prototype.findRootMostMatchingPathAndValue=function(e,t){if(null!=this.value&&t(this.value))return{path:U.Empty,value:this.value};if(e.isEmpty())return null;var n=e.getFront(),r=this.children.get(n);if(null!==r){var i=r.findRootMostMatchingPathAndValue(e.popFront(),t);return null!=i?{path:new U(n).child(i.path),value:i.value}:null}return null},e.prototype.findRootMostValueAndPath=function(e){return this.findRootMostMatchingPathAndValue(e,function(){return!0})},e.prototype.subtree=function(t){if(t.isEmpty())return this;var n=t.getFront(),r=this.children.get(n);return null!==r?r.subtree(t.popFront()):e.Empty},e.prototype.set=function(t,n){if(t.isEmpty())return new e(n,this.children);var r=t.getFront(),i=(this.children.get(r)||e.Empty).set(t.popFront(),n),o=this.children.insert(r,i);return new e(this.value,o)},e.prototype.remove=function(t){if(t.isEmpty())return this.children.isEmpty()?e.Empty:new e(null,this.children);var n=t.getFront(),r=this.children.get(n);if(r){var i=r.remove(t.popFront()),o=void 0;return o=i.isEmpty()?this.children.remove(n):this.children.insert(n,i),null===this.value&&o.isEmpty()?e.Empty:new e(this.value,o)}return this},e.prototype.get=function(e){if(e.isEmpty())return this.value;var t=e.getFront(),n=this.children.get(t);return n?n.get(e.popFront()):null},e.prototype.setTree=function(t,n){if(t.isEmpty())return n;var r=t.getFront(),i=(this.children.get(r)||e.Empty).setTree(t.popFront(),n),o=void 0;return o=i.isEmpty()?this.children.remove(r):this.children.insert(r,i),new e(this.value,o)},e.prototype.fold=function(e){return this.fold_(U.Empty,e)},e.prototype.fold_=function(e,t){var n={};return this.children.inorderTraversal(function(r,i){n[r]=i.fold_(e.child(r),t)}),t(e,this.value,n)},e.prototype.findOnPath=function(e,t){return this.findOnPath_(e,U.Empty,t)},e.prototype.findOnPath_=function(e,t,n){var r=!!this.value&&n(t,this.value);if(r)return r;if(e.isEmpty())return null;var i=e.getFront(),o=this.children.get(i);return o?o.findOnPath_(e.popFront(),t.child(i),n):null},e.prototype.foreachOnPath=function(e,t){return this.foreachOnPath_(e,U.Empty,t)},e.prototype.foreachOnPath_=function(t,n,r){if(t.isEmpty())return this;this.value&&r(n,this.value);var i=t.getFront(),o=this.children.get(i);return o?o.foreachOnPath_(t.popFront(),n.child(i),r):e.Empty},e.prototype.foreach=function(e){this.foreach_(U.Empty,e)},e.prototype.foreach_=function(e,t){this.children.inorderTraversal(function(n,r){r.foreach_(e.child(n),t)}),this.value&&t(e,this.value)},e.prototype.foreachChild=function(e){this.children.inorderTraversal(function(t,n){n.value&&e(t,n.value)})},e.Empty=new e(null),e}(),it=function(){function e(e,t){this.source=e,this.path=t,this.type=Ue.LISTEN_COMPLETE}return e.prototype.operationForChild=function(t){return this.path.isEmpty()?new e(this.source,U.Empty):new e(this.source,this.path.popFront())},e}(),ot=function(){function e(e,t,n){this.source=e,this.path=t,this.snap=n,this.type=Ue.OVERWRITE}return e.prototype.operationForChild=function(t){return this.path.isEmpty()?new e(this.source,U.Empty,this.snap.getImmediateChild(t)):new e(this.source,this.path.popFront(),this.snap)},e}(),st=function(){function e(e,t,n){this.source=e,this.path=t,this.children=n,this.type=Ue.MERGE}return e.prototype.operationForChild=function(t){if(this.path.isEmpty()){var n=this.children.subtree(new U(t));return n.isEmpty()?null:n.value?new ot(this.source,U.Empty,n.value):new e(this.source,U.Empty,n)}return s.assert(this.path.getFront()===t,"Can't get a merge for a child not on the path of the operation"),new e(this.source,this.path.popFront(),this.children)},e.prototype.toString=function(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"},e}(),at=function(){function e(e,t,n){this.node_=e,this.fullyInitialized_=t,this.filtered_=n}return e.prototype.isFullyInitialized=function(){return this.fullyInitialized_},e.prototype.isFiltered=function(){return this.filtered_},e.prototype.isCompleteForPath=function(e){if(e.isEmpty())return this.isFullyInitialized()&&!this.filtered_;var t=e.getFront();return this.isCompleteForChild(t)},e.prototype.isCompleteForChild=function(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)},e.prototype.getNode=function(){return this.node_},e}(),ut=function(){function e(e,t){this.eventCache_=e,this.serverCache_=t}return e.prototype.updateEventSnap=function(t,n,r){return new e(new at(t,n,r),this.serverCache_)},e.prototype.updateServerSnap=function(t,n,r){return new e(this.eventCache_,new at(t,n,r))},e.prototype.getEventCache=function(){return this.eventCache_},e.prototype.getCompleteEventSnap=function(){return this.eventCache_.isFullyInitialized()?this.eventCache_.getNode():null},e.prototype.getServerCache=function(){return this.serverCache_},e.prototype.getCompleteServerSnap=function(){return this.serverCache_.isFullyInitialized()?this.serverCache_.getNode():null},e.Empty=new e(new at(Me.EMPTY_NODE,!1,!1),new at(Me.EMPTY_NODE,!1,!1)),e}(),ct=function(){function e(e,t,n,r,i){this.type=e,this.snapshotNode=t,this.childName=n,this.oldSnap=r,this.prevName=i}return e.valueChange=function(t){return new e(e.VALUE,t)},e.childAddedChange=function(t,n){return new e(e.CHILD_ADDED,n,t)},e.childRemovedChange=function(t,n){return new e(e.CHILD_REMOVED,n,t)},e.childChangedChange=function(t,n,r){return new e(e.CHILD_CHANGED,n,t,r)},e.childMovedChange=function(t,n){return new e(e.CHILD_MOVED,n,t)},e.CHILD_ADDED="child_added",e.CHILD_REMOVED="child_removed",e.CHILD_CHANGED="child_changed",e.CHILD_MOVED="child_moved",e.VALUE="value",e}(),ht=function(){function e(e){this.index_=e}return e.prototype.updateChild=function(e,t,n,r,i,o){s.assert(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");var a=e.getImmediateChild(t);return a.getChild(r).equals(n.getChild(r))&&a.isEmpty()==n.isEmpty()?e:(null!=o&&(n.isEmpty()?e.hasChild(t)?o.trackChildChange(ct.childRemovedChange(t,a)):s.assert(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?o.trackChildChange(ct.childAddedChange(t,n)):o.trackChildChange(ct.childChangedChange(t,n,a))),e.isLeafNode()&&n.isEmpty()?e:e.updateImmediateChild(t,n).withIndex(this.index_))},e.prototype.updateFullNode=function(e,t,n){return null!=n&&(e.isLeafNode()||e.forEachChild(Se,function(e,r){t.hasChild(e)||n.trackChildChange(ct.childRemovedChange(e,r))}),t.isLeafNode()||t.forEachChild(Se,function(t,r){if(e.hasChild(t)){var i=e.getImmediateChild(t);i.equals(r)||n.trackChildChange(ct.childChangedChange(t,r,i))}else n.trackChildChange(ct.childAddedChange(t,r))})),t.withIndex(this.index_)},e.prototype.updatePriority=function(e,t){return e.isEmpty()?Me.EMPTY_NODE:e.updatePriority(t)},e.prototype.filtersNodes=function(){return!1},e.prototype.getIndexedFilter=function(){return this},e.prototype.getIndex=function(){return this.index_},e}(),lt=function(){function e(){this.changeMap=new Map}return e.prototype.trackChildChange=function(e){var t=e.type,n=e.childName;s.assert(t==ct.CHILD_ADDED||t==ct.CHILD_CHANGED||t==ct.CHILD_REMOVED,"Only child changes supported for tracking"),s.assert(".priority"!==n,"Only non-priority child changes can be tracked.");var r=this.changeMap.get(n);if(r){var i=r.type;if(t==ct.CHILD_ADDED&&i==ct.CHILD_REMOVED)this.changeMap.set(n,ct.childChangedChange(n,e.snapshotNode,r.snapshotNode));else if(t==ct.CHILD_REMOVED&&i==ct.CHILD_ADDED)this.changeMap.delete(n);else if(t==ct.CHILD_REMOVED&&i==ct.CHILD_CHANGED)this.changeMap.set(n,ct.childRemovedChange(n,r.oldSnap));else if(t==ct.CHILD_CHANGED&&i==ct.CHILD_ADDED)this.changeMap.set(n,ct.childAddedChange(n,e.snapshotNode));else{if(t!=ct.CHILD_CHANGED||i!=ct.CHILD_CHANGED)throw s.assertionError("Illegal combination of changes: "+e+" occurred after "+r);this.changeMap.set(n,ct.childChangedChange(n,e.snapshotNode,r.oldSnap))}}else this.changeMap.set(n,e)},e.prototype.getChanges=function(){return Array.from(this.changeMap.values())},e}(),pt=new(function(){function e(){}return e.prototype.getCompleteChild=function(e){return null},e.prototype.getChildAfterChild=function(e,t,n){return null},e}()),dt=function(){function e(e,t,n){void 0===n&&(n=null),this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=n}return e.prototype.getCompleteChild=function(e){var t=this.viewCache_.getEventCache();if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);var n=null!=this.optCompleteServerCache_?new at(this.optCompleteServerCache_,!0,!1):this.viewCache_.getServerCache();return this.writes_.calcCompleteChild(e,n)},e.prototype.getChildAfterChild=function(e,t,n){var r=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:this.viewCache_.getCompleteServerSnap(),i=this.writes_.calcIndexedSlice(r,t,1,n,e);return 0===i.length?null:i[0]},e}(),ft=function(){return function(e,t){this.viewCache=e,this.changes=t}}(),mt=function(){function e(e){this.filter_=e}return e.prototype.assertIndexed=function(e){s.assert(e.getEventCache().getNode().isIndexed(this.filter_.getIndex()),"Event snap not indexed"),s.assert(e.getServerCache().getNode().isIndexed(this.filter_.getIndex()),"Server snap not indexed")},e.prototype.applyOperation=function(t,n,r,i){var o,a,u=new lt;if(n.type===Ue.OVERWRITE){var c=n;c.source.fromUser?o=this.applyUserOverwrite_(t,c.path,c.snap,r,i,u):(s.assert(c.source.fromServer,"Unknown source."),a=c.source.tagged||t.getServerCache().isFiltered()&&!c.path.isEmpty(),o=this.applyServerOverwrite_(t,c.path,c.snap,r,i,a,u))}else if(n.type===Ue.MERGE){var h=n;h.source.fromUser?o=this.applyUserMerge_(t,h.path,h.children,r,i,u):(s.assert(h.source.fromServer,"Unknown source."),a=h.source.tagged||t.getServerCache().isFiltered(),o=this.applyServerMerge_(t,h.path,h.children,r,i,a,u))}else if(n.type===Ue.ACK_USER_WRITE){var l=n;o=l.revert?this.revertUserWrite_(t,l.path,r,i,u):this.ackUserWrite_(t,l.path,l.affectedTree,r,i,u)}else{if(n.type!==Ue.LISTEN_COMPLETE)throw s.assertionError("Unknown operation type: "+n.type);o=this.listenComplete_(t,n.path,r,u)}var p=u.getChanges();return e.maybeAddValueEvent_(t,o,p),new ft(o,p)},e.maybeAddValueEvent_=function(e,t,n){var r=t.getEventCache();if(r.isFullyInitialized()){var i=r.getNode().isLeafNode()||r.getNode().isEmpty(),o=e.getCompleteEventSnap();(n.length>0||!e.getEventCache().isFullyInitialized()||i&&!r.getNode().equals(o)||!r.getNode().getPriority().equals(o.getPriority()))&&n.push(ct.valueChange(t.getCompleteEventSnap()))}},e.prototype.generateEventCacheAfterServerEvent_=function(e,t,n,r,i){var o=e.getEventCache();if(null!=n.shadowingWrite(t))return e;var a=void 0,u=void 0;if(t.isEmpty())if(s.assert(e.getServerCache().isFullyInitialized(),"If change path is empty, we must have complete server data"),e.getServerCache().isFiltered()){var c=e.getCompleteServerSnap(),h=c instanceof Me?c:Me.EMPTY_NODE,l=n.calcCompleteEventChildren(h);a=this.filter_.updateFullNode(e.getEventCache().getNode(),l,i)}else{var p=n.calcCompleteEventCache(e.getCompleteServerSnap());a=this.filter_.updateFullNode(e.getEventCache().getNode(),p,i)}else{var d=t.getFront();if(".priority"==d){s.assert(1==t.getLength(),"Can't have a priority with additional path components");var f=o.getNode();u=e.getServerCache().getNode();var m=n.calcEventCacheAfterServerOverwrite(t,f,u);a=null!=m?this.filter_.updatePriority(f,m):o.getNode()}else{var y=t.popFront(),v=void 0;if(o.isCompleteForChild(d)){u=e.getServerCache().getNode();var g=n.calcEventCacheAfterServerOverwrite(t,o.getNode(),u);v=null!=g?o.getNode().getImmediateChild(d).updateChild(y,g):o.getNode().getImmediateChild(d)}else v=n.calcCompleteChild(d,e.getServerCache());a=null!=v?this.filter_.updateChild(o.getNode(),d,v,y,r,i):o.getNode()}}return e.updateEventSnap(a,o.isFullyInitialized()||t.isEmpty(),this.filter_.filtersNodes())},e.prototype.applyServerOverwrite_=function(e,t,n,r,i,o,s){var a,u=e.getServerCache(),c=o?this.filter_:this.filter_.getIndexedFilter();if(t.isEmpty())a=c.updateFullNode(u.getNode(),n,null);else if(c.filtersNodes()&&!u.isFiltered()){var h=u.getNode().updateChild(t,n);a=c.updateFullNode(u.getNode(),h,null)}else{var l=t.getFront();if(!u.isCompleteForPath(t)&&t.getLength()>1)return e;var p=t.popFront(),d=u.getNode().getImmediateChild(l).updateChild(p,n);a=".priority"==l?c.updatePriority(u.getNode(),d):c.updateChild(u.getNode(),l,d,p,pt,null)}var f=e.updateServerSnap(a,u.isFullyInitialized()||t.isEmpty(),c.filtersNodes()),m=new dt(r,f,i);return this.generateEventCacheAfterServerEvent_(f,t,r,m,s)},e.prototype.applyUserOverwrite_=function(e,t,n,r,i,o){var s,a,u=e.getEventCache(),c=new dt(r,e,i);if(t.isEmpty())a=this.filter_.updateFullNode(e.getEventCache().getNode(),n,o),s=e.updateEventSnap(a,!0,this.filter_.filtersNodes());else{var h=t.getFront();if(".priority"===h)a=this.filter_.updatePriority(e.getEventCache().getNode(),n),s=e.updateEventSnap(a,u.isFullyInitialized(),u.isFiltered());else{var l=t.popFront(),p=u.getNode().getImmediateChild(h),d=void 0;if(l.isEmpty())d=n;else{var f=c.getCompleteChild(h);d=null!=f?".priority"===l.getBack()&&f.getChild(l.parent()).isEmpty()?f:f.updateChild(l,n):Me.EMPTY_NODE}if(p.equals(d))s=e;else{var m=this.filter_.updateChild(u.getNode(),h,d,l,c,o);s=e.updateEventSnap(m,u.isFullyInitialized(),this.filter_.filtersNodes())}}}return s},e.cacheHasChild_=function(e,t){return e.getEventCache().isCompleteForChild(t)},e.prototype.applyUserMerge_=function(t,n,r,i,o,s){var a=this,u=t;return r.foreach(function(r,c){var h=n.child(r);e.cacheHasChild_(t,h.getFront())&&(u=a.applyUserOverwrite_(u,h,c,i,o,s))}),r.foreach(function(r,c){var h=n.child(r);e.cacheHasChild_(t,h.getFront())||(u=a.applyUserOverwrite_(u,h,c,i,o,s))}),u},e.prototype.applyMerge_=function(e,t){return t.foreach(function(t,n){e=e.updateChild(t,n)}),e},e.prototype.applyServerMerge_=function(e,t,n,r,i,o,s){var a=this;if(e.getServerCache().getNode().isEmpty()&&!e.getServerCache().isFullyInitialized())return e;var u,c=e;u=t.isEmpty()?n:rt.Empty.setTree(t,n);var h=e.getServerCache().getNode();return u.children.inorderTraversal(function(t,n){if(h.hasChild(t)){var u=e.getServerCache().getNode().getImmediateChild(t),l=a.applyMerge_(u,n);c=a.applyServerOverwrite_(c,new U(t),l,r,i,o,s)}}),u.children.inorderTraversal(function(t,n){var u=!e.getServerCache().isCompleteForChild(t)&&null==n.value;if(!h.hasChild(t)&&!u){var l=e.getServerCache().getNode().getImmediateChild(t),p=a.applyMerge_(l,n);c=a.applyServerOverwrite_(c,new U(t),p,r,i,o,s)}}),c},e.prototype.ackUserWrite_=function(e,t,n,r,i,o){if(null!=r.shadowingWrite(t))return e;var s=e.getServerCache().isFiltered(),a=e.getServerCache();if(null!=n.value){if(t.isEmpty()&&a.isFullyInitialized()||a.isCompleteForPath(t))return this.applyServerOverwrite_(e,t,a.getNode().getChild(t),r,i,s,o);if(t.isEmpty()){var u=rt.Empty;return a.getNode().forEachChild(fe,function(e,t){u=u.set(new U(e),t)}),this.applyServerMerge_(e,t,u,r,i,s,o)}return e}var c=rt.Empty;return n.foreach(function(e,n){var r=t.child(e);a.isCompleteForPath(r)&&(c=c.set(e,a.getNode().getChild(r)))}),this.applyServerMerge_(e,t,c,r,i,s,o)},e.prototype.listenComplete_=function(e,t,n,r){var i=e.getServerCache(),o=e.updateServerSnap(i.getNode(),i.isFullyInitialized()||t.isEmpty(),i.isFiltered());return this.generateEventCacheAfterServerEvent_(o,t,n,pt,r)},e.prototype.revertUserWrite_=function(e,t,n,r,i){var o;if(null!=n.shadowingWrite(t))return e;var a=new dt(n,e,r),u=e.getEventCache().getNode(),c=void 0;if(t.isEmpty()||".priority"===t.getFront()){var h=void 0;if(e.getServerCache().isFullyInitialized())h=n.calcCompleteEventCache(e.getCompleteServerSnap());else{var l=e.getServerCache().getNode();s.assert(l instanceof Me,"serverChildren would be complete if leaf node"),h=n.calcCompleteEventChildren(l)}h=h,c=this.filter_.updateFullNode(u,h,i)}else{var p=t.getFront(),d=n.calcCompleteChild(p,e.getServerCache());null==d&&e.getServerCache().isCompleteForChild(p)&&(d=u.getImmediateChild(p)),(c=null!=d?this.filter_.updateChild(u,p,d,t.popFront(),a,i):e.getEventCache().getNode().hasChild(p)?this.filter_.updateChild(u,p,Me.EMPTY_NODE,t.popFront(),a,i):u).isEmpty()&&e.getServerCache().isFullyInitialized()&&(o=n.calcCompleteEventCache(e.getCompleteServerSnap())).isLeafNode()&&(c=this.filter_.updateFullNode(c,o,i))}return o=e.getServerCache().isFullyInitialized()||null!=n.shadowingWrite(U.Empty),e.updateEventSnap(c,o,this.filter_.filtersNodes())},e}(),yt=function(){function e(e){this.query_=e,this.index_=this.query_.getQueryParams().getIndex()}return e.prototype.generateEventsForChanges=function(e,t,n){var r=this,i=[],o=[];return e.forEach(function(e){e.type===ct.CHILD_CHANGED&&r.index_.indexedValueChanged(e.oldSnap,e.snapshotNode)&&o.push(ct.childMovedChange(e.childName,e.snapshotNode))}),this.generateEventsForType_(i,ct.CHILD_REMOVED,e,n,t),this.generateEventsForType_(i,ct.CHILD_ADDED,e,n,t),this.generateEventsForType_(i,ct.CHILD_MOVED,o,n,t),this.generateEventsForType_(i,ct.CHILD_CHANGED,e,n,t),this.generateEventsForType_(i,ct.VALUE,e,n,t),i},e.prototype.generateEventsForType_=function(e,t,n,r,i){var o=this,s=n.filter(function(e){return e.type===t});s.sort(this.compareChanges_.bind(this)),s.forEach(function(t){var n=o.materializeSingleChange_(t,i);r.forEach(function(r){r.respondsTo(t.type)&&e.push(r.createEvent(n,o.query_))})})},e.prototype.materializeSingleChange_=function(e,t){return"value"===e.type||"child_removed"===e.type?e:(e.prevName=t.getPredecessorChildName(e.childName,e.snapshotNode,this.index_),e)},e.prototype.compareChanges_=function(e,t){if(null==e.childName||null==t.childName)throw s.assertionError("Should only compare child_ events.");var n=new le(e.childName,e.snapshotNode),r=new le(t.childName,t.snapshotNode);return this.index_.compare(n,r)},e}(),vt=function(){function e(e,t){this.query_=e,this.eventRegistrations_=[];var n=this.query_.getQueryParams(),r=new ht(n.getIndex()),i=n.getNodeFilter();this.processor_=new mt(i);var o=t.getServerCache(),s=t.getEventCache(),a=r.updateFullNode(Me.EMPTY_NODE,o.getNode(),null),u=i.updateFullNode(Me.EMPTY_NODE,s.getNode(),null),c=new at(a,o.isFullyInitialized(),r.filtersNodes()),h=new at(u,s.isFullyInitialized(),i.filtersNodes());this.viewCache_=new ut(h,c),this.eventGenerator_=new yt(this.query_)}return e.prototype.getQuery=function(){return this.query_},e.prototype.getServerCache=function(){return this.viewCache_.getServerCache().getNode()},e.prototype.getCompleteServerCache=function(e){var t=this.viewCache_.getCompleteServerSnap();return t&&(this.query_.getQueryParams().loadsAllData()||!e.isEmpty()&&!t.getImmediateChild(e.getFront()).isEmpty())?t.getChild(e):null},e.prototype.isEmpty=function(){return 0===this.eventRegistrations_.length},e.prototype.addEventRegistration=function(e){this.eventRegistrations_.push(e)},e.prototype.removeEventRegistration=function(e,t){var n=[];if(t){s.assert(null==e,"A cancel should cancel all event registrations.");var r=this.query_.path;this.eventRegistrations_.forEach(function(e){t=t;var i=e.createCancelEvent(t,r);i&&n.push(i)})}if(e){for(var i=[],o=0;o<this.eventRegistrations_.length;++o){var a=this.eventRegistrations_[o];if(a.matches(e)){if(e.hasAnyCallback()){i=i.concat(this.eventRegistrations_.slice(o+1));break}}else i.push(a)}this.eventRegistrations_=i}else this.eventRegistrations_=[];return n},e.prototype.applyOperation=function(e,t,n){e.type===Ue.MERGE&&null!==e.source.queryId&&(s.assert(this.viewCache_.getCompleteServerSnap(),"We should always have a full cache before handling merges"),s.assert(this.viewCache_.getCompleteEventSnap(),"Missing event cache, even though we have a server cache"));var r=this.viewCache_,i=this.processor_.applyOperation(r,e,t,n);return this.processor_.assertIndexed(i.viewCache),s.assert(i.viewCache.getServerCache().isFullyInitialized()||!r.getServerCache().isFullyInitialized(),"Once a server snap is complete, it should never go back"),this.viewCache_=i.viewCache,this.generateEventsForChanges_(i.changes,i.viewCache.getEventCache().getNode(),null)},e.prototype.getInitialEvents=function(e){var t=this.viewCache_.getEventCache(),n=[];t.getNode().isLeafNode()||t.getNode().forEachChild(Se,function(e,t){n.push(ct.childAddedChange(e,t))});return t.isFullyInitialized()&&n.push(ct.valueChange(t.getNode())),this.generateEventsForChanges_(n,t.getNode(),e)},e.prototype.generateEventsForChanges_=function(e,t,n){var r=n?[n]:this.eventRegistrations_;return this.eventGenerator_.generateEventsForChanges(e,t,r)},e}(),gt=function(){function e(){this.views=new Map}return Object.defineProperty(e,"__referenceConstructor",{get:function(){return s.assert(Ze,"Reference.ts has not been loaded"),Ze},set:function(e){s.assert(!Ze,"__referenceConstructor has already been defined"),Ze=e},enumerable:!0,configurable:!0}),e.prototype.isEmpty=function(){return 0===this.views.size},e.prototype.applyOperation=function(e,t,n){var r,i,a=e.source.queryId;if(null!==a){var u=this.views.get(a);return s.assert(null!=u,"SyncTree gave us an op for an invalid query."),u.applyOperation(e,t,n)}var c=[];try{for(var h=o.__values(this.views.values()),l=h.next();!l.done;l=h.next()){u=l.value;c=c.concat(u.applyOperation(e,t,n))}}catch(e){r={error:e}}finally{try{l&&!l.done&&(i=h.return)&&i.call(h)}finally{if(r)throw r.error}}return c},e.prototype.addEventRegistration=function(e,t,n,r,i){var o=e.queryIdentifier(),s=this.views.get(o);if(!s){var a=n.calcCompleteEventCache(i?r:null),u=!1;a?u=!0:r instanceof Me?(a=n.calcCompleteEventChildren(r),u=!1):(a=Me.EMPTY_NODE,u=!1);var c=new ut(new at(a,u,!1),new at(r,i,!1));s=new vt(e,c),this.views.set(o,s)}return s.addEventRegistration(t),s.getInitialEvents(t)},e.prototype.removeEventRegistration=function(t,n,r){var i,s,a=t.queryIdentifier(),u=[],c=[],h=this.hasCompleteView();if("default"===a)try{for(var l=o.__values(this.views.entries()),p=l.next();!p.done;p=l.next()){var d=o.__read(p.value,2),f=d[0],m=d[1];c=c.concat(m.removeEventRegistration(n,r)),m.isEmpty()&&(this.views.delete(f),m.getQuery().getQueryParams().loadsAllData()||u.push(m.getQuery()))}}catch(e){i={error:e}}finally{try{p&&!p.done&&(s=l.return)&&s.call(l)}finally{if(i)throw i.error}}else(m=this.views.get(a))&&(c=c.concat(m.removeEventRegistration(n,r)),m.isEmpty()&&(this.views.delete(a),m.getQuery().getQueryParams().loadsAllData()||u.push(m.getQuery())));return h&&!this.hasCompleteView()&&u.push(new e.__referenceConstructor(t.repo,t.path)),{removed:u,events:c}},e.prototype.getQueryViews=function(){var e,t,n=[];try{for(var r=o.__values(this.views.values()),i=r.next();!i.done;i=r.next()){var s=i.value;s.getQuery().getQueryParams().loadsAllData()||n.push(s)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}return n},e.prototype.getCompleteServerCache=function(e){var t,n,r=null;try{for(var i=o.__values(this.views.values()),s=i.next();!s.done;s=i.next()){var a=s.value;r=r||a.getCompleteServerCache(e)}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return r},e.prototype.viewForQuery=function(e){if(e.getQueryParams().loadsAllData())return this.getCompleteView();var t=e.queryIdentifier();return this.views.get(t)},e.prototype.viewExistsForQuery=function(e){return null!=this.viewForQuery(e)},e.prototype.hasCompleteView=function(){return null!=this.getCompleteView()},e.prototype.getCompleteView=function(){var e,t;try{for(var n=o.__values(this.views.values()),r=n.next();!r.done;r=n.next()){var i=r.value;if(i.getQuery().getQueryParams().loadsAllData())return i}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}return null},e}(),_t=function(){function e(e){this.writeTree_=e}return e.prototype.addWrite=function(t,n){if(t.isEmpty())return new e(new rt(n));var r=this.writeTree_.findRootMostValueAndPath(t);if(null!=r){var i=r.path,o=r.value,s=U.relativePath(i,t);return o=o.updateChild(s,n),new e(this.writeTree_.set(i,o))}var a=new rt(n);return new e(this.writeTree_.setTree(t,a))},e.prototype.addWrites=function(e,t){var n=this;return P(t,function(t,r){n=n.addWrite(e.child(t),r)}),n},e.prototype.removeWrite=function(t){return t.isEmpty()?e.Empty:new e(this.writeTree_.setTree(t,rt.Empty))},e.prototype.hasCompleteWrite=function(e){return null!=this.getCompleteNode(e)},e.prototype.getCompleteNode=function(e){var t=this.writeTree_.findRootMostValueAndPath(e);return null!=t?this.writeTree_.get(t.path).getChild(U.relativePath(t.path,e)):null},e.prototype.getCompleteChildren=function(){var e=[],t=this.writeTree_.value;return null!=t?t.isLeafNode()||t.forEachChild(Se,function(t,n){e.push(new le(t,n))}):this.writeTree_.children.inorderTraversal(function(t,n){null!=n.value&&e.push(new le(t,n.value))}),e},e.prototype.childCompoundWrite=function(t){if(t.isEmpty())return this;var n=this.getCompleteNode(t);return new e(null!=n?new rt(n):this.writeTree_.subtree(t))},e.prototype.isEmpty=function(){return this.writeTree_.isEmpty()},e.prototype.apply=function(e){return function e(t,n,r){if(null!=n.value)return r.updateChild(t,n.value);var i=null;return n.children.inorderTraversal(function(n,o){".priority"===n?(s.assert(null!==o.value,"Priority writes must always be leaf nodes"),i=o.value):r=e(t.child(n),o,r)}),r.getChild(t).isEmpty()||null===i||(r=r.updateChild(t.child(".priority"),i)),r}(U.Empty,this.writeTree_,e)},e.Empty=new e(new rt(null)),e}();var bt=function(){function e(){this.visibleWrites_=_t.Empty,this.allWrites_=[],this.lastWriteId_=-1}return e.prototype.childWrites=function(e){return new wt(e,this)},e.prototype.addOverwrite=function(e,t,n,r){s.assert(n>this.lastWriteId_,"Stacking an older write on top of newer ones"),void 0===r&&(r=!0),this.allWrites_.push({path:e,snap:t,writeId:n,visible:r}),r&&(this.visibleWrites_=this.visibleWrites_.addWrite(e,t)),this.lastWriteId_=n},e.prototype.addMerge=function(e,t,n){s.assert(n>this.lastWriteId_,"Stacking an older merge on top of newer ones"),this.allWrites_.push({path:e,children:t,writeId:n,visible:!0}),this.visibleWrites_=this.visibleWrites_.addWrites(e,t),this.lastWriteId_=n},e.prototype.getWrite=function(e){for(var t=0;t<this.allWrites_.length;t++){var n=this.allWrites_[t];if(n.writeId===e)return n}return null},e.prototype.removeWrite=function(e){var t=this,n=this.allWrites_.findIndex(function(t){return t.writeId===e});s.assert(n>=0,"removeWrite called with nonexistent writeId.");var r=this.allWrites_[n];this.allWrites_.splice(n,1);for(var i=r.visible,o=!1,a=this.allWrites_.length-1;i&&a>=0;){var u=this.allWrites_[a];u.visible&&(a>=n&&this.recordContainsPath_(u,r.path)?i=!1:r.path.contains(u.path)&&(o=!0)),a--}if(i){if(o)return this.resetTree_(),!0;r.snap?this.visibleWrites_=this.visibleWrites_.removeWrite(r.path):P(r.children,function(e){t.visibleWrites_=t.visibleWrites_.removeWrite(r.path.child(e))});return!0}return!1},e.prototype.getCompleteWriteData=function(e){return this.visibleWrites_.getCompleteNode(e)},e.prototype.calcCompleteEventCache=function(t,n,r,i){if(r||i){var o=this.visibleWrites_.childCompoundWrite(t);if(!i&&o.isEmpty())return n;if(i||null!=n||o.hasCompleteWrite(U.Empty)){var s=e.layerTree_(this.allWrites_,function(e){return(e.visible||i)&&(!r||!~r.indexOf(e.writeId))&&(e.path.contains(t)||t.contains(e.path))},t);c=n||Me.EMPTY_NODE;return s.apply(c)}return null}var a=this.visibleWrites_.getCompleteNode(t);if(null!=a)return a;var u=this.visibleWrites_.childCompoundWrite(t);if(u.isEmpty())return n;if(null!=n||u.hasCompleteWrite(U.Empty)){var c=n||Me.EMPTY_NODE;return u.apply(c)}return null},e.prototype.calcCompleteEventChildren=function(e,t){var n=Me.EMPTY_NODE,r=this.visibleWrites_.getCompleteNode(e);if(r)return r.isLeafNode()||r.forEachChild(Se,function(e,t){n=n.updateImmediateChild(e,t)}),n;if(t){var i=this.visibleWrites_.childCompoundWrite(e);return t.forEachChild(Se,function(e,t){var r=i.childCompoundWrite(new U(e)).apply(t);n=n.updateImmediateChild(e,r)}),i.getCompleteChildren().forEach(function(e){n=n.updateImmediateChild(e.name,e.node)}),n}return this.visibleWrites_.childCompoundWrite(e).getCompleteChildren().forEach(function(e){n=n.updateImmediateChild(e.name,e.node)}),n},e.prototype.calcEventCacheAfterServerOverwrite=function(e,t,n,r){s.assert(n||r,"Either existingEventSnap or existingServerSnap must exist");var i=e.child(t);if(this.visibleWrites_.hasCompleteWrite(i))return null;var o=this.visibleWrites_.childCompoundWrite(i);return o.isEmpty()?r.getChild(t):o.apply(r.getChild(t))},e.prototype.calcCompleteChild=function(e,t,n){var r=e.child(t),i=this.visibleWrites_.getCompleteNode(r);return null!=i?i:n.isCompleteForChild(t)?this.visibleWrites_.childCompoundWrite(r).apply(n.getNode().getImmediateChild(t)):null},e.prototype.shadowingWrite=function(e){return this.visibleWrites_.getCompleteNode(e)},e.prototype.calcIndexedSlice=function(e,t,n,r,i,o){var s,a=this.visibleWrites_.childCompoundWrite(e),u=a.getCompleteNode(U.Empty);if(null!=u)s=u;else{if(null==t)return[];s=a.apply(t)}if((s=s.withIndex(o)).isEmpty()||s.isLeafNode())return[];for(var c=[],h=o.getCompare(),l=i?s.getReverseIteratorFrom(n,o):s.getIteratorFrom(n,o),p=l.getNext();p&&c.length<r;)0!==h(p,n)&&c.push(p),p=l.getNext();return c},e.prototype.recordContainsPath_=function(e,t){if(e.snap)return e.path.contains(t);for(var n in e.children)if(e.children.hasOwnProperty(n)&&e.path.child(n).contains(t))return!0;return!1},e.prototype.resetTree_=function(){this.visibleWrites_=e.layerTree_(this.allWrites_,e.DefaultFilter_,U.Empty),this.allWrites_.length>0?this.lastWriteId_=this.allWrites_[this.allWrites_.length-1].writeId:this.lastWriteId_=-1},e.DefaultFilter_=function(e){return e.visible},e.layerTree_=function(e,t,n){for(var r=_t.Empty,i=0;i<e.length;++i){var o=e[i];if(t(o)){var a=o.path,u=void 0;if(o.snap)n.contains(a)?(u=U.relativePath(n,a),r=r.addWrite(u,o.snap)):a.contains(n)&&(u=U.relativePath(a,n),r=r.addWrite(U.Empty,o.snap.getChild(u)));else{if(!o.children)throw s.assertionError("WriteRecord should have .snap or .children");if(n.contains(a))u=U.relativePath(n,a),r=r.addWrites(u,o.children);else if(a.contains(n))if((u=U.relativePath(a,n)).isEmpty())r=r.addWrites(U.Empty,o.children);else{var c=s.safeGet(o.children,u.getFront());if(c){var h=c.getChild(u.popFront());r=r.addWrite(U.Empty,h)}}}}}return r},e}(),wt=function(){function e(e,t){this.treePath_=e,this.writeTree_=t}return e.prototype.calcCompleteEventCache=function(e,t,n){return this.writeTree_.calcCompleteEventCache(this.treePath_,e,t,n)},e.prototype.calcCompleteEventChildren=function(e){return this.writeTree_.calcCompleteEventChildren(this.treePath_,e)},e.prototype.calcEventCacheAfterServerOverwrite=function(e,t,n){return this.writeTree_.calcEventCacheAfterServerOverwrite(this.treePath_,e,t,n)},e.prototype.shadowingWrite=function(e){return this.writeTree_.shadowingWrite(this.treePath_.child(e))},e.prototype.calcIndexedSlice=function(e,t,n,r,i){return this.writeTree_.calcIndexedSlice(this.treePath_,e,t,n,r,i)},e.prototype.calcCompleteChild=function(e,t){return this.writeTree_.calcCompleteChild(this.treePath_,e,t)},e.prototype.child=function(t){return new e(this.treePath_.child(t),this.writeTree_)},e}(),Et=function(){function e(e){this.listenProvider_=e,this.syncPointTree_=rt.Empty,this.pendingWriteTree_=new bt,this.tagToQueryMap=new Map,this.queryToTagMap=new Map}return e.prototype.applyUserOverwrite=function(e,t,n,r){return this.pendingWriteTree_.addOverwrite(e,t,n,r),r?this.applyOperationToSyncPoints_(new ot(et.User,e,t)):[]},e.prototype.applyUserMerge=function(e,t,n){this.pendingWriteTree_.addMerge(e,t,n);var r=rt.fromObject(t);return this.applyOperationToSyncPoints_(new st(et.User,e,r))},e.prototype.ackUserWrite=function(e,t){void 0===t&&(t=!1);var n=this.pendingWriteTree_.getWrite(e);if(this.pendingWriteTree_.removeWrite(e)){var r=rt.Empty;return null!=n.snap?r=r.set(U.Empty,!0):P(n.children,function(e,t){r=r.set(new U(e),t)}),this.applyOperationToSyncPoints_(new tt(n.path,r,t))}return[]},e.prototype.applyServerOverwrite=function(e,t){return this.applyOperationToSyncPoints_(new ot(et.Server,e,t))},e.prototype.applyServerMerge=function(e,t){var n=rt.fromObject(t);return this.applyOperationToSyncPoints_(new st(et.Server,e,n))},e.prototype.applyListenComplete=function(e){return this.applyOperationToSyncPoints_(new it(et.Server,e))},e.prototype.applyTaggedQueryOverwrite=function(t,n,r){var i=this.queryKeyForTag_(r);if(null!=i){var o=e.parseQueryKey_(i),s=o.path,a=o.queryId,u=U.relativePath(s,t),c=new ot(et.forServerTaggedQuery(a),u,n);return this.applyTaggedOperation_(s,c)}return[]},e.prototype.applyTaggedQueryMerge=function(t,n,r){var i=this.queryKeyForTag_(r);if(i){var o=e.parseQueryKey_(i),s=o.path,a=o.queryId,u=U.relativePath(s,t),c=rt.fromObject(n),h=new st(et.forServerTaggedQuery(a),u,c);return this.applyTaggedOperation_(s,h)}return[]},e.prototype.applyTaggedListenComplete=function(t,n){var r=this.queryKeyForTag_(n);if(r){var i=e.parseQueryKey_(r),o=i.path,s=i.queryId,a=U.relativePath(o,t),u=new it(et.forServerTaggedQuery(s),a);return this.applyTaggedOperation_(o,u)}return[]},e.prototype.addEventRegistration=function(t,n){var r=t.path,i=null,o=!1;this.syncPointTree_.foreachOnPath(r,function(e,t){var n=U.relativePath(e,r);i=i||t.getCompleteServerCache(n),o=o||t.hasCompleteView()});var a,u=this.syncPointTree_.get(r);(u?(o=o||u.hasCompleteView(),i=i||u.getCompleteServerCache(U.Empty)):(u=new gt,this.syncPointTree_=this.syncPointTree_.set(r,u)),null!=i)?a=!0:(a=!1,i=Me.EMPTY_NODE,this.syncPointTree_.subtree(r).foreachChild(function(e,t){var n=t.getCompleteServerCache(U.Empty);n&&(i=i.updateImmediateChild(e,n))}));var c=u.viewExistsForQuery(t);if(!c&&!t.getQueryParams().loadsAllData()){var h=e.makeQueryKey_(t);s.assert(!this.queryToTagMap.has(h),"View does not exist, but we have a tag");var l=e.getNextQueryTag_();this.queryToTagMap.set(h,l),this.tagToQueryMap.set(l,h)}var p=this.pendingWriteTree_.childWrites(r),d=u.addEventRegistration(t,n,p,i,a);if(!c&&!o){var f=u.viewForQuery(t);d=d.concat(this.setupListener_(t,f))}return d},e.prototype.removeEventRegistration=function(t,n,r){var i=this,o=t.path,s=this.syncPointTree_.get(o),a=[];if(s&&("default"===t.queryIdentifier()||s.viewExistsForQuery(t))){var u=s.removeEventRegistration(t,n,r);s.isEmpty()&&(this.syncPointTree_=this.syncPointTree_.remove(o));var c=u.removed;a=u.events;var h=-1!==c.findIndex(function(e){return e.getQueryParams().loadsAllData()}),l=this.syncPointTree_.findOnPath(o,function(e,t){return t.hasCompleteView()});if(h&&!l){var p=this.syncPointTree_.subtree(o);if(!p.isEmpty())for(var d=this.collectDistinctViewsForSubTree_(p),f=0;f<d.length;++f){var m=d[f],y=m.getQuery(),v=this.createListenerForView_(m);this.listenProvider_.startListening(e.queryForListening_(y),this.tagForQuery_(y),v.hashFn,v.onComplete)}}if(!l&&c.length>0&&!r)if(h){this.listenProvider_.stopListening(e.queryForListening_(t),null)}else c.forEach(function(t){var n=i.queryToTagMap.get(e.makeQueryKey_(t));i.listenProvider_.stopListening(e.queryForListening_(t),n)});this.removeTags_(c)}return a},e.prototype.calcCompleteEventCache=function(e,t){var n=this.pendingWriteTree_,r=this.syncPointTree_.findOnPath(e,function(t,n){var r=U.relativePath(t,e),i=n.getCompleteServerCache(r);if(i)return i});return n.calcCompleteEventCache(e,r,t,!0)},e.prototype.collectDistinctViewsForSubTree_=function(e){return e.fold(function(e,t,n){if(t&&t.hasCompleteView())return[t.getCompleteView()];var r=[];return t&&(r=t.getQueryViews()),P(n,function(e,t){r=r.concat(t)}),r})},e.prototype.removeTags_=function(t){for(var n=0;n<t.length;++n){var r=t[n];if(!r.getQueryParams().loadsAllData()){var i=e.makeQueryKey_(r),o=this.queryToTagMap.get(i);this.queryToTagMap.delete(i),this.tagToQueryMap.delete(o)}}},e.queryForListening_=function(e){return e.getQueryParams().loadsAllData()&&!e.getQueryParams().isDefault()?e.getRef():e},e.prototype.setupListener_=function(t,n){var r=t.path,i=this.tagForQuery_(t),o=this.createListenerForView_(n),a=this.listenProvider_.startListening(e.queryForListening_(t),i,o.hashFn,o.onComplete),u=this.syncPointTree_.subtree(r);if(i)s.assert(!u.value.hasCompleteView(),"If we're adding a query, it shouldn't be shadowed");else for(var c=u.fold(function(e,t,n){if(!e.isEmpty()&&t&&t.hasCompleteView())return[t.getCompleteView().getQuery()];var r=[];return t&&(r=r.concat(t.getQueryViews().map(function(e){return e.getQuery()}))),P(n,function(e,t){r=r.concat(t)}),r}),h=0;h<c.length;++h){var l=c[h];this.listenProvider_.stopListening(e.queryForListening_(l),this.tagForQuery_(l))}return a},e.prototype.createListenerForView_=function(e){var t=this,n=e.getQuery(),r=this.tagForQuery_(n);return{hashFn:function(){return(e.getServerCache()||Me.EMPTY_NODE).hash()},onComplete:function(e){if("ok"===e)return r?t.applyTaggedListenComplete(n.path,r):t.applyListenComplete(n.path);var i=function(e,t){var n="Unknown Error";"too_big"===e?n="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"==e?n="Client doesn't have permission to access the desired data.":"unavailable"==e&&(n="The service is unavailable");var r=new Error(e+" at "+t.path.toString()+": "+n);return r.code=e.toUpperCase(),r}(e,n);return t.removeEventRegistration(n,null,i)}}},e.makeQueryKey_=function(e){return e.path.toString()+"$"+e.queryIdentifier()},e.parseQueryKey_=function(e){var t=e.indexOf("$");return s.assert(-1!==t&&t<e.length-1,"Bad queryKey."),{queryId:e.substr(t+1),path:new U(e.substr(0,t))}},e.prototype.queryKeyForTag_=function(e){return this.tagToQueryMap.get(e)},e.prototype.tagForQuery_=function(t){var n=e.makeQueryKey_(t);return this.queryToTagMap.get(n)},e.getNextQueryTag_=function(){return e.nextQueryTag_++},e.prototype.applyTaggedOperation_=function(e,t){var n=this.syncPointTree_.get(e);s.assert(n,"Missing sync point for query tag that we're tracking");var r=this.pendingWriteTree_.childWrites(e);return n.applyOperation(t,r,null)},e.prototype.applyOperationToSyncPoints_=function(e){return this.applyOperationHelper_(e,this.syncPointTree_,null,this.pendingWriteTree_.childWrites(U.Empty))},e.prototype.applyOperationHelper_=function(e,t,n,r){if(e.path.isEmpty())return this.applyOperationDescendantsHelper_(e,t,n,r);var i=t.get(U.Empty);null==n&&null!=i&&(n=i.getCompleteServerCache(U.Empty));var o=[],s=e.path.getFront(),a=e.operationForChild(s),u=t.children.get(s);if(u&&a){var c=n?n.getImmediateChild(s):null,h=r.child(s);o=o.concat(this.applyOperationHelper_(a,u,c,h))}return i&&(o=o.concat(i.applyOperation(e,r,n))),o},e.prototype.applyOperationDescendantsHelper_=function(e,t,n,r){var i=this,o=t.get(U.Empty);null==n&&null!=o&&(n=o.getCompleteServerCache(U.Empty));var s=[];return t.children.inorderTraversal(function(t,o){var a=n?n.getImmediateChild(t):null,u=r.child(t),c=e.operationForChild(t);c&&(s=s.concat(i.applyOperationDescendantsHelper_(c,o,a,u)))}),o&&(s=s.concat(o.applyOperation(e,r,n))),s},e.nextQueryTag_=1,e}(),St=function(){function e(){this.rootNode_=Me.EMPTY_NODE}return e.prototype.getNode=function(e){return this.rootNode_.getChild(e)},e.prototype.updateSnapshot=function(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)},e}(),Ct=function(){function e(e){this.app_=e}return e.prototype.getToken=function(e){return this.app_.INTERNAL.getToken(e).then(null,function(e){return e&&"auth/token-not-initialized"===e.code?(b("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(e)})},e.prototype.addTokenChangeListener=function(e){this.app_.INTERNAL.addAuthTokenListener(e)},e.prototype.removeTokenChangeListener=function(e){this.app_.INTERNAL.removeAuthTokenListener(e)},e.prototype.notifyForInvalidToken=function(){var e='Provided authentication credentials for the app named "'+this.app_.name+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.app_.options?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.app_.options?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',C(e)},e}(),Tt=function(){function e(){this.counters_={}}return e.prototype.incrementCounter=function(e,t){void 0===t&&(t=1),s.contains(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t},e.prototype.get=function(){return s.deepCopy(this.counters_)},e}(),kt=function(){function e(){}return e.getCollection=function(e){var t=e.toString();return this.collections_[t]||(this.collections_[t]=new Tt),this.collections_[t]},e.getOrCreateReporter=function(e,t){var n=e.toString();return this.reporters_[n]||(this.reporters_[n]=t()),this.reporters_[n]},e.collections_={},e.reporters_={},e}(),It=function(){function e(e){this.collection_=e,this.last_=null}return e.prototype.get=function(){var e=this.collection_.get(),t=o.__assign({},e);return this.last_&&P(this.last_,function(e,n){t[e]=t[e]-n}),this.last_=e,t},e}(),At=1e4,Nt=3e4,Rt=function(){function e(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new It(e);var n=At+(Nt-At)*Math.random();B(this.reportStats_.bind(this),Math.floor(n))}return e.prototype.includeStat=function(e){this.statsToReport_[e]=!0},e.prototype.reportStats_=function(){var e=this,t={},n=!1;P(this.statsListener_.get(),function(r,i){i>0&&s.contains(e.statsToReport_,r)&&(t[r]=i,n=!0)}),n&&this.server_.reportStats(t),B(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))},e}(),Ot=function(){function e(){this.eventLists_=[],this.recursionDepth_=0}return e.prototype.queueEvents=function(e){for(var t=null,n=0;n<e.length;n++){var r=e[n],i=r.getPath();null===t||i.equals(t.getPath())||(this.eventLists_.push(t),t=null),null===t&&(t=new xt(i)),t.add(r)}t&&this.eventLists_.push(t)},e.prototype.raiseEventsAtPath=function(e,t){this.queueEvents(t),this.raiseQueuedEventsMatchingPredicate_(function(t){return t.equals(e)})},e.prototype.raiseEventsForChangedPath=function(e,t){this.queueEvents(t),this.raiseQueuedEventsMatchingPredicate_(function(t){return t.contains(e)||e.contains(t)})},e.prototype.raiseQueuedEventsMatchingPredicate_=function(e){this.recursionDepth_++;for(var t=!0,n=0;n<this.eventLists_.length;n++){var r=this.eventLists_[n];if(r)e(r.getPath())?(this.eventLists_[n].raise(),this.eventLists_[n]=null):t=!1}t&&(this.eventLists_=[]),this.recursionDepth_--},e}(),xt=function(){function e(e){this.path_=e,this.events_=[]}return e.prototype.add=function(e){this.events_.push(e)},e.prototype.raise=function(){for(var e=0;e<this.events_.length;e++){var t=this.events_[e];if(null!==t){this.events_[e]=null;var n=t.getEventRunner();v&&b("event: "+t.toString()),j(n)}}},e.prototype.getPath=function(){return this.path_},e}(),Pt=function(){function e(e){this.allowedEvents_=e,this.listeners_={},s.assert(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}return e.prototype.trigger=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(Array.isArray(this.listeners_[e]))for(var r=o.__spread(this.listeners_[e]),i=0;i<r.length;i++)r[i].callback.apply(r[i].context,t)},e.prototype.on=function(e,t,n){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:n});var r=this.getInitialEvent(e);r&&t.apply(n,r)},e.prototype.off=function(e,t,n){this.validateEventType_(e);for(var r=this.listeners_[e]||[],i=0;i<r.length;i++)if(r[i].callback===t&&(!n||n===r[i].context))return void r.splice(i,1)},e.prototype.validateEventType_=function(e){s.assert(this.allowedEvents_.find(function(t){return t===e}),"Unknown event: "+e)},e}(),Dt=function(e){function t(){var t,n,r=e.call(this,["visible"])||this;return"undefined"!=typeof document&&void 0!==document.addEventListener&&(void 0!==document.hidden?(n="visibilitychange",t="hidden"):void 0!==document.mozHidden?(n="mozvisibilitychange",t="mozHidden"):void 0!==document.msHidden?(n="msvisibilitychange",t="msHidden"):void 0!==document.webkitHidden&&(n="webkitvisibilitychange",t="webkitHidden")),r.visible_=!0,n&&document.addEventListener(n,function(){var e=!document[t];e!==r.visible_&&(r.visible_=e,r.trigger("visible",e))},!1),r}return o.__extends(t,e),t.getInstance=function(){return new t},t.prototype.getInitialEvent=function(e){return s.assert("visible"===e,"Unknown event type: "+e),[this.visible_]},t}(Pt),Mt=function(e){function t(){var t=e.call(this,["online"])||this;return t.online_=!0,"undefined"==typeof window||void 0===window.addEventListener||s.isMobileCordova()||(window.addEventListener("online",function(){t.online_||(t.online_=!0,t.trigger("online",!0))},!1),window.addEventListener("offline",function(){t.online_&&(t.online_=!1,t.trigger("online",!1))},!1)),t}return o.__extends(t,e),t.getInstance=function(){return new t},t.prototype.getInitialEvent=function(e){return s.assert("online"===e,"Unknown event type: "+e),[this.online_]},t.prototype.currentlyOnline=function(){return this.online_},t}(Pt),Lt=function(){function e(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}return e.prototype.closeAfter=function(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)},e.prototype.handleResponse=function(e,t){var n=this;this.pendingResponses[e]=t;for(var r=function(){var e=i.pendingResponses[i.currentResponseNum];delete i.pendingResponses[i.currentResponseNum];for(var t=function(t){e[t]&&j(function(){n.onMessage_(e[t])})},r=0;r<e.length;++r)t(r);if(i.currentResponseNum===i.closeAfterResponse)return i.onClose&&(i.onClose(),i.onClose=null),"break";i.currentResponseNum++},i=this;this.pendingResponses[this.currentResponseNum];){if("break"===r())break}},e}(),jt="pLPCommand",Ft="pRTLPCB",Bt=function(){function e(e,t,n,r){this.connId=e,this.repoInfo=t,this.transportSessionId=n,this.lastSessionId=r,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=w(e),this.stats_=kt.getCollection(t),this.urlFn=function(e){return t.connectionURL(q,e)}}return e.prototype.open=function(e,t){var n=this;this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new Lt(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(function(){n.log_("Timed out trying to connect."),n.onClosed_(),n.connectTimeoutTimer_=null},Math.floor(3e4)),function(e){if(s.isNodeSdk()||"complete"===document.readyState)e();else{var t=!1,n=function(){document.body?t||(t=!0,e()):setTimeout(n,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",function(){"complete"===document.readyState&&n()}),window.attachEvent("onload",n))}}(function(){if(!n.isClosed_){n.scriptTagHolder=new Ut(function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=o.__read(e,5),i=r[0],s=r[1],a=r[2];r[3],r[4];if(n.incrementIncomingBytes_(e),n.scriptTagHolder)if(n.connectTimeoutTimer_&&(clearTimeout(n.connectTimeoutTimer_),n.connectTimeoutTimer_=null),n.everConnected_=!0,"start"==i)n.id=s,n.password=a;else{if("close"!==i)throw new Error("Unrecognized command received: "+i);s?(n.scriptTagHolder.sendNewPolls=!1,n.myPacketOrderer.closeAfter(s,function(){n.onClosed_()})):n.onClosed_()}},function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=o.__read(e,2),i=r[0],s=r[1];n.incrementIncomingBytes_(e),n.myPacketOrderer.handleResponse(i,s)},function(){n.onClosed_()},n.urlFn);var e={start:"t"};e.ser=Math.floor(1e8*Math.random()),n.scriptTagHolder.uniqueCallbackIdentifier&&(e.cb=n.scriptTagHolder.uniqueCallbackIdentifier),e.v="5",n.transportSessionId&&(e.s=n.transportSessionId),n.lastSessionId&&(e.ls=n.lastSessionId),!s.isNodeSdk()&&"undefined"!=typeof location&&location.href&&-1!==location.href.indexOf("firebaseio.com")&&(e.r="f");var t=n.urlFn(e);n.log_("Connecting via long-poll to "+t),n.scriptTagHolder.addTag(t,function(){})}})},e.prototype.start=function(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)},e.forceAllow=function(){e.forceAllow_=!0},e.forceDisallow=function(){e.forceDisallow_=!0},e.isAvailable=function(){return e.forceAllow_||!e.forceDisallow_&&"undefined"!=typeof document&&null!=document.createElement&&!("object"==typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))&&!("object"==typeof Windows&&"object"==typeof Windows.UI)&&!s.isNodeSdk()},e.prototype.markConnectionHealthy=function(){},e.prototype.shutdown_=function(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)},e.prototype.onClosed_=function(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))},e.prototype.close=function(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())},e.prototype.send=function(e){var t=s.stringify(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);for(var n=s.base64Encode(t),r=x(n,1840),i=0;i<r.length;i++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,r.length,r[i]),this.curSegmentNum++},e.prototype.addDisconnectPingFrame=function(e,t){if(!s.isNodeSdk()){this.myDisconnFrame=document.createElement("iframe");var n={dframe:"t"};n.id=e,n.pw=t,this.myDisconnFrame.src=this.urlFn(n),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}},e.prototype.incrementIncomingBytes_=function(e){var t=s.stringify(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)},e}(),Ut=function(){function e(t,n,r,i){if(this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0,s.isNodeSdk())this.commandCB=t,this.onMessageCB=n;else{this.uniqueCallbackIdentifier=f(),window[jt+this.uniqueCallbackIdentifier]=t,window[Ft+this.uniqueCallbackIdentifier]=n,this.myIFrame=e.createIFrame_();var o="";if(this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,"javascript:".length))o='<script>document.domain="'+document.domain+'";<\/script>';var a="<html><body>"+o+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(a),this.myIFrame.doc.close()}catch(e){b("frame writing exception"),e.stack&&b(e.stack),b(e)}}}return e.createIFrame_=function(){var e=document.createElement("iframe");if(e.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(e);try{e.contentWindow.document||b("No IE domain setting required")}catch(n){var t=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+t+"';document.close();})())"}return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e},e.prototype.close=function(){var t=this;if(this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.innerHTML="",setTimeout(function(){null!==t.myIFrame&&(document.body.removeChild(t.myIFrame),t.myIFrame=null)},Math.floor(0))),s.isNodeSdk()&&this.myID){var n={disconn:"t"};n.id=this.myID,n.pw=this.myPW;var r=this.urlFn(n);e.nodeRestRequest(r)}var i=this.onDisconnect;i&&(this.onDisconnect=null,i())},e.prototype.startLongPoll=function(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););},e.prototype.newRequest_=function(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;var e={};e.id=this.myID,e.pw=this.myPW,e.ser=this.currentSerial;for(var t=this.urlFn(e),n="",r=0;this.pendingSegs.length>0;){if(!(this.pendingSegs[0].d.length+30+n.length<=1870))break;var i=this.pendingSegs.shift();n=n+"&seg"+r+"="+i.seg+"&ts"+r+"="+i.ts+"&d"+r+"="+i.d,r++}return t+=n,this.addLongPollTag_(t,this.currentSerial),!0}return!1},e.prototype.enqueueSegment=function(e,t,n){this.pendingSegs.push({seg:e,ts:t,d:n}),this.alive&&this.newRequest_()},e.prototype.addLongPollTag_=function(e,t){var n=this;this.outstandingRequests.add(t);var r=function(){n.outstandingRequests.delete(t),n.newRequest_()},i=setTimeout(r,Math.floor(25e3));this.addTag(e,function(){clearTimeout(i),r()})},e.prototype.addTag=function(e,t){var n=this;s.isNodeSdk()?this.doNodeLongPoll(e,t):setTimeout(function(){try{if(!n.sendNewPolls)return;var r=n.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){var e=r.readyState;e&&"loaded"!==e&&"complete"!==e||(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),t())},r.onerror=function(){b("Long-poll script failed to load: "+e),n.sendNewPolls=!1,n.close()},n.myIFrame.doc.body.appendChild(r)}catch(e){}},Math.floor(1))},e}(),Vt="";var qt=null;"undefined"!=typeof MozWebSocket?qt=MozWebSocket:"undefined"!=typeof WebSocket&&(qt=WebSocket);var Wt=function(){function e(t,n,r,i){this.connId=t,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=w(this.connId),this.stats_=kt.getCollection(n),this.connURL=e.connectionURL_(n,r,i)}return e.connectionURL_=function(e,t,n){var r={v:"5"};return!s.isNodeSdk()&&"undefined"!=typeof location&&location.href&&-1!==location.href.indexOf("firebaseio.com")&&(r.r="f"),t&&(r.s=t),n&&(r.ls=n),e.connectionURL("websocket",r)},e.prototype.open=function(e,t){var n=this;this.onDisconnect=t,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,l.set("previous_websocket_failure",!0);try{if(s.isNodeSdk()){var i=s.CONSTANTS.NODE_ADMIN?"AdminNode":"Node",o={headers:{"User-Agent":"Firebase/5/"+Vt+"/"+r.platform+"/"+i}},a=r.env,u=0==this.connURL.indexOf("wss://")?a.HTTPS_PROXY||a.https_proxy:a.HTTP_PROXY||a.http_proxy;u&&(o.proxy={origin:u}),this.mySock=new qt(this.connURL,[],o)}else this.mySock=new qt(this.connURL)}catch(e){this.log_("Error instantiating WebSocket.");var c=e.message||e.data;return c&&this.log_(c),void this.onClosed_()}this.mySock.onopen=function(){n.log_("Websocket connected."),n.everConnected_=!0},this.mySock.onclose=function(){n.log_("Websocket connection was disconnected."),n.mySock=null,n.onClosed_()},this.mySock.onmessage=function(e){n.handleIncomingFrame(e)},this.mySock.onerror=function(e){n.log_("WebSocket error.  Closing connection.");var t=e.message||e.data;t&&n.log_(t),n.onClosed_()}},e.prototype.start=function(){},e.forceDisallow=function(){e.forceDisallow_=!0},e.isAvailable=function(){var t=!1;if("undefined"!=typeof navigator&&navigator.userAgent){var n=navigator.userAgent.match(/Android ([0-9]{0,}\.[0-9]{0,})/);n&&n.length>1&&parseFloat(n[1])<4.4&&(t=!0)}return!t&&null!==qt&&!e.forceDisallow_},e.previouslyFailed=function(){return l.isInMemoryStorage||!0===l.get("previous_websocket_failure")},e.prototype.markConnectionHealthy=function(){l.remove("previous_websocket_failure")},e.prototype.appendFrame_=function(e){if(this.frames.push(e),this.frames.length==this.totalFrames){var t=this.frames.join("");this.frames=null;var n=s.jsonEval(t);this.onMessage(n)}},e.prototype.handleNewFrameCount_=function(e){this.totalFrames=e,this.frames=[]},e.prototype.extractFrameCount_=function(e){if(s.assert(null===this.frames,"We already have a frame buffer"),e.length<=6){var t=Number(e);if(!isNaN(t))return this.handleNewFrameCount_(t),null}return this.handleNewFrameCount_(1),e},e.prototype.handleIncomingFrame=function(e){if(null!==this.mySock){var t=e.data;if(this.bytesReceived+=t.length,this.stats_.incrementCounter("bytes_received",t.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(t);else{var n=this.extractFrameCount_(t);null!==n&&this.appendFrame_(n)}}},e.prototype.send=function(e){this.resetKeepAlive();var t=s.stringify(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);var n=x(t,16384);n.length>1&&this.sendString_(String(n.length));for(var r=0;r<n.length;r++)this.sendString_(n[r])},e.prototype.shutdown_=function(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)},e.prototype.onClosed_=function(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))},e.prototype.close=function(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())},e.prototype.resetKeepAlive=function(){var e=this;clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(function(){e.mySock&&e.sendString_("0"),e.resetKeepAlive()},Math.floor(45e3))},e.prototype.sendString_=function(e){try{this.mySock.send(e)}catch(e){this.log_("Exception thrown from WebSocket.send():",e.message||e.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}},e.responsesRequiredToBeHealthy=2,e.healthyTimeout=3e4,e}(),Ht=function(){function e(e){this.initTransports_(e)}return Object.defineProperty(e,"ALL_TRANSPORTS",{get:function(){return[Bt,Wt]},enumerable:!0,configurable:!0}),e.prototype.initTransports_=function(t){var n,r,i=Wt&&Wt.isAvailable(),s=i&&!Wt.previouslyFailed();if(t.webSocketOnly&&(i||C("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),s=!0),s)this.transports_=[Wt];else{var a=this.transports_=[];try{for(var u=o.__values(e.ALL_TRANSPORTS),c=u.next();!c.done;c=u.next()){var h=c.value;h&&h.isAvailable()&&a.push(h)}}catch(e){n={error:e}}finally{try{c&&!c.done&&(r=u.return)&&r.call(u)}finally{if(n)throw n.error}}}},e.prototype.initialTransport=function(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")},e.prototype.upgradeTransport=function(){return this.transports_.length>1?this.transports_[1]:null},e}(),Gt=function(){function e(e,t,n,r,i,o,s){this.id=e,this.repoInfo_=t,this.onMessage_=n,this.onReady_=r,this.onDisconnect_=i,this.onKill_=o,this.lastSessionId=s,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=w("c:"+this.id+":"),this.transportManager_=new Ht(t),this.log_("Connection created"),this.start_()}return e.prototype.start_=function(){var e=this,t=this.transportManager_.initialTransport();this.conn_=new t(this.nextTransportId_(),this.repoInfo_,void 0,this.lastSessionId),this.primaryResponsesRequired_=t.responsesRequiredToBeHealthy||0;var n=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(function(){e.conn_&&e.conn_.open(n,r)},Math.floor(0));var i=t.healthyTimeout||0;i>0&&(this.healthyTimeout_=B(function(){e.healthyTimeout_=null,e.isHealthy_||(e.conn_&&e.conn_.bytesReceived>102400?(e.log_("Connection exceeded healthy timeout but has received "+e.conn_.bytesReceived+" bytes.  Marking connection healthy."),e.isHealthy_=!0,e.conn_.markConnectionHealthy()):e.conn_&&e.conn_.bytesSent>10240?e.log_("Connection exceeded healthy timeout but has sent "+e.conn_.bytesSent+" bytes.  Leaving connection alive."):(e.log_("Closing unhealthy connection after timeout."),e.close()))},Math.floor(i)))},e.prototype.nextTransportId_=function(){return"c:"+this.id+":"+this.connectionCount++},e.prototype.disconnReceiver_=function(e){var t=this;return function(n){e===t.conn_?t.onConnectionLost_(n):e===t.secondaryConn_?(t.log_("Secondary connection lost."),t.onSecondaryConnectionLost_()):t.log_("closing an old connection")}},e.prototype.connReceiver_=function(e){var t=this;return function(n){2!=t.state_&&(e===t.rx_?t.onPrimaryMessageReceived_(n):e===t.secondaryConn_?t.onSecondaryMessageReceived_(n):t.log_("message on old connection"))}},e.prototype.sendRequest=function(e){var t={t:"d",d:e};this.sendData_(t)},e.prototype.tryCleanupConnection=function(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)},e.prototype.onSecondaryControl_=function(e){if("t"in e){var t=e.t;"a"===t?this.upgradeIfSecondaryHealthy_():"r"===t?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),this.tx_!==this.secondaryConn_&&this.rx_!==this.secondaryConn_||this.close()):"o"===t&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}},e.prototype.onSecondaryMessageReceived_=function(e){var t=R("t",e),n=R("d",e);if("c"==t)this.onSecondaryControl_(n);else{if("d"!=t)throw new Error("Unknown protocol layer: "+t);this.pendingDataMessages.push(n)}},e.prototype.upgradeIfSecondaryHealthy_=function(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))},e.prototype.proceedWithUpgrade_=function(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()},e.prototype.onPrimaryMessageReceived_=function(e){var t=R("t",e),n=R("d",e);"c"==t?this.onControl_(n):"d"==t&&this.onDataMessage_(n)},e.prototype.onDataMessage_=function(e){this.onPrimaryResponse_(),this.onMessage_(e)},e.prototype.onPrimaryResponse_=function(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))},e.prototype.onControl_=function(e){var t=R("t",e);if("d"in e){var n=e.d;if("h"===t)this.onHandshake_(n);else if("n"===t){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(var r=0;r<this.pendingDataMessages.length;++r)this.onDataMessage_(this.pendingDataMessages[r]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===t?this.onConnectionShutdown_(n):"r"===t?this.onReset_(n):"e"===t?E("Server Error: "+n):"o"===t?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):E("Unknown control packet command: "+t)}},e.prototype.onHandshake_=function(e){var t=e.ts,n=e.v,r=e.h;this.sessionId=e.s,this.repoInfo_.updateHost(r),0==this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),"5"!==n&&C("Protocol version mismatch detected"),this.tryStartUpgrade_())},e.prototype.tryStartUpgrade_=function(){var e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)},e.prototype.startUpgrade_=function(e){var t=this;this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;var n=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,r),B(function(){t.secondaryConn_&&(t.log_("Timed out trying to upgrade."),t.secondaryConn_.close())},Math.floor(6e4))},e.prototype.onReset_=function(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.updateHost(e),1===this.state_?this.close():(this.closeConnections_(),this.start_())},e.prototype.onConnectionEstablished_=function(e,t){var n=this;this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):B(function(){n.sendPingOnPrimaryIfNecessary_()},Math.floor(5e3))},e.prototype.sendPingOnPrimaryIfNecessary_=function(){this.isHealthy_||1!==this.state_||(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))},e.prototype.onSecondaryConnectionLost_=function(){var e=this.secondaryConn_;this.secondaryConn_=null,this.tx_!==e&&this.rx_!==e||this.close()},e.prototype.onConnectionLost_=function(e){this.conn_=null,e||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(l.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()},e.prototype.onConnectionShutdown_=function(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()},e.prototype.sendData_=function(e){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(e)},e.prototype.close=function(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))},e.prototype.closeConnections_=function(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)},e}(),zt=function(){function e(){}return e.prototype.put=function(e,t,n,r){},e.prototype.merge=function(e,t,n,r){},e.prototype.refreshAuthToken=function(e){},e.prototype.onDisconnectPut=function(e,t,n){},e.prototype.onDisconnectMerge=function(e,t,n){},e.prototype.onDisconnectCancel=function(e,t){},e.prototype.reportStats=function(e){},e}(),Yt=1e3,Qt=3e5,Kt=function(e){function t(n,r,i,o,a,u){var c=e.call(this)||this;if(c.repoInfo_=n,c.onDataUpdate_=r,c.onConnectStatus_=i,c.onServerInfoUpdate_=o,c.authTokenProvider_=a,c.authOverride_=u,c.id=t.nextPersistentConnectionId_++,c.log_=w("p:"+c.id+":"),c.interruptReasons_={},c.listens=new Map,c.outstandingPuts_=[],c.outstandingPutCount_=0,c.onDisconnectRequestQueue_=[],c.connected_=!1,c.reconnectDelay_=Yt,c.maxReconnectDelay_=Qt,c.securityDebugCallback_=null,c.lastSessionId=null,c.establishConnectionTimer_=null,c.visible_=!1,c.requestCBHash_={},c.requestNumber_=0,c.realtime_=null,c.authToken_=null,c.forceTokenRefresh_=!1,c.invalidAuthTokenCount_=0,c.firstConnection_=!0,c.lastConnectionAttemptTime_=null,c.lastConnectionEstablishedTime_=null,u&&!s.isNodeSdk())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");return c.scheduleConnect_(0),Dt.getInstance().on("visible",c.onVisible_,c),-1===n.host.indexOf("fblocal")&&Mt.getInstance().on("online",c.onOnline_,c),c}return o.__extends(t,e),t.prototype.sendRequest=function(e,t,n){var r=++this.requestNumber_,i={r:r,a:e,b:t};this.log_(s.stringify(i)),s.assert(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(i),n&&(this.requestCBHash_[r]=n)},t.prototype.listen=function(e,t,n,r){var i=e.queryIdentifier(),o=e.path.toString();this.log_("Listen called for "+o+" "+i),this.listens.has(o)||this.listens.set(o,new Map),s.assert(e.getQueryParams().isDefault()||!e.getQueryParams().loadsAllData(),"listen() called for non-default but complete query"),s.assert(!this.listens.get(o).has(i),"listen() called twice for same path/queryId.");var a={onComplete:r,hashFn:t,query:e,tag:n};this.listens.get(o).set(i,a),this.connected_&&this.sendListen_(a)},t.prototype.sendListen_=function(e){var n=this,r=e.query,i=r.path.toString(),o=r.queryIdentifier();this.log_("Listen on "+i+" for "+o);var s={p:i};e.tag&&(s.q=r.queryObject(),s.t=e.tag),s.h=e.hashFn(),this.sendRequest("q",s,function(s){var a=s.d,u=s.s;t.warnOnListenWarnings_(a,r),(n.listens.get(i)&&n.listens.get(i).get(o))===e&&(n.log_("listen response",s),"ok"!==u&&n.removeListen_(i,o),e.onComplete&&e.onComplete(u,a))})},t.warnOnListenWarnings_=function(e,t){if(e&&"object"==typeof e&&s.contains(e,"w")){var n=s.safeGet(e,"w");if(Array.isArray(n)&&~n.indexOf("no_index")){var r='".indexOn": "'+t.getQueryParams().getIndex().toString()+'"',i=t.path.toString();C("Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding "+r+" at "+i+" to your security rules for better performance.")}}},t.prototype.refreshAuthToken=function(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},function(){}),this.reduceReconnectDelayIfAdminCredential_(e)},t.prototype.reduceReconnectDelayIfAdminCredential_=function(e){(e&&40===e.length||s.isAdmin(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)},t.prototype.tryAuth=function(){var e=this;if(this.connected_&&this.authToken_){var t=this.authToken_,n=s.isValidFormat(t)?"auth":"gauth",r={cred:t};null===this.authOverride_?r.noauth=!0:"object"==typeof this.authOverride_&&(r.authvar=this.authOverride_),this.sendRequest(n,r,function(n){var r=n.s,i=n.d||"error";e.authToken_===t&&("ok"===r?e.invalidAuthTokenCount_=0:e.onAuthRevoked_(r,i))})}},t.prototype.unlisten=function(e,t){var n=e.path.toString(),r=e.queryIdentifier();this.log_("Unlisten called for "+n+" "+r),s.assert(e.getQueryParams().isDefault()||!e.getQueryParams().loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(n,r)&&this.connected_&&this.sendUnlisten_(n,r,e.queryObject(),t)},t.prototype.sendUnlisten_=function(e,t,n,r){this.log_("Unlisten on "+e+" for "+t);var i={p:e};r&&(i.q=n,i.t=r),this.sendRequest("n",i)},t.prototype.onDisconnectPut=function(e,t,n){this.connected_?this.sendOnDisconnect_("o",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:t,onComplete:n})},t.prototype.onDisconnectMerge=function(e,t,n){this.connected_?this.sendOnDisconnect_("om",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:t,onComplete:n})},t.prototype.onDisconnectCancel=function(e,t){this.connected_?this.sendOnDisconnect_("oc",e,null,t):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:t})},t.prototype.sendOnDisconnect_=function(e,t,n,r){var i={p:t,d:n};this.log_("onDisconnect "+e,i),this.sendRequest(e,i,function(e){r&&setTimeout(function(){r(e.s,e.d)},Math.floor(0))})},t.prototype.put=function(e,t,n,r){this.putInternal("p",e,t,n,r)},t.prototype.merge=function(e,t,n,r){this.putInternal("m",e,t,n,r)},t.prototype.putInternal=function(e,t,n,r,i){var o={p:t,d:n};void 0!==i&&(o.h=i),this.outstandingPuts_.push({action:e,request:o,onComplete:r}),this.outstandingPutCount_++;var s=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(s):this.log_("Buffering put: "+t)},t.prototype.sendPut_=function(e){var t=this,n=this.outstandingPuts_[e].action,r=this.outstandingPuts_[e].request,i=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(n,r,function(r){t.log_(n+" response",r),delete t.outstandingPuts_[e],t.outstandingPutCount_--,0===t.outstandingPutCount_&&(t.outstandingPuts_=[]),i&&i(r.s,r.d)})},t.prototype.reportStats=function(e){var t=this;if(this.connected_){var n={c:e};this.log_("reportStats",n),this.sendRequest("s",n,function(e){if("ok"!==e.s){var n=e.d;t.log_("reportStats","Error sending stats: "+n)}})}},t.prototype.onDataMessage_=function(e){if("r"in e){this.log_("from server: "+s.stringify(e));var t=e.r,n=this.requestCBHash_[t];n&&(delete this.requestCBHash_[t],n(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}},t.prototype.onDataPush_=function(e,t){this.log_("handleServerMessage",e,t),"d"===e?this.onDataUpdate_(t.p,t.d,!1,t.t):"m"===e?this.onDataUpdate_(t.p,t.d,!0,t.t):"c"===e?this.onListenRevoked_(t.p,t.q):"ac"===e?this.onAuthRevoked_(t.s,t.d):"sd"===e?this.onSecurityDebugPacket_(t):E("Unrecognized action received from server: "+s.stringify(e)+"\nAre you using the latest client?")},t.prototype.onReady_=function(e,t){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(e),this.lastSessionId=t,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)},t.prototype.scheduleConnect_=function(e){var t=this;s.assert(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(function(){t.establishConnectionTimer_=null,t.establishConnection_()},Math.floor(e))},t.prototype.onVisible_=function(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Yt,this.realtime_||this.scheduleConnect_(0)),this.visible_=e},t.prototype.onOnline_=function(e){e?(this.log_("Browser went online."),this.reconnectDelay_=Yt,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())},t.prototype.onRealtimeDisconnect_=function(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){if(this.visible_){if(this.lastConnectionEstablishedTime_){(new Date).getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=Yt),this.lastConnectionEstablishedTime_=null}}else this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime();var e=(new Date).getTime()-this.lastConnectionAttemptTime_,t=Math.max(0,this.reconnectDelay_-e);t=Math.random()*t,this.log_("Trying to reconnect in "+t+"ms"),this.scheduleConnect_(t),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)},t.prototype.establishConnection_=function(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=(new Date).getTime(),this.lastConnectionEstablishedTime_=null;var e=this.onDataMessage_.bind(this),n=this.onReady_.bind(this),r=this.onRealtimeDisconnect_.bind(this),i=this.id+":"+t.nextConnectionId_++,o=this,a=this.lastSessionId,u=!1,c=null,h=function(){c?c.close():(u=!0,r())};this.realtime_={close:h,sendRequest:function(e){s.assert(c,"sendRequest call when we're not connected not allowed."),c.sendRequest(e)}};var l=this.forceTokenRefresh_;this.forceTokenRefresh_=!1,this.authTokenProvider_.getToken(l).then(function(t){u?b("getToken() completed but was canceled"):(b("getToken() completed. Creating connection."),o.authToken_=t&&t.accessToken,c=new Gt(i,o.repoInfo_,e,n,r,function(e){C(e+" ("+o.repoInfo_.toString()+")"),o.interrupt("server_kill")},a))}).then(null,function(e){o.log_("Failed to get token: "+e),u||(s.CONSTANTS.NODE_ADMIN&&C(e),h())})}},t.prototype.interrupt=function(e){b("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())},t.prototype.resume=function(e){b("Resuming connection for reason: "+e),delete this.interruptReasons_[e],s.isEmpty(this.interruptReasons_)&&(this.reconnectDelay_=Yt,this.realtime_||this.scheduleConnect_(0))},t.prototype.handleTimestamp_=function(e){var t=e-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:t})},t.prototype.cancelSentTransactions_=function(){for(var e=0;e<this.outstandingPuts_.length;e++){var t=this.outstandingPuts_[e];t&&"h"in t.request&&t.queued&&(t.onComplete&&t.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])},t.prototype.onListenRevoked_=function(e,t){var n;n=t?t.map(function(e){return O(e)}).join("$"):"default";var r=this.removeListen_(e,n);r&&r.onComplete&&r.onComplete("permission_denied")},t.prototype.removeListen_=function(e,t){var n,r=new U(e).toString();if(this.listens.has(r)){var i=this.listens.get(r);n=i.get(t),i.delete(t),0===i.size&&this.listens.delete(r)}else n=void 0;return n},t.prototype.onAuthRevoked_=function(e,t){b("Auth token revoked: "+e+"/"+t),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),"invalid_token"!==e&&"permission_denied"!==e||(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))},t.prototype.onSecurityDebugPacket_=function(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace("\n","\nFIREBASE: "))},t.prototype.restoreState_=function(){var e,t,n,r;this.tryAuth();try{for(var i=o.__values(this.listens.values()),s=i.next();!s.done;s=i.next()){var a=s.value;try{for(var u=(n=void 0,o.__values(a.values())),c=u.next();!c.done;c=u.next()){var h=c.value;this.sendListen_(h)}}catch(e){n={error:e}}finally{try{c&&!c.done&&(r=u.return)&&r.call(u)}finally{if(n)throw n.error}}}}catch(t){e={error:t}}finally{try{s&&!s.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}for(var l=0;l<this.outstandingPuts_.length;l++)this.outstandingPuts_[l]&&this.sendPut_(l);for(;this.onDisconnectRequestQueue_.length;){var p=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(p.action,p.pathString,p.data,p.onComplete)}},t.prototype.sendConnectStats_=function(){var e={},t="js";s.CONSTANTS.NODE_ADMIN?t="admin_node":s.CONSTANTS.NODE_CLIENT&&(t="node"),e["sdk."+t+"."+Vt.replace(/\./g,"-")]=1,s.isMobileCordova()?e["framework.cordova"]=1:s.isReactNative()&&(e["framework.reactnative"]=1),this.reportStats(e)},t.prototype.shouldReconnect_=function(){var e=Mt.getInstance().currentlyOnline();return s.isEmpty(this.interruptReasons_)&&e},t.nextPersistentConnectionId_=0,t.nextConnectionId_=0,t}(zt),$t=function(e){function t(t,n,r){var i=e.call(this)||this;return i.repoInfo_=t,i.onDataUpdate_=n,i.authTokenProvider_=r,i.log_=w("p:rest:"),i.listens_={},i}return o.__extends(t,e),t.prototype.reportStats=function(e){throw new Error("Method not implemented.")},t.getListenId_=function(e,t){return void 0!==t?"tag$"+t:(s.assert(e.getQueryParams().isDefault(),"should have a tag if it's not a default query."),e.path.toString())},t.prototype.listen=function(e,n,r,i){var o=this,a=e.path.toString();this.log_("Listen called for "+a+" "+e.queryIdentifier());var u=t.getListenId_(e,r),c={};this.listens_[u]=c;var h=e.getQueryParams().toRestQueryStringParameters();this.restRequest_(a+".json",h,function(e,t){var n=t;(404===e&&(n=null,e=null),null===e&&o.onDataUpdate_(a,n,!1,r),s.safeGet(o.listens_,u)===c)&&i(e?401==e?"permission_denied":"rest_error:"+e:"ok",null)})},t.prototype.unlisten=function(e,n){var r=t.getListenId_(e,n);delete this.listens_[r]},t.prototype.refreshAuthToken=function(e){},t.prototype.restRequest_=function(e,t,n){var r=this;void 0===t&&(t={}),t.format="export",this.authTokenProvider_.getToken(!1).then(function(i){var o=i&&i.accessToken;o&&(t.auth=o);var a=(r.repoInfo_.secure?"https://":"http://")+r.repoInfo_.host+e+"?ns="+r.repoInfo_.namespace+s.querystring(t);r.log_("Sending REST request for "+a);var u=new XMLHttpRequest;u.onreadystatechange=function(){if(n&&4===u.readyState){r.log_("REST Response for "+a+" received. status:",u.status,"response:",u.responseText);var e=null;if(u.status>=200&&u.status<300){try{e=s.jsonEval(u.responseText)}catch(e){C("Failed to parse JSON response for "+a+": "+u.responseText)}n(null,e)}else 401!==u.status&&404!==u.status&&C("Got unsuccessful REST response for "+a+" Status: "+u.status),n(u.status);n=null}},u.open("GET",a,!0),u.send()})},t}(zt),Xt=function(){function e(e,t,n){var r=this;this.repoInfo_=e,this.app=n,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new Ot,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=new Ke,this.persistentConnection_=null;var i=new Ct(n);if(this.stats_=kt.getCollection(e),t||F())this.server_=new $t(this.repoInfo_,this.onDataUpdate_.bind(this),i),setTimeout(this.onConnectStatus_.bind(this,!0),0);else{var o=n.options.databaseAuthVariableOverride;if(void 0!==o&&null!==o){if("object"!=typeof o)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{s.stringify(o)}catch(e){throw new Error("Invalid authOverride provided: "+e)}}this.persistentConnection_=new Kt(this.repoInfo_,this.onDataUpdate_.bind(this),this.onConnectStatus_.bind(this),this.onServerInfoUpdate_.bind(this),i,o),this.server_=this.persistentConnection_}i.addTokenChangeListener(function(e){r.server_.refreshAuthToken(e)}),this.statsReporter_=kt.getOrCreateReporter(e,function(){return new Rt(r.stats_,r.server_)}),this.transactions_init_(),this.infoData_=new St,this.infoSyncTree_=new Et({startListening:function(e,t,n,i){var o=[],s=r.infoData_.getNode(e.path);return s.isEmpty()||(o=r.infoSyncTree_.applyServerOverwrite(e.path,s),setTimeout(function(){i("ok")},0)),o},stopListening:function(){}}),this.updateInfo_("connected",!1),this.serverSyncTree_=new Et({startListening:function(e,t,n,i){return r.server_.listen(e,n,t,function(t,n){var o=i(t,n);r.eventQueue_.raiseEventsForChangedPath(e.path,o)}),[]},stopListening:function(e,t){r.server_.unlisten(e,t)}})}return e.prototype.toString=function(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host},e.prototype.name=function(){return this.repoInfo_.namespace},e.prototype.serverTime=function(){var e=this.infoData_.getNode(new U(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+e},e.prototype.generateServerValues=function(){return function(e){return(e=e||{}).timestamp=e.timestamp||(new Date).getTime(),e}({timestamp:this.serverTime()})},e.prototype.onDataUpdate_=function(e,t,n,r){this.dataUpdateCount++;var i=new U(e);t=this.interceptServerDataCallback_?this.interceptServerDataCallback_(e,t):t;var o=[];if(r)if(n){var a=s.map(t,function(e){return Fe(e)});o=this.serverSyncTree_.applyTaggedQueryMerge(i,a,r)}else{var u=Fe(t);o=this.serverSyncTree_.applyTaggedQueryOverwrite(i,u,r)}else if(n){var c=s.map(t,function(e){return Fe(e)});o=this.serverSyncTree_.applyServerMerge(i,c)}else{var h=Fe(t);o=this.serverSyncTree_.applyServerOverwrite(i,h)}var l=i;o.length>0&&(l=this.rerunTransactions_(i)),this.eventQueue_.raiseEventsForChangedPath(l,o)},e.prototype.interceptServerData_=function(e){this.interceptServerDataCallback_=e},e.prototype.onConnectStatus_=function(e){this.updateInfo_("connected",e),!1===e&&this.runOnDisconnectEvents_()},e.prototype.onServerInfoUpdate_=function(e){var t=this;P(e,function(e,n){t.updateInfo_(n,e)})},e.prototype.updateInfo_=function(e,t){var n=new U("/.info/"+e),r=Fe(t);this.infoData_.updateSnapshot(n,r);var i=this.infoSyncTree_.applyServerOverwrite(n,r);this.eventQueue_.raiseEventsForChangedPath(n,i)},e.prototype.getNextWriteId_=function(){return this.nextWriteId_++},e.prototype.setWithPriority=function(e,t,n,r){var i=this;this.log_("set",{path:e.toString(),value:t,priority:n});var o=this.generateServerValues(),s=Fe(t,n),a=Xe(s,o),u=this.getNextWriteId_(),c=this.serverSyncTree_.applyUserOverwrite(e,a,u,!0);this.eventQueue_.queueEvents(c),this.server_.put(e.toString(),s.val(!0),function(t,n){var o="ok"===t;o||C("set at "+e+" failed: "+t);var s=i.serverSyncTree_.ackUserWrite(u,!o);i.eventQueue_.raiseEventsForChangedPath(e,s),i.callOnCompleteCallback(r,t,n)});var h=this.abortTransactions_(e);this.rerunTransactions_(h),this.eventQueue_.raiseEventsForChangedPath(h,[])},e.prototype.update=function(e,t,n){var r=this;this.log_("update",{path:e.toString(),value:t});var i=!0,o=this.generateServerValues(),s={};if(P(t,function(e,t){i=!1;var n=Fe(t);s[e]=Xe(n,o)}),i)b("update() called with empty data.  Don't do anything."),this.callOnCompleteCallback(n,"ok");else{var a=this.getNextWriteId_(),u=this.serverSyncTree_.applyUserMerge(e,s,a);this.eventQueue_.queueEvents(u),this.server_.merge(e.toString(),t,function(t,i){var o="ok"===t;o||C("update at "+e+" failed: "+t);var s=r.serverSyncTree_.ackUserWrite(a,!o),u=s.length>0?r.rerunTransactions_(e):e;r.eventQueue_.raiseEventsForChangedPath(u,s),r.callOnCompleteCallback(n,t,i)}),P(t,function(t){var n=r.abortTransactions_(e.child(t));r.rerunTransactions_(n)}),this.eventQueue_.raiseEventsForChangedPath(e,[])}},e.prototype.runOnDisconnectEvents_=function(){var e=this;this.log_("onDisconnectEvents");var t=this.generateServerValues(),n=[];(function(e,t){var n=new Ke;return e.forEachTree(new U(""),function(e,r){n.remember(e,Xe(r,t))}),n})(this.onDisconnect_,t).forEachTree(U.Empty,function(t,r){n=n.concat(e.serverSyncTree_.applyServerOverwrite(t,r));var i=e.abortTransactions_(t);e.rerunTransactions_(i)}),this.onDisconnect_=new Ke,this.eventQueue_.raiseEventsForChangedPath(U.Empty,n)},e.prototype.onDisconnectCancel=function(e,t){var n=this;this.server_.onDisconnectCancel(e.toString(),function(r,i){"ok"===r&&n.onDisconnect_.forget(e),n.callOnCompleteCallback(t,r,i)})},e.prototype.onDisconnectSet=function(e,t,n){var r=this,i=Fe(t);this.server_.onDisconnectPut(e.toString(),i.val(!0),function(t,o){"ok"===t&&r.onDisconnect_.remember(e,i),r.callOnCompleteCallback(n,t,o)})},e.prototype.onDisconnectSetWithPriority=function(e,t,n,r){var i=this,o=Fe(t,n);this.server_.onDisconnectPut(e.toString(),o.val(!0),function(t,n){"ok"===t&&i.onDisconnect_.remember(e,o),i.callOnCompleteCallback(r,t,n)})},e.prototype.onDisconnectUpdate=function(e,t,n){var r=this;if(s.isEmpty(t))return b("onDisconnect().update() called with empty data.  Don't do anything."),void this.callOnCompleteCallback(n,"ok");this.server_.onDisconnectMerge(e.toString(),t,function(i,o){"ok"===i&&P(t,function(t,n){var i=Fe(n);r.onDisconnect_.remember(e.child(t),i)}),r.callOnCompleteCallback(n,i,o)})},e.prototype.addEventCallbackForQuery=function(e,t){var n;n=".info"===e.path.getFront()?this.infoSyncTree_.addEventRegistration(e,t):this.serverSyncTree_.addEventRegistration(e,t),this.eventQueue_.raiseEventsAtPath(e.path,n)},e.prototype.removeEventCallbackForQuery=function(e,t){var n;n=".info"===e.path.getFront()?this.infoSyncTree_.removeEventRegistration(e,t):this.serverSyncTree_.removeEventRegistration(e,t),this.eventQueue_.raiseEventsAtPath(e.path,n)},e.prototype.interrupt=function(){this.persistentConnection_&&this.persistentConnection_.interrupt("repo_interrupt")},e.prototype.resume=function(){this.persistentConnection_&&this.persistentConnection_.resume("repo_interrupt")},e.prototype.stats=function(e){if(void 0===e&&(e=!1),"undefined"!=typeof console){var t;e?(this.statsListener_||(this.statsListener_=new It(this.stats_)),t=this.statsListener_.get()):t=this.stats_.get();var n=Object.keys(t).reduce(function(e,t){return Math.max(t.length,e)},0);P(t,function(e,t){for(var r=e,i=e.length;i<n+2;i++)r+=" ";console.log(r+t)})}},e.prototype.statsIncrementCounter=function(e){this.stats_.incrementCounter(e),this.statsReporter_.includeStat(e)},e.prototype.log_=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n="";this.persistentConnection_&&(n=this.persistentConnection_.id+":"),b.apply(void 0,o.__spread([n],e))},e.prototype.callOnCompleteCallback=function(e,t,n){e&&j(function(){if("ok"==t)e(null);else{var r=(t||"error").toUpperCase(),i=r;n&&(i+=": "+n);var o=new Error(i);o.code=r,e(o)}})},Object.defineProperty(e.prototype,"database",{get:function(){return this.__database||(this.__database=new un(this))},enumerable:!0,configurable:!0}),e}(),Jt=function(){function e(t){this.indexedFilter_=new ht(t.getIndex()),this.index_=t.getIndex(),this.startPost_=e.getStartPost_(t),this.endPost_=e.getEndPost_(t)}return e.prototype.getStartPost=function(){return this.startPost_},e.prototype.getEndPost=function(){return this.endPost_},e.prototype.matches=function(e){return this.index_.compare(this.getStartPost(),e)<=0&&this.index_.compare(e,this.getEndPost())<=0},e.prototype.updateChild=function(e,t,n,r,i,o){return this.matches(new le(t,n))||(n=Me.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,n,r,i,o)},e.prototype.updateFullNode=function(e,t,n){t.isLeafNode()&&(t=Me.EMPTY_NODE);var r=t.withIndex(this.index_);r=r.updatePriority(Me.EMPTY_NODE);var i=this;return t.forEachChild(Se,function(e,t){i.matches(new le(e,t))||(r=r.updateImmediateChild(e,Me.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,r,n)},e.prototype.updatePriority=function(e,t){return e},e.prototype.filtersNodes=function(){return!0},e.prototype.getIndexedFilter=function(){return this.indexedFilter_},e.prototype.getIndex=function(){return this.index_},e.getStartPost_=function(e){if(e.hasStart()){var t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}return e.getIndex().minPost()},e.getEndPost_=function(e){if(e.hasEnd()){var t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}return e.getIndex().maxPost()},e}(),Zt=function(){function e(e){this.rangedFilter_=new Jt(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft()}return e.prototype.updateChild=function(e,t,n,r,i,o){return this.rangedFilter_.matches(new le(t,n))||(n=Me.EMPTY_NODE),e.getImmediateChild(t).equals(n)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,n,r,i,o):this.fullLimitUpdateChild_(e,t,n,i,o)},e.prototype.updateFullNode=function(e,t,n){var r;if(t.isLeafNode()||t.isEmpty())r=Me.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<t.numChildren()&&t.isIndexed(this.index_)){r=Me.EMPTY_NODE.withIndex(this.index_);var i=void 0;i=this.reverse_?t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);for(var o=0;i.hasNext()&&o<this.limit_;){var s=i.getNext();if(!(this.reverse_?this.index_.compare(this.rangedFilter_.getStartPost(),s)<=0:this.index_.compare(s,this.rangedFilter_.getEndPost())<=0))break;r=r.updateImmediateChild(s.name,s.node),o++}}else{r=(r=t.withIndex(this.index_)).updatePriority(Me.EMPTY_NODE);var a=void 0,u=void 0,c=void 0;i=void 0;if(this.reverse_){i=r.getReverseIterator(this.index_),a=this.rangedFilter_.getEndPost(),u=this.rangedFilter_.getStartPost();var h=this.index_.getCompare();c=function(e,t){return h(t,e)}}else i=r.getIterator(this.index_),a=this.rangedFilter_.getStartPost(),u=this.rangedFilter_.getEndPost(),c=this.index_.getCompare();o=0;for(var l=!1;i.hasNext();){s=i.getNext();!l&&c(a,s)<=0&&(l=!0),l&&o<this.limit_&&c(s,u)<=0?o++:r=r.updateImmediateChild(s.name,Me.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,r,n)},e.prototype.updatePriority=function(e,t){return e},e.prototype.filtersNodes=function(){return!0},e.prototype.getIndexedFilter=function(){return this.rangedFilter_.getIndexedFilter()},e.prototype.getIndex=function(){return this.index_},e.prototype.fullLimitUpdateChild_=function(e,t,n,r,i){var o;if(this.reverse_){var a=this.index_.getCompare();o=function(e,t){return a(t,e)}}else o=this.index_.getCompare();var u=e;s.assert(u.numChildren()==this.limit_,"");var c=new le(t,n),h=this.reverse_?u.getFirstChild(this.index_):u.getLastChild(this.index_),l=this.rangedFilter_.matches(c);if(u.hasChild(t)){for(var p=u.getImmediateChild(t),d=r.getChildAfterChild(this.index_,h,this.reverse_);null!=d&&(d.name==t||u.hasChild(d.name));)d=r.getChildAfterChild(this.index_,d,this.reverse_);var f=null==d?1:o(d,c);if(l&&!n.isEmpty()&&f>=0)return null!=i&&i.trackChildChange(ct.childChangedChange(t,n,p)),u.updateImmediateChild(t,n);null!=i&&i.trackChildChange(ct.childRemovedChange(t,p));var m=u.updateImmediateChild(t,Me.EMPTY_NODE);return null!=d&&this.rangedFilter_.matches(d)?(null!=i&&i.trackChildChange(ct.childAddedChange(d.name,d.node)),m.updateImmediateChild(d.name,d.node)):m}return n.isEmpty()?e:l&&o(h,c)>=0?(null!=i&&(i.trackChildChange(ct.childRemovedChange(h.name,h.node)),i.trackChildChange(ct.childAddedChange(t,n))),u.updateImmediateChild(t,n).updateImmediateChild(h.name,Me.EMPTY_NODE)):e},e}(),en=function(){function e(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=Se}return e.prototype.hasStart=function(){return this.startSet_},e.prototype.isViewFromLeft=function(){return""===this.viewFrom_?this.startSet_:this.viewFrom_===e.WIRE_PROTOCOL_CONSTANTS_.VIEW_FROM_LEFT},e.prototype.getIndexStartValue=function(){return s.assert(this.startSet_,"Only valid if start has been set"),this.indexStartValue_},e.prototype.getIndexStartName=function(){return s.assert(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:k},e.prototype.hasEnd=function(){return this.endSet_},e.prototype.getIndexEndValue=function(){return s.assert(this.endSet_,"Only valid if end has been set"),this.indexEndValue_},e.prototype.getIndexEndName=function(){return s.assert(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:I},e.prototype.hasLimit=function(){return this.limitSet_},e.prototype.hasAnchoredLimit=function(){return this.limitSet_&&""!==this.viewFrom_},e.prototype.getLimit=function(){return s.assert(this.limitSet_,"Only valid if limit has been set"),this.limit_},e.prototype.getIndex=function(){return this.index_},e.prototype.copy_=function(){var t=new e;return t.limitSet_=this.limitSet_,t.limit_=this.limit_,t.startSet_=this.startSet_,t.indexStartValue_=this.indexStartValue_,t.startNameSet_=this.startNameSet_,t.indexStartName_=this.indexStartName_,t.endSet_=this.endSet_,t.indexEndValue_=this.indexEndValue_,t.endNameSet_=this.endNameSet_,t.indexEndName_=this.indexEndName_,t.index_=this.index_,t.viewFrom_=this.viewFrom_,t},e.prototype.limit=function(e){var t=this.copy_();return t.limitSet_=!0,t.limit_=e,t.viewFrom_="",t},e.prototype.limitToFirst=function(t){var n=this.copy_();return n.limitSet_=!0,n.limit_=t,n.viewFrom_=e.WIRE_PROTOCOL_CONSTANTS_.VIEW_FROM_LEFT,n},e.prototype.limitToLast=function(t){var n=this.copy_();return n.limitSet_=!0,n.limit_=t,n.viewFrom_=e.WIRE_PROTOCOL_CONSTANTS_.VIEW_FROM_RIGHT,n},e.prototype.startAt=function(e,t){var n=this.copy_();return n.startSet_=!0,void 0===e&&(e=null),n.indexStartValue_=e,null!=t?(n.startNameSet_=!0,n.indexStartName_=t):(n.startNameSet_=!1,n.indexStartName_=""),n},e.prototype.endAt=function(e,t){var n=this.copy_();return n.endSet_=!0,void 0===e&&(e=null),n.indexEndValue_=e,void 0!==t?(n.endNameSet_=!0,n.indexEndName_=t):(n.endNameSet_=!1,n.indexEndName_=""),n},e.prototype.orderBy=function(e){var t=this.copy_();return t.index_=e,t},e.prototype.getQueryObject=function(){var t=e.WIRE_PROTOCOL_CONSTANTS_,n={};if(this.startSet_&&(n[t.INDEX_START_VALUE]=this.indexStartValue_,this.startNameSet_&&(n[t.INDEX_START_NAME]=this.indexStartName_)),this.endSet_&&(n[t.INDEX_END_VALUE]=this.indexEndValue_,this.endNameSet_&&(n[t.INDEX_END_NAME]=this.indexEndName_)),this.limitSet_){n[t.LIMIT]=this.limit_;var r=this.viewFrom_;""===r&&(r=this.isViewFromLeft()?t.VIEW_FROM_LEFT:t.VIEW_FROM_RIGHT),n[t.VIEW_FROM]=r}return this.index_!==Se&&(n[t.INDEX]=this.index_.toString()),n},e.prototype.loadsAllData=function(){return!(this.startSet_||this.endSet_||this.limitSet_)},e.prototype.isDefault=function(){return this.loadsAllData()&&this.index_==Se},e.prototype.getNodeFilter=function(){return this.loadsAllData()?new ht(this.getIndex()):this.hasLimit()?new Zt(this):new Jt(this)},e.prototype.toRestQueryStringParameters=function(){var t,n=e.REST_QUERY_CONSTANTS_,r={};return this.isDefault()?r:(this.index_===Se?t=n.PRIORITY_INDEX:this.index_===Ve?t=n.VALUE_INDEX:this.index_===fe?t=n.KEY_INDEX:(s.assert(this.index_ instanceof qe,"Unrecognized index type!"),t=this.index_.toString()),r[n.ORDER_BY]=s.stringify(t),this.startSet_&&(r[n.START_AT]=s.stringify(this.indexStartValue_),this.startNameSet_&&(r[n.START_AT]+=","+s.stringify(this.indexStartName_))),this.endSet_&&(r[n.END_AT]=s.stringify(this.indexEndValue_),this.endNameSet_&&(r[n.END_AT]+=","+s.stringify(this.indexEndName_))),this.limitSet_&&(this.isViewFromLeft()?r[n.LIMIT_TO_FIRST]=this.limit_:r[n.LIMIT_TO_LAST]=this.limit_),r)},e.WIRE_PROTOCOL_CONSTANTS_={INDEX_START_VALUE:"sp",INDEX_START_NAME:"sn",INDEX_END_VALUE:"ep",INDEX_END_NAME:"en",LIMIT:"l",VIEW_FROM:"vf",VIEW_FROM_LEFT:"l",VIEW_FROM_RIGHT:"r",INDEX:"i"},e.REST_QUERY_CONSTANTS_={ORDER_BY:"orderBy",PRIORITY_INDEX:"$priority",VALUE_INDEX:"$value",KEY_INDEX:"$key",START_AT:"startAt",END_AT:"endAt",LIMIT_TO_FIRST:"limitToFirst",LIMIT_TO_LAST:"limitToLast"},e.DEFAULT=new e,e}(),tn=function(e){function t(t,n){if(!(t instanceof Xt))throw new Error("new Reference() no longer supported - use app.database().");return e.call(this,t,n,en.DEFAULT,!1)||this}return o.__extends(t,e),t.prototype.getKey=function(){return s.validateArgCount("Reference.key",0,0,arguments.length),this.path.isEmpty()?null:this.path.getBack()},t.prototype.child=function(e){return s.validateArgCount("Reference.child",1,1,arguments.length),"number"==typeof e?e=String(e):e instanceof U||(null===this.path.getFront()?function(e,t,n,r){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),oe(e,t,n,r)}("Reference.child",1,e,!1):oe("Reference.child",1,e,!1)),new t(this.repo,this.path.child(e))},t.prototype.getParent=function(){s.validateArgCount("Reference.parent",0,0,arguments.length);var e=this.path.parent();return null===e?null:new t(this.repo,e)},t.prototype.getRoot=function(){s.validateArgCount("Reference.root",0,0,arguments.length);for(var e=this;null!==e.getParent();)e=e.getParent();return e},t.prototype.databaseProp=function(){return this.repo.database},t.prototype.set=function(e,t){s.validateArgCount("Reference.set",1,2,arguments.length),se("Reference.set",this.path),Z("Reference.set",1,e,this.path,!1),s.validateCallback("Reference.set",2,t,!0);var n=new s.Deferred;return this.repo.setWithPriority(this.path,e,null,n.wrapCallback(t)),n.promise},t.prototype.update=function(e,t){if(s.validateArgCount("Reference.update",1,2,arguments.length),se("Reference.update",this.path),Array.isArray(e)){for(var n={},r=0;r<e.length;++r)n[""+r]=e[r];e=n,C("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}te("Reference.update",1,e,this.path,!1),s.validateCallback("Reference.update",2,t,!0);var i=new s.Deferred;return this.repo.update(this.path,e,i.wrapCallback(t)),i.promise},t.prototype.setWithPriority=function(e,t,n){if(s.validateArgCount("Reference.setWithPriority",2,3,arguments.length),se("Reference.setWithPriority",this.path),Z("Reference.setWithPriority",1,e,this.path,!1),ne("Reference.setWithPriority",2,t,!1),s.validateCallback("Reference.setWithPriority",3,n,!0),".length"===this.getKey()||".keys"===this.getKey())throw"Reference.setWithPriority failed: "+this.getKey()+" is a read-only object.";var r=new s.Deferred;return this.repo.setWithPriority(this.path,e,t,r.wrapCallback(n)),r.promise},t.prototype.remove=function(e){return s.validateArgCount("Reference.remove",0,1,arguments.length),se("Reference.remove",this.path),s.validateCallback("Reference.remove",1,e,!0),this.set(null,e)},t.prototype.transaction=function(e,t,n){if(s.validateArgCount("Reference.transaction",1,3,arguments.length),se("Reference.transaction",this.path),s.validateCallback("Reference.transaction",1,e,!1),s.validateCallback("Reference.transaction",2,t,!0),function(e,t,n,r){if((!r||void 0!==n)&&"boolean"!=typeof n)throw new Error(s.errorPrefix(e,t,r)+"must be a boolean.")}("Reference.transaction",3,n,!0),".length"===this.getKey()||".keys"===this.getKey())throw"Reference.transaction failed: "+this.getKey()+" is a read-only object.";void 0===n&&(n=!0);var r=new s.Deferred;"function"==typeof t&&r.promise.catch(function(){});return this.repo.startTransaction(this.path,e,function(e,n,i){e?r.reject(e):r.resolve(new ce(n,i)),"function"==typeof t&&t(e,n,i)},n),r.promise},t.prototype.setPriority=function(e,t){s.validateArgCount("Reference.setPriority",1,2,arguments.length),se("Reference.setPriority",this.path),ne("Reference.setPriority",1,e,!1),s.validateCallback("Reference.setPriority",2,t,!0);var n=new s.Deferred;return this.repo.setWithPriority(this.path.child(".priority"),e,null,n.wrapCallback(t)),n.promise},t.prototype.push=function(e,t){s.validateArgCount("Reference.push",0,2,arguments.length),se("Reference.push",this.path),Z("Reference.push",1,e,this.path,!0),s.validateCallback("Reference.push",2,t,!0);var n,r=this.repo.serverTime(),i=he(r),o=this.child(i),a=this.child(i);return n=null!=e?o.set(e,t).then(function(){return a}):Promise.resolve(a),o.then=n.then.bind(n),o.catch=n.then.bind(n,void 0),"function"==typeof t&&n.catch(function(){}),o},t.prototype.onDisconnect=function(){return se("Reference.onDisconnect",this.path),new ue(this.repo,this.path)},Object.defineProperty(t.prototype,"database",{get:function(){return this.databaseProp()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"key",{get:function(){return this.getKey()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return this.getParent()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"root",{get:function(){return this.getRoot()},enumerable:!0,configurable:!0}),t}(Qe);Qe.__referenceConstructor=tn,gt.__referenceConstructor=tn;var nn,rn=function(){return function(){this.children={},this.childCount=0,this.value=null}}(),on=function(){function e(e,t,n){void 0===e&&(e=""),void 0===t&&(t=null),void 0===n&&(n=new rn),this.name_=e,this.parent_=t,this.node_=n}return e.prototype.subTree=function(t){for(var n,r=t instanceof U?t:new U(t),i=this;null!==(n=r.getFront());){i=new e(n,i,s.safeGet(i.node_.children,n)||new rn),r=r.popFront()}return i},e.prototype.getValue=function(){return this.node_.value},e.prototype.setValue=function(e){s.assert(void 0!==e,"Cannot set value to undefined"),this.node_.value=e,this.updateParents_()},e.prototype.clear=function(){this.node_.value=null,this.node_.children={},this.node_.childCount=0,this.updateParents_()},e.prototype.hasChildren=function(){return this.node_.childCount>0},e.prototype.isEmpty=function(){return null===this.getValue()&&!this.hasChildren()},e.prototype.forEachChild=function(t){var n=this;P(this.node_.children,function(r,i){t(new e(r,n,i))})},e.prototype.forEachDescendant=function(e,t,n){t&&!n&&e(this),this.forEachChild(function(t){t.forEachDescendant(e,!0,n)}),t&&n&&e(this)},e.prototype.forEachAncestor=function(e,t){for(var n=t?this:this.parent();null!==n;){if(e(n))return!0;n=n.parent()}return!1},e.prototype.forEachImmediateDescendantWithValue=function(e){this.forEachChild(function(t){null!==t.getValue()?e(t):t.forEachImmediateDescendantWithValue(e)})},e.prototype.path=function(){return new U(null===this.parent_?this.name_:this.parent_.path()+"/"+this.name_)},e.prototype.name=function(){return this.name_},e.prototype.parent=function(){return this.parent_},e.prototype.updateParents_=function(){null!==this.parent_&&this.parent_.updateChild_(this.name_,this)},e.prototype.updateChild_=function(e,t){var n=t.isEmpty(),r=s.contains(this.node_.children,e);n&&r?(delete this.node_.children[e],this.node_.childCount--,this.updateParents_()):n||r||(this.node_.children[e]=t.node_,this.node_.childCount++,this.updateParents_())},e}();!function(e){e[e.RUN=0]="RUN",e[e.SENT=1]="SENT",e[e.COMPLETED=2]="COMPLETED",e[e.SENT_NEEDS_ABORT=3]="SENT_NEEDS_ABORT",e[e.NEEDS_ABORT=4]="NEEDS_ABORT"}(nn||(nn={})),Xt.MAX_TRANSACTION_RETRIES_=25,Xt.prototype.transactions_init_=function(){this.transactionQueueTree_=new on},Xt.prototype.startTransaction=function(e,t,n,r){this.log_("transaction on "+e);var i=function(){},o=new tn(this,e);o.on("value",i);var a={path:e,update:t,onComplete:n,status:null,order:f(),applyLocally:r,retryCount:0,unwatcher:function(){o.off("value",i)},abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},u=this.getLatestState_(e);a.currentInputSnapshot=u;var c=a.update(u.val());if(void 0===c){if(a.unwatcher(),a.currentOutputSnapshotRaw=null,a.currentOutputSnapshotResolved=null,a.onComplete){var h=new We(a.currentInputSnapshot,new tn(this,a.path),Se);a.onComplete(null,!1,h)}}else{ee("transaction failed: Data returned ",c,a.path),a.status=nn.RUN;var l=this.transactionQueueTree_.subTree(e),p=l.getValue()||[];p.push(a),l.setValue(p);var d=void 0;if("object"==typeof c&&null!==c&&s.contains(c,".priority"))d=s.safeGet(c,".priority"),s.assert(J(d),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.");else d=(this.serverSyncTree_.calcCompleteEventCache(e)||Me.EMPTY_NODE).getPriority().val();d=d;var m=this.generateServerValues(),y=Fe(c,d),v=Xe(y,m);a.currentOutputSnapshotRaw=y,a.currentOutputSnapshotResolved=v,a.currentWriteId=this.getNextWriteId_();var g=this.serverSyncTree_.applyUserOverwrite(e,v,a.currentWriteId,a.applyLocally);this.eventQueue_.raiseEventsForChangedPath(e,g),this.sendReadyTransactions_()}},Xt.prototype.getLatestState_=function(e,t){return this.serverSyncTree_.calcCompleteEventCache(e,t)||Me.EMPTY_NODE},Xt.prototype.sendReadyTransactions_=function(e){var t=this;if(void 0===e&&(e=this.transactionQueueTree_),e||this.pruneCompletedTransactionsBelowNode_(e),null!==e.getValue()){var n=this.buildTransactionQueue_(e);s.assert(n.length>0,"Sending zero length transaction queue"),n.every(function(e){return e.status===nn.RUN})&&this.sendTransactionQueue_(e.path(),n)}else e.hasChildren()&&e.forEachChild(function(e){t.sendReadyTransactions_(e)})},Xt.prototype.sendTransactionQueue_=function(e,t){for(var n=this,r=t.map(function(e){return e.currentWriteId}),i=this.getLatestState_(e,r),o=i,a=i.hash(),u=0;u<t.length;u++){var c=t[u];s.assert(c.status===nn.RUN,"tryToSendTransactionQueue_: items in queue should all be run."),c.status=nn.SENT,c.retryCount++;var h=U.relativePath(e,c.path);o=o.updateChild(h,c.currentOutputSnapshotRaw)}var l=o.val(!0),p=e;this.server_.put(p.toString(),l,function(r){n.log_("transaction put response",{path:p.toString(),status:r});var i=[];if("ok"===r){for(var o=[],s=0;s<t.length;s++){if(t[s].status=nn.COMPLETED,i=i.concat(n.serverSyncTree_.ackUserWrite(t[s].currentWriteId)),t[s].onComplete){var a=t[s].currentOutputSnapshotResolved,u=new tn(n,t[s].path),c=new We(a,u,Se);o.push(t[s].onComplete.bind(null,null,!0,c))}t[s].unwatcher()}n.pruneCompletedTransactionsBelowNode_(n.transactionQueueTree_.subTree(e)),n.sendReadyTransactions_(),n.eventQueue_.raiseEventsForChangedPath(e,i);for(s=0;s<o.length;s++)j(o[s])}else{if("datastale"===r)for(s=0;s<t.length;s++)t[s].status===nn.SENT_NEEDS_ABORT?t[s].status=nn.NEEDS_ABORT:t[s].status=nn.RUN;else{C("transaction at "+p.toString()+" failed: "+r);for(s=0;s<t.length;s++)t[s].status=nn.NEEDS_ABORT,t[s].abortReason=r}n.rerunTransactions_(e)}},a)},Xt.prototype.rerunTransactions_=function(e){var t=this.getAncestorTransactionNode_(e),n=t.path(),r=this.buildTransactionQueue_(t);return this.rerunTransactionQueue_(r,n),n},Xt.prototype.rerunTransactionQueue_=function(e,t){if(0!==e.length){for(var n=[],r=[],i=e.filter(function(e){return e.status===nn.RUN}).map(function(e){return e.currentWriteId}),o=0;o<e.length;o++){var a=e[o],u=U.relativePath(t,a.path),c=!1,h=void 0;if(s.assert(null!==u,"rerunTransactionsUnderNode_: relativePath should not be null."),a.status===nn.NEEDS_ABORT)c=!0,h=a.abortReason,r=r.concat(this.serverSyncTree_.ackUserWrite(a.currentWriteId,!0));else if(a.status===nn.RUN)if(a.retryCount>=Xt.MAX_TRANSACTION_RETRIES_)c=!0,h="maxretry",r=r.concat(this.serverSyncTree_.ackUserWrite(a.currentWriteId,!0));else{var l=this.getLatestState_(a.path,i);a.currentInputSnapshot=l;var p=e[o].update(l.val());if(void 0!==p){ee("transaction failed: Data returned ",p,a.path);var d=Fe(p);"object"==typeof p&&null!=p&&s.contains(p,".priority")||(d=d.updatePriority(l.getPriority()));var f=a.currentWriteId,m=this.generateServerValues(),y=Xe(d,m);a.currentOutputSnapshotRaw=d,a.currentOutputSnapshotResolved=y,a.currentWriteId=this.getNextWriteId_(),i.splice(i.indexOf(f),1),r=(r=r.concat(this.serverSyncTree_.applyUserOverwrite(a.path,y,a.currentWriteId,a.applyLocally))).concat(this.serverSyncTree_.ackUserWrite(f,!0))}else c=!0,h="nodata",r=r.concat(this.serverSyncTree_.ackUserWrite(a.currentWriteId,!0))}if(this.eventQueue_.raiseEventsForChangedPath(t,r),r=[],c&&(e[o].status=nn.COMPLETED,function(e){setTimeout(e,Math.floor(0))}(e[o].unwatcher),e[o].onComplete))if("nodata"===h){var v=new tn(this,e[o].path),g=e[o].currentInputSnapshot,_=new We(g,v,Se);n.push(e[o].onComplete.bind(null,null,!1,_))}else n.push(e[o].onComplete.bind(null,new Error(h),!1,null))}this.pruneCompletedTransactionsBelowNode_(this.transactionQueueTree_);for(o=0;o<n.length;o++)j(n[o]);this.sendReadyTransactions_()}},Xt.prototype.getAncestorTransactionNode_=function(e){for(var t,n=this.transactionQueueTree_;null!==(t=e.getFront())&&null===n.getValue();)n=n.subTree(t),e=e.popFront();return n},Xt.prototype.buildTransactionQueue_=function(e){var t=[];return this.aggregateTransactionQueuesForNode_(e,t),t.sort(function(e,t){return e.order-t.order}),t},Xt.prototype.aggregateTransactionQueuesForNode_=function(e,t){var n=this,r=e.getValue();if(null!==r)for(var i=0;i<r.length;i++)t.push(r[i]);e.forEachChild(function(e){n.aggregateTransactionQueuesForNode_(e,t)})},Xt.prototype.pruneCompletedTransactionsBelowNode_=function(e){var t=this,n=e.getValue();if(n){for(var r=0,i=0;i<n.length;i++)n[i].status!==nn.COMPLETED&&(n[r]=n[i],r++);n.length=r,e.setValue(n.length>0?n:null)}e.forEachChild(function(e){t.pruneCompletedTransactionsBelowNode_(e)})},Xt.prototype.abortTransactions_=function(e){var t=this,n=this.getAncestorTransactionNode_(e).path(),r=this.transactionQueueTree_.subTree(e);return r.forEachAncestor(function(e){t.abortTransactionsOnNode_(e)}),this.abortTransactionsOnNode_(r),r.forEachDescendant(function(e){t.abortTransactionsOnNode_(e)}),n},Xt.prototype.abortTransactionsOnNode_=function(e){var t=e.getValue();if(null!==t){for(var n=[],r=[],i=-1,o=0;o<t.length;o++)if(t[o].status===nn.SENT_NEEDS_ABORT);else if(t[o].status===nn.SENT)s.assert(i===o-1,"All SENT items should be at beginning of queue."),i=o,t[o].status=nn.SENT_NEEDS_ABORT,t[o].abortReason="set";else if(s.assert(t[o].status===nn.RUN,"Unexpected transaction status in abort"),t[o].unwatcher(),r=r.concat(this.serverSyncTree_.ackUserWrite(t[o].currentWriteId,!0)),t[o].onComplete){n.push(t[o].onComplete.bind(null,new Error("set"),!1,null))}-1===i?e.setValue(null):t.length=i+1,this.eventQueue_.raiseEventsForChangedPath(e.path(),r);for(o=0;o<n.length;o++)j(n[o])}};var sn,an=function(){function e(){this.repos_={},this.useRestClient_=!1}return e.getInstance=function(){return sn||(sn=new e),sn},e.prototype.interrupt=function(){for(var e in this.repos_)for(var t in this.repos_[e])this.repos_[e][t].interrupt()},e.prototype.resume=function(){for(var e in this.repos_)for(var t in this.repos_[e])this.repos_[e][t].resume()},e.prototype.databaseFromApp=function(e,t){var n=t||e.options.databaseURL;void 0===n&&S("Can't determine Firebase Database URL.  Be sure to include databaseURL option when calling firebase.initializeApp().");var r=z(n),i=r.repoInfo;return ae("Invalid Firebase Database URL",1,r),r.path.isEmpty()||S("Database URL must point to the root of a Firebase Database (not including a child path)."),this.createRepo(i,e).database},e.prototype.deleteRepo=function(e){var t=s.safeGet(this.repos_,e.app.name);t&&s.safeGet(t,e.repoInfo_.toURLString())===e||S("Database "+e.app.name+"("+e.repoInfo_+") has already been deleted."),e.interrupt(),delete t[e.repoInfo_.toURLString()]},e.prototype.createRepo=function(e,t){var n=s.safeGet(this.repos_,t.name);n||(n={},this.repos_[t.name]=n);var r=s.safeGet(n,e.toURLString());return r&&S("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),r=new Xt(e,this.useRestClient_,t),n[e.toURLString()]=r,r},e.prototype.forceRestClient=function(e){this.useRestClient_=e},e}(),un=function(){function e(e){this.repo_=e,e instanceof Xt||S("Don't call new Database() directly - please use firebase.database()."),this.root_=new tn(e,U.Empty),this.INTERNAL=new cn(this)}return Object.defineProperty(e.prototype,"app",{get:function(){return this.repo_.app},enumerable:!0,configurable:!0}),e.prototype.ref=function(e){return this.checkDeleted_("ref"),s.validateArgCount("database.ref",0,1,arguments.length),e instanceof tn?this.refFromURL(e.toString()):void 0!==e?this.root_.child(e):this.root_},e.prototype.refFromURL=function(e){var t="database.refFromURL";this.checkDeleted_(t),s.validateArgCount(t,1,1,arguments.length);var n=z(e);ae(t,1,n);var r=n.repoInfo;return r.host!==this.repo_.repoInfo_.host&&S(t+": Host name does not match the current database: (found "+r.host+" but expected "+this.repo_.repoInfo_.host+")"),this.ref(n.path.toString())},e.prototype.checkDeleted_=function(e){null===this.repo_&&S("Cannot call "+e+" on a deleted database.")},e.prototype.goOffline=function(){s.validateArgCount("database.goOffline",0,0,arguments.length),this.checkDeleted_("goOffline"),this.repo_.interrupt()},e.prototype.goOnline=function(){s.validateArgCount("database.goOnline",0,0,arguments.length),this.checkDeleted_("goOnline"),this.repo_.resume()},e.ServerValue={TIMESTAMP:{".sv":"timestamp"}},e}(),cn=function(){function e(e){this.database=e}return e.prototype.delete=function(){return o.__awaiter(this,void 0,void 0,function(){return o.__generator(this,function(e){return this.database.checkDeleted_("delete"),an.getInstance().deleteRepo(this.database.repo_),this.database.repo_=null,this.database.root_=null,this.database.INTERNAL=null,this.database=null,[2]})})},e}(),hn=Object.freeze({forceLongPolling:function(){Wt.forceDisallow(),Bt.forceAllow()},forceWebSockets:function(){Bt.forceDisallow()},isWebSocketsAvailable:function(){return Wt.isAvailable()},setSecurityDebugCallback:function(e,t){e.repo.persistentConnection_.securityDebugCallback_=t},stats:function(e,t){e.repo.stats(t)},statsIncrementCounter:function(e,t){e.repo.statsIncrementCounter(t)},dataUpdateCount:function(e){return e.repo.dataUpdateCount},interceptServerData:function(e,t){return e.repo.interceptServerData_(t)}}),ln=Kt;Kt.prototype.simpleListen=function(e,t){this.sendRequest("q",{p:e},t)},Kt.prototype.echo=function(e,t){this.sendRequest("echo",{d:e},t)};var pn=Gt,dn=W,fn=Object.freeze({DataConnection:ln,RealTimeConnection:pn,hijackHash:function(e){var t=Kt.prototype.put;return Kt.prototype.put=function(n,r,i,o){void 0!==o&&(o=e()),t.call(this,n,r,i,o)},function(){Kt.prototype.put=t}},ConnectionTarget:dn,queryIdentifier:function(e){return e.queryIdentifier()},forceRestClient:function(e){an.getInstance().forceRestClient(e)}}),mn=un.ServerValue;function yn(t){!function(e){Vt=e}(t.SDK_VERSION);var n=t.INTERNAL.registerService("database",function(e,t,n){return an.getInstance().databaseFromApp(e,n)},{Reference:tn,Query:Qe,Database:un,DataSnapshot:We,enableLogging:_,INTERNAL:hn,ServerValue:mn,TEST_ACCESS:fn},null,!0);s.isNodeSdk()&&(e.exports=n)}yn(i),t.DataSnapshot=We,t.Database=un,t.OnDisconnect=ue,t.Query=Qe,t.Reference=tn,t.ServerValue=mn,t.enableLogging=_,t.registerDatabase=yn}).call(t,n("W2nU"))},yviF:function(e,t,n){"use strict";var r=function(e){return e&&"object"==typeof e&&"default"in e?e.default:e}(n("O4tu"));e.exports=r}});