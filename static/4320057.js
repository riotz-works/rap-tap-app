(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{283:function(t,a,e){"use strict";e(302),e(303);var r=e(293),n=e.n(r),o=e(75);if(n.a.initializeApp(o.a.firebase),!n.a.auth||!n.a.database)throw Error("firebase auth and database are not supported");n.a.auth().signInAnonymously();var s=n.a.database();a.a=s},292:function(t,a,e){var r=e(317);"string"==typeof r&&(r=[[t.i,r,""]]),r.locals&&(t.exports=r.locals);(0,e(22).default)("f9165bb8",r,!0,{sourceMap:!1})},316:function(t,a,e){"use strict";var r=e(292);e.n(r).a},317:function(t,a,e){(a=e(21)(!1)).push([t.i,".chat-contents[data-v-3c6248f3]{max-height:200px;overflow:scroll}.chat-content-flex[data-v-3c6248f3],.chat-input-flex[data-v-3c6248f3]{margin:.2em}",""]),t.exports=a},318:function(t,a,e){var r=e(424);"string"==typeof r&&(r=[[t.i,r,""]]),r.locals&&(t.exports=r.locals);(0,e(22).default)("930581f4",r,!0,{sourceMap:!1})},320:function(t,a,e){"use strict";e.r(a);e(28);var r=e(0),n=e(283),o=r.a.extend({name:"Chat",props:{roomId:{type:String,required:!0},myNickname:{type:String,required:!0}},data:function(){return{chatCount:0,chats:[],chatInputMessage:""}},mounted:function(){var t=this;n.a.ref("/rooms/".concat(this.roomId,"/messages")).on("child_added",(function(a){if(a&&a.val()){var e=a.val();t.chats.push({id:"chatid-".concat(t.chatCount+1),nickname:e.name,content:e.content}),t.chatCount++}}))},methods:{sendChatMessage:function(){n.a.ref("/rooms/".concat(this.roomId,"/messages")).push({name:this.myNickname,content:this.chatInputMessage}),this.chatInputMessage=""}}}),s=(e(316),e(58)),c=e(116),i=e.n(c),p=e(298),u=e(274),l=e(301),d=e(390),m=e(391),h=e(429),v=Object(s.a)(o,(function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("section",[e("v-layout",{attrs:{row:""}},[e("v-flex",{staticClass:"chat-content-flex",attrs:{xs12:""}},[e("v-card",{staticClass:"chat-contents transparent-panel"},t._l(t.chats,(function(a){return e("div",{key:a.id},[e("v-chip",{attrs:{label:"",color:"pink","text-color":"white"}},[t._v("\n            "+t._s(a.nickname)+"\n          ")]),t._v(t._s(a.content)+"\n        ")],1)})),0)],1)],1),t._v(" "),e("v-layout",{attrs:{row:""}},[e("v-flex",{staticClass:"chat-input-flex",attrs:{xs12:""}},[e("v-card",{staticClass:"transparent-panel"},[e("v-card-actions",[e("v-text-field",{attrs:{counter:20,"append-icon":"chat",label:"メッセージを入力してください",required:""},on:{"click:append":t.sendChatMessage},model:{value:t.chatInputMessage,callback:function(a){t.chatInputMessage=a},expression:"chatInputMessage"}})],1)],1)],1)],1)],1)}),[],!1,null,"3c6248f3",null);a.default=v.exports;i()(v,{VCard:p.a,VCardActions:u.a,VChip:l.a,VFlex:d.a,VLayout:m.a,VTextField:h.a})},423:function(t,a,e){"use strict";var r=e(318);e.n(r).a},424:function(t,a,e){(a=e(21)(!1)).push([t.i,".battle-movie[data-v-500008f1]{width:100%;height:auto}.display-label[data-v-500008f1]{width:100%;margin:.5em 0}.margin-0-2[data-v-500008f1]{margin:.2em}",""]),t.exports=a},443:function(t,a,e){"use strict";e.r(a);e(115);var r=e(334),n=e.n(r),o=e(0),s=e(75),c=e(283),i=o.a.extend({data:function(){return{roomState:"wating",peer:void 0,rapperStreamA:void 0,rapperStreamB:void 0,rappers:{A:{state:"waiting",nickname:"Waiting...",peerId:void 0,feedback:{thumbUp:0,thumbDown:0}},B:{state:"waiting",nickname:"Waiting...",peerId:void 0,feedback:{thumbUp:0,thumbDown:0}}}}},computed:{roomId:function(){return this.$route.query.roomId},roomName:function(){return this.$route.query.roomName},nickname:function(){return this.$route.query.nickname}},mounted:function(){var t=this;this.peer=new n.a({key:s.a.skywayApiKey,debug:3}),this.peer.on("open",(function(){var a=t.peer.joinRoom(t.roomId,{mode:"sfu"});a.on("peerJoin",(function(){})),a.on("stream",(function(a){t.$coreApi.get("/rooms/".concat(t.roomId)).then((function(e){var r=e.data.rappers.find((function(t){return t.peerId===a.peerId}));if(r){if(t.rappers.A.peerId){if(!t.rappers.B.peerId){t.rappers.B.peerId=r.peerId,t.rappers.B.nickname=r.nickname,c.a.ref("/rooms/".concat(t.roomId,"/rappers/").concat(t.rappers.B.peerId,"/feedback")).on("value",(function(a){a&&a.val()&&(t.rappers.B.feedback=a.val())})),t.rappers.B.state="entered",t.rapperStreamB=a,document.getElementById("rapper-b").srcObject=a}}else t.rappers.A.peerId=r.peerId,t.rappers.A.nickname=r.nickname,c.a.ref("/rooms/".concat(t.roomId,"/rappers/").concat(t.rappers.A.peerId,"/feedback")).on("value",(function(a){a&&a.val()&&(t.rappers.A.feedback=a.val())})),t.rappers.A.state="entered",t.rapperStreamA=a,document.getElementById("rapper-a").srcObject=a;t.rappers.A.peerId&&t.rappers.B.peerId&&(t.roomState="started")}}))}))}))},methods:{sendMessage:function(){c.a.ref("/rooms/".concat(this.$route.query.roomId,"/messages")).push({name:this.nickname,content:this.chatMessage}),this.chatMessage=""},onClickThumbUpForA:function(){c.a.ref("/rooms/".concat(this.$route.query.roomId,"/rappers/").concat(this.rappers.A.peerId,"/feedback")).transaction((function(t){return t?{thumbUp:t.thumbUp+1,thumbDown:t.thumbDown}:void 0}))},onClickThumbDownForA:function(){c.a.ref("/rooms/".concat(this.$route.query.roomId,"/rappers/").concat(this.rappers.A.peerId,"/feedback")).transaction((function(t){return t?{thumbUp:t.thumbUp,thumbDown:t.thumbDown+1}:void 0}))},onClickThumbUpForB:function(){c.a.ref("/rooms/".concat(this.$route.query.roomId,"/rappers/").concat(this.rappers.B.peerId,"/feedback")).transaction((function(t){return t?{thumbUp:t.thumbUp+1,thumbDown:t.thumbDown}:void 0}))},onClickThumbDownForB:function(){c.a.ref("/rooms/".concat(this.$route.query.roomId,"/rappers/").concat(this.rappers.B.peerId,"/feedback")).transaction((function(t){return t?{thumbUp:t.thumbUp,thumbDown:t.thumbDown+1}:void 0}))}}}),p=(e(423),e(58)),u=e(116),l=e.n(u),d=e(307),m=e(298),h=e(274),v=e(301),f=e(390),b=e(324),k=e(391),_=e(278),w=e(270),C=Object(p.a)(i,(function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("section",[e("v-layout",{attrs:{row:""}},[e("v-flex",{staticClass:"margin-0-2",attrs:{xs6:"","text-xs-center":""}},[e("v-card",{staticClass:"transparent-panel"},["waiting"===t.rappers.A.state?e("div",[e("br"),t._v(" "),e("v-progress-circular",{staticClass:"battle-movie",attrs:{size:50,color:"amber",indeterminate:""}})],1):t._e(),t._v(" "),e("video",{staticClass:"battle-movie",attrs:{id:"rapper-a",autoplay:"",playsinline:""}}),t._v(" "),e("v-card-title",[e("div",[t._v(t._s(t.rappers.A.nickname))])]),t._v(" "),e("v-card-actions",[e("v-chip",{attrs:{color:"white",label:"",outline:""},on:{click:t.onClickThumbUpForA}},[e("v-avatar",[e("v-icon",{staticClass:"neon"},[t._v("thumb_up")])],1),t._v(" "),e("span",{staticClass:"neon"},[t._v(t._s(t.rappers.A.feedback.thumbUp))])],1),t._v(" "),e("v-spacer"),t._v(" "),e("v-chip",{attrs:{color:"white",label:"",outline:""},on:{click:t.onClickThumbDownForA}},[e("span",{staticClass:"neon-blue"},[t._v(t._s(t.rappers.A.feedback.thumbDown))]),t._v(" "),e("v-avatar",[e("v-icon",{staticClass:"neon-blue thumbDown"},[t._v("thumb_down")])],1)],1)],1)],1)],1),t._v(" "),e("v-flex",{staticClass:"margin-0-2",attrs:{xs6:"","text-xs-center":""}},[e("v-card",{staticClass:"transparent-panel"},["waiting"===t.rappers.B.state?e("div",[e("br"),t._v(" "),e("v-progress-circular",{staticClass:"battle-movie",attrs:{size:50,color:"amber",indeterminate:""}})],1):t._e(),t._v(" "),e("video",{staticClass:"battle-movie",attrs:{id:"rapper-b",autoplay:"",playsinline:""}}),t._v(" "),e("v-card-title",[e("div",[t._v(t._s(t.rappers.B.nickname))])]),t._v(" "),e("v-card-actions",[e("v-chip",{attrs:{color:"white",label:"",outline:""},on:{click:t.onClickThumbUpForB}},[e("v-avatar",[e("v-icon",{staticClass:"neon"},[t._v("thumb_up")])],1),t._v(" "),e("span",{staticClass:"neon"},[t._v(t._s(t.rappers.B.feedback.thumbUp))])],1),t._v(" "),e("v-spacer"),t._v(" "),e("v-chip",{attrs:{color:"white",label:"",outline:""},on:{click:t.onClickThumbDownForB}},[e("span",{staticClass:"neon-blue"},[t._v(t._s(t.rappers.B.feedback.thumbDown))]),t._v(" "),e("v-avatar",[e("v-icon",{staticClass:"neon-blue thumbDown"},[t._v("thumb_down")])],1)],1)],1)],1)],1)],1),t._v(" "),e("chat",{attrs:{"room-id":t.roomId,"my-nickname":t.nickname}})],1)}),[],!1,null,"500008f1",null);a.default=C.exports;l()(C,{Chat:e(320).default}),l()(C,{VAvatar:d.a,VCard:m.a,VCardActions:h.a,VCardTitle:h.b,VChip:v.a,VFlex:f.a,VIcon:b.a,VLayout:k.a,VProgressCircular:_.a,VSpacer:w.a})}}]);